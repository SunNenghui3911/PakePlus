var requirejs,require,define;!function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var i;if(e)for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}function eachReverse(e,t){var i;if(e)for(i=e.length-1;-1<i&&(!e[i]||!t(e[i],i,e));i-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,s){return t&&eachProp(t,function(t,n){!i&&hasProp(e,n)||(!s||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[n]=t:(e[n]||(e[n]={}),mixin(e[n],t,i,s)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,s){var n=new Error(t+"\nhttps://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=s,i&&(n.originalError=i),n}if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,s){var n,a,r=defContextName;return isArray(e)||"string"==typeof e||(a=e,isArray(t)?(e=t,t=i,i=s):e=[]),a&&a.context&&(r=a.context),(n=getOwn(contexts,r))||(n=contexts[r]=req.s.newContext(r)),a&&n.configure(a),n.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var s=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return s.type=e.scriptType||"text/javascript",s.charset="utf-8",s.async=!0,s},req.load=function(e,t,i){var s,n=e&&e.config||{};if(isBrowser)return(s=req.createNode(n,t,i)).setAttribute("data-requirecontext",e.contextName),s.setAttribute("data-requiremodule",t),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",e.onScriptLoad,!1),s.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",e.onScriptLoad)),s.src=i,n.onNodeCreated&&n.onNodeCreated(s,n,t,i),currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(mainScript=(src=mainScript.split("/")).pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var s,n;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript())&&(e||(e=s.getAttribute("data-requiremodule")),n=contexts[s.getAttribute("data-requirecontext")]),n?(n.defQueue.push([e,t,i]),n.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(e){var t,i,s,n,a,r={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},o={},l={},d={},c=[],h={},u={},g={},m=1,p=1;function f(e,t,i){var s,n,a,o,l,d,c,h,u,g,m=t&&t.split("/"),p=r.map,f=p&&p["*"];if(e&&(d=(e=e.split("/")).length-1,r.nodeIdCompat&&jsSuffixRegExp.test(e[d])&&(e[d]=e[d].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&m&&(e=m.slice(0,m.length-1).concat(e)),function(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;0<t&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),i&&p&&(m||f)){e:for(a=(n=e.split("/")).length;0<a;a-=1){if(l=n.slice(0,a).join("/"),m)for(o=m.length;0<o;o-=1)if((s=getOwn(p,m.slice(0,o).join("/")))&&(s=getOwn(s,l))){c=s,h=a;break e}!u&&f&&getOwn(f,l)&&(u=getOwn(f,l),g=a)}!c&&u&&(c=u,h=g),c&&(n.splice(0,h,c),e=n.join("/"))}return getOwn(r.pkgs,e)||e}function b(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===s.contextName)return t.parentNode.removeChild(t),!0})}function v(e){var t=getOwn(r.paths,e);if(t&&isArray(t)&&1<t.length)return t.shift(),s.require.undef(e),s.makeRequire(null,{skipMap:!0})([e]),!0}function y(e){var t,i=e?e.indexOf("!"):-1;return-1<i&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function w(e,t,i,n){var a,r,o,l,d=null,c=t?t.name:null,u=e,g=!0,b="";return e||(g=!1,e="_@r"+(m+=1)),d=(l=y(e))[0],e=l[1],d&&(d=f(d,c,n),r=getOwn(h,d)),e&&(d?b=i?e:r&&r.normalize?r.normalize(e,function(e){return f(e,c,n)}):-1===e.indexOf("!")?f(e,c,n):e:(d=(l=y(b=f(e,c,n)))[0],b=l[1],i=!0,a=s.nameToUrl(b))),{prefix:d,name:b,parentMap:t,unnormalized:!!(o=!d||r||i?"":"_unnormalized"+(p+=1)),url:a,originalName:u,isDefine:g,id:(d?d+"!"+b:b)+o}}function x(e){var t=e.id,i=getOwn(o,t);return i||(i=o[t]=new s.Module(e)),i}function E(e,t,i){var s=e.id,n=getOwn(o,s);!hasProp(h,s)||n&&!n.defineEmitComplete?(n=x(e)).error&&"error"===t?i(n.error):n.on(t,i):"defined"===t&&i(h[s])}function I(e,t){var i=e.requireModules,s=!1;t?t(e):(each(i,function(t){var i=getOwn(o,t);i&&(i.error=e,i.events.error&&(s=!0,i.emit("error",e)))}),s||req.onError(e))}function C(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(s.defQueueMap[t]=!0),c.push(e)}),globalDefQueue=[])}function _(e){delete o[e],delete l[e]}function S(){var e,i,n=1e3*r.waitSeconds,d=n&&s.startTime+n<(new Date).getTime(),c=[],u=[],g=!1,m=!0;if(!t){if(t=!0,eachProp(l,function(e){var t=e.map,s=t.id;if(e.enabled&&(t.isDefine||u.push(e),!e.error))if(!e.inited&&d)v(s)?g=i=!0:(c.push(s),b(s));else if(!e.inited&&e.fetched&&t.isDefine&&(g=!0,!t.prefix))return m=!1}),d&&c.length)return(e=makeError("timeout","Load timeout for modules: "+c,null,c)).contextName=s.contextName,I(e);m&&each(u,function(e){!function e(t,i,s){var n=t.map.id;t.error?t.emit("error",t.error):(i[n]=!0,each(t.depMaps,function(n,a){var r=n.id,l=getOwn(o,r);!l||t.depMatched[a]||s[r]||(getOwn(i,r)?(t.defineDep(a,h[r]),t.check()):e(l,i,s))}),s[n]=!0)}(e,{},{})}),d&&!i||!g||!isBrowser&&!isWebWorker||a||(a=setTimeout(function(){a=0,S()},50)),t=!1}}function T(e){hasProp(h,e[0])||x(w(e[0],null,!0)).init(e[1],e[2])}function D(e,t,i,s){e.detachEvent&&!isOpera?s&&e.detachEvent(s,t):e.removeEventListener(i,t,!1)}function A(e){var t=e.currentTarget||e.srcElement;return D(t,s.onScriptLoad,"load","onreadystatechange"),D(t,s.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function L(){var e;for(C();c.length;){if(null===(e=c.shift())[0])return I(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));T(e)}s.defQueueMap={}}return n={require:function(e){return e.require?e.require:e.require=s.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?h[e.map.id]=e.exports:e.exports=h[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(r.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(i=function(e){this.events=getOwn(d,e.id)||{},this.map=e,this.shim=getOwn(r.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,i,s){s=s||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,s.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();s.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;u[e]||(u[e]=!0,s.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,a=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{a=s.execCb(i,r,n,a)}catch(t){e=t}else a=s.execCb(i,r,n,a);if(this.map.isDefine&&void 0===a&&((t=this.module)?a=t.exports:this.usingExports&&(a=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",I(this.error=e)}else a=r;if(this.exports=a,this.map.isDefine&&!this.ignore&&(h[i]=a,req.onResourceLoad)){var o=[];each(this.depMaps,function(e){o.push(e.normalizedMap||e)}),req.onResourceLoad(s,this.map,o)}_(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(s.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=w(e.prefix);this.depMaps.push(i),E(i,"defined",bind(this,function(i){var n,a,l,d=getOwn(g,this.map.id),c=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,u=s.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(c=i.normalize(c,function(e){return f(e,h,!0)})||""),E(a=w(e.prefix+"!"+c,this.map.parentMap,!0),"defined",bind(this,function(e){this.map.normalizedMap=a,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((l=getOwn(o,a.id))&&(this.depMaps.push(a),this.events.error&&l.on("error",bind(this,function(e){this.emit("error",e)})),l.enable()))):d?(this.map.url=s.nameToUrl(d),void this.load()):((n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,(this.error=e).requireModules=[t],eachProp(o,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&_(e.map.id)}),I(e)}),n.fromText=bind(this,function(i,a){var o=e.name,l=w(o),d=useInteractive;a&&(i=a),d&&(useInteractive=!1),x(l),hasProp(r.config,t)&&(r.config[o]=r.config[t]);try{req.exec(i)}catch(i){return I(makeError("fromtexteval","fromText eval for "+t+" failed: "+i,i,[t]))}d&&(useInteractive=!0),this.depMaps.push(l),s.completeLoad(o),u([o],n)}),void i.load(e.name,u,n,r))})),s.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){(l[this.map.id]=this).enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,a,r;if("string"==typeof e){if(e=w(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(n,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,E(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?E(e,"error",bind(this,this.errback)):this.events.error&&E(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,a=o[i],hasProp(n,i)||!a||a.enabled||s.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(o,e.id);t&&!t.enabled&&s.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(s={config:r,contextName:e,registry:o,defined:h,urlFetched:u,defQueue:c,defQueueMap:{},Module:i,makeModuleMap:w,nextTick:req.nextTick,onError:I,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(-1===i.indexOf("?")?"?":"&")+t}}var i=r.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(r[t]||(r[t]={}),mixin(r[t],e,!0,!0)):r[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(g[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=s.makeShimExports(e)),i[t]=e}),r.shim=i),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(r.paths[t]=e.location),r.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(o,function(e,t){e.inited||e.map.unnormalized||(e.map=w(t,null,!0))}),(e.deps||e.callback)&&s.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(t,i){function a(r,l,d){var c,u;return i.enableBuildCallback&&l&&isFunction(l)&&(l.__requireJsBuild=!0),"string"==typeof r?isFunction(l)?I(makeError("requireargs","Invalid require call"),d):t&&hasProp(n,r)?n[r](o[t.id]):req.get?req.get(s,r,t,a):(c=w(r,t,!1,!0).id,hasProp(h,c)?h[c]:I(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(L(),s.nextTick(function(){L(),(u=x(w(null,t))).skipMap=i.skipMap,u.init(r,l,d,{enabled:!0}),S()}),a)}return i=i||{},mixin(a,{isBrowser:isBrowser,toUrl:function(e){var i,n=e.lastIndexOf("."),a=e.split("/")[0];return-1!==n&&(!("."===a||".."===a)||1<n)&&(i=e.substring(n,e.length),e=e.substring(0,n)),s.nameToUrl(f(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(h,w(e,t,!1,!0).id)},specified:function(e){return e=w(e,t,!1,!0).id,hasProp(h,e)||hasProp(o,e)}}),t||(a.undef=function(e){C();var i=w(e,t,!0),n=getOwn(o,e);n.undefed=!0,b(e),delete h[e],delete u[i.url],delete d[e],eachReverse(c,function(t,i){t[0]===e&&c.splice(i,1)}),delete s.defQueueMap[e],n&&(n.events.defined&&(d[e]=n.events),_(e))}),a},enable:function(e){getOwn(o,e.id)&&x(e).enable()},completeLoad:function(e){var t,i,n,a=getOwn(r.shim,e)||{},l=a.exports;for(C();c.length;){if(null===(i=c.shift())[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);T(i)}if(s.defQueueMap={},n=getOwn(o,e),!t&&!hasProp(h,e)&&n&&!n.inited){if(!(!r.enforceDefine||l&&getGlobal(l)))return v(e)?void 0:I(makeError("nodefine","No define call for "+e,null,[e]));T([e,a.deps||[],a.exportsFn])}S()},nameToUrl:function(e,t,i){var n,a,o,l,d,c,h=getOwn(r.pkgs,e);if(h&&(e=h),c=getOwn(g,e))return s.nameToUrl(c,t,i);if(req.jsExtRegExp.test(e))l=e+(t||"");else{for(n=r.paths,o=(a=e.split("/")).length;0<o;o-=1)if(d=getOwn(n,a.slice(0,o).join("/"))){isArray(d)&&(d=d[0]),a.splice(0,o,d);break}l=a.join("/"),l=("/"===(l+=t||(/^data\:|^blob\:|\?/.test(l)||i?"":".js")).charAt(0)||l.match(/^[\w\+\.\-]+:/)?"":r.baseUrl)+l}return r.urlArgs&&!/^blob\:/.test(l)?l+r.urlArgs(e,l):l},load:function(e,t){req.load(s,e,t)},execCb:function(e,t,i,s){return t.apply(s,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=A(e);s.completeLoad(t.id)}},onScriptError:function(e){var t=A(e);if(!v(t.id)){var i=[];return eachProp(o,function(e,s){0!==s.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(s),!0})}),I(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}}).require=s.makeRequire(),s}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState||eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("requireLib",function(){}),define("brease/config",[],function(){"use strict";var config={font:"Arial, Helvetica, sans-serif",undefinedTextReturnValue:"undefined key",visu:{activityCount:!1,moveThreshold:20,keyboardOperation:!1},ContentCaching:{preserveOldValues:!0},WidgetData:{renderingPolicy:"default",securityPolicy:"on"},themeFolder:"release/"};return Object.defineProperty(config,"isKeyboardOperationEnabled",{enumerable:!1,configurable:!1,writable:!1,value:function(){return void 0!==config.visu&&!0===config.visu.keyboardOperation}}),config}),define("brease/enum/EnumObject",[],function(){"use strict";var EnumObject=function EnumObject(e){for(var t in e){if(EnumObject.prototype[t])throw new SyntaxError("reserved key '"+t+"'");Object.defineProperty(this,t,{enumerable:!0,configurable:!1,writable:!1,value:e[t]})}};return Object.defineProperty(EnumObject.prototype,"hasMember",{value:function(e){return-1!==this.getMembers().indexOf(e)},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(EnumObject.prototype,"getMembers",{value:function(){var e=[];for(var t in this)this.propertyIsEnumerable(t)&&"function"!=typeof this[t]&&e.push(this[t]);return e},enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(EnumObject.prototype,"getKeyForValue",{value:function(e){var t;for(var i in this)if(this[i]===e){t=i;break}return t},enumerable:!1,configurable:!1,writable:!1}),EnumObject}),define("brease/enum/Enum",["brease/enum/EnumObject"],function(EnumObject){"use strict";var Enum={};function e(e,t){Object.defineProperty(Enum,e,{enumerable:!0,configurable:!1,writable:!1,value:new EnumObject(t)})}return e("TextAlign",{center:"center",left:"left",right:"right"}),e("Floating",{left:"left",right:"right"}),e("Orientation",{RTL:"RightToLeft",LTR:"LeftToRight",BTT:"BottomToTop",TTB:"TopToBottom"}),e("XAxisOrientation",{RTL:"RightToLeft",LTR:"LeftToRight"}),e("YAxisOrientation",{BTT:"BottomToTop",TTB:"TopToBottom"}),e("Direction",{horizontal:"horizontal",vertical:"vertical"}),e("CrossAlign",{start:"start",center:"center",end:"end"}),e("MainAlign",{start:"start",center:"center",end:"end"}),e("LabelPosition",{inside:"inside",outside:"outside"}),e("WidgetState",{ABORTED:-3,FAILED:-2,NON_EXISTENT:-1,IN_QUEUE:0,IN_PARSE_QUEUE:.5,INITIALIZED:1,READY:2,SUSPENDED:3}),e("KeyAction",{Accept:"Accept",Cancel:"Cancel",ScrollDown:"ScrollDown",ScrollUp:"ScrollUp",ScrollRight:"ScrollRight",ScrollLeft:"ScrollLeft",ScrollDownFast:"ScrollDownFast",ScrollUpFast:"ScrollUpFast",Close:"Close"}),e("Dependency",{INACTIVE:-1,SUSPENDED:0,ACTIVE:1}),e("MessageBoxIcon",{ASTERISK:"Asterisk",ERROR:"Error",EXCLAMATION:"Exclamation",HAND:"Hand",INFORMATION:"Information",NONE:"None",QUESTION:"Question",STOP:"Stop",WARNING:"Warning"}),e("MessageBoxState",{YES:1,NO:2,OK:4,CANCEL:8,ABORT:16,RETRY:32,IGNORE:64}),e("MessageBoxType",{AbortRetryIgnore:"AbortRetryIgnore",OK:"OK",OKCancel:"OKCancel",RetryCancel:"RetryCancel",YesNo:"YesNo",YesNoCancel:"YesNoCancel"}),e("DialogMode",{MODAL:"modal",MODELESS:"modeless"}),e("AutoRaise",{ENABLED:"enabled",DISABLED:"disabled"}),e("NoSelectionPolicy",{selectFirst:"selectFirst",showPrompt:"showPrompt"}),e("LimitViolationPolicy",{NO_SUBMIT:"noSubmit",NO_SUBMIT_AND_CLOSE:"noSubmitAndClose",SUBMIT_ALL:"submitAll",SET_TO_LIMIT:"setToLimit",SET_TO_LIMIT_AND_SUBMIT:"setToLimitAndSubmit"}),e("RenderingPolicy",{DEFAULT:"default",PERFORMANCE:"performance"}),e("SecurityPolicy",{ON:"on",OFF:"off"}),e("SortDirection",{ASC:"ascending",DESC:"descending",SASC:"ascendingBySeverity",SDESC:"descendingBySeverity"}),e("SortFunction",{STRING:"string",STRING_INS:"string-ins",NUMBER:"number",INT:"int",DATE:"date"}),e("ImageAlign",{left:"left",right:"right",top:"top",bottom:"bottom"}),e("TabPosition",{left:"left",right:"right",top:"top",bottom:"bottom"}),e("ScrollDirection",{right:"right",left:"left",bottom:"bottom",top:"top"}),e("ImagePosition",{left:"left",right:"right"}),e("BackgroundPosition",{left_top:"left top",left_center:"left center",left_bottom:"left bottom",center_top:"center top",center_center:"center center",center_bottom:"center bottom",right_top:"right top",right_center:"right center",right_bottom:"right bottom"}),e("TextAlignmentAll",{left_top:"left top",left_center:"left",left_bottom:"left bottom",center_top:"center top",center_center:"center",center_bottom:"center bottom",right_top:"right top",right_center:"right",right_bottom:"right bottom"}),e("InterpolationType",{NONE:"none",STEP:"step",LINEAR:"linear"}),e("Position",{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"}),e("PointOfOrigin",{APP:"application",CONTAINER:"container",ELEMENT:"element",WINDOW:"window"}),e("PromptType",{image:"image",text:"text",all:"all"}),e("ChildPositioning",{absolute:"absolute",relative:"relative"}),e("LoadPolicy",{ONDEMAND:"onDemand",IMMEDIATE:"immediate"}),e("InputType",{text:"text",password:"password"}),e("CachePolicy",{CACHE:"cache",NO_CACHE:"noCache"}),e("SelectMode",{STANDARD:"standard",ADVANCED:"advanced",QUICK:"quick"}),e("SizeMode",{COVER:"cover",CONTAIN:"contain",FILL:"fill"}),Object.defineProperty(Enum.SizeMode,"convertToCSS",{value:function(e){var t="contain";return e===Enum.SizeMode.CONTAIN?t="contain":e===Enum.SizeMode.COVER?t="cover":e===Enum.SizeMode.FILL&&(t="100% 100%"),t},enumerable:!1,configurable:!1,writable:!1}),e("TickStyle",{NONE:"none",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOPBOTTOM:"topbottom"}),e("ChartType",{LINE_CHART:"linechart",BAR_CHART:"barchart",PIE_CHART:"piechart"}),e("VerticalAlign",{top:"top",bottom:"bottom"}),e("HorizontalAlign",{left:"left",right:"right"}),e("MeasurementSystem",{METRIC:"metric",IMPERIAL:"imperial",IMPERIAL_US:"imperial-us"}),e("HorizontalPosition",{left:"left",center:"center",right:"right"}),e("VerticalPosition",{top:"top",middle:"middle",bottom:"bottom"}),e("ShowData",{percentage:"percentage",value:"value",none:"none"}),e("AlarmListItemType",{ad1:"additionalInfo1",ad2:"additionalInfo2",cod:"code",ins:"instanceId",mes:"message",nam:"name",sco:"scope",sev:"severity",sta:"state",tim:"timestamp",cat:"category"}),e("AlarmHistoryItemType",{ad1:"additionalInfo1",ad2:"additionalInfo2",cat:"category",cod:"code",ins:"instanceId",mes:"message",nam:"name",sco:"scope",sev:"severity",stn:"new state",sto:"old state",tim:"timestamp"}),e("PlcOpenGroupState",{GroupDisabled:201,GroupStandby:220,GroupHoming:212,GroupMoving:230,GroupStopping:240,GroupErrorStop:250}),e("mcProgramPhase",{mcPRGPH_INACTIVE:0,mcPRGPH_SIMULATION_RUN:1,mcPRGPH_WAIT_FOR_AXES_REPOS:2,mcPRGPH_AXES_REPOS:3,mcPRGPH_WAIT_FOR_REAL_RUN:4,mcPRGPH_REAL_RUN:5}),e("CropToParent",{none:"none",height:"height",width:"width",both:"both"}),e("VideoPlayerPreload",{auto:"auto",metadata:"metadata",none:"none"}),e("DropDownDisplaySettings",{default:"default",image:"image",text:"text",imageAndText:"imageAndText"}),e("AuditListItemType",{idx:"id",opn:"operator name",tex:"text",tim:"timestamp",typ:"type",new:"new",old:"old"}),e("UserListItemType",{userName:"UserName",fullName:"FullName",roles:"Roles",isAdmin:"IsAdmin",isLocked:"IsLocked",lastLogin:"LastLogin"}),e("ChartZoomType",{none:"none",x:"x",y:"y",xy:"xy"}),e("ChartInterpolationType",{linear:"linear",stepBefore:"step-before",stepAfter:"step-after",cardinal:"cardinal",monotone:"monotone"}),e("RangeMode",{autoscale:"autoscale",fromConfiguration:"fromConfiguration",fromSource:"fromSource"}),e("GraphType",{stepLine:"stepLine",line:"line",spline:"spline"}),e("EventLoggerFacility",{IAT:193}),e("EventLoggerId",{CLIENT_START_OK:32e3,CLIENT_START_FAIL:32001,NO_FURTHER_SESSION:32003,MAX_CLIENTS:32004,NOT_ENOUGH_LICENSES:32005,NO_LICENSE:32006,CLIENT_SCRIPT_FAIL:32010,CLIENT_MODULELOADER_FAIL:32011,CLIENT_PARSE_ERROR:32012,CLIENT_BINDING_ATTACH_OK:32020,CLIENT_BINDING_ATTACH_FAIL:32021,CLIENT_BINDING_ID_NOTFOUND:32022,CLIENT_BINDING_DETACH_OK:32030,CLIENT_BINDING_DETACH_FAIL:32031,CLIENT_USER_AUTHENTICATE_OK:32040,CLIENT_USER_AUTHENTICATE_FAIL:32041,CLIENT_USER_SETUSER_OK:32050,CLIENT_USER_SETUSER_FAIL:32051,CLIENT_USER_USERCHANGE:32052,CLIENT_VISU_NOT_FOUND:32060,CLIENT_INCORRECT_VISU:32061,CLIENT_NO_PAGES_FOUND:32062,CLIENT_NO_LAYOUTS_FOUND:32063,CLIENT_PAGE_NOT_FOUND:32064,CLIENT_CONTENT_NOT_FOUND:32065,CLIENT_LAYOUT_NOT_FOUND:32066,CLIENT_DIALOG_NOT_FOUND:32067,CLIENT_AREA_NOT_FOUND:32068,CLIENT_THEME_NOT_FOUND:32069,CLIENT_PAGE_NOT_CURRENT:32070,CLIENT_CONTENT_IS_ACTIVE:32071,CLIENT_CONTENT_NOT_ASSIGNED:32072,CONTENT_LOADING_IN_PROCESS:32075,CLIENT_PRECACHING_CONTENT_SLOTS_EXCEEDED:32082,CLIENT_INVALID_PROPERTY_VALUE:32083,CLIENT_VISU_ACTIVATE_FAILED:32084,NESTED_CONTENT_CONTROL_FOUND:32085,CLIENT_INVALID_WIDGET_LOCATION:32086,CLIENT_WIDGET_INITIALIZATION_FAILED:32087,CLIENT_USER_CHANGEPASSWORD_OK:32088,CLIENT_USER_CHANGEPASSWORD_FAIL:32089,CLIENT_FOCUS_ACTION_FAIL:32090,CROSS_ORIGIN_REQUEST_BLOCKED:32100,DOCUMENT_CONTENT_SANITIZED:32101}),e("EventLoggerVerboseLevel",{OFF:0,LOW:1,HIGH:2,ALL:255}),e("EventLoggerSeverity",{SUCCESS:0,INFORMATIONAL:1,WARNING:2,ERROR:3}),e("EventLoggerCustomer",{CUSTOMER:1,BUR:0}),e("ScrollPosition",{TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"}),e("IMEMode",{DISABLED:"disabled","ZH-CN":"zh-cn","ZH-HK":"zh-hk"}),e("MappTableConfigurationType",{Filtering:"filter",Sorting:"sort",Styling:"style",AddUser:"adduser",ModifyUser:"modifyuser"}),e("MpUserXError",{BUSY:0,SUCCESS:1,INVALID_SESSION:104,PASSWORD_POLICIES_NOT_MET:106,USER_DOESNT_EXIST:200,USER_ALREADY_EXISTS:201,INSUFFICIENT_RIGHTS:202,ROLE_DOESNT_EXIST:203,TOO_MANY_ROLES:204,USERNAME_EMPTY:205,ACTION_NOT_ALLOWED:206,USER_CURRENTLY_LOGGED_IN:207,USERNAME_TOO_SHORT:209}),e("ErrorCorrectionLevel",{low:"low",medium:"medium",quartile:"quartile",high:"high"}),e("Docking",{NONE:"none",BOTTOM:"bottom"}),Enum}),define("brease/core/Utils",["DOMPurify","brease/enum/Enum"],function(e,Enum){"use strict";var t=/'/g,Utils={};Utils.defineProperty=function(e,t,i,s,n,a){var config={enumerable:void 0===s||s,configurable:void 0!==n&&n,writable:void 0!==a&&a,value:i};Object.defineProperty(e,t,config)},Utils.deepCopy=function(e){return r(e)},Utils.extendDeepToNew=function(e,t){return o(r(e),t)},Utils.extendOptionsToNew=function(e,t){return d(r(e),t)},Utils.extendOptions=function(e,t){return c(r(e),t)},Utils.uniqueArray=function(e){return e&&"function"==typeof e.filter&&"function"==typeof e.lastIndexOf?e.filter(function(e,t,i){return i.lastIndexOf(e)===t}):e},Utils.prependChild=function(e,t){if(e instanceof Node==!1)throw new SyntaxError("first argument has to be of type Node");if(t instanceof Node==!1)throw new SyntaxError("second argument has to be of type Node");null!==e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},Utils.elemContains=function(e,t){return $.contains(e,t)},Utils.getPositionedParent=function(e){for(var t=e.parentElement;t&&"static"===$.css(t,"position");)t=t.parentElement;return t||document.documentElement},Utils.parseElementData=function(e,t){var i="data-"+t,s=e.getAttribute(i);return s?Utils.parsePseudoJSON(s,"Illegal data in attribute "+i+" for widget "+e.id+", widget will have default values!")||{}:{}},Utils.parsePseudoJSON=function(e,i){var s;if(!Utils.isString(e))return i?console.iatWarn(i):console.iatWarn("SyntaxError: input ("+e+") is not a string"),s;try{return JSON.parse(e.replace(t,'"'))}catch(e){i?console.iatWarn(i):console.iatWarn(e.toString())}return s},Utils.getActDate=function(){return new Date},Utils.getUserAgent=function(){return navigator.userAgent};var i=1;Utils.uniqueID=function(e){var t=e||"abcdefghijklmnopqrstuvwxyz"[Math.ceil(25*Math.random())];return i+=1,t+"_"+i},Utils.radToDeg=function(e){return 180/Math.PI*e},Utils.degToRad=function(e){return e/180*Math.PI},Utils.isString=function(e){return"string"==typeof e||e instanceof String},Utils.isBoolean=function(e){return!0===e||!1===e},Utils.isBlank=function(e){return!e||/^\s*$/.test(e)},Utils.isWidget=function(e){return e&&"function"==typeof e._bind&&void 0!==e.settings&&void 0!==e.settings.className&&-1!==e.settings.className.indexOf("widgets")},Utils.isObject=function(e){return e instanceof Object},Utils.isFunction=function(e){return"function"==typeof e},Utils.isNumeric=function(e){return!isNaN(e)&&""!==e&&!0!==e&&!1!==e&&null!==e},Utils.getter=function(e){var t;return this.isStructuredProperty(e)?(t=this.parseStructuredProperty(e),a("get",t.attribute)):a("get",e)},Utils.setter=function(e){var t;return this.isStructuredProperty(e)?(t=this.parseStructuredProperty(e),a("set",t.attribute)):a("set",e)},Utils.isStructuredProperty=function(e){return e.indexOf("[")>0},Utils.isPercentageValue=function(e){return Utils.isString(e)&&e.endsWith("%")},Utils.getPercentageWidth=function(e,t){var i=getComputedStyle(t),s=parseInt(i.getPropertyValue("border-left-width"),10)+parseInt(i.getPropertyValue("border-right-width"),10),n=parseInt(i.getPropertyValue("padding-left"),10)+parseInt(i.getPropertyValue("padding-right"),10),a=Utils.getScaleFactor(t),r=t.getBoundingClientRect().width-s*a-n*a;return parseInt(e,10)/100*r},Utils.parseStructuredProperty=function(e){var t=e.replace(/\].|\[/g,"|").split("|");return{path:"_"+t[0]+"_"+t[1],instanceName:t[1],attribute:t[0],subAttribute:t[2]}},Utils.getScaleFactor=function(e){var t=1;if(e instanceof Element&&"function"==typeof e.getBoundingClientRect){var i=$(e).outerWidth();i>0&&(t=e.getBoundingClientRect().width/i)}return t},Utils.getTransformedScaleFactor=function(e){var t=1;if(e instanceof Element&&"function"==typeof window.getComputedStyle&&"function"==typeof e.getBoundingClientRect){var i=Utils.getMatrix(e),s=$(e).outerWidth();"1"===i[1]||"-1"===i[1]?s>0&&(t=e.getBoundingClientRect().height/s):s>0&&(t=e.getBoundingClientRect().width/s)}return t},Utils.getMatrix=function(e){var t,i=window.getComputedStyle(e,null).getPropertyValue("transform");return t=-1!==i.indexOf("matrix")?i.replace(/matrix|\(|\)|\s/gi,"").split(","):[],t},Utils.closestWidgetElem=function(e){if(Utils.hasClass(e,"breaseWidget"))return e;for(var t=e,i;t!==document.body&&!Utils.hasClass(t,"breaseWidget")&&(i=t.parentNode,i);)t=i;return t},Utils.getClosestDialogElem=function(e){var t=e,i,s=null;if(!(t instanceof HTMLElement))return s;for(;t!==document.body;){if(Utils.hasClass(t,"breaseDialogWindow")||Utils.hasClass(t,"breaseGenericDialog")){s=t;break}if(i=t.parentNode,!i)break;t=i}return s},Utils.parentWidgetElem=function(e){for(var t=e,i,s;t!==document.body&&null!==t;){if(i=t.parentNode,Utils.hasClass(i,"breaseWidget")){s=i;break}t=i}return s},Utils.isSameWidgetElem=function(e,t){
return Utils.closestWidgetElem(e)===Utils.closestWidgetElem(t)},Utils.getChromeScale=function(e){var t=Utils.getUserAgent(),i=t.toLowerCase().indexOf("chrome"),s=-1!==i,n=0;return s&&(n=parseInt(t.substring(i+7),10)),s&&n>=58?1:Utils.getScaleFactor(e)},Utils.logError=function(e,t){t=t||"log",e.stack?console[t]("%c"+e.stack,"color:red;"):e.name&&e.message?console[t]("%c"+e.name+": "+e.message,"color:red;"):e.message?console[t]("%cError: "+e.message,"color:red;"):console[t]("%cError in try/catch; log trace for more info","color:red;")},Utils.getStylesheetByHref=function(e){var t;if(""!==e)for(var i=0;i<document.styleSheets.length;i+=1)if(document.styleSheets[i].href&&-1!==document.styleSheets[i].href.indexOf(e)){t=document.styleSheets[i];break}return t};var s=/\(([\s\S]*?)\)/;Utils.getFunctionArguments=function e(t){if("function"!=typeof t)throw new SyntaxError("argument has to be of type function");var i=s.exec(t);return i&&""!==i[1]?i[1].replace(/ /g,"").split(","):[]},Utils.getOriginalEvent=function(e){for(var t=[e];e&&void 0!==e.originalEvent;){if(-1!==t.indexOf(e.originalEvent))return e;t.push(e.originalEvent),e=e.originalEvent}return e},Utils.getPointerId=function(e){var t;if(e.detail&&void 0!==e.detail.pointerId)t=e.detail.pointerId;else{var i=Utils.getOriginalEvent(e);void 0!==i.pointerId?t=i.pointerId:i.changedTouches&&i.changedTouches.length>0&&(t=i.changedTouches[0].identifier)}return t},Utils.getWidgetId=function(e,t){var i=t;return"function"==typeof t.indexOf&&0===t.indexOf(e)&&(i=t.slice(e.length>0?1+e.length:0,t.length)),i},Utils.getOffsetOfEvent=function(e){var t=Utils.getOriginalEvent(e),i={x:0,y:0};if(void 0!==t.changedTouches&&t.changedTouches.length>0){var s=t.changedTouches[0];void 0!==s.pageX&&(i.x=s.pageX),void 0!==s.pageY&&(i.y=s.pageY)}else void 0!==t.pageX&&(i.x=t.pageX,i.y=t.pageY);return i},Utils.hasClass=function(e,t){return null!==e&&void 0!==e&&(void 0!==e.className&&"function"==typeof e.className.indexOf&&-1!==e.className.indexOf(t)||void 0!==e.classList&&void 0!==e.classList.value&&-1!==e.classList.value.indexOf(t))},Utils.addClass=function(e,t){var i="";if(e&&"function"==typeof e.getAttribute&&"function"==typeof e.setAttribute&&Utils.isString(t)){var s=e.getAttribute("class");s&&(i=""+s),""!==i?-1===i.split(" ").indexOf(t)&&e.setAttribute("class",i+" "+t):e.setAttribute("class",t)}},Utils.removeClass=function(e,t){var i="";if(e&&"function"==typeof e.getAttribute&&"function"==typeof e.setAttribute&&Utils.isString(t)){var s=e.getAttribute("class");if(s&&(i=""+s),""!==i)if(-1!==i.indexOf(" ")){for(var n=(""+i).split(" "),a=n.indexOf(t);-1!==a;)n.splice(a,1),a=n.indexOf(t);e.setAttribute("class",n.join(" "))}else i===t&&e.setAttribute("class","")}},Utils.removeClassByRegExp=function(e,t){if(e&&"function"==typeof e.getAttribute&&"function"==typeof e.setAttribute&&"function"==typeof e.hasAttribute&&e.hasAttribute("class")){var i=e.getAttribute("class"),s=i.match(t);null!==s&&e.setAttribute("class",i.replace(s[0],""))}},Utils.arrayToObject=function(e,t){if(!Array.isArray(e))throw new SyntaxError("first argument has to be of type Array");if(void 0!==t&&!Utils.isString(t))throw new SyntaxError("second argument has to be of type String");for(var i={},s,n,a=0,r=e.length;a<r;a+=1)s=e[a],n=void 0!==t&&void 0!==s[t]?s[t]:""+a,i[n]=s;return i},Utils.transferProperties=function(e,t,i){if(!Utils.isObject(e))throw new SyntaxError("first argument has to be of type Object");if(!Utils.isObject(t))throw new SyntaxError("second argument has to be of type Object");if(!Array.isArray(i))throw new SyntaxError("third argument has to be of type Array");for(var s=0,n=i.length;s<n;s+=1)t[i[s]]=e[i[s]]},Utils.ensureVisuId=function(e){return Utils.isString(e)?e.toLowerCase():e},Utils.getHighestZindex=function(e){for(var t=0,i=0,s=e.length,n=s-1;n>=0;n-=1)i=parseFloat(Utils.getCSSValue(e[n],"z-index")),i>t&&(t=i);return t},Utils.getDimension=function(e){var t,i,s,n,a={width:0,height:0};return e&&"function"==typeof e.get&&(t=e.get(0)),t&&1===t.nodeType&&(i=window.getComputedStyle(t,null),s=parseFloat(i.getPropertyValue("width")),n=parseFloat(i.getPropertyValue("height")),a.width=isNaN(s)?e.innerWidth():s,a.height=isNaN(n)?e.innerHeight():n),a},Utils.getCSSValue=function(e,t){return window.getComputedStyle(e).getPropertyValue(t)},Utils.isVisible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&"hidden"!==window.getComputedStyle(e).visibility},Utils.addTimestamp=function(e){return e+=(-1!==e.indexOf("?")?"&":"?")+"t="+Date.now(),e},Utils.roundTo=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(0===e)return e;t=Math.max(0,parseInt(t,10));var i=Math.round(e+"e"+t),s=Math.pow(10,t);return isNaN(i)?Math.round(e*s)/s:i/s},Utils.fileTimeToDate=function(e){return new Date(e/1e4-116444736e5)},Utils.fileTimeFromDate=function(e){return 1e4*e.getTime()+116444736e9},Utils.parseJSON=function(e){var t={};try{t.obj=JSON.parse(e)}catch(e){t.error=e.toString()}return t},Utils.getBackgroundImageUrl=function(e){if(e&&"function"==typeof e.getAttribute){var t=$(e).css("background-image");if(Utils.isString(t)&&0===t.indexOf("url"))return t.match(/url\([^)]+\)/gi)[0].split(/[()'"]+/)[1]}},Utils.getBRPanelType=function(e){e=""+e;var t=e.indexOf("BRPanel"),i;return-1!==t&&(i=e.substring(e.indexOf("BRPanel")),i=i.substring(i.indexOf("(")+1,i.indexOf(";"))),i},Utils.isT30=function(e){return"PPT30"===Utils.getBRPanelType(e)},Utils.hasSameOrigin=function(e){return new URL(document.baseURI).origin===new URL(e,document.baseURI).origin},Utils.sanitizeHtml=function(t){if(brease.config.WidgetData.securityPolicy===Enum.SecurityPolicy.OFF)return t;var i={ADD_TAGS:["foreignObject"]};t instanceof Node&&(i.IN_PLACE=!0,i.RETURN_DOM=!0);var s=e.sanitize(t,i);return e.removed.length&&n(),s},Utils.createNullObject=function(e){var t={};if(e)for(var i in e)"function"==typeof e[i]&&(t[i]=function(){});return t};function n(){var t=Enum.EventLoggerId.DOCUMENT_CONTENT_SANITIZED,i=Enum.EventLoggerVerboseLevel.OFF,s=Enum.EventLoggerSeverity.WARNING,n=e.removed[0].element?"element":"attribute",a=e.removed[0][n].localName;brease.loggerService.log(t,Enum.EventLoggerCustomer.BUR,i,s,[n,a])}function a(e,t){return e+t.substring(0,1).toUpperCase()+t.substring(1)}function r(e){var t;if("object"!=typeof e)return e;if(Utils.isString(e))return e.valueOf();if(!e)return e;if(Array.isArray(e)){t=[];for(var i=0,s=e.length;i<s;i+=1)t[i]=r(e[i]);return t}t={};for(var n in e)t[n]=r(e[n]);return t}function o(e,t){if(void 0!==e&&null!==e){var i,s;for(i in t)s=t[i],void 0!==s&&("object"!=typeof s||null===s?e[i]=s:Array.isArray(s)?Array.isArray(e[i])?l(e[i],s):e[i]=r(s):void 0===e[i]?e[i]=r(s):e[i]=o(e[i],s));return e}return void 0!==t?t:e}function l(e,t){for(var i=0,s=t.length;i<s;i+=1)void 0!==t[i]&&("object"!=typeof t[i]||null===t[i]?e[i]=t[i]:e[i]=o(e[i],t[i]))}function d(e,t){if(void 0!==e&&null!==e){var i,s;for(i in t)s=t[i],void 0!==s&&("object"!=typeof s||null===s?e[i]=s:Array.isArray(s)?e[i]=r(s):void 0===e[i]?e[i]=r(s):e[i]=o(e[i],s));return e}return void 0!==t?t:e}function c(e,t){if(void 0!==e&&null!==e){for(var i in t){var s=t[i];void 0!==s&&(e[i]=r(s))}return e}return void 0!==t?r(t):e}return Utils}),define("brease/settings",["brease/core/Utils"],function(Utils){"use strict";var e={},t=window.devicePixelRatio>1?window.devicePixelRatio:1;return Utils.defineProperty(e,"globalContent","0global"),Utils.defineProperty(e,"noKeyValue",""),Utils.defineProperty(e,"noValueString","XX"),Utils.defineProperty(e,"swipe",{}),Utils.defineProperty(e,"cachingSlotsMax",500),Utils.defineProperty(e,"cachingSlotsDefault",25),window.platform&&-1!==["Android","iOS","Windows Phone"].indexOf(window.platform.os.family)&&Math.min(window.innerWidth,window.innerHeight)<768?(e.swipe.maxFingerDistance=120,e.swipe.moveThreshold=150,e.swipe.velocity=1):(e.swipe.maxFingerDistance=120*t,e.swipe.moveThreshold=150*t,e.swipe.velocity=1.3),e}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var i=[],s=e.document,n=i.slice,a=i.concat,r=i.push,o=i.indexOf,l={},d=l.toString,c=l.hasOwnProperty,h={},u="2.2.3",g=function(e,t){return new g.fn.init(e,t)},m=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,f=/-([\da-z])/gi,b=function(e,t){return t.toUpperCase()};g.fn=g.prototype={jquery:"2.2.3",constructor:g,selector:"",length:0,toArray:function(){return n.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:n.call(this)},pushStack:function(e){var t=g.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return g.each(this,e)},map:function(e){return this.pushStack(g.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:r,sort:i.sort,splice:i.splice},g.extend=g.fn.extend=function(){var e,t,i,s,n,a,r=arguments[0]||{},o=1,l=arguments.length,d=!1;for("boolean"==typeof r&&(d=r,r=arguments[o]||{},o++),"object"==typeof r||g.isFunction(r)||(r={}),o===l&&(r=this,o--);o<l;o++)if(null!=(e=arguments[o]))for(t in e)i=r[t],s=e[t],r!==s&&(d&&s&&(g.isPlainObject(s)||(n=g.isArray(s)))?(n?(n=!1,a=i&&g.isArray(i)?i:[]):a=i&&g.isPlainObject(i)?i:{},r[t]=g.extend(d,a,s)):void 0!==s&&(r[t]=s));return r},g.extend({expando:"jQuery"+("2.2.3"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===g.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!g.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){var t;if("object"!==g.type(e)||e.nodeType||g.isWindow(e))return!1;if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||c.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[d.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=g.trim(e),e&&(1===e.indexOf("use strict")?(t=s.createElement("script"),t.text=e,s.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(p,"ms-").replace(f,b)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,s=0;if(v(e))for(i=e.length;s<i&&!1!==t.call(e[s],s,e[s]);s++);else for(s in e)if(!1===t.call(e[s],s,e[s]))break;return e},trim:function(e){return null==e?"":(e+"").replace(m,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(v(Object(e))?g.merge(i,"string"==typeof e?[e]:e):r.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:o.call(t,e,i)},merge:function(e,t){for(var i=+t.length,s=0,n=e.length;s<i;s++)e[n++]=t[s];return e.length=n,e},grep:function(e,t,i){for(var s,n=[],a=0,r=e.length,o=!i;a<r;a++)s=!t(e[a],a),s!==o&&n.push(e[a]);return n},map:function(e,t,i){var s,n,r=0,o=[];if(v(e))for(s=e.length;r<s;r++)n=t(e[r],r,i),null!=n&&o.push(n);else for(r in e)n=t(e[r],r,i),null!=n&&o.push(n);return a.apply([],o)},guid:1,proxy:function(e,t){var i,s,a;if("string"==typeof t&&(i=e[t],t=e,e=i),g.isFunction(e))return s=n.call(arguments,2),a=function(){return e.apply(t||this,s.concat(n.call(arguments)))},a.guid=e.guid=e.guid||g.guid++,a},now:Date.now,support:h}),"function"==typeof Symbol&&(g.fn[Symbol.iterator]=i[Symbol.iterator]),g.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function v(e){var t=!!e&&"length"in e&&e.length,i=g.type(e);return"function"!==i&&!g.isWindow(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}var y=function(e){var t,i,s,n,a,r,o,l,d,c,h,u,g,m,p,f,b,v,y,w="sizzle"+1*new Date,x=e.document,E=0,I=0,C=ae(),_=ae(),S=ae(),T=function(e,t){return e===t&&(h=!0),0},D=1<<31,A={}.hasOwnProperty,L=[],P=L.pop,O=L.push,N=L.push,k=L.slice,R=function(e,t){for(var i=0,s=e.length;i<s;i++)if(e[i]===t)return i;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",V="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W="\\["+M+"*("+V+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+V+"))|)"+M+"*\\]",H=":("+V+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",F=new RegExp(M+"+","g"),U=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),G=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),K=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),$=new RegExp(H),j=new RegExp("^"+V+"$"),Y={ID:new RegExp("^#("+V+")"),CLASS:new RegExp("^\\.("+V+")"),TAG:new RegExp("^("+V+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,ee=/'|\\/g,te=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ie=function(e,t,i){var s="0x"+t-65536;return s!==s||i?t:s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)},se=function(){u()};try{N.apply(L=k.call(x.childNodes),x.childNodes),L[x.childNodes.length].nodeType}catch(e){N={apply:L.length?function(e,t){O.apply(e,k.call(t))}:function(e,t){for(var i=e.length,s=0;e[i++]=t[s++];);e.length=i-1}}}function ne(e,t,s,n){var a,o,d,c,h,m,b,v,E=t&&t.ownerDocument,I=t?t.nodeType:9;if(s=s||[],"string"!=typeof e||!e||1!==I&&9!==I&&11!==I)return s;if(!n&&((t?t.ownerDocument||t:x)!==g&&u(t),t=t||g,p)){if(11!==I&&(m=Q.exec(e)))if(a=m[1]){if(9===I){if(!(d=t.getElementById(a)))return s;if(d.id===a)return s.push(d),s}else if(E&&(d=E.getElementById(a))&&y(t,d)&&d.id===a)return s.push(d),s}else{if(m[2])return N.apply(s,t.getElementsByTagName(e)),s;if((a=m[3])&&i.getElementsByClassName&&t.getElementsByClassName)return N.apply(s,t.getElementsByClassName(a)),s}if(i.qsa&&!S[e+" "]&&(!f||!f.test(e))){if(1!==I)E=t,v=e;else if("object"!==t.nodeName.toLowerCase()){for((c=t.getAttribute("id"))?c=c.replace(ee,"\\$&"):t.setAttribute("id",c=w),b=r(e),o=b.length,h=j.test(c)?"#"+c:"[id='"+c+"']";o--;)b[o]=h+" "+pe(b[o]);v=b.join(","),E=J.test(e)&&ge(t.parentNode)||t}if(v)try{return N.apply(s,E.querySelectorAll(v)),s}catch(e){}finally{c===w&&t.removeAttribute("id")}}}return l(e.replace(U,"$1"),t,s,n)}function ae(){var e=[];function t(i,n){return e.push(i+" ")>s.cacheLength&&delete t[e.shift()],t[i+" "]=n}return t}function re(e){return e[w]=!0,e}function oe(e){var t=g.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var i=e.split("|"),n=i.length;n--;)s.attrHandle[i[n]]=t}function de(e,t){var i=t&&e,s=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function ce(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function ue(e){return re(function(t){return t=+t,re(function(i,s){for(var n,a=e([],i.length,t),r=a.length;r--;)i[n=a[r]]&&(i[n]=!(s[n]=i[n]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}i=ne.support={},a=ne.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},u=ne.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:x;return r!==g&&9===r.nodeType&&r.documentElement?(g=r,m=g.documentElement,p=!a(g),(n=g.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",se,!1):n.attachEvent&&n.attachEvent("onunload",se)),i.attributes=oe(function(e){return e.className="i",!e.getAttribute("className")}),i.getElementsByTagName=oe(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),i.getElementsByClassName=Z.test(g.getElementsByClassName),i.getById=oe(function(e){return m.appendChild(e).id=w,!g.getElementsByName||!g.getElementsByName(w).length}),i.getById?(s.find.ID=function(e,t){if(void 0!==t.getElementById&&p){var i=t.getElementById(e);return i?[i]:[]}},s.filter.ID=function(e){var t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(te,ie);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),s.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,s=[],n=0,a=t.getElementsByTagName(e);if("*"===e){for(;i=a[n++];)1===i.nodeType&&s.push(i);return s}return a},s.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&p)return t.getElementsByClassName(e)},b=[],f=[],(i.qsa=Z.test(g.querySelectorAll))&&(oe(function(e){m.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&f.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||f.push("\\["+M+"*(?:value|"+B+")"),e.querySelectorAll("[id~="+w+"-]").length||f.push("~="),e.querySelectorAll(":checked").length||f.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||f.push(".#.+[+~]")}),oe(function(e){var t=g.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&f.push("name"+M+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||f.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),f.push(",.*:")})),(i.matchesSelector=Z.test(v=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&oe(function(e){i.disconnectedMatch=v.call(e,"div"),v.call(e,"[s!='']:x"),b.push("!=",H)}),f=f.length&&new RegExp(f.join("|")),b=b.length&&new RegExp(b.join("|")),t=Z.test(m.compareDocumentPosition),y=t||Z.test(m.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,s=t&&t.parentNode;return e===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):e.compareDocumentPosition&&16&e.compareDocumentPosition(s)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},T=t?function(e,t){if(e===t)return h=!0,0;var s=!e.compareDocumentPosition-!t.compareDocumentPosition;return s||(s=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&s||!i.sortDetached&&t.compareDocumentPosition(e)===s?e===g||e.ownerDocument===x&&y(x,e)?-1:t===g||t.ownerDocument===x&&y(x,t)?1:c?R(c,e)-R(c,t):0:4&s?-1:1)}:function(e,t){if(e===t)return h=!0,0;var i,s=0,n=e.parentNode,a=t.parentNode,r=[e],o=[t];if(!n||!a)return e===g?-1:t===g?1:n?-1:a?1:c?R(c,e)-R(c,t):0;if(n===a)return de(e,t);for(i=e;i=i.parentNode;)r.unshift(i);for(i=t;i=i.parentNode;)o.unshift(i);for(;r[s]===o[s];)s++;return s?de(r[s],o[s]):r[s]===x?-1:o[s]===x?1:0},g):g},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==g&&u(e),t=t.replace(K,"='$1']"),i.matchesSelector&&p&&!S[t+" "]&&(!b||!b.test(t))&&(!f||!f.test(t)))try{var s=v.call(e,t);if(s||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(e){}return ne(t,g,null,[e]).length>0},ne.contains=function(e,t){return(e.ownerDocument||e)!==g&&u(e),y(e,t)},ne.attr=function(e,t){(e.ownerDocument||e)!==g&&u(e);var n=s.attrHandle[t.toLowerCase()],a=n&&A.call(s.attrHandle,t.toLowerCase())?n(e,t,!p):void 0;return void 0!==a?a:i.attributes||!p?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,s=[],n=0,a=0;if(h=!i.detectDuplicates,c=!i.sortStable&&e.slice(0),e.sort(T),h){for(;t=e[a++];)t===e[a]&&(n=s.push(a));for(;n--;)e.splice(s[n],1)}return c=null,e},n=ne.getText=function(e){var t,i="",s=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=n(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[s++];)i+=n(t);return i},s=ne.selectors={cacheLength:50,createPseudo:re,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&$.test(i)&&(t=r(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(s){var n=ne.attr(s,e);return null==n?"!="===t:!t||(n+="","="===t?n===i:"!="===t?n!==i:"^="===t?i&&0===n.indexOf(i):"*="===t?i&&n.indexOf(i)>-1:"$="===t?i&&n.slice(-i.length)===i:"~="===t?(" "+n.replace(F," ")+" ").indexOf(i)>-1:"|="===t&&(n===i||n.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,s,n){var a="nth"!==e.slice(0,3),r="last"!==e.slice(-4),o="of-type"===t;return 1===s&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var d,c,h,u,g,m,p=a!==r?"nextSibling":"previousSibling",f=t.parentNode,b=o&&t.nodeName.toLowerCase(),v=!l&&!o,y=!1;if(f){if(a){for(;p;){for(u=t;u=u[p];)if(o?u.nodeName.toLowerCase()===b:1===u.nodeType)return!1;m=p="only"===e&&!m&&"nextSibling"}return!0}if(m=[r?f.firstChild:f.lastChild],r&&v){for(u=f,h=u[w]||(u[w]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),d=c[e]||[],g=d[0]===E&&d[1],y=g&&d[2],u=g&&f.childNodes[g];u=++g&&u&&u[p]||(y=g=0)||m.pop();)if(1===u.nodeType&&++y&&u===t){c[e]=[E,g,y];break}}else if(v&&(u=t,h=u[w]||(u[w]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),d=c[e]||[],g=d[0]===E&&d[1],y=g),!1===y)for(;(u=++g&&u&&u[p]||(y=g=0)||m.pop())&&((o?u.nodeName.toLowerCase()!==b:1!==u.nodeType)||!++y||(v&&(h=u[w]||(u[w]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),c[e]=[E,y]),u!==t)););return y-=n,y===s||y%s==0&&y/s>=0}}},PSEUDO:function(e,t){var i,n=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return n[w]?n(t):n.length>1?(i=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?re(function(e,i){for(var s,a=n(e,t),r=a.length;r--;)s=R(e,a[r]),e[s]=!(i[s]=a[r])}):function(e){return n(e,0,i)}):n}},pseudos:{not:re(function(e){var t=[],i=[],s=o(e.replace(U,"$1"));return s[w]?re(function(e,t,i,n){for(var a,r=s(e,null,n,[]),o=e.length;o--;)(a=r[o])&&(e[o]=!(t[o]=a))}):function(e,n,a){return t[0]=e,s(t,null,a,i),t[0]=null,!i.pop()}}),has:re(function(e){return function(t){return ne(e,t).length>0}}),contains:re(function(e){return e=e.replace(te,ie),function(t){return(t.textContent||t.innerText||n(t)).indexOf(e)>-1}}),lang:re(function(e){return j.test(e||"")||ne.error("unsupported lang: "+e),e=e.replace(te,ie).toLowerCase(),function(t){var i;do{if(i=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===g.activeElement&&(!g.hasFocus||g.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ue(function(){return[0]}),last:ue(function(e,t){return[t-1]}),eq:ue(function(e,t,i){return[i<0?i+t:i]}),even:ue(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:ue(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:ue(function(e,t,i){for(var s=i<0?i+t:i;--s>=0;)e.push(s);return e}),gt:ue(function(e,t,i){for(var s=i<0?i+t:i;++s<t;)e.push(s);return e})}},s.pseudos.nth=s.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[t]=ce(t);for(t in{submit:!0,reset:!0})s.pseudos[t]=he(t);function me(){}me.prototype=s.filters=s.pseudos,s.setFilters=new me,r=ne.tokenize=function(e,t){var i,n,a,r,o,l,d,c=_[e+" "];if(c)return t?0:c.slice(0);for(o=e,l=[],d=s.preFilter;o;){i&&!(n=G.exec(o))||(n&&(o=o.slice(n[0].length)||o),l.push(a=[])),i=!1,(n=z.exec(o))&&(i=n.shift(),a.push({value:i,type:n[0].replace(U," ")}),o=o.slice(i.length));for(r in s.filter)!(n=Y[r].exec(o))||d[r]&&!(n=d[r](n))||(i=n.shift(),a.push({value:i,type:r,matches:n}),o=o.slice(i.length));if(!i)break}return t?o.length:o?ne.error(e):_(e,l).slice(0)};function pe(e){for(var t=0,i=e.length,s="";t<i;t++)s+=e[t].value;return s}function fe(e,t,i){var s=t.dir,n=i&&"parentNode"===s,a=I++;return t.first?function(t,i,a){for(;t=t[s];)if(1===t.nodeType||n)return e(t,i,a)}:function(t,i,r){var o,l,d,c=[E,a];if(r){for(;t=t[s];)if((1===t.nodeType||n)&&e(t,i,r))return!0}else for(;t=t[s];)if(1===t.nodeType||n){if(d=t[w]||(t[w]={}),l=d[t.uniqueID]||(d[t.uniqueID]={}),(o=l[s])&&o[0]===E&&o[1]===a)return c[2]=o[2];if(l[s]=c,c[2]=e(t,i,r))return!0}}}function be(e){return e.length>1?function(t,i,s){for(var n=e.length;n--;)if(!e[n](t,i,s))return!1;return!0}:e[0]}function ve(e,t,i){for(var s=0,n=t.length;s<n;s++)ne(e,t[s],i);return i}function ye(e,t,i,s,n){for(var a,r=[],o=0,l=e.length,d=null!=t;o<l;o++)(a=e[o])&&(i&&!i(a,s,n)||(r.push(a),d&&t.push(o)));return r}function we(e,t,i,s,n,a){return s&&!s[w]&&(s=we(s)),n&&!n[w]&&(n=we(n,a)),re(function(a,r,o,l){var d,c,h,u=[],g=[],m=r.length,p=a||ve(t||"*",o.nodeType?[o]:o,[]),f=!e||!a&&t?p:ye(p,u,e,o,l),b=i?n||(a?e:m||s)?[]:r:f;if(i&&i(f,b,o,l),s)for(d=ye(b,g),s(d,[],o,l),c=d.length;c--;)(h=d[c])&&(b[g[c]]=!(f[g[c]]=h));if(a){if(n||e){if(n){for(d=[],c=b.length;c--;)(h=b[c])&&d.push(f[c]=h);n(null,b=[],d,l)}for(c=b.length;c--;)(h=b[c])&&(d=n?R(a,h):u[c])>-1&&(a[d]=!(r[d]=h))}}else b=ye(b===r?b.splice(m,b.length):b),n?n(null,r,b,l):N.apply(r,b)})}function xe(e){for(var t,i,n,a=e.length,r=s.relative[e[0].type],o=r||s.relative[" "],l=r?1:0,c=fe(function(e){return e===t},o,!0),h=fe(function(e){return R(t,e)>-1},o,!0),u=[function(e,i,s){var n=!r&&(s||i!==d)||((t=i).nodeType?c(e,i,s):h(e,i,s));return t=null,n}];l<a;l++)if(i=s.relative[e[l].type])u=[fe(be(u),i)];else{if(i=s.filter[e[l].type].apply(null,e[l].matches),i[w]){for(n=++l;n<a&&!s.relative[e[n].type];n++);return we(l>1&&be(u),l>1&&pe(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(U,"$1"),i,l<n&&xe(e.slice(l,n)),n<a&&xe(e=e.slice(n)),n<a&&pe(e))}u.push(i)}return be(u)}function Ee(e,t){var i=t.length>0,n=e.length>0,a=function(a,r,o,l,c){var h,m,f,b=0,v="0",y=a&&[],w=[],x=d,I=a||n&&s.find.TAG("*",c),C=E+=null==x?1:Math.random()||.1,_=I.length;for(c&&(d=r===g||r||c);v!==_&&null!=(h=I[v]);v++){if(n&&h){for(m=0,r||h.ownerDocument===g||(u(h),o=!p);f=e[m++];)if(f(h,r||g,o)){l.push(h);break}c&&(E=C)}i&&((h=!f&&h)&&b--,a&&y.push(h))}if(b+=v,i&&v!==b){for(m=0;f=t[m++];)f(y,w,r,o);if(a){if(b>0)for(;v--;)y[v]||w[v]||(w[v]=P.call(l));w=ye(w)}N.apply(l,w),c&&!a&&w.length>0&&b+t.length>1&&ne.uniqueSort(l)}return c&&(E=C,d=x),y};return i?re(a):a}return o=ne.compile=function(e,t){var i,s=[],n=[],a=S[e+" "];if(!a){for(t||(t=r(e)),i=t.length;i--;)a=xe(t[i]),a[w]?s.push(a):n.push(a);a=S(e,Ee(n,s)),a.selector=e}return a},l=ne.select=function(e,t,n,a){var l,d,c,h,u,g="function"==typeof e&&e,m=!a&&r(e=g.selector||e);if(n=n||[],1===m.length){if(d=m[0]=m[0].slice(0),d.length>2&&"ID"===(c=d[0]).type&&i.getById&&9===t.nodeType&&p&&s.relative[d[1].type]){if(t=(s.find.ID(c.matches[0].replace(te,ie),t)||[])[0],!t)return n;g&&(t=t.parentNode),e=e.slice(d.shift().value.length)}for(l=Y.needsContext.test(e)?0:d.length;l--&&(c=d[l],!s.relative[h=c.type]);)if((u=s.find[h])&&(a=u(c.matches[0].replace(te,ie),J.test(d[0].type)&&ge(t.parentNode)||t))){if(d.splice(l,1),e=a.length&&pe(d),!e)return N.apply(n,a),n;break}}return(g||o(e,m))(a,t,!p,n,!t||J.test(e)&&ge(t.parentNode)||t),n},i.sortStable=w.split("").sort(T).join("")===w,i.detectDuplicates=!!h,u(),i.sortDetached=oe(function(e){return 1&e.compareDocumentPosition(g.createElement("div"))}),oe(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),i.attributes&&oe(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),oe(function(e){return null==e.getAttribute("disabled")})||le(B,function(e,t,i){var s;if(!i)return!0===e[t]?t.toLowerCase():(s=e.getAttributeNode(t))&&s.specified?s.value:null}),ne}(e);g.find=y,g.expr=y.selectors,g.expr[":"]=g.expr.pseudos,g.uniqueSort=g.unique=y.uniqueSort,g.text=y.getText,g.isXMLDoc=y.isXML,g.contains=y.contains;var w=function(e,t,i){for(var s=[],n=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&g(e).is(i))break;s.push(e)}return s},x=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},E=g.expr.match.needsContext,I=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,C=/^.[^:#\[\.,]*$/;function _(e,t,i){if(g.isFunction(t))return g.grep(e,function(e,s){return!!t.call(e,s,e)!==i});if(t.nodeType)return g.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(C.test(t))return g.filter(t,e,i);t=g.filter(t,e)}return g.grep(e,function(e){return o.call(t,e)>-1!==i})}g.filter=function(e,t,i){var s=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===s.nodeType?g.find.matchesSelector(s,e)?[s]:[]:g.find.matches(e,g.grep(t,function(e){return 1===e.nodeType}))},g.fn.extend({find:function(e){var t,i=this.length,s=[],n=this;if("string"!=typeof e)return this.pushStack(g(e).filter(function(){for(t=0;t<i;t++)if(g.contains(n[t],this))return!0}));for(t=0;t<i;t++)g.find(e,n[t],s);return s=this.pushStack(i>1?g.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(e){return this.pushStack(_(this,e||[],!1))},not:function(e){return this.pushStack(_(this,e||[],!0))},is:function(e){
return!!_(this,"string"==typeof e&&E.test(e)?g(e):e||[],!1).length}});var S,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(g.fn.init=function(e,t,i){var n,a;if(!e)return this;if(i=i||S,"string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:T.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof g?t[0]:t,g.merge(this,g.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:s,!0)),I.test(n[1])&&g.isPlainObject(t))for(n in t)g.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return a=s.getElementById(n[2]),a&&a.parentNode&&(this.length=1,this[0]=a),this.context=s,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):g.isFunction(e)?void 0!==i.ready?i.ready(e):e(g):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),g.makeArray(e,this))}).prototype=g.fn,S=g(s);var D=/^(?:parents|prev(?:Until|All))/,A={children:!0,contents:!0,next:!0,prev:!0};g.fn.extend({has:function(e){var t=g(e,this),i=t.length;return this.filter(function(){for(var e=0;e<i;e++)if(g.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,s=0,n=this.length,a=[],r=E.test(e)||"string"!=typeof e?g(e,t||this.context):0;s<n;s++)for(i=this[s];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&g.find.matchesSelector(i,e))){a.push(i);break}return this.pushStack(a.length>1?g.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?o.call(g(e),this[0]):o.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(g.uniqueSort(g.merge(this.get(),g(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function L(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}g.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return w(e,"parentNode")},parentsUntil:function(e,t,i){return w(e,"parentNode",i)},next:function(e){return L(e,"nextSibling")},prev:function(e){return L(e,"previousSibling")},nextAll:function(e){return w(e,"nextSibling")},prevAll:function(e){return w(e,"previousSibling")},nextUntil:function(e,t,i){return w(e,"nextSibling",i)},prevUntil:function(e,t,i){return w(e,"previousSibling",i)},siblings:function(e){return x((e.parentNode||{}).firstChild,e)},children:function(e){return x(e.firstChild)},contents:function(e){return e.contentDocument||g.merge([],e.childNodes)}},function(e,t){g.fn[e]=function(i,s){var n=g.map(this,t,i);return"Until"!==e.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=g.filter(s,n)),this.length>1&&(A[e]||g.uniqueSort(n),D.test(e)&&n.reverse()),this.pushStack(n)}});var P=/\S+/g;function O(e){var t={};return g.each(e.match(P)||[],function(e,i){t[i]=!0}),t}g.Callbacks=function(e){e="string"==typeof e?O(e):g.extend({},e);var t,i,s,n,a=[],r=[],o=-1,l=function(){for(n=e.once,s=t=!0;r.length;o=-1)for(i=r.shift();++o<a.length;)!1===a[o].apply(i[0],i[1])&&e.stopOnFalse&&(o=a.length,i=!1);e.memory||(i=!1),t=!1,n&&(a=i?[]:"")},d={add:function(){return a&&(i&&!t&&(o=a.length-1,r.push(i)),function t(i){g.each(i,function(i,s){g.isFunction(s)?e.unique&&d.has(s)||a.push(s):s&&s.length&&"string"!==g.type(s)&&t(s)})}(arguments),i&&!t&&l()),this},remove:function(){return g.each(arguments,function(e,t){for(var i;(i=g.inArray(t,a,i))>-1;)a.splice(i,1),i<=o&&o--}),this},has:function(e){return e?g.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return n=r=[],a=i="",this},disabled:function(){return!a},lock:function(){return n=r=[],i||(a=i=""),this},locked:function(){return!!n},fireWith:function(e,i){return n||(i=i||[],i=[e,i.slice?i.slice():i],r.push(i),t||l()),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!s}};return d},g.extend({Deferred:function(e){var t=[["resolve","done",g.Callbacks("once memory"),"resolved"],["reject","fail",g.Callbacks("once memory"),"rejected"],["notify","progress",g.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return g.Deferred(function(i){g.each(t,function(t,a){var r=g.isFunction(e[t])&&e[t];n[a[1]](function(){var e=r&&r.apply(this,arguments);e&&g.isFunction(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[a[0]+"With"](this===s?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?g.extend(e,s):s}},n={};return s.pipe=s.then,g.each(t,function(e,a){var r=a[2],o=a[3];s[a[1]]=r.add,o&&r.add(function(){i=o},t[1^e][2].disable,t[2][2].lock),n[a[0]]=function(){return n[a[0]+"With"](this===n?s:this,arguments),this},n[a[0]+"With"]=r.fireWith}),s.promise(n),e&&e.call(n,n),n},when:function(e){var t=0,i=n.call(arguments),s=i.length,a=1!==s||e&&g.isFunction(e.promise)?s:0,r=1===a?e:g.Deferred(),o=function(e,t,i){return function(s){t[e]=this,i[e]=arguments.length>1?n.call(arguments):s,i===l?r.notifyWith(t,i):--a||r.resolveWith(t,i)}},l,d,c;if(s>1)for(l=new Array(s),d=new Array(s),c=new Array(s);t<s;t++)i[t]&&g.isFunction(i[t].promise)?i[t].promise().progress(o(t,d,l)).done(o(t,c,i)).fail(r.reject):--a;return a||r.resolveWith(c,i),r.promise()}});var N;g.fn.ready=function(e){return g.ready.promise().done(e),this},g.extend({isReady:!1,readyWait:1,holdReady:function(e){e?g.readyWait++:g.ready(!0)},ready:function(e){(!0===e?--g.readyWait:g.isReady)||(g.isReady=!0,!0!==e&&--g.readyWait>0||(N.resolveWith(s,[g]),g.fn.triggerHandler&&(g(s).triggerHandler("ready"),g(s).off("ready"))))}});function k(){s.removeEventListener("DOMContentLoaded",k),e.removeEventListener("load",k),g.ready()}g.ready.promise=function(t){return N||(N=g.Deferred(),"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll?e.setTimeout(g.ready):(s.addEventListener("DOMContentLoaded",k),e.addEventListener("load",k))),N.promise(t)},g.ready.promise();var R=function(e,t,i,s,n,a,r){var o=0,l=e.length,d=null==i;if("object"===g.type(i)){n=!0;for(o in i)R(e,t,o,i[o],!0,a,r)}else if(void 0!==s&&(n=!0,g.isFunction(s)||(r=!0),d&&(r?(t.call(e,s),t=null):(d=t,t=function(e,t,i){return d.call(g(e),i)})),t))for(;o<l;o++)t(e[o],i,r?s:s.call(e[o],o,t(e[o],i)));return n?e:d?t.call(e):l?t(e[0],i):a},B=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function M(){this.expando=g.expando+M.uid++}M.uid=1,M.prototype={register:function(e,t){var i=t||{};return e.nodeType?e[this.expando]=i:Object.defineProperty(e,this.expando,{value:i,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!B(e))return{};var t=e[this.expando];return t||(t={},B(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var s,n=this.cache(e);if("string"==typeof t)n[t]=i;else for(s in t)n[s]=t[s];return n},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,i){var s;return void 0===t||t&&"string"==typeof t&&void 0===i?(s=this.get(e,t),void 0!==s?s:this.get(e,g.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,s,n,a=e[this.expando];if(void 0!==a){if(void 0===t)this.register(e);else{g.isArray(t)?s=t.concat(t.map(g.camelCase)):(n=g.camelCase(t),t in a?s=[t,n]:(s=n,s=s in a?[s]:s.match(P)||[])),i=s.length;for(;i--;)delete a[s[i]]}(void 0===t||g.isEmptyObject(a))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!g.isEmptyObject(t)}};var V=new M,W=new M,H=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,F=/[A-Z]/g;function U(e,t,i){var s;if(void 0===i&&1===e.nodeType)if(s="data-"+t.replace(F,"-$&").toLowerCase(),i=e.getAttribute(s),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:H.test(i)?g.parseJSON(i):i)}catch(e){}W.set(e,t,i)}else i=void 0;return i}g.extend({hasData:function(e){return W.hasData(e)||V.hasData(e)},data:function(e,t,i){return W.access(e,t,i)},removeData:function(e,t){W.remove(e,t)},_data:function(e,t,i){return V.access(e,t,i)},_removeData:function(e,t){V.remove(e,t)}}),g.fn.extend({data:function(e,t){var i,s,n,a=this[0],r=a&&a.attributes;if(void 0===e){if(this.length&&(n=W.get(a),1===a.nodeType&&!V.get(a,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&(s=r[i].name,0===s.indexOf("data-")&&(s=g.camelCase(s.slice(5)),U(a,s,n[s])));V.set(a,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each(function(){W.set(this,e)}):R(this,function(t){var i,s;if(a&&void 0===t){if(i=W.get(a,e)||W.get(a,e.replace(F,"-$&").toLowerCase()),void 0!==i)return i;if(s=g.camelCase(e),i=W.get(a,s),void 0!==i)return i;if(i=U(a,s,void 0),void 0!==i)return i}else s=g.camelCase(e),this.each(function(){var i=W.get(this,s);W.set(this,s,t),e.indexOf("-")>-1&&void 0!==i&&W.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){W.remove(this,e)})}}),g.extend({queue:function(e,t,i){var s;if(e)return t=(t||"fx")+"queue",s=V.get(e,t),i&&(!s||g.isArray(i)?s=V.access(e,t,g.makeArray(i)):s.push(i)),s||[]},dequeue:function(e,t){t=t||"fx";var i=g.queue(e,t),s=i.length,n=i.shift(),a=g._queueHooks(e,t),r=function(){g.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===t&&i.unshift("inprogress"),delete a.stop,n.call(e,r,a)),!s&&a&&a.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return V.get(e,i)||V.access(e,i,{empty:g.Callbacks("once memory").add(function(){V.remove(e,[t+"queue",i])})})}}),g.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?g.queue(this[0],e):void 0===t?this:this.each(function(){var i=g.queue(this,e,t);g._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&g.dequeue(this,e)})},dequeue:function(e){return this.each(function(){g.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,s=1,n=g.Deferred(),a=this,r=this.length,o=function(){--s||n.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)i=V.get(a[r],e+"queueHooks"),i&&i.empty&&(s++,i.empty.add(o));return o(),n.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,z=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),K=["Top","Right","Bottom","Left"],$=function(e,t){return e=t||e,"none"===g.css(e,"display")||!g.contains(e.ownerDocument,e)};function j(e,t,i,s){var n,a=1,r=20,o=s?function(){return s.cur()}:function(){return g.css(e,t,"")},l=o(),d=i&&i[3]||(g.cssNumber[t]?"":"px"),c=(g.cssNumber[t]||"px"!==d&&+l)&&z.exec(g.css(e,t));if(c&&c[3]!==d){d=d||c[3],i=i||[],c=+l||1;do{a=a||".5",c/=a,g.style(e,t,c+d)}while(a!==(a=o()/l)&&1!==a&&--r)}return i&&(c=+c||+l||0,n=i[1]?c+(i[1]+1)*i[2]:+i[2],s&&(s.unit=d,s.start=c,s.end=n)),n}var Y=/^(?:checkbox|radio)$/i,X=/<([\w:-]+)/,q=/^$|\/(?:java|ecma)script/i,Z={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Z.optgroup=Z.option,Z.tbody=Z.tfoot=Z.colgroup=Z.caption=Z.thead,Z.th=Z.td;function Q(e,t){var i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&g.nodeName(e,t)?g.merge([e],i):i}function J(e,t){for(var i=0,s=e.length;i<s;i++)V.set(e[i],"globalEval",!t||V.get(t[i],"globalEval"))}var ee=/<|&#?\w+;/;function te(e,t,i,s,n){for(var a,r,o,l,d,c,h=t.createDocumentFragment(),u=[],m=0,p=e.length;m<p;m++)if(a=e[m],a||0===a)if("object"===g.type(a))g.merge(u,a.nodeType?[a]:a);else if(ee.test(a)){for(r=r||h.appendChild(t.createElement("div")),o=(X.exec(a)||["",""])[1].toLowerCase(),l=Z[o]||Z._default,r.innerHTML=l[1]+g.htmlPrefilter(a)+l[2],c=l[0];c--;)r=r.lastChild;g.merge(u,r.childNodes),r=h.firstChild,r.textContent=""}else u.push(t.createTextNode(a));for(h.textContent="",m=0;a=u[m++];)if(s&&g.inArray(a,s)>-1)n&&n.push(a);else if(d=g.contains(a.ownerDocument,a),r=Q(h.appendChild(a),"script"),d&&J(r),i)for(c=0;a=r[c++];)q.test(a.type||"")&&i.push(a);return h}!function(){var e=s.createDocumentFragment(),t=e.appendChild(s.createElement("div")),i=s.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),h.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var ie=/^key/,se=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ne=/^([^.]*)(?:\.(.+)|)/;function ae(){return!0}function re(){return!1}function oe(){try{return s.activeElement}catch(e){}}function le(e,t,i,s,n,a){var r,o;if("object"==typeof t){"string"!=typeof i&&(s=s||i,i=void 0);for(o in t)le(e,o,i,s,t[o],a);return e}if(null==s&&null==n?(n=i,s=i=void 0):null==n&&("string"==typeof i?(n=s,s=void 0):(n=s,s=i,i=void 0)),!1===n)n=re;else if(!n)return e;return 1===a&&(r=n,n=function(e){return g().off(e),r.apply(this,arguments)},n.guid=r.guid||(r.guid=g.guid++)),e.each(function(){g.event.add(this,t,n,s,i)})}g.event={global:{},add:function(e,t,i,s,n){var a,r,o,l,d,c,h,u,m,p,f,b=V.get(e);if(b)for(i.handler&&(a=i,i=a.handler,n=a.selector),i.guid||(i.guid=g.guid++),(l=b.events)||(l=b.events={}),(r=b.handle)||(r=b.handle=function(t){return void 0!==g&&g.event.triggered!==t.type?g.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(P)||[""],d=t.length;d--;)o=ne.exec(t[d])||[],m=f=o[1],p=(o[2]||"").split(".").sort(),m&&(h=g.event.special[m]||{},m=(n?h.delegateType:h.bindType)||m,h=g.event.special[m]||{},c=g.extend({type:m,origType:f,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&g.expr.match.needsContext.test(n),namespace:p.join(".")},a),(u=l[m])||(u=l[m]=[],u.delegateCount=0,h.setup&&!1!==h.setup.call(e,s,p,r)||e.addEventListener&&e.addEventListener(m,r)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),n?u.splice(u.delegateCount++,0,c):u.push(c),g.event.global[m]=!0)},remove:function(e,t,i,s,n){var a,r,o,l,d,c,h,u,m,p,f,b=V.hasData(e)&&V.get(e);if(b&&(l=b.events)){for(t=(t||"").match(P)||[""],d=t.length;d--;)if(o=ne.exec(t[d])||[],m=f=o[1],p=(o[2]||"").split(".").sort(),m){for(h=g.event.special[m]||{},m=(s?h.delegateType:h.bindType)||m,u=l[m]||[],o=o[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=a=u.length;a--;)c=u[a],!n&&f!==c.origType||i&&i.guid!==c.guid||o&&!o.test(c.namespace)||s&&s!==c.selector&&("**"!==s||!c.selector)||(u.splice(a,1),c.selector&&u.delegateCount--,h.remove&&h.remove.call(e,c));r&&!u.length&&(h.teardown&&!1!==h.teardown.call(e,p,b.handle)||g.removeEvent(e,m,b.handle),delete l[m])}else for(m in l)g.event.remove(e,m+t[d],i,s,!0);g.isEmptyObject(l)&&V.remove(e,"handle events")}},dispatch:function(e){e=g.event.fix(e);var t,i,s,a,r,o=[],l=n.call(arguments),d=(V.get(this,"events")||{})[e.type]||[],c=g.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(o=g.event.handlers.call(this,e,d),t=0;(a=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,i=0;(r=a.handlers[i++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(r.namespace)||(e.handleObj=r,e.data=r.data,s=((g.event.special[r.origType]||{}).handle||r.handler).apply(a.elem,l),void 0!==s&&!1===(e.result=s)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,s,n,a,r=[],o=t.delegateCount,l=e.target;if(o&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(s=[],i=0;i<o;i++)a=t[i],n=a.selector+" ",void 0===s[n]&&(s[n]=a.needsContext?g(n,this).index(l)>-1:g.find(n,this,null,[l]).length),s[n]&&s.push(a);s.length&&r.push({elem:l,handlers:s})}return o<t.length&&r.push({elem:this,handlers:t.slice(o)}),r},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,a,r=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||s,n=i.documentElement,a=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[g.expando])return e;var t,i,n,a=e.type,r=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=se.test(a)?this.mouseHooks:ie.test(a)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new g.Event(r),t=n.length;t--;)i=n[t],e[i]=r[i];return e.target||(e.target=s),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==oe()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===oe()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&g.nodeName(this,"input"))return this.click(),!1},_default:function(e){return g.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},g.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},g.Event=function(e,t){if(!(this instanceof g.Event))return new g.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?ae:re):this.type=e,t&&g.extend(this,t),this.timeStamp=e&&e.timeStamp||g.now(),this[g.expando]=!0},g.Event.prototype={constructor:g.Event,isDefaultPrevented:re,isPropagationStopped:re,isImmediatePropagationStopped:re,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ae,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ae,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=ae,e&&e.stopImmediatePropagation(),this.stopPropagation()}},g.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){g.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,s=this,n=e.relatedTarget,a=e.handleObj;return n&&(n===s||g.contains(s,n))||(e.type=a.origType,i=a.handler.apply(this,arguments),e.type=t),i}}}),g.fn.extend({on:function(e,t,i,s){return le(this,e,t,i,s)},one:function(e,t,i,s){return le(this,e,t,i,s,1)},off:function(e,t,i){var s,n;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,g(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=re),this.each(function(){g.event.remove(this,e,i,t)})}});var de=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ce=/<script|<style|<link/i,he=/checked\s*(?:[^=]|=\s*.checked.)/i,ue=/^true\/(.*)/,ge=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function me(e,t){return g.nodeName(e,"table")&&g.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function fe(e){var t=ue.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function be(e,t){var i,s,n,a,r,o,l,d;if(1===t.nodeType){if(V.hasData(e)&&(a=V.access(e),r=V.set(t,a),d=a.events,d)){delete r.handle,r.events={};for(n in d)for(i=0,s=d[n].length;i<s;i++)g.event.add(t,n,d[n][i])}W.hasData(e)&&(o=W.access(e),l=g.extend({},o),W.set(t,l))}}function ve(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Y.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function ye(e,t,i,s){t=a.apply([],t);var n,r,o,l,d,c,u=0,m=e.length,p=m-1,f=t[0],b=g.isFunction(f);if(b||m>1&&"string"==typeof f&&!h.checkClone&&he.test(f))return e.each(function(n){var a=e.eq(n);b&&(t[0]=f.call(this,n,a.html())),ye(a,t,i,s)});if(m&&(n=te(t,e[0].ownerDocument,!1,e,s),r=n.firstChild,1===n.childNodes.length&&(n=r),r||s)){for(o=g.map(Q(n,"script"),pe),l=o.length;u<m;u++)d=n,u!==p&&(d=g.clone(d,!0,!0),l&&g.merge(o,Q(d,"script"))),i.call(e[u],d,u);if(l)for(c=o[o.length-1].ownerDocument,g.map(o,fe),u=0;u<l;u++)d=o[u],q.test(d.type||"")&&!V.access(d,"globalEval")&&g.contains(c,d)&&(d.src?g._evalUrl&&g._evalUrl(d.src):g.globalEval(d.textContent.replace(ge,"")))}return e}function we(e,t,i){for(var s,n=t?g.filter(t,e):e,a=0;null!=(s=n[a]);a++)i||1!==s.nodeType||g.cleanData(Q(s)),s.parentNode&&(i&&g.contains(s.ownerDocument,s)&&J(Q(s,"script")),s.parentNode.removeChild(s));return e}g.extend({htmlPrefilter:function(e){return e.replace(de,"<$1></$2>")},clone:function(e,t,i){var s,n,a,r,o=e.cloneNode(!0),l=g.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||g.isXMLDoc(e)))for(r=Q(o),a=Q(e),s=0,n=a.length;s<n;s++)ve(a[s],r[s]);if(t)if(i)for(a=a||Q(e),r=r||Q(o),s=0,n=a.length;s<n;s++)be(a[s],r[s]);else be(e,o);return r=Q(o,"script"),r.length>0&&J(r,!l&&Q(e,"script")),o},cleanData:function(e){for(var t,i,s,n=g.event.special,a=0;void 0!==(i=e[a]);a++)if(B(i)){if(t=i[V.expando]){if(t.events)for(s in t.events)n[s]?g.event.remove(i,s):g.removeEvent(i,s,t.handle);i[V.expando]=void 0}i[W.expando]&&(i[W.expando]=void 0)}}}),g.fn.extend({domManip:ye,detach:function(e){return we(this,e,!0)},remove:function(e){return we(this,e)},text:function(e){return R(this,function(e){return void 0===e?g.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return ye(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){me(this,e).appendChild(e)}})},prepend:function(){return ye(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=me(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return ye(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return ye(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(g.cleanData(Q(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return g.clone(this,e,t)})},html:function(e){return R(this,function(e){var t=this[0]||{},i=0,s=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ce.test(e)&&!Z[(X.exec(e)||["",""])[1].toLowerCase()]){e=g.htmlPrefilter(e);try{for(;i<s;i++)t=this[i]||{},1===t.nodeType&&(g.cleanData(Q(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return ye(this,arguments,function(t){var i=this.parentNode;g.inArray(this,e)<0&&(g.cleanData(Q(this)),i&&i.replaceChild(t,this))},e)}}),g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){g.fn[e]=function(e){for(var i,s=[],n=g(e),a=n.length-1,o=0;o<=a;o++)i=o===a?this:this.clone(!0),g(n[o])[t](i),r.apply(s,i.get());return this.pushStack(s)}});var xe,Ee={HTML:"block",BODY:"block"};function Ie(e,t){var i=g(t.createElement(e)).appendTo(t.body),s=g.css(i[0],"display");return i.detach(),s}function Ce(e){var t=s,i=Ee[e];return i||(i=Ie(e,t),"none"!==i&&i||(xe=(xe||g("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=xe[0].contentDocument,t.write(),t.close(),i=Ie(e,t),xe.detach()),Ee[e]=i),i}var _e=/^margin/,Se=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),Te=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},De=function(e,t,i,s){var n,a,r={};for(a in t)r[a]=e.style[a],e.style[a]=t[a];n=i.apply(e,s||[]);for(a in t)e.style[a]=r[a];return n},Ae=s.documentElement;!function(){var t,i,n,a,r=s.createElement("div"),o=s.createElement("div");function l(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",o.innerHTML="",Ae.appendChild(r);var s=e.getComputedStyle(o);t="1%"!==s.top,a="2px"===s.marginLeft,i="4px"===s.width,o.style.marginRight="50%",n="4px"===s.marginRight,Ae.removeChild(r)}o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===o.style.backgroundClip,r.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",r.appendChild(o),g.extend(h,{pixelPosition:function(){return l(),t},boxSizingReliable:function(){return null==i&&l(),i},pixelMarginRight:function(){return null==i&&l(),n},reliableMarginLeft:function(){return null==i&&l(),a},reliableMarginRight:function(){var t,i=o.appendChild(s.createElement("div"));return i.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",o.style.width="1px",Ae.appendChild(r),t=!parseFloat(e.getComputedStyle(i).marginRight),Ae.removeChild(r),o.removeChild(i),t}}))}();function Le(e,t,i){var s,n,a,r,o=e.style;return i=i||Te(e),r=i?i.getPropertyValue(t)||i[t]:void 0,""!==r&&void 0!==r||g.contains(e.ownerDocument,e)||(r=g.style(e,t)),i&&!h.pixelMarginRight()&&Se.test(r)&&_e.test(t)&&(s=o.width,n=o.minWidth,a=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=i.width,o.width=s,o.minWidth=n,o.maxWidth=a),void 0!==r?r+"":r}function Pe(e,t){return{get:function(){return e()?(delete this.get,void 0):(this.get=t).apply(this,arguments)}}}var Oe=/^(none|table(?!-c[ea]).+)/,Ne={position:"absolute",visibility:"hidden",display:"block"},ke={letterSpacing:"0",fontWeight:"400"},Re=["Webkit","O","Moz","ms"],Be=s.createElement("div").style;function Me(e){if(e in Be)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=Re.length;i--;)if(e=Re[i]+t,e in Be)return e}function Ve(e,t,i){var s=z.exec(t);return s?Math.max(0,s[2]-(i||0))+(s[3]||"px"):t}function We(e,t,i,s,n){for(var a=i===(s?"border":"content")?4:"width"===t?1:0,r=0;a<4;a+=2)"margin"===i&&(r+=g.css(e,i+K[a],!0,n)),s?("content"===i&&(r-=g.css(e,"padding"+K[a],!0,n)),"margin"!==i&&(r-=g.css(e,"border"+K[a]+"Width",!0,n))):(r+=g.css(e,"padding"+K[a],!0,n),"padding"!==i&&(r+=g.css(e,"border"+K[a]+"Width",!0,n)));return r}function He(t,i,n){var a=!0,r="width"===i?t.offsetWidth:t.offsetHeight,o=Te(t),l="border-box"===g.css(t,"boxSizing",!1,o);if(s.msFullscreenElement&&e.top!==e&&t.getClientRects().length&&(r=Math.round(100*t.getBoundingClientRect()[i])),r<=0||null==r){if(r=Le(t,i,o),(r<0||null==r)&&(r=t.style[i]),Se.test(r))return r;a=l&&(h.boxSizingReliable()||r===t.style[i]),r=parseFloat(r)||0}return r+We(t,i,n||(l?"border":"content"),a,o)+"px"}function Fe(e,t){for(var i,s,n,a=[],r=0,o=e.length;r<o;r++)s=e[r],s.style&&(a[r]=V.get(s,"olddisplay"),i=s.style.display,t?(a[r]||"none"!==i||(s.style.display=""),""===s.style.display&&$(s)&&(a[r]=V.access(s,"olddisplay",Ce(s.nodeName)))):(n=$(s),"none"===i&&n||V.set(s,"olddisplay",n?i:g.css(s,"display"))));for(r=0;r<o;r++)s=e[r],s.style&&(t&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=t?a[r]||"":"none"));return e}g.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Le(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,i,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,a,r,o=g.camelCase(t),l=e.style;if(t=g.cssProps[o]||(g.cssProps[o]=Me(o)||o),r=g.cssHooks[t]||g.cssHooks[o],void 0===i)return r&&"get"in r&&void 0!==(n=r.get(e,!1,s))?n:l[t];a=typeof i,"string"===a&&(n=z.exec(i))&&n[1]&&(i=j(e,t,n),a="number"),null!=i&&i===i&&("number"===a&&(i+=n&&n[3]||(g.cssNumber[o]?"":"px")),h.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),r&&"set"in r&&void 0===(i=r.set(e,i,s))||(l[t]=i))}},css:function(e,t,i,s){var n,a,r,o=g.camelCase(t);return t=g.cssProps[o]||(g.cssProps[o]=Me(o)||o),r=g.cssHooks[t]||g.cssHooks[o],r&&"get"in r&&(n=r.get(e,!0,i)),void 0===n&&(n=Le(e,t,s)),"normal"===n&&t in ke&&(n=ke[t]),""===i||i?(a=parseFloat(n),!0===i||isFinite(a)?a||0:n):n}}),g.each(["height","width"],function(e,t){g.cssHooks[t]={get:function(e,i,s){if(i)return Oe.test(g.css(e,"display"))&&0===e.offsetWidth?De(e,Ne,function(){return He(e,t,s)}):He(e,t,s)},set:function(e,i,s){var n,a=s&&Te(e),r=s&&We(e,t,s,"border-box"===g.css(e,"boxSizing",!1,a),a);return r&&(n=z.exec(i))&&"px"!==(n[3]||"px")&&(e.style[t]=i,i=g.css(e,t)),Ve(e,i,r)}}}),g.cssHooks.marginLeft=Pe(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Le(e,"marginLeft"))||e.getBoundingClientRect().left-De(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),g.cssHooks.marginRight=Pe(h.reliableMarginRight,function(e,t){if(t)return De(e,{display:"inline-block"},Le,[e,"marginRight"])}),g.each({margin:"",padding:"",border:"Width"},function(e,t){g.cssHooks[e+t]={expand:function(i){for(var s=0,n={},a="string"==typeof i?i.split(" "):[i];s<4;s++)n[e+K[s]+t]=a[s]||a[s-2]||a[0];return n}},_e.test(e)||(g.cssHooks[e+t].set=Ve)}),g.fn.extend({css:function(e,t){return R(this,function(e,t,i){var s,n,a={},r=0;if(g.isArray(t)){for(s=Te(e),n=t.length;r<n;r++)a[t[r]]=g.css(e,t[r],!1,s);return a}return void 0!==i?g.style(e,t,i):g.css(e,t)},e,t,arguments.length>1)},show:function(){return Fe(this,!0)},hide:function(){return Fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){$(this)?g(this).show():g(this).hide()})}});function Ue(e,t,i,s,n){return new Ue.prototype.init(e,t,i,s,n)}g.Tween=Ue,Ue.prototype={constructor:Ue,init:function(e,t,i,s,n,a){this.elem=e,this.prop=i,this.easing=n||g.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=s,this.unit=a||(g.cssNumber[i]?"":"px")},cur:function(){var e=Ue.propHooks[this.prop];return e&&e.get?e.get(this):Ue.propHooks._default.get(this)},run:function(e){var t,i=Ue.propHooks[this.prop];return this.options.duration?this.pos=t=g.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ue.propHooks._default.set(this),this}},Ue.prototype.init.prototype=Ue.prototype,Ue.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=g.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){g.fx.step[e.prop]?g.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[g.cssProps[e.prop]]&&!g.cssHooks[e.prop]?e.elem[e.prop]=e.now:g.style(e.elem,e.prop,e.now+e.unit)}}},Ue.propHooks.scrollTop=Ue.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},g.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},g.fx=Ue.prototype.init,g.fx.step={};var Ge,ze,Ke=/^(?:toggle|show|hide)$/,$e=/queueHooks$/;function je(){return e.setTimeout(function(){Ge=void 0}),Ge=g.now()}function Ye(e,t){
var i,s=0,n={height:e};for(t=t?1:0;s<4;s+=2-t)i=K[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function Xe(e,t,i){for(var s,n=(Qe.tweeners[t]||[]).concat(Qe.tweeners["*"]),a=0,r=n.length;a<r;a++)if(s=n[a].call(i,t,e))return s}function qe(e,t,i){var s,n,a,r,o,l,d,c,h=this,u={},m=e.style,p=e.nodeType&&$(e),f=V.get(e,"fxshow");i.queue||(o=g._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,l=o.empty.fire,o.empty.fire=function(){o.unqueued||l()}),o.unqueued++,h.always(function(){h.always(function(){o.unqueued--,g.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],d=g.css(e,"display"),c="none"===d?V.get(e,"olddisplay")||Ce(e.nodeName):d,"inline"===c&&"none"===g.css(e,"float")&&(m.display="inline-block")),i.overflow&&(m.overflow="hidden",h.always(function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]}));for(s in t)if(n=t[s],Ke.exec(n)){if(delete t[s],a=a||"toggle"===n,n===(p?"hide":"show")){if("show"!==n||!f||void 0===f[s])continue;p=!0}u[s]=f&&f[s]||g.style(e,s)}else d=void 0;if(g.isEmptyObject(u))"inline"===("none"===d?Ce(e.nodeName):d)&&(m.display=d);else{f?"hidden"in f&&(p=f.hidden):f=V.access(e,"fxshow",{}),a&&(f.hidden=!p),p?g(e).show():h.done(function(){g(e).hide()}),h.done(function(){var t;V.remove(e,"fxshow");for(t in u)g.style(e,t,u[t])});for(s in u)r=Xe(p?f[s]:0,s,h),s in f||(f[s]=r.start,p&&(r.end=r.start,r.start="width"===s||"height"===s?1:0))}}function Ze(e,t){var i,s,n,a,r;for(i in e)if(s=g.camelCase(i),n=t[s],a=e[i],g.isArray(a)&&(n=a[1],a=e[i]=a[0]),i!==s&&(e[s]=a,delete e[i]),r=g.cssHooks[s],r&&"expand"in r){a=r.expand(a),delete e[s];for(i in a)i in e||(e[i]=a[i],t[i]=n)}else t[s]=n}function Qe(e,t,i){var s,n,a=0,r=Qe.prefilters.length,o=g.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Ge||je(),i=Math.max(0,d.startTime+d.duration-t),s=i/d.duration||0,a=1-s,r=0,l=d.tweens.length;r<l;r++)d.tweens[r].run(a);return o.notifyWith(e,[d,a,i]),a<1&&l?i:(o.resolveWith(e,[d]),!1)},d=o.promise({elem:e,props:g.extend({},t),opts:g.extend(!0,{specialEasing:{},easing:g.easing._default},i),originalProperties:t,originalOptions:i,startTime:Ge||je(),duration:i.duration,tweens:[],createTween:function(t,i){var s=g.Tween(e,d.opts,t,i,d.opts.specialEasing[t]||d.opts.easing);return d.tweens.push(s),s},stop:function(t){var i=0,s=t?d.tweens.length:0;if(n)return this;for(n=!0;i<s;i++)d.tweens[i].run(1);return t?(o.notifyWith(e,[d,1,0]),o.resolveWith(e,[d,t])):o.rejectWith(e,[d,t]),this}}),c=d.props;for(Ze(c,d.opts.specialEasing);a<r;a++)if(s=Qe.prefilters[a].call(d,e,c,d.opts),s)return g.isFunction(s.stop)&&(g._queueHooks(d.elem,d.opts.queue).stop=g.proxy(s.stop,s)),s;return g.map(c,Xe,d),g.isFunction(d.opts.start)&&d.opts.start.call(e,d),g.fx.timer(g.extend(l,{elem:e,anim:d,queue:d.opts.queue})),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always)}g.Animation=g.extend(Qe,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return j(i.elem,e,z.exec(t),i),i}]},tweener:function(e,t){g.isFunction(e)?(t=e,e=["*"]):e=e.match(P);for(var i,s=0,n=e.length;s<n;s++)i=e[s],Qe.tweeners[i]=Qe.tweeners[i]||[],Qe.tweeners[i].unshift(t)},prefilters:[qe],prefilter:function(e,t){t?Qe.prefilters.unshift(e):Qe.prefilters.push(e)}}),g.speed=function(e,t,i){var s=e&&"object"==typeof e?g.extend({},e):{complete:i||!i&&t||g.isFunction(e)&&e,duration:e,easing:i&&t||t&&!g.isFunction(t)&&t};return s.duration=g.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in g.fx.speeds?g.fx.speeds[s.duration]:g.fx.speeds._default,null!=s.queue&&!0!==s.queue||(s.queue="fx"),s.old=s.complete,s.complete=function(){g.isFunction(s.old)&&s.old.call(this),s.queue&&g.dequeue(this,s.queue)},s},g.fn.extend({fadeTo:function(e,t,i,s){return this.filter($).css("opacity",0).show().end().animate({opacity:t},e,i,s)},animate:function(e,t,i,s){var n=g.isEmptyObject(e),a=g.speed(t,i,s),r=function(){var t=Qe(this,g.extend({},e),a);(n||V.get(this,"finish"))&&t.stop(!0)};return r.finish=r,n||!1===a.queue?this.each(r):this.queue(a.queue,r)},stop:function(e,t,i){var s=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",a=g.timers,r=V.get(this);if(n)r[n]&&r[n].stop&&s(r[n]);else for(n in r)r[n]&&r[n].stop&&$e.test(n)&&s(r[n]);for(n=a.length;n--;)a[n].elem!==this||null!=e&&a[n].queue!==e||(a[n].anim.stop(i),t=!1,a.splice(n,1));!t&&i||g.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,i=V.get(this),s=i[e+"queue"],n=i[e+"queueHooks"],a=g.timers,r=s?s.length:0;for(i.finish=!0,g.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<r;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish})}}),g.each(["toggle","show","hide"],function(e,t){var i=g.fn[t];g.fn[t]=function(e,s,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Ye(t,!0),e,s,n)}}),g.each({slideDown:Ye("show"),slideUp:Ye("hide"),slideToggle:Ye("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){g.fn[e]=function(e,i,s){return this.animate(t,e,i,s)}}),g.timers=[],g.fx.tick=function(){var e,t=0,i=g.timers;for(Ge=g.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||g.fx.stop(),Ge=void 0},g.fx.timer=function(e){g.timers.push(e),e()?g.fx.start():g.timers.pop()},g.fx.interval=13,g.fx.start=function(){ze||(ze=e.setInterval(g.fx.tick,g.fx.interval))},g.fx.stop=function(){e.clearInterval(ze),ze=null},g.fx.speeds={slow:600,fast:200,_default:400},g.fn.delay=function(t,i){return t=g.fx?g.fx.speeds[t]||t:t,i=i||"fx",this.queue(i,function(i,s){var n=e.setTimeout(i,t);s.stop=function(){e.clearTimeout(n)}})},function(){var e=s.createElement("input"),t=s.createElement("select"),i=t.appendChild(s.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=i.selected,t.disabled=!0,h.optDisabled=!i.disabled,e=s.createElement("input"),e.value="t",e.type="radio",h.radioValue="t"===e.value}();var Je,et=g.expr.attrHandle;g.fn.extend({attr:function(e,t){return R(this,g.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){g.removeAttr(this,e)})}}),g.extend({attr:function(e,t,i){var s,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?g.prop(e,t,i):(1===a&&g.isXMLDoc(e)||(t=t.toLowerCase(),n=g.attrHooks[t]||(g.expr.match.bool.test(t)?Je:void 0)),void 0!==i?null===i?(g.removeAttr(e,t),void 0):n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:(e.setAttribute(t,i+""),i):n&&"get"in n&&null!==(s=n.get(e,t))?s:(s=g.find.attr(e,t),null==s?void 0:s))},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&g.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,s,n=0,a=t&&t.match(P);if(a&&1===e.nodeType)for(;i=a[n++];)s=g.propFix[i]||i,g.expr.match.bool.test(i)&&(e[s]=!1),e.removeAttribute(i)}}),Je={set:function(e,t,i){return!1===t?g.removeAttr(e,i):e.setAttribute(i,i),i}},g.each(g.expr.match.bool.source.match(/\w+/g),function(e,t){var i=et[t]||g.find.attr;et[t]=function(e,t,s){var n,a;return s||(a=et[t],et[t]=n,n=null!=i(e,t,s)?t.toLowerCase():null,et[t]=a),n}});var tt=/^(?:input|select|textarea|button)$/i,it=/^(?:a|area)$/i;g.fn.extend({prop:function(e,t){return R(this,g.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[g.propFix[e]||e]})}}),g.extend({prop:function(e,t,i){var s,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&g.isXMLDoc(e)||(t=g.propFix[t]||t,n=g.propHooks[t]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:e[t]=i:n&&"get"in n&&null!==(s=n.get(e,t))?s:e[t]},propHooks:{tabIndex:{get:function(e){var t=g.find.attr(e,"tabindex");return t?parseInt(t,10):tt.test(e.nodeName)||it.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),h.optSelected||(g.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){g.propFix[this.toLowerCase()]=this});var st=/[\t\r\n\f]/g;function nt(e){return e.getAttribute&&e.getAttribute("class")||""}g.fn.extend({addClass:function(e){var t,i,s,n,a,r,o,l=0;if(g.isFunction(e))return this.each(function(t){g(this).addClass(e.call(this,t,nt(this)))});if("string"==typeof e&&e)for(t=e.match(P)||[];i=this[l++];)if(n=nt(i),s=1===i.nodeType&&(" "+n+" ").replace(st," "),s){for(r=0;a=t[r++];)s.indexOf(" "+a+" ")<0&&(s+=a+" ");o=g.trim(s),n!==o&&i.setAttribute("class",o)}return this},removeClass:function(e){var t,i,s,n,a,r,o,l=0;if(g.isFunction(e))return this.each(function(t){g(this).removeClass(e.call(this,t,nt(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(P)||[];i=this[l++];)if(n=nt(i),s=1===i.nodeType&&(" "+n+" ").replace(st," "),s){for(r=0;a=t[r++];)for(;s.indexOf(" "+a+" ")>-1;)s=s.replace(" "+a+" "," ");o=g.trim(s),n!==o&&i.setAttribute("class",o)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):g.isFunction(e)?this.each(function(i){g(this).toggleClass(e.call(this,i,nt(this),t),t)}):this.each(function(){var t,s,n,a;if("string"===i)for(s=0,n=g(this),a=e.match(P)||[];t=a[s++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else void 0!==e&&"boolean"!==i||(t=nt(this),t&&V.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":V.get(this,"__className__")||""))})},hasClass:function(e){var t,i,s=0;for(t=" "+e+" ";i=this[s++];)if(1===i.nodeType&&(" "+nt(i)+" ").replace(st," ").indexOf(t)>-1)return!0;return!1}});var at=/\r/g,rt=/[\x20\t\r\n\f]+/g;g.fn.extend({val:function(e){var t,i,s,n=this[0];{if(arguments.length)return s=g.isFunction(e),this.each(function(i){var n;1===this.nodeType&&(n=s?e.call(this,i,g(this).val()):e,null==n?n="":"number"==typeof n?n+="":g.isArray(n)&&(n=g.map(n,function(e){return null==e?"":e+""})),t=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))});if(n)return t=g.valHooks[n.type]||g.valHooks[n.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(n,"value"))?i:(i=n.value,"string"==typeof i?i.replace(at,""):null==i?"":i)}}}),g.extend({valHooks:{option:{get:function(e){var t=g.find.attr(e,"value");return null!=t?t:g.trim(g.text(e)).replace(rt," ")}},select:{get:function(e){for(var t,i,s=e.options,n=e.selectedIndex,a="select-one"===e.type||n<0,r=a?null:[],o=a?n+1:s.length,l=n<0?o:a?n:0;l<o;l++)if(i=s[l],(i.selected||l===n)&&(h.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!g.nodeName(i.parentNode,"optgroup"))){if(t=g(i).val(),a)return t;r.push(t)}return r},set:function(e,t){for(var i,s,n=e.options,a=g.makeArray(t),r=n.length;r--;)s=n[r],(s.selected=g.inArray(g.valHooks.option.get(s),a)>-1)&&(i=!0);return i||(e.selectedIndex=-1),a}}}}),g.each(["radio","checkbox"],function(){g.valHooks[this]={set:function(e,t){if(g.isArray(t))return e.checked=g.inArray(g(e).val(),t)>-1}},h.checkOn||(g.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var ot=/^(?:focusinfocus|focusoutblur)$/;g.extend(g.event,{trigger:function(t,i,n,a){var r,o,l,d,h,u,m,p=[n||s],f=c.call(t,"type")?t.type:t,b=c.call(t,"namespace")?t.namespace.split("."):[];if(o=l=n=n||s,3!==n.nodeType&&8!==n.nodeType&&!ot.test(f+g.event.triggered)&&(f.indexOf(".")>-1&&(b=f.split("."),f=b.shift(),b.sort()),h=f.indexOf(":")<0&&"on"+f,t=t[g.expando]?t:new g.Event(f,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:g.makeArray(i,[t]),m=g.event.special[f]||{},a||!m.trigger||!1!==m.trigger.apply(n,i))){if(!a&&!m.noBubble&&!g.isWindow(n)){for(d=m.delegateType||f,ot.test(d+f)||(o=o.parentNode);o;o=o.parentNode)p.push(o),l=o;l===(n.ownerDocument||s)&&p.push(l.defaultView||l.parentWindow||e)}for(r=0;(o=p[r++])&&!t.isPropagationStopped();)t.type=r>1?d:m.bindType||f,u=(V.get(o,"events")||{})[t.type]&&V.get(o,"handle"),u&&u.apply(o,i),u=h&&o[h],u&&u.apply&&B(o)&&(t.result=u.apply(o,i),!1===t.result&&t.preventDefault());return t.type=f,a||t.isDefaultPrevented()||m._default&&!1!==m._default.apply(p.pop(),i)||!B(n)||h&&g.isFunction(n[f])&&!g.isWindow(n)&&(l=n[h],l&&(n[h]=null),g.event.triggered=f,n[f](),g.event.triggered=void 0,l&&(n[h]=l)),t.result}},simulate:function(e,t,i){var s=g.extend(new g.Event,i,{type:e,isSimulated:!0});g.event.trigger(s,null,t),s.isDefaultPrevented()&&i.preventDefault()}}),g.fn.extend({trigger:function(e,t){return this.each(function(){g.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return g.event.trigger(e,t,i,!0)}}),g.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){g.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),g.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),h.focusin="onfocusin"in e,h.focusin||g.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){g.event.simulate(t,e.target,g.event.fix(e))};g.event.special[t]={setup:function(){var s=this.ownerDocument||this,n=V.access(s,t);n||s.addEventListener(e,i,!0),V.access(s,t,(n||0)+1)},teardown:function(){var s=this.ownerDocument||this,n=V.access(s,t)-1;n?V.access(s,t,n):(s.removeEventListener(e,i,!0),V.remove(s,t))}}});var lt=e.location,dt=g.now(),ct=/\?/;g.parseJSON=function(e){return JSON.parse(e+"")},g.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||g.error("Invalid XML: "+t),i};var ht=/#.*$/,ut=/([?&])_=[^&]*/,gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,mt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,pt=/^(?:GET|HEAD)$/,ft=/^\/\//,bt={},vt={},yt="*/".concat("*"),wt=s.createElement("a");wt.href=lt.href;function xt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var s,n=0,a=t.toLowerCase().match(P)||[];if(g.isFunction(i))for(;s=a[n++];)"+"===s[0]?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(i)):(e[s]=e[s]||[]).push(i)}}function Et(e,t,i,s){var n={},a=e===vt;function r(o){var l;return n[o]=!0,g.each(e[o]||[],function(e,o){var d=o(t,i,s);return"string"!=typeof d||a||n[d]?a?!(l=d):void 0:(t.dataTypes.unshift(d),r(d),!1)}),l}return r(t.dataTypes[0])||!n["*"]&&r("*")}function It(e,t){var i,s,n=g.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:s||(s={}))[i]=t[i]);return s&&g.extend(!0,e,s),e}function Ct(e,t,i){for(var s,n,a,r,o=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(n in o)if(o[n]&&o[n].test(s)){l.unshift(n);break}if(l[0]in i)a=l[0];else{for(n in i){if(!l[0]||e.converters[n+" "+l[0]]){a=n;break}r||(r=n)}a=a||r}if(a)return a!==l[0]&&l.unshift(a),i[a]}function _t(e,t,i,s){var n,a,r,o,l,d={},c=e.dataTypes.slice();if(c[1])for(r in e.converters)d[r.toLowerCase()]=e.converters[r];for(a=c.shift();a;)if(e.responseFields[a]&&(i[e.responseFields[a]]=t),!l&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift(),a)if("*"===a)a=l;else if("*"!==l&&l!==a){if(r=d[l+" "+a]||d["* "+a],!r)for(n in d)if(o=n.split(" "),o[1]===a&&(r=d[l+" "+o[0]]||d["* "+o[0]],r)){!0===r?r=d[n]:!0!==d[n]&&(a=o[0],c.unshift(o[1]));break}if(!0!==r)if(r&&e.throws)t=r(t);else try{t=r(t)}catch(e){return{state:"parsererror",error:r?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:lt.href,type:"GET",isLocal:mt.test(lt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":g.parseJSON,"text xml":g.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?It(It(e,g.ajaxSettings),t):It(g.ajaxSettings,e)},ajaxPrefilter:xt(bt),ajaxTransport:xt(vt),ajax:function(t,i){"object"==typeof t&&(i=t,t=void 0),i=i||{};var n,a,r,o,l,d,c,h,u=g.ajaxSetup({},i),m=u.context||u,p=u.context&&(m.nodeType||m.jquery)?g(m):g.event,f=g.Deferred(),b=g.Callbacks("once memory"),v=u.statusCode||{},y={},w={},x=0,E="canceled",I={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!o)for(o={};t=gt.exec(r);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return x||(e=w[i]=w[i]||e,y[e]=t),this},overrideMimeType:function(e){return x||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(x<2)for(t in e)v[t]=[v[t],e[t]];else I.always(e[I.status]);return this},abort:function(e){var t=e||E;return n&&n.abort(t),C(0,t),this}};if(f.promise(I).complete=b.add,I.success=I.done,I.error=I.fail,u.url=((t||u.url||lt.href)+"").replace(ht,"").replace(ft,lt.protocol+"//"),u.type=i.method||i.type||u.method||u.type,u.dataTypes=g.trim(u.dataType||"*").toLowerCase().match(P)||[""],null==u.crossDomain){d=s.createElement("a");try{d.href=u.url,d.href=d.href,u.crossDomain=wt.protocol+"//"+wt.host!=d.protocol+"//"+d.host}catch(e){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=g.param(u.data,u.traditional)),Et(bt,u,i,I),2===x)return I;c=g.event&&u.global,c&&0==g.active++&&g.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!pt.test(u.type),a=u.url,u.hasContent||(u.data&&(a=u.url+=(ct.test(a)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=ut.test(a)?a.replace(ut,"$1_="+dt++):a+(ct.test(a)?"&":"?")+"_="+dt++)),u.ifModified&&(g.lastModified[a]&&I.setRequestHeader("If-Modified-Since",g.lastModified[a]),g.etag[a]&&I.setRequestHeader("If-None-Match",g.etag[a])),(u.data&&u.hasContent&&!1!==u.contentType||i.contentType)&&I.setRequestHeader("Content-Type",u.contentType),I.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+yt+"; q=0.01":""):u.accepts["*"]);for(h in u.headers)I.setRequestHeader(h,u.headers[h]);if(u.beforeSend&&(!1===u.beforeSend.call(m,I,u)||2===x))return I.abort();E="abort";for(h in{success:1,error:1,complete:1})I[h](u[h]);if(n=Et(vt,u,i,I),n){if(I.readyState=1,c&&p.trigger("ajaxSend",[I,u]),2===x)return I;u.async&&u.timeout>0&&(l=e.setTimeout(function(){I.abort("timeout")},u.timeout));try{x=1,n.send(y,C)}catch(e){if(!(x<2))throw e;C(-1,e)}}else C(-1,"No Transport");function C(t,i,s,o){var d,h,y,w,E,C=i;2!==x&&(x=2,l&&e.clearTimeout(l),n=void 0,r=o||"",I.readyState=t>0?4:0,d=t>=200&&t<300||304===t,s&&(w=Ct(u,I,s)),w=_t(u,w,I,d),d?(u.ifModified&&(E=I.getResponseHeader("Last-Modified"),E&&(g.lastModified[a]=E),E=I.getResponseHeader("etag"),E&&(g.etag[a]=E)),204===t||"HEAD"===u.type?C="nocontent":304===t?C="notmodified":(C=w.state,h=w.data,y=w.error,d=!y)):(y=C,!t&&C||(C="error",t<0&&(t=0))),I.status=t,I.statusText=(i||C)+"",d?f.resolveWith(m,[h,C,I]):f.rejectWith(m,[I,C,y]),I.statusCode(v),v=void 0,c&&p.trigger(d?"ajaxSuccess":"ajaxError",[I,u,d?h:y]),b.fireWith(m,[I,C]),c&&(p.trigger("ajaxComplete",[I,u]),--g.active||g.event.trigger("ajaxStop")))}return I},getJSON:function(e,t,i){return g.get(e,t,i,"json")},getScript:function(e,t){return g.get(e,void 0,t,"script")}}),g.each(["get","post"],function(e,t){g[t]=function(e,i,s,n){return g.isFunction(i)&&(n=n||s,s=i,i=void 0),g.ajax(g.extend({url:e,type:t,dataType:n,data:i,success:s},g.isPlainObject(e)&&e))}}),g._evalUrl=function(e){return g.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},g.fn.extend({wrapAll:function(e){var t;return g.isFunction(e)?this.each(function(t){g(this).wrapAll(e.call(this,t))}):(this[0]&&(t=g(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return g.isFunction(e)?this.each(function(t){g(this).wrapInner(e.call(this,t))}):this.each(function(){var t=g(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=g.isFunction(e);return this.each(function(i){g(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){g.nodeName(this,"body")||g(this).replaceWith(this.childNodes)}).end()}}),g.expr.filters.hidden=function(e){return!g.expr.filters.visible(e)},g.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var St=/%20/g,Tt=/\[\]$/,Dt=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;function Pt(e,t,i,s){var n;if(g.isArray(t))g.each(t,function(t,n){i||Tt.test(e)?s(e,n):Pt(e+"["+("object"==typeof n&&null!=n?t:"")+"]",n,i,s)});else if(i||"object"!==g.type(t))s(e,t);else for(n in t)Pt(e+"["+n+"]",t[n],i,s)}g.param=function(e,t){var i,s=[],n=function(e,t){t=g.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=g.ajaxSettings&&g.ajaxSettings.traditional),g.isArray(e)||e.jquery&&!g.isPlainObject(e))g.each(e,function(){n(this.name,this.value)});else for(i in e)Pt(i,e[i],t,n);return s.join("&").replace(St,"+")},g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=g.prop(this,"elements");return e?g.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!g(this).is(":disabled")&&Lt.test(this.nodeName)&&!At.test(e)&&(this.checked||!Y.test(e))}).map(function(e,t){var i=g(this).val();return null==i?null:g.isArray(i)?g.map(i,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:i.replace(Dt,"\r\n")}}).get()}}),g.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ot={0:200,1223:204},Nt=g.ajaxSettings.xhr();h.cors=!!Nt&&"withCredentials"in Nt,h.ajax=Nt=!!Nt,g.ajaxTransport(function(t){var i,s;if(h.cors||Nt&&!t.crossDomain)return{send:function(n,a){var r,o=t.xhr();if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(r in n)o.setRequestHeader(r,n[r]);i=function(e){return function(){i&&(i=s=o.onload=o.onerror=o.onabort=o.onreadystatechange=null,"abort"===e?o.abort():"error"===e?"number"!=typeof o.status?a(0,"error"):a(o.status,o.statusText):a(Ot[o.status]||o.status,o.statusText,"text"!==(o.responseType||"text")||"string"!=typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=i(),s=o.onerror=i("error"),void 0!==o.onabort?o.onabort=s:o.onreadystatechange=function(){4===o.readyState&&e.setTimeout(function(){i&&s()})},i=i("abort");try{o.send(t.hasContent&&t.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return g.globalEval(e),e}}}),g.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),g.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,a){t=g("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&a("error"===e.type?404:200,e.type)}),s.head.appendChild(t[0])},abort:function(){i&&i()}}}});var kt=[],Rt=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=kt.pop()||g.expando+"_"+dt++;return this[e]=!0,e}}),g.ajaxPrefilter("json jsonp",function(t,i,s){var n,a,r,o=!1!==t.jsonp&&(Rt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rt.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=g.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Rt,"$1"+n):!1!==t.jsonp&&(t.url+=(ct.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return r||g.error(n+" was not called"),r[0]},t.dataTypes[0]="json",a=e[n],e[n]=function(){r=arguments},s.always(function(){void 0===a?g(e).removeProp(n):e[n]=a,t[n]&&(t.jsonpCallback=i.jsonpCallback,kt.push(n)),r&&g.isFunction(a)&&a(r[0]),r=a=void 0}),"script"}),g.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||s;var n=I.exec(e),a=!i&&[];return n?[t.createElement(n[1])]:(n=te([e],t,a),a&&a.length&&g(a).remove(),g.merge([],n.childNodes))};var Bt=g.fn.load;g.fn.load=function(e,t,i){if("string"!=typeof e&&Bt)return Bt.apply(this,arguments);var s,n,a,r=this,o=e.indexOf(" ");return o>-1&&(s=g.trim(e.slice(o)),e=e.slice(0,o)),g.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(n="POST"),r.length>0&&g.ajax({url:e,type:n||"GET",dataType:"html",data:t}).done(function(e){a=arguments,r.html(s?g("<div>").append(g.parseHTML(e)).find(s):e)}).always(i&&function(e,t){r.each(function(){i.apply(this,a||[e.responseText,t,e])})}),this},g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){g.fn[t]=function(e){return this.on(t,e)}}),g.expr.filters.animated=function(e){return g.grep(g.timers,function(t){return e===t.elem}).length};function Mt(e){return g.isWindow(e)?e:9===e.nodeType&&e.defaultView}g.offset={setOffset:function(e,t,i){var s,n,a,r,o,l,d,c=g.css(e,"position"),h=g(e),u={};"static"===c&&(e.style.position="relative"),o=h.offset(),a=g.css(e,"top"),l=g.css(e,"left"),d=("absolute"===c||"fixed"===c)&&(a+l).indexOf("auto")>-1,d?(s=h.position(),r=s.top,n=s.left):(r=parseFloat(a)||0,n=parseFloat(l)||0),g.isFunction(t)&&(t=t.call(e,i,g.extend({},o))),null!=t.top&&(u.top=t.top-o.top+r),null!=t.left&&(u.left=t.left-o.left+n),"using"in t?t.using.call(e,u):h.css(u)}},g.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){g.offset.setOffset(this,e,t)});var t,i,s=this[0],n={top:0,left:0},a=s&&s.ownerDocument;if(a)return t=a.documentElement,g.contains(t,s)?(n=s.getBoundingClientRect(),i=Mt(a),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n},position:function(){if(this[0]){var e,t,i=this[0],s={top:0,left:0};return"fixed"===g.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),g.nodeName(e[0],"html")||(s=e.offset()),s.top+=g.css(e[0],"borderTopWidth",!0),s.left+=g.css(e[0],"borderLeftWidth",!0)),{top:t.top-s.top-g.css(i,"marginTop",!0),left:t.left-s.left-g.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===g.css(e,"position");)e=e.offsetParent;return e||Ae})}}),g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;g.fn[e]=function(s){return R(this,function(e,s,n){var a=Mt(e);if(void 0===n)return a?a[t]:e[s];a?a.scrollTo(i?a.pageXOffset:n,i?n:a.pageYOffset):e[s]=n},e,s,arguments.length)}}),g.each(["top","left"],function(e,t){g.cssHooks[t]=Pe(h.pixelPosition,function(e,i){if(i)return i=Le(e,t),Se.test(i)?g(e).position()[t]+"px":i})}),g.each({Height:"height",Width:"width"},function(e,t){g.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,s){g.fn[s]=function(s,n){var a=arguments.length&&(i||"boolean"!=typeof s),r=i||(!0===s||!0===n?"margin":"border");return R(this,function(t,i,s){var n;return g.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])):void 0===s?g.css(t,i,r):g.style(t,i,s,r)},t,a?s:void 0,a,null)}})}),g.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,s){return this.on(t,e,i,s)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},size:function(){return this.length}}),g.fn.andSelf=g.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return g});var Vt=e.jQuery,Wt=e.$;return g.noConflict=function(t){return e.$===g&&(e.$=Wt),t&&e.jQuery===g&&(e.jQuery=Vt),g},t||(e.jQuery=e.$=g),g}),define("brease/events/DummyEvent",[],function(){"use strict";var DummyEvent=function(e,t){this.type=e,this.target=t,this.defaultPrevented=!1};return DummyEvent.prototype.preventDefault=function(){this.originalEvent&&!0!==this.defaultPrevented&&"function"==typeof this.originalEvent.preventDefault&&(this.defaultPrevented=!0,this.originalEvent.preventDefault())},DummyEvent.prototype.stopPropagation=function(){},DummyEvent.prototype.stopImmediatePropagation=function(){},DummyEvent.prototype.isDefaultPrevented=function(){return this.defaultPrevented},DummyEvent.prototype.isImmediatePropagationStopped=function(){return!1},DummyEvent.prototype.isPropagationStopped=function(){return!1},DummyEvent}),define("brease/events/VirtualEvents",["brease/core/Utils","brease/config","brease/events/DummyEvent","jquery"],function(Utils,Config,DummyEvent){"use strict";function e(){document.addEventListener("mouseup",function(e){if(!0!==VirtualEvents.endEvent){var t=new DummyEvent("touchend",e.target);t.pointerId=0,Utils.transferProperties(e,t,s),p(t)}},!0)}var VirtualEvents={init:function(){for(var s in t)document.addEventListener(s,p,!0);Utils.isT30(navigator.userAgent)&&e(),m.on("click mousedown mouseup",function(e){void 0!==e.isTrigger&&L(e.target,"v"+e.type,e,{pointerId:0})});for(var a=0;a<n.length;a+=1)$.event.special[n[a]]=I(n[a]);return i.init(),window.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},delete VirtualEvents.init,this},reset:function(){i.reset(),g=!0},getPointerId:function(e){return C(e)},triggerVirtualEvent:function(e,t,i,s){L(e,t,i,s)},isVirtualEvent:function(e){return!0===e.virtual},config:function(){Config.visu.moveThreshold<=r&&Config.visu.moveThreshold>=o&&(l=a*Config.visu.moveThreshold),Utils.defineProperty(VirtualEvents,"MOVE_THRESHOLD",l,!0,!1,!0)}},t={mousedown:{vtype:"vmousedown",device:"mouse",phase:"start"},touchstart:{vtype:"vmousedown",device:"touch",phase:"start"},mouseup:{vtype:"vmouseup",device:"mouse",phase:"end"},touchend:{vtype:"vmouseup",device:"touch",phase:"end"},mousemove:{vtype:"vmousemove",device:"mouse",phase:"move"},touchmove:{vtype:"vmousemove",device:"touch",phase:"move"}},i={blocked:"",block:function(e){this.blocked=e},isBlocked:function(e){return this.blocked===e},startReset:function(){this.stopReset(),this.timer=window.setTimeout(this.boundReset,1e3)},stopReset:function(){window.clearTimeout(this.timer)},reset:function(){this.stopReset(),this.blocked=""},init:function(){this.boundReset=this.reset.bind(this)}
},s=["clientX","clientY","pageX","pageY","screenX","screenY"],n=["vmousedown","vmousemove","vmouseup","vclick"],a=window.devicePixelRatio>1?window.devicePixelRatio:1,r=50,o=20,l=a*Config.visu.moveThreshold,d=2,c={},h={},u={},g=!0,m=$(document);Utils.defineProperty(VirtualEvents,"SCROLL_THRESHOLD",d),Utils.defineProperty(VirtualEvents,"MOVE_THRESHOLD",l,!0,!1,!0);function p(e){var i=e.type,s=e.target,n=t[i],a=C(e),r=P(e);VirtualEvents.touchLength=r,!0===f(n,s,a,r)&&!0===u[a]&&("vmouseup"===n.vtype?(h.el=A(s),h.ev=Utils.getOffsetOfEvent(e),VirtualEvents.endEvent=!0):"vmousedown"===n.vtype&&(VirtualEvents.endEvent=!1),L(s,n.vtype,e,{pointerId:a}),b(n,e,s,a))}function f(e,t,s,n){var a=!1;switch(e.phase){case"start":"touch"===e.device?(i.stopReset(),i.block("mouse"),a=!0):a=!i.isBlocked("mouse"),u[s]=!(n>1)||D(t),g=!1;break;case"move":a="touch"===e.device?!g:!i.isBlocked("mouse")&&!g;break;case"end":a="touch"===e.device||!i.isBlocked("mouse"),0===n&&(g=!0),0===n&&"touch"===e.device&&i.startReset();break}return a}function b(e,t,i,s){"vmouseup"===e.vtype&&y(t,i,s),"end"===e.phase&&x(s),"start"===e.phase&&v(t,i,s)}function v(e,t,i){c[i]={el:A(t),ev:Utils.getOffsetOfEvent(e),target:t}}function y(e,i,s){if(void 0!==c[s]&&Utils.isSameWidgetElem(c[s].target,i)){var n=Math.abs(h.el.x-c[s].el.x),a=Math.abs(h.el.y-c[s].el.y),r=Math.abs(h.ev.x-c[s].ev.x),o=Math.abs(h.ev.y-c[s].ev.y);if(n<=d&&a<=d&&r<l&&o<l)w(e,s);else if(r<3&&o<3)w(e,s);else if("mouse"===t[e.type].device){var u=A(c[s].target);Math.abs(u.x-c[s].el.x)<d&&Math.abs(u.y-c[s].el.y)<d&&w(e,s)}}}function w(e,t){L(e.target,"vclick",e,{pointerId:t})}function x(e){c[e]=void 0}function E(){}function I(e){var t=e.substr(1);return{setup:function(){$(this).on(t,E)},teardown:function(){$(this).off(t,E)}}}function C(e){return void 0!==e.pointerId?e.pointerId:e.changedTouches?e.changedTouches[0].identifier:0}function _(e,t,i,n){var a;return i=i||{},VirtualEvents.isVirtualEvent(e)||void 0!==e.isTrigger?(a=$.Event(t,{detail:i,originalEvent:e.originalEvent}),Utils.transferProperties(e,a,s)):(a=$.event.fix(e),a=S(a,e,i.pointerId),a.type=t,a.detail=i,a.target=n||a.target),a.virtual=!0,void 0===a.which&&(a.which=1),"vclick"===t&&(a.originalEvent=new DummyEvent("click",e.target),Utils.transferProperties(e,a.originalEvent,s),e!==a&&(a.originalEvent.originalEvent=e)),a}function S(e,t,i){if(-1!==t.type.indexOf("touch")){var n=T(t,i);n&&Utils.transferProperties(n,e,s)}return e}function T(e,t){var i,s,n=e.touches,a=e.changedTouches;if(a&&a.length>0){for(s=0;s<a.length;s+=1)if(a[s].identifier===t){i=a[s];break}}else if(n&&n.length>0)for(s=0;s<n.length;s+=1)if(n[s].identifier===t){i=n[s];break}return i}function D(e){return null!==e.getAttribute("data-multitouch")||$(e).parents("[data-multitouch]").length>0}function A(e){if(e&&"function"==typeof e.getBoundingClientRect){var t=e.getBoundingClientRect();return{x:void 0!==t.left?t.left:0,y:void 0!==t.top?t.top:0}}return{x:0,y:0}}function L(e,t,i,s){var n=_(i,t,s,e);$(e).trigger(n)}function P(e){var t=0;return e&&e.touches&&(t=e.touches.length),t}return VirtualEvents.init()}),define("brease/events/jqueryEvents",["jquery","brease/events/VirtualEvents"],function(e,VirtualEvents){"use strict";return e.event.special.dblclick={name:"dblclick",namespace:".dblclick",setup:function(){e(this).on("vmouseup"+e.event.special.dblclick.namespace,e.event.special.dblclick.handler)},handler:function(t){var i=t.target,s=e(i),n=s.data("lastTouch")||0,a=(new Date).getTime(),r=a-n;r>20&&r<500?(s.data("lastTouch",0),window.setTimeout(function(){VirtualEvents.triggerVirtualEvent(i,e.event.special.dblclick.name,t,{pointerId:VirtualEvents.getPointerId(t)})},0)):s.data("lastTouch",a)},teardown:function(){e(this).data("lastTouch",0),e(this).off("vmouseup"+e.event.special.dblclick.namespace)}},e.event.special.taphold={threshold:750,name:"taphold",namespace:".taphold",setup:function(){e(this).on("vmousedown"+e.event.special.taphold.namespace,e.event.special.taphold.handler)},handler:function(t){if(t.which>1)return!1;var i,s=t.target,n=e(s);function a(){window.clearTimeout(i)}function r(){a(),n.off("vmouseup"+e.event.special.taphold.namespace,a),n.off("vclick"+e.event.special.taphold.namespace,r)}n.on("vmouseup"+e.event.special.taphold.namespace,a),n.on("vclick"+e.event.special.taphold.namespace,r),i=window.setTimeout(function(){VirtualEvents.triggerVirtualEvent(s,e.event.special.taphold.name,t,{pointerId:VirtualEvents.getPointerId(t)})},e.event.special.taphold.threshold)},teardown:function(){e(this).off("vmousedown"+e.event.special.taphold.namespace).off("vclick"+e.event.special.taphold.namespace).off("vmouseup"+e.event.special.taphold.namespace)}},null}),define("libs/keyboardevent-key-polyfill",[],function(){var e={polyfill:s,keys:{3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",106:"*",107:"+",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"}},t;for(t=1;t<25;t++)e.keys[111+t]="F"+t;var i="";for(t=65;t<91;t++)i=String.fromCharCode(t),e.keys[t]=[i.toLowerCase(),i.toUpperCase()];for(t=96;t<106;t++)i=String.fromCharCode(t-48),e.keys[t]=i;function s(){var t=navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||navigator.userAgent.indexOf("Edge/")>0;if(!("KeyboardEvent"in window)||"key"in KeyboardEvent.prototype&&!t)return!1;var i={get:function(t){var i=e.keys[this.which||this.keyCode];return Array.isArray(i)&&(i=i[+this.shiftKey]),i},enumerable:!0,configurable:!0};return Object.defineProperty(KeyboardEvent.prototype,"key",i),i}return e}),define("libs/polyfill",["libs/keyboardevent-key-polyfill"],function(e){"use strict";window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}window.CustomEvent&&(t.prototype=window.CustomEvent.prototype),window.CustomEvent=t,Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,s=function(){},n=function(){return i.apply(this instanceof s&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return s.prototype=this.prototype,n.prototype=new s,n}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t=[],i;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}),!console||!console.log||"debug"in console||(console.debug=function(){console.log.apply(console,arguments)}),!console||!console.log||"warn"in console||(console.warn=function(){console.log.apply(console,arguments)}),!console||!console.log||"info"in console||(console.info=function(){console.log.apply(console,arguments)}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var e=/function\s([^(]{1,})\(/,t=e.exec(this.toString());return t&&t.length>1?t[1].trim():""},set:function(){}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null===this||void 0===this)throw new TypeError('"this" is null or not defined');var i=Object(this),s=i.length>>>0;if(0===s)return!1;var n=0|t,a=Math.max(n>=0?n:s-Math.abs(n),0);function r(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}for(;a<s;){if(r(i[a],e))return!0;a+=1}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t,i=0;i<this.length;i+=1)if(!0===e(this[i])){t=this[i];break}return t}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var s=arguments[1],n=0;n<i;){var a=t[n];if(e.call(s,a,n,t))return n;n++}return-1},configurable:!0,writable:!0}),Array.prototype.from||Object.defineProperty(Array.prototype,"from",{value:function(e){for(var t=[],i=e.length;i--;t.unshift(e[i]));return t}}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var i=t>0?0|t:0;return this.substring(i,i+e.length)===e}}),document.baseURI||Object.defineProperty(document,"baseURI",{get:function(){var e=document.getElementsByTagName("base");return e.length>0?e[0].href:document.URL}}),window.Map||(window.Map=function(){this.items={},this.orderedItems=[];var e=this;Object.defineProperty(e,"size",{get:function(){return Object.keys(e.items).length}})},Map.prototype.set=function(e,t){return this.items[e]=t,this.orderedItems.push({key:e,value:t}),this},Map.prototype.get=function(e){return this.items[e]},Map.prototype.delete=function(e){var t=!1;return this.items[e]&&(delete this.items[e],t=!0),t},Map.prototype.forEach=function(e){for(var t in this.items)e(this.items[t],t)},Map.prototype.clear=function(){this.orderedItems=[];for(var e in this.items)delete this.items[e]},Map.prototype.has=function(e){return void 0!==this.items[e]},Map.prototype.entries=function(){var e=[];e=this.orderedItems.map(function(e){return[e.key,e.value]});function t(e){var t=0;return{next:function(){return t<e.length?{value:e[t++]}:{value:void 0}}}}return t(e)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function e(t,i){if(null===t||void 0===t)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),n=1;n<arguments.length;n+=1){var a=arguments[n];if(null!==a&&void 0!==a)for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},writable:!0,configurable:!0}),"function"!=typeof Math.log10&&(Math.log10=function(e){return Math.log(e)/Math.LN10}),"function"!=typeof Math.trunc&&(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),e.polyfill()}),define("brease/services/LoadedByBootstrapper",["libs/polyfill"],function(){"use strict";var e={get:function(e){var i=t.get(e);return void 0!==i&&t.delete(e),i}},t=new Map;return!function e(){if(window.brease&&window.brease.preloaded)for(var i in window.brease.preloaded)t.set(i,window.brease.preloaded[i])}(),e}),define("brease/application",["brease/config","brease/settings","brease/core/Utils","jquery","brease/events/VirtualEvents","brease/events/jqueryEvents","libs/lodash","libs/polyfill","brease/services/LoadedByBootstrapper"],function(config,e,Utils){"use strict";function t(t,i,s){var n=document.getElementById("appContainer").getAttribute("data-mocked"),a=null!==n,r=a?"brease/helper/stubs/ServiceBridge":"brease/services/ServiceBridge",o=a?"brease/helper/stubs/WebSocket":"brease/services/WebSocket";void 0!==s&&$.extend(!0,config,s),config.detection||(config.detection={mobile:!1,ios:!1}),Utils.defineProperty(config,"debug",0===$('script[src="release/brease.js"]').length),a&&(config.mocked=a,config.mockType=n);var l=document.getElementById("appContainer");try{window.brease={config:config,settings:e,appElem:l,appView:$(l)}}catch(e){}require([r,o,"brease/services/RuntimeService","brease/core/libs/Extensions","brease/events/BreaseEvent"],function(e,s,n,Extensions,BreaseEvent){if(BreaseEvent.init(brease.config.editMode),Extensions.console.initStorageLog(config.storageLog),Extensions.console.init(config),n.init(e,s),!0===brease.config.debug){var r=new Date;console.iatInfo("application start: "+r.toLocaleDateString()+", "+r.toLocaleTimeString()),a&&console.iatInfo("server communication mocked: true")}var o=["brease/core/BaseWidget"];!0!==brease.config.editMode&&!0!==brease.config.mocked||o.push("brease/core/designer/BaseWidget/ClassExtension"),require(o,function(BaseWidget,e){e&&e.extend(BaseWidget),require(["brease/controller/BindingController","brease/controller/ConnectionController","brease/controller/InfoController","brease/controller/ActionController","brease/controller/PageController","brease/controller/OverlayController","brease/controller/UIController","brease/helper/NumberFormatter","brease/controller/EventController","brease/controller/WidgetController","brease/model/VisuModel","brease/controller/KeyboardManager"],function(e,s,a,r,l,d,c,NumberFormatter,h,u,g,m){require(["brease/services/MeasurementSystem","brease/services/Language","brease/services/Culture","brease/services/UserService","brease/services/TextFormatter","brease/services/Logger","brease/services/Configuration","brease/services/Opcua"],function(p,f,b,v,y,w,x,E){o=["brease/brease"],!0!==brease.config.editMode&&!0!==brease.config.mocked||o.push("brease/core/designer/Brease/ClassExtension"),require(o,function(brease,o){o&&o.extend(brease),brease.init(n,{measurementSystem:p,language:f,culture:b,user:v,textFormatter:y,loggerService:w,configuration:x,opcua:E},{bindingController:e,connectionController:s,infoController:a,action:r,visuModel:g,pageController:l,overlayController:d,uiController:c,widgetController:u,formatter:new NumberFormatter,eventController:h,keyboardManager:m}),brease[t](i)})})})})})}return{start:function(e,i){t("startContent",e,i)},startVisu:function(e,i){t("startVisu",e,i)}}}),define("brease/controller/objects/Client",[],function(){"use strict";var Client={init:function(i){i&&"function"==typeof i.setClientInformation&&(t=i),e=void 0},setValid:function(i){!0!==e&&!0===i&&void 0!==t&&t.setClientInformation('{"isValid": true}'),e=i},setId:function(e){i=e}},e,t,i;return Object.defineProperty(Client,"isValid",{get:function(){return e},enumerable:!0,configurable:!0}),Object.defineProperty(Client,"id",{get:function(){return i},enumerable:!0,configurable:!0}),Client}),define("brease/events/BreaseEvent",[],function(){"use strict";var e={enumerable:!0,configurable:!1,writable:!1},t=function(t,i,s){e.value=s,Object.defineProperty(t,i,e)},i={};t(i,"CLICK","vclick"),t(i,"MOUSE_DOWN","vmousedown"),t(i,"MOUSE_UP","vmouseup"),t(i,"MOUSE_MOVE","vmousemove"),t(i,"DBL_CLICK","dblclick"),t(i,"ONDRAG_ENTER","OnDragEnter"),t(i,"ONDRAG_LEAVE","OnDragLeave"),t(i,"ONDROP","OnDrop");var BreaseEvent=function(){this.EDIT={}},s=BreaseEvent.prototype;t(s,"eventNames",i),t(s,"support",{}),s.init=function(e){this.setEditMode(e);try{document.createElement("div").addEventListener("test",function(){},{get capture(){return n.support.options=!0,!1}})}catch(e){n.support.options=!1}this.init=function(){}},s.setEditMode=function(e){for(var t in this.eventNames)this.EDIT[t]=!0===e?this.eventNames[t]:"notAvailable",this[t]=!0===e?"notAvailable":this.eventNames[t]};var n=new BreaseEvent;return t(n,"APP_READY","app_ready"),t(n,"APP_RESIZE","app_resize"),t(n,"UI_READY","ui_ready"),t(n,"BINDING_LOADED","binding_loaded"),t(n,"EVENTBINDING_LOADED","eventbinding_loaded"),t(n,"CONTENT_ACTIVATED","ContentActivated"),t(n,"CONTENT_DEACTIVATED","ContentDeactivated"),t(n,"CONTENT_SUSPENDED","ContentSuspended"),t(n,"CONTENT_DISPOSED","ContentDisposed"),t(n,"CONTENT_ACTIVATE_ERROR","content_activate_error"),t(n,"VISU_ACTIVATED","VisuActivated"),t(n,"VISU_DEACTIVATED","VisuDeactivated"),t(n,"CONTENT_REMOVED","ContentRemoved"),t(n,"DISABLED_CLICK","disabled_click"),t(n,"RESOURCES_LOADED","resources_loaded"),t(n,"CONFIG_LOADED","config_loaded"),t(n,"LANGUAGE_LOADED","language_loaded"),t(n,"LANGUAGE_CHANGED","language_changed"),t(n,"CULTURE_LOADED","culture_loaded"),t(n,"CULTURE_CHANGED","culture_changed"),t(n,"MEASUREMENT_SYSTEM_LOADED","measurementSystem_loaded"),t(n,"MEASUREMENT_SYSTEM_CHANGED","measurementSystem_changed"),t(n,"USER_CHANGED","user_changed"),t(n,"USER_LOADED","user_loaded"),t(n,"ROLES_CHANGED","roles_changed"),t(n,"CHANGEPASSWORDDIALOG_CLOSED","change_password_dialog_closed"),t(n,"SCROLL_START","scrollStart"),t(n,"SCROLL_END","scrollEnd"),t(n,"VISIBILITY_CHANGED","visibility_changed"),t(n,"BEFORE_ENABLE_CHANGE","before_enable_change"),t(n,"ENABLE_CHANGED","EnableChanged"),t(n,"BEFORE_VISIBLE_CHANGE","before_visible_change"),t(n,"VISIBLE_CHANGED","VisibleChanged"),t(n,"FOCUS_IN","FocusIn"),t(n,"FOCUS_OUT","FocusOut"),t(n,"BEFORE_FOCUS_MOVE","BeforeFocusMove"),t(n,"FOCUS_ELEM_READY","FocusElemReady"),t(n,"FOCUS_ELEM_DISPOSED","FocusElemDisposed"),t(n,"LOG_MESSAGE","log_message"),t(n,"CONTENT_PARSED","content_parsed"),t(n,"CONTENT_READY","content_ready"),t(n,"CONTENT_LOAD_ABORTED","content_load_aborted"),t(n,"PROPERTY_CHANGED","property_changed"),t(n,"INITIAL_VALUE_CHANGE_FINISHED","PropertyValueChangedFinished"),t(n,"WIDGET_READY","widget_ready"),t(n,"WIDGET_INITIALIZED","widget_initialized"),t(n,"WIDGET_DISPOSE","widget_dispose"),t(n,"WIDGET_UPDATED","widget_updated"),t(n,"PLUGIN_LOADED","plugin_loaded"),t(n,"SYSTEM_KEYBOARD_CHANGED","system_keyboard_changed"),t(n,"CLOSED","window_closed"),t(n,"WINDOW_SHOW","window_show"),t(n,"DIALOG_OPEN","dialog_open"),t(n,"DIALOG_CLOSED","dialog_closed"),t(n,"DIALOG_OPEN_ABORTED","dialog_open_aborted"),t(n,"MESSAGE_BOX_OPENED","message_box_open"),t(n,"MESSAGE_BOX_CLOSED","message_box_close"),t(n,"TOOLTIPMODE_ACTIVE","tooltipMode_activate"),t(n,"TOOLTIPMODE_INACTIVE","tooltipMode_inactive"),t(n,"ONDRAG_START","OnDragStart"),t(n,"ONDRAG_END","OnDragEnd"),t(n,"SORT_COMPLETED","sort_completed"),t(n,"ROW_SELECTED","row_selected"),t(n,"FRAGMENT_LOADED","fragment_loaded"),t(n,"FRAGMENT_SHOW","fragment_show"),t(n,"FRAGMENT_HIDE","fragment_hide"),t(n,"BEFORE_HIDE","fragment_before_hide"),t(n,"BEFORE_UNLOAD","fragment_before_unload"),t(n,"PAGE_CHANGE","pageChange"),t(n,"PAGE_LOADED","pageLoaded"),t(n,"THEME_CHANGED","theme_changed"),t(n,"NAVIGATION_DISPOSE","navDispose"),t(n,"LOAD_ERROR","load_error"),t(n,"UPDATE_CURSOR_INTERSECTION","update_cursor_intersection"),t(n,"UPDATE_CURSOR","update_ursor"),t(n,"REMOVE_CURSOR","remove_cursor"),t(n,"VIEWPORT_CHANGE","viewport_changed"),t(n,"CURVE_CHANGE","curve_changed"),t(n,"SUBMIT","value_submit"),t(n,"CHANGE","change"),t(n,"ATTRIBUTE_CHANGE","attribute_change"),t(n,"NODE_ATTRIBUTE_CHANGE","node_attribute_change"),t(n,"NUMBERFORMAT_CHANGE","numberFormat_change"),t(n,"GROUP_CHANGE","group_change"),t(n,"TICK","tick"),t(n,"ALERT","alert"),t(n,"TAP_HOLD","taphold"),t(n,"SHOW_MODAL","show_modal"),t(n,"HIDE_MODAL","hide_modal"),t(n,"TABINDEX_CHANGED","tabindex_changed"),t(n,"WIDGET_ADDED","widget_added"),t(n,"WIDGET_REMOVED","widget_removed"),t(n,"WIDGET_PROPERTIES_CHANGED","widget_properties_changed"),t(n,"WIDGET_STYLE_PROPERTIES_CHANGED","widget_style_properties_changed"),t(n,"WIDGET_EDITOR_IF_READY","widget_editor_if_ready"),t(n,"WIDGET_RESIZE","widget_resize"),n}),define("brease/events/SocketEvent",["brease/core/Utils"],function(Utils){"use strict";var SocketEvent={};return Utils.defineProperty(SocketEvent,"CONTENT_ACTIVATED","ContentActivated"),Utils.defineProperty(SocketEvent,"CONTENT_DEACTIVATED","ContentDeactivated"),Utils.defineProperty(SocketEvent,"LANGUAGE_CHANGED","LanguageChanged"),Utils.defineProperty(SocketEvent,"MEASUREMENT_SYSTEM_CHANGED","MeasurementSystemChanged"),Utils.defineProperty(SocketEvent,"PROPERTY_VALUE_CHANGED","PropertyValueChanged"),Utils.defineProperty(SocketEvent,"SESSION_ACTIVATED","SessionActivated"),Utils.defineProperty(SocketEvent,"CONNECTION_STATE_CHANGED","ConnectionStateChanged"),Utils.defineProperty(SocketEvent,"TRANSFER_START","TransferStart"),Utils.defineProperty(SocketEvent,"TRANSFER_FINISH","TransferFinish"),Utils.defineProperty(SocketEvent,"USER_CHANGED","UserChanged"),Utils.defineProperty(SocketEvent,"VISU_ACTIVATED","VisuActivated"),Utils.defineProperty(SocketEvent,"VISU_DEACTIVATED","VisuDeactivated"),Utils.defineProperty(SocketEvent,"ACTION","action"),Utils.defineProperty(SocketEvent,"SUBSCRIBE","subscribe"),Utils.defineProperty(SocketEvent,"UNSUBSCRIBE","unsubscribe"),Utils.defineProperty(SocketEvent,"WATCHDOG_TIMEOUT","WatchdogTimeout"),Utils.defineProperty(SocketEvent,"PONG","Pong"),SocketEvent}),define("brease/events/SystemGestures",["brease/core/Utils","brease/config","hammer"],function(Utils,config,e){"use strict";var t=2,i=50,s=5,n=1,a={SystemGesture1:{Type:"SystemGesture1",touchPoints:2},SystemGesture2:{Type:"SystemGesture2",touchPoints:2,snapTolerance:50},SystemGesture3:{Type:"SystemGesture3",touchPoints:2}},SystemGestures={GESTURES:a,maxTouchPoints:5,minTouchPoints:1,activeGestures:[],lockTimeout:300,init:function(t){for(var i=1;i<=3;i+=1)brease.config.gestures&&brease.config.gestures["SystemGesture"+i]?a["SystemGesture"+i].touchPoints=Math.min(5,Math.max(1,brease.config.gestures["SystemGesture"+i].touchPoints)):a["SystemGesture"+i].touchPoints=2;var s=50;brease.config.gestures&&brease.config.gestures.SystemGesture2&&(s=parseInt(brease.config.gestures.SystemGesture2.snapTolerance,10),s=isNaN(s)||s<0||s>100?50:s),a.SystemGesture2.snapTolerance=s;var n={};!0===config.visu.browserZoom&&!0===config.detection.ios&&(n.touchAction="pinch-zoom");var r=t||e.Manager;return this.gestureManager=new r(document.body,n),this.gestureManager},on:function(e,t){if(void 0===a[e])return console.warn("unknown gesture type:"+e),void 0;void 0===r[e]&&h.call(SystemGestures,e),o[e]||(o[e]=[]),-1===o[e].indexOf(t)&&o[e].push(t)},off:function(e,t){if(o[e]){var i=o[e].indexOf(t);-1!==i&&o[e].splice(i,1)}},hasEventListener:function(e){return Array.isArray(o[e])&&o[e].length>0}},r={},o={},l=!1,d,c=["clientX","clientY","pageX","pageY","screenX","screenY"];function h(t){r[t]={manager:this.gestureManager,recognizer:new e.Swipe({event:t,direction:e.DIRECTION_ALL,pointers:a[t].touchPoints,threshold:brease.settings.swipe.moveThreshold,velocity:brease.settings.swipe.velocity})},r[t].manager.add([r[t].recognizer]),r[t].manager.on(t,u)}function u(e){var t=p(e.direction),i=m(e.pointers),s=g(i,e.direction);if(""!==t&&!1===l&&(0===s||s<=brease.settings.swipe.maxFingerDistance)){l=!0;var n={type:e.type,target:e.target,detail:{direction:t}};Array.isArray(e.changedPointers)&&Utils.transferProperties(e.changedPointers[0],n,c),v(n),f()}}function g(e,t){var i=0;if(e.length>1){var s=e[0],n=e[1],a=Math.abs(s.x-n.x),r=Math.abs(s.y-n.y);i=2===t||4===t?parseInt(r,10):parseInt(a,10)}return i}function m(e){var t=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)t.push({x:e[i].pageX,y:e[i].pageY});return t}function p(e){var t="";switch(e){case 2:t="fromRight";break;case 4:t="fromLeft";break;case 8:t="fromBottom";break;case 16:t="fromTop";break}return t}function f(){d&&clearTimeout(d),SystemGestures.lockTimeout>0?d=window.setTimeout(b,SystemGestures.lockTimeout):b()}function b(){l=!1}function v(e){for(var t=0;t<o[e.type].length;t+=1)o[e.type][t].call(null,e)}return SystemGestures}),define("brease/controller/libs/LogCode",["brease/core/Utils","brease/enum/Enum"],function(Utils,Enum){"use strict";var LogCode=function(){};LogCode.prototype.getConfig=function(e){return t[e]};var e=new LogCode;Utils.defineProperty(e,"PAGE_NOT_FOUND","PAGE_NOT_FOUND"),Utils.defineProperty(e,"PAGE_IS_CURRENT","PAGE_IS_CURRENT"),Utils.defineProperty(e,"PAGE_NOT_CURRENT","PAGE_NOT_CURRENT"),Utils.defineProperty(e,"CONTAINER_NOT_FOUND","CONTAINER_NOT_FOUND"),Utils.defineProperty(e,"DIALOG_NOT_FOUND","DIALOG_NOT_FOUND"),Utils.defineProperty(e,"NO_PAGES_FOUND","NO_PAGES_FOUND"),Utils.defineProperty(e,"NO_LAYOUTS_FOUND","NO_LAYOUTS_FOUND"),Utils.defineProperty(e,"LAYOUT_NOT_FOUND","LAYOUT_NOT_FOUND"),Utils.defineProperty(e,"CONTENT_NOT_FOUND","CONTENT_NOT_FOUND"),Utils.defineProperty(e,"CONTENT_NOT_ASSIGNED","CONTENT_NOT_ASSIGNED"),Utils.defineProperty(e,"CONTENT_IS_ACTIVE","CONTENT_IS_ACTIVE"),Utils.defineProperty(e,"AREA_NOT_FOUND","AREA_NOT_FOUND"),Utils.defineProperty(e,"NO_VISUDATA_FOUND","NO_VISUDATA_FOUND"),Utils.defineProperty(e,"THEME_NOT_FOUND","THEME_NOT_FOUND"),Utils.defineProperty(e,"VISU_MALFORMED","VISU_MALFORMED"),Utils.defineProperty(e,"VISU_NOT_FOUND","VISU_NOT_FOUND"),Utils.defineProperty(e,"VISU_ACTIVATE_FAILED","VISU_ACTIVATE_FAILED"),Utils.defineProperty(e,"CONTENT_LOADING_IN_PROCESS","CONTENT_LOADING_IN_PROCESS"),Utils.defineProperty(e,"CLIENT_INVALID_PROPERTY_VALUE","CLIENT_INVALID_PROPERTY_VALUE"),Utils.defineProperty(e,"NESTED_CONTENT_CONTROL_FOUND","NESTED_CONTENT_CONTROL_FOUND"),Utils.defineProperty(e,"CLIENT_INVALID_WIDGET_LOCATION","CLIENT_INVALID_WIDGET_LOCATION"),Utils.defineProperty(e,"CLIENT_WIDGET_INITIALIZATION_FAILED","CLIENT_WIDGET_INITIALIZATION_FAILED"),Utils.defineProperty(e,"PRELOADING_ACTIVE","PRELOADING_ACTIVE"),Utils.defineProperty(e,"CLIENT_FOCUS_ACTION_FAIL","CLIENT_FOCUS_ACTION_FAIL"),Utils.defineProperty(e,"CROSS_ORIGIN_REQUEST_BLOCKED","CROSS_ORIGIN_REQUEST_BLOCKED");var t={PAGE_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_PAGE_NOT_FOUND,messageKey:"brease.error.STARTPAGE_NOT_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CONTAINER_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_PAGE_NOT_FOUND,messageKey:"brease.error.STARTPAGE_NOT_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},DIALOG_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_DIALOG_NOT_FOUND,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},NO_PAGES_FOUND:{code:Enum.EventLoggerId.CLIENT_NO_PAGES_FOUND,messageKey:"brease.error.NO_PAGES_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},NO_LAYOUTS_FOUND:{code:Enum.EventLoggerId.CLIENT_NO_LAYOUTS_FOUND,messageKey:"brease.error.NO_LAYOUTS_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},VISU_MALFORMED:{code:Enum.EventLoggerId.CLIENT_INCORRECT_VISU,messageKey:"brease.error.INCORRECT_VISU",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},VISU_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_VISU_NOT_FOUND,messageKey:"brease.error.VISU_NOT_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},LAYOUT_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_LAYOUT_NOT_FOUND,messageKey:"brease.error.LAYOUT_NOT_FOUND",severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},CONTENT_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_CONTENT_NOT_FOUND,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CONTENT_NOT_ASSIGNED:{code:Enum.EventLoggerId.CLIENT_CONTENT_NOT_ASSIGNED,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CONTENT_IS_ACTIVE:{code:Enum.EventLoggerId.CLIENT_CONTENT_IS_ACTIVE,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},AREA_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_AREA_NOT_FOUND,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},PAGE_NOT_CURRENT:{code:Enum.EventLoggerId.CLIENT_PAGE_NOT_CURRENT,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},THEME_NOT_FOUND:{code:Enum.EventLoggerId.CLIENT_THEME_NOT_FOUND,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.LOW},VISU_ACTIVATE_FAILED:{messageKey:"brease.error.ACTIVATE_VISU_FAILED"},CONTENT_LOADING_IN_PROCESS:{code:Enum.EventLoggerId.CONTENT_LOADING_IN_PROCESS,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CLIENT_INVALID_PROPERTY_VALUE:{code:Enum.EventLoggerId.CLIENT_INVALID_PROPERTY_VALUE,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},NESTED_CONTENT_CONTROL_FOUND:{code:Enum.EventLoggerId.NESTED_CONTENT_CONTROL_FOUND,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CLIENT_INVALID_WIDGET_LOCATION:{code:Enum.EventLoggerId.CLIENT_INVALID_WIDGET_LOCATION,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CLIENT_WIDGET_INITIALIZATION_FAILED:{code:Enum.EventLoggerId.CLIENT_WIDGET_INITIALIZATION_FAILED,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CLIENT_FOCUS_ACTION_FAIL:{code:Enum.EventLoggerId.CLIENT_FOCUS_ACTION_FAIL,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF},CROSS_ORIGIN_REQUEST_BLOCKED:{code:Enum.EventLoggerId.CROSS_ORIGIN_REQUEST_BLOCKED,severity:Enum.EventLoggerSeverity.WARNING,verboseLevel:Enum.EventLoggerVerboseLevel.OFF}};return e}),define("brease/services/libs/ServerCode",["brease/enum/EnumObject"],function(EnumObject){"use strict";return new EnumObject({SUCCESS:0,NO_FURTHER_SESSION:2148073484,MAX_CLIENTS:2148139020,NOT_ENOUGH_LICENSES:2148204556,NO_LICENSE:2148270092,GENERIC_CONNECTION_FAILED:-1})}),define("brease/helper/ScrollUtils",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var e,t=!1;function i(t){if(void 0===e){var i=window.getComputedStyle(t),s=parseInt(i.getPropertyValue("outline-offset"),10),a=parseInt(i.getPropertyValue("outline-width"),10);e=Math.max(0,s+a),n()}return e}function s(){e=void 0}function n(){!0!==t&&(document.body.addEventListener(BreaseEvent.THEME_CHANGED,s),t=!0)}var Utils={getFocusRect:function(e){var t=e.getBoundingClientRect();if(e===document.activeElement){var s=i(e);return{top:t.top-s,y:t.top-s,bottom:t.bottom+s,left:t.left-s,x:t.left-s,right:t.right+s,width:t.width+2*s,height:t.height+2*s}}return t},checkElemOutsideScrollArea:function(e,t){var i=Utils.getFocusRect(e),s=t.getBoundingClientRect();return{vertical:i.top<s.top||i.bottom>s.bottom,horizontal:i.left<s.left||i.right>s.right}},checkElemOutsideViewport:function(e){var t=Utils.getFocusRect(e),i={x:0,y:0},s=window.innerWidth,n=window.innerHeight;return t.top<0?i.y=t.top:t.bottom>n&&(i.y=t.bottom-n),t.left<0?i.x=t.left:t.right>s&&(i.x=t.right-s),i}};return Utils}),define("brease/helper/Scroller",["libs/iscroll-probe","brease/core/Utils","brease/events/BreaseEvent","brease/helper/ScrollUtils"],function(e,Utils,BreaseEvent,ScrollUtils){"use strict";var Scroller={init:function(t){void 0!==t&&"function"==typeof t.update&&(i=t),e.prototype.breaseUpdateZoomFactor=function(){this.zoomFactor=Utils.getScaleFactor(this.wrapper)},e.prototype.subsequentlyDisableMouse=function(){this.wrapper.removeEventListener("mousedown",this),this.wrapper.removeEventListener("mousemove",this),this.wrapper.removeEventListener("mousecancel",this),this.wrapper.removeEventListener("mouseup",this)},e.prototype.subsequentlyEnableMouse=function(){this.wrapper.addEventListener("mousedown",this),this.wrapper.addEventListener("mousemove",this),this.wrapper.addEventListener("mousecancel",this),this.wrapper.addEventListener("mouseup",this)},e.prototype.subsequentlyDisableTouch=function(){this.wrapper.removeEventListener("touchstart",this),this.wrapper.removeEventListener("touchmove",this),this.wrapper.removeEventListener("touchcancel",this),this.wrapper.removeEventListener("touchend",this)},e.prototype.subsequentlyEnableTouch=function(){this.wrapper.addEventListener("touchstart",this),this.wrapper.addEventListener("touchmove",this),
this.wrapper.addEventListener("touchcancel",this),this.wrapper.addEventListener("touchend",this)}},addScrollbars:function(t,s,a){var r="string"==typeof t?document.querySelector(t):t,o;return null!==r?(o=new e(r,n(s)),o.zoomFactor=Utils.getScaleFactor(r),o.on("beforeScrollStart",function(){this.stopped=!1,c(this)}),o.on("scrollStart",function(){this.options.preventDefault=!0,this.wrapper.dispatchEvent(new CustomEvent(BreaseEvent.SCROLL_START,{bubbles:!0}))}),o.on("scrollEnd",function(){this.options.preventDefault=!1,this.stopped||(h(),this.stopped=!0)}),o.on("scrollCancel",function(){this.options.preventDefault=!1,this.stopped||(h(),this.stopped=!0)}),o.on("destroy",function(){document.body.removeEventListener(BreaseEvent.APP_RESIZE,this.boundUpdateZoomFactor),this.wrapper.removeEventListener(BreaseEvent.FOCUS_IN,this.boundFocusIn),this.wrapper.removeEventListener("scroll",b),this.wrapper.removeEventListener("wheel",this.boundStopPropagation)}),o.boundUpdateZoomFactor=o.breaseUpdateZoomFactor.bind(o),document.body.addEventListener(BreaseEvent.APP_RESIZE,o.boundUpdateZoomFactor),o.boundFocusIn=f.bind(o),o.wrapper.addEventListener(BreaseEvent.FOCUS_IN,o.boundFocusIn),o.wrapper.addEventListener("scroll",b),o.boundStopPropagation=d.bind(o),o.wrapper.addEventListener("wheel",o.boundStopPropagation),i.update(),!0!==a&&u(r,o)):o={on:function(){p(t)},off:function(){},refresh:function(){},scrollToElement:function(){},scrollTo:function(){},scrollBy:function(){},destroy:function(){},enable:function(){},disable:function(){},wrapper:{}},o},disableAllStartedScrollers:function(){for(var e in t.scroller)t.scroller[e].disable()}},t={scroller:{}},i={update:function(){}},s={};Utils.defineProperty(s,"bounce",!1),Utils.defineProperty(s,"fadeScrollbars",!1),Utils.defineProperty(s,"momentum",!0),Utils.defineProperty(s,"mouseWheel",!1),Utils.defineProperty(s,"resizeScrollbars",!0),Utils.defineProperty(s,"scrollbars","custom"),Utils.defineProperty(s,"preventDefault",!1),Utils.defineProperty(s,"disableTouch",!1),Utils.defineProperty(s,"disableMouse",!1),Utils.defineProperty(s,"disablePointer",!0),Utils.defineProperty(s,"HWCompositing",!1),Utils.defineProperty(Scroller,"defaults",s);function n(e){var t=$.extend({},Scroller.defaults,e);return t.disableTouch=!1,t.disableMouse=!1,t.disablePointer=!0,t.HWCompositing=!1,t}function a(e){return e.enabled&&!0===e.options.mouseWheel&&Math.abs(e.maxScrollX)>0}function r(e){return e.enabled&&!0===e.options.mouseWheel&&Math.abs(e.maxScrollY)>0}function o(e){return Math.abs(e.deltaX)>0}function l(e){return Math.abs(e.deltaY)>0}function d(e){(l(e)&&r(this)||o(e)&&a(this)||!r(this)&&a(this)&&l(e))&&e.stopPropagation()}function c(e){if(e.hasHorizontalScroll||e.hasVerticalScroll){var i=$(e.wrapper).closest("[id]")[0].id;t.scroller[i]=e;for(var s in t.scroller)if(t.scroller[s]!==e&&$.contains(e.wrapper,t.scroller[s].wrapper)){e.disable();break}}}function h(){!0!==t.stopped&&(t.stopped=!0,window.setTimeout(function(){for(var e in t.scroller){var i=t.scroller[e];i.enabled||(i.initiated=0,i.enable())}t.scroller={},t.stopped=!1},0))}function u(e,t){if("function"==typeof MutationObserver){var i=new MutationObserver(m);i.debouncedRefresh=_.debounce(g.bind(null,t,i),300),i.observe(e,{childList:!0,subtree:!0})}}function g(e,t){e.wrapper&&e.wrapper.ownerDocument===document&&e.refresh(),t.disconnect(),t.debouncedRefresh=null}function m(e,t){var i=!1;e.forEach(function(e){e.addedNodes.length>0&&(i=!0)}),i&&t.debouncedRefresh()}function p(e){console.iatWarn("trying to add a scroller to a null object:"+e)}function f(e){var t=e.target,i=ScrollUtils.checkElemOutsideScrollArea(t,this.wrapper);if(!t.matches(":active")){var s=i.horizontal&&!0===this.hasHorizontalScroll,n=i.vertical&&!0===this.hasVerticalScroll;(s||n)&&this.scrollToElement(t,0,s,n);var a=ScrollUtils.checkElemOutsideViewport(t);0===a.x&&0===a.y||window.scrollBy(a.x,a.y)}}function b(e){e.preventDefault()}return Scroller}),define("brease/controller/PopUpManager",["brease/core/Utils","brease/events/BreaseEvent"],function(Utils,BreaseEvent){"use strict";var PopUpManager={debounceTime:200,init:function(){n();var e=_.debounce(n,PopUpManager.debounceTime);document.body.addEventListener(BreaseEvent.APP_RESIZE,function(t){t.detail&&t.detail.immediate?(e.cancel(),n()):e()}),$(window).on("resize",e)},addWindow:function(e,s){t[e]||(t[e]={id:e,type:s,index:i+=1})},updateIndex:function(e,i){t[e]&&(t[e].index=i)},getNumberOfWindowsOfType:function(e){var i=0;for(var s in t)t[s]&&t[s].type===e&&(i+=1);return i},removeWindow:function(e){delete t[e]},overlays:function(e){var i=[],s=0;if(t[e]){s=t[e].index;for(var n in t)t[n]&&t[n].index>s&&i.push(t[n].id)}return i},getHighestZindex:function(){return a(),e+=1,e},update:function(){n()},getDimensions:function(){return{winWidth:s.winWidth,winHeight:s.winHeight,appWidth:s.appWidth,appHeight:s.appHeight}}},e=-1,t={},i=0,s={};function n(){s={winWidth:window.innerWidth,winHeight:window.innerHeight,appWidth:brease.appView.innerWidth(),appHeight:brease.appView.innerHeight()}}function a(){e=Utils.getHighestZindex(document.querySelectorAll("body > [class],body > [style],body > [id]"))}return PopUpManager.init(),PopUpManager}),define("brease/controller/objects/PageType",["brease/core/Utils"],function(Utils){"use strict";var e={};return Utils.defineProperty(e,"PAGE","Page"),Utils.defineProperty(e,"DIALOG","Dialog"),e}),define("brease/controller/libs/Utils",["brease/controller/objects/PageType"],function(PageType){"use strict";var e=new RegExp(".*_style_.*"),t="eval";function i(e){return"string"==typeof e||e instanceof String}function s(e){var t=e.closest(".breaseHideableContentControlContainer");if(t){var i=$(t).data("widgetid"),s=document.getElementById(i);if(s)return s.closest(".LayoutArea[id^=root]")}return null}var Utils={findLoaders:function(e){if(e&&"function"==typeof e.querySelectorAll){var t=e.querySelectorAll(".systemContentLoader"),i=t.length;if(i>0){for(var s=new Array(i),n=0;n<i;n+=1)s[i-(n+1)]=t[n];return s}}return[]},resetContentControls:function(e){if(e&&"function"==typeof e.querySelectorAll)for(var t=e.querySelectorAll(".breaseContentControl"),i=0;i<t.length;i+=1)brease.uiController.callWidget(t[i].id,"reset")},setPageStyle:function(t,s,n){if(i(t)&&i(n)){var a=$(s),r=Utils.pageStyleName(t,n);if(a.length>0){n===PageType.DIALOG&&(a=a.closest('[data-brease-widget="widgets/brease/DialogWindow"]'));var o=a[0].classList;if(!1===o.contains(r)){for(var l in o)e.test(o[l])&&a.removeClass(o[l]);a.addClass(r)}}}},pageStyleName:function(e,t){return"system_brease_"+t+"_style_"+e},appendHTML:function(e,t){if(e&&void 0!==e.innerHTML&&i(t)){e.innerHTML=t;for(var s=e.querySelectorAll("script"),n=0;n<s.length;n+=1)window.eval(s[n].textContent),s[n].parentNode.removeChild(s[n])}},injectCSS:function(e){var t;return i(e)&&(this.headElem||(this.headElem=document.getElementsByTagName("head")[0]),t=document.createElement("style"),t.textContent=e,this.headElem.appendChild(t)),t},forceRepaint:function(e){var t=e.style.cssText;e.style.cssText+=";transform:rotateZ(0deg)",e.offsetHeight,e.style.cssText=t},getContentPageAreaIds:function(e){var t={},i=document.querySelector('[data-brease-contentid="'+e+'"]');if(i){var n=i.parentElement,a=n.closest(".LayoutArea[id^=root]");if(a||(a=s(n)),a){var r=a.parentElement;t.areaId=a.getAttribute("data-brease-areaid"),t.pageId=r.getAttribute("data-brease-pageid")}}return t},hasModalWindow:function(){return null!==document.body.querySelector(".breaseModalDimmer.active")},compareTabOrder:function(e,t){var i=e.getTabIndex(),s=t.getTabIndex();return i===s?e.elem.compareDocumentPosition(t.elem)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1:0===i?1:0===s?-1:i-s}};return Utils}),define("brease/controller/ZoomManager",["brease/controller/libs/Utils"],function(Utils){"use strict";var ZoomManager={setBrowserZoom:function(){e("browserZoom")?brease.bodyEl.css({"touch-action":"pinch-zoom","-ms-touch-action":"pinch-zoom"}):(brease.bodyEl.css({"touch-action":"none","-ms-touch-action":"pinch-zoom"}),!0===brease.config.detection.ios&&(brease.bodyEl.css({"touch-action":"manipulation"}),$(document.head).find('meta[name="viewport"]').attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"),"Safari"===brease.config.detection.browser&&document.addEventListener("gesturestart",function(e){e.preventDefault()})))},iosBodyFix:function(){!0===brease.config.detection.ios&&(brease.appView.height()<=window.innerHeight?brease.bodyEl.css({position:"fixed"}):brease.bodyEl.css({position:"static"}))},setRootLayoutSize:function(i,s,n){e("zoom")?(document.body.style.overflow="hidden",t.init(i,n)):(document.body.style.overflow="auto",n.css({width:s.width+"px",height:s.height+"px"}),brease.dispatchResize({immediate:!0}))},getAppZoom:function(){return t.scale},zoomFitContainerSize:function(e,t,i){var s=e*t.width,n=e*t.height,a=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER;return s>i.width&&(a=i.width/t.width),n>i.height&&(r=i.height/t.height),Math.min(a,r,e)}};function e(e){return void 0!==brease.config.visu&&!0===brease.config.visu[e]}var t={scale:1,listening:!1,init:function e(i,s){this.$layoutDiv=$(i),this.$rootContainer=s,this.scale=1,this.listening||($(window).on("resize",_.debounce(t.onResize,150)),this.listening=!0),this.zoom(!0)},zoom:function e(t){"iOS"===brease.config.detection.os&&brease.bodyEl.css("width","100%");var i=this.$layoutDiv[0].getBoundingClientRect(),s=document.body.getBoundingClientRect(),n=Math.floor(s.width)/(i.width/this.scale),a=Math.floor(s.height)/(i.height/this.scale);if(this.scale=Math.min(n,a),this.scale===n){var r=Math.floor(this.$layoutDiv.outerWidth()*this.scale);this.scale=r/this.$layoutDiv.outerWidth()}else{var o=Math.floor(this.$layoutDiv.outerHeight()*this.scale);this.scale=o/this.$layoutDiv.outerHeight()}this.$layoutDiv.css({transform:"scale("+this.scale+","+this.scale+")","transform-origin":"0 0"}),i=this.$layoutDiv[0].getBoundingClientRect(),this.$rootContainer.css({width:i.width,height:i.height}),Utils.forceRepaint(this.$rootContainer[0]),t?brease.dispatchResize({immediate:!0}):brease.dispatchResize()},windowResizeHandler:function(){this.zoom()}};return t.onResize=t.windowResizeHandler.bind(t),ZoomManager}),define("brease/controller/libs/FocusChain",["brease/events/BreaseEvent","brease/controller/libs/Utils","brease/enum/Enum","brease/controller/libs/LogCode"],function(BreaseEvent,Utils,Enum,LogCode){"use strict";var FocusChain=function(){this.chain=[],this.position={content:void 0,widget:void 0},this.orderedContents=[],this.chainCircle={start:void 0,length:void 0},this.recoveryPoints=new Map,this.resetted=!1,this.modalWidgets=[]};FocusChain.prototype.hasFocus=function(){return void 0!==this.position.content&&void 0!==this.chain[this.position.content]},FocusChain.prototype.resetFocus=function(){this.hasFocus()?this.getFocusedElem().focus({preventScroll:!0}):(this.position.content=m.call(this).start,this.position.widget=0,this.focusNext(!0,!0),this.resetted=!0)},FocusChain.prototype.addDialog=function(e){for(var t=n(e),i=0;i<t.length;++i){var s=this.chain.findIndex(function(e){return t[i].contentId===e.contentId});s>=0?(t[i].widgets=this.chain[s].widgets,a.call(this,t[i].contentId)):(t[i].widgets=[],delete t[i].contentId),this.chain.push(t[i])}this.recoveryPoints.set(e,{lastFocused:this.getFocusedElem(),modalWidgets:_.clone(this.modalWidgets)}),this.modalWidgets.length=0,this.position.content=this.chain.length-t.length,this.position.widget=0,Utils.hasModalWindow()&&(this.chainCircle.start=this.position.content,this.chainCircle.length=t.length),this.focusNext(!0,!0),this.resetted=!0},FocusChain.prototype.removeDialog=function(e,t){v.call(this),r.call(this,e);var i=this.recoveryPoints.get(e);i&&(this.modalWidgets=i.modalWidgets,this.hasFocus()||(this.focus(i.lastFocused),t||this.focusNext(!0,!0)),this.recoveryPoints.delete(e))},FocusChain.prototype.addGenericDialog=function(e){this.recoveryPoints.set(e,{lastFocused:this.getFocusedElem(),modalWidgets:_.clone(this.modalWidgets)}),this.chain.push({contentId:brease.settings.globalContent,widgets:[],areaId:"",pageId:e,type:"Dialog",tabIndex:[1]}),this.chainCircle.start=this.chain.length-1,this.chainCircle.length=1},FocusChain.prototype.removeGenericDialog=function(e,t){var i=this.recoveryPoints.get(e);this.modalWidgets=i.modalWidgets,this.remove(brease.settings.globalContent),v.call(this),this.focus(i.lastFocused),t||this.focusNext(!0,!0),this.recoveryPoints.delete(e)},FocusChain.prototype.add=function(t,i){e.call(this,t)||(brease.pageController.isPageChangeInProgress()?this.chain.push({contentId:t,widgets:i}):void 0===this.position.content?(this.chain.push({contentId:t,widgets:i}),this.resetFocus()):c.call(this,{contentId:t,widgets:i}))},FocusChain.prototype.remove=function(e){if(!brease.pageController.isPageChangeInProgress()||brease.pageController.isContentToBeRemoved(e)){var i=this.chain[t.call(this,e)],s=a.call(this,e);s<0||(s===this.position.content?o.call(this,i):s<this.position.content&&--this.position.content)}},FocusChain.prototype.addWidget=function(e,i){if(!(i.getTabIndex()<0||!i.settings.focusable||this.hasElem(i.elem))){var s=t.call(this,e);s<0||(l.call(this,s,i),document.activeElement!==this.getFocusedElem()&&this.focus(document.activeElement))}},FocusChain.prototype.removeWidget=function(e,i){var s=t.call(this,e);if(!(s<0)){var n=this.chain[s].widgets.findIndex(function(e){return e===i});-1!==n&&(this.chain[s].widgets.splice(n,1),s===this.position.content&&this.position.widget>0&&n<=this.position.widget&&this.position.widget--)}},FocusChain.prototype.sort=function(e){for(var t=n(e),i,s=0;s<t.length;++s){var a=this.chain.findIndex(function(e){return t[s].contentId===e.contentId});a>=0?(this.hasFocus()&&this.position.content===a&&(i=s),t[s].widgets=this.chain[a].widgets):(t[s].widgets=[],delete t[s].contentId)}this.position.content=i,this.chain=t},FocusChain.prototype.sortContent=function(e){d.call(this);var i=t.call(this,e);i>=0&&(this.chain[i].widgets.sort(Utils.compareTabOrder),document.activeElement!==this.getFocusedElem()&&this.focus(document.activeElement))},FocusChain.prototype.focus=function(e){if(e===this.getFocusedElem())return!1;for(var t=0;t<this.chain.length;++t)for(var i=this.chain[t].widgets,s=0;s<i.length;++s)if(i[s].elem===e){if(f.call(this,t))i[s].isEnabled()?(this.position={content:t,widget:s},this.resetted=!1):document.activeElement.blur();else{document.activeElement.blur();var n=LogCode.getConfig("CLIENT_FOCUS_ACTION_FAIL");brease.loggerService.log(n.code,Enum.EventLoggerCustomer.BUR,n.verboseLevel,n.severity,[e.id])}return!0}return!1},FocusChain.prototype.focusNext=function(e,t){if(0===this.chain.length)return this.position.widget=void 0,this.position.content=void 0,void 0;for(var i=this.getFocusedElem(),s=m.call(this),n=0;n<s.length+1;++n){this.position.content>s.end&&(this.position.content=s.start);for(var a=this.chain[this.position.content].widgets;this.position.widget<a.length;++this.position.widget)if(e){var r=a[this.position.widget];if(r.isFocusable()&&y.call(this,r.elem.id))return t||i.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_FOCUS_MOVE,{bubbles:!1,cancelable:!1,detail:{}})),r.elem.focus({preventScroll:!0}),this.resetted=!1,void 0}else e=!0;this.position.widget=0,++this.position.content}this.position.widget=void 0,this.position.content=void 0},FocusChain.prototype.focusPrevious=function(){var e=!1;if(0===this.chain.length)return this.position.widget=void 0,this.position.content=void 0,void 0;for(var t=this.getFocusedElem(),i=m.call(this),s=0;s<i.length+1;++s){this.position.content<i.start&&(this.position.content=i.end);var n=this.chain[this.position.content].widgets;if(n.length>0)for(void 0===this.position.widget&&(this.position.widget=n.length-1);this.position.widget>=0;--this.position.widget)if(e){var a=n[this.position.widget];if(a.isFocusable()&&y.call(this,a.elem.id))return t.isSameNode(a.elem)||t.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_FOCUS_MOVE,{bubbles:!1,cancelable:!1,detail:{}})),a.elem.focus({preventScroll:!0}),this.resetted=!1,void 0}else e=!0;this.position.widget=void 0,--this.position.content}this.position.widget=void 0,this.position.content=void 0},FocusChain.prototype.getFocusedElem=function(){if(this.hasFocus()&&this.chain[this.position.content].widgets.length>0&&this.chain[this.position.content].widgets[this.position.widget])return this.chain[this.position.content].widgets[this.position.widget].elem},FocusChain.prototype.hasElem=function(e){return this.chain.some(function(t){return t.widgets.some(function(t){return e.isSameNode(t.elem)})})},FocusChain.prototype.pushModalWidgets=function(e,t){this.modalWidgets.findIndex(function(t){return t.id===e})>=0||(this.modalWidgets.push({id:e,widgetIds:t.map(function(e){return e.elem.id})}),this.focusNext(!0))},FocusChain.prototype.removeModalWidgets=function(e){var t=this.modalWidgets.findIndex(function(t){return t.id===e});t>=0?this.modalWidgets.splice(t,1):this.recoveryPoints&&this.recoveryPoints.forEach(function(t){this.removeModalWidgets.call(t,e)},this)};function e(e){return-1!==t.call(this,e)}function t(e){return this.chain.findIndex(function(t){return t.contentId===e})}function i(e){return this.chain.some(function(t){return t.pageId===e&&void 0!==t.contentId})}function s(){for(var e=this.chain.length-1;e>=0;--e)if("Dialog"===this.chain[e].type&&void 0!==this.chain[e].contentId)return this.chain[e].pageId}function n(e){var t=brease.pageController.getPageById(e)||brease.pageController.getDialogById(e),i=brease.pageController.getLayoutById(t.layout).areas,s=[];for(var a in t.assignments){var r=t.assignments[a],o=i[r.areaId].tabIndex>0?i[r.areaId].tabIndex:void 0;if("Content"===r.type)s.push({type:t.type,pageId:e,areaId:r.areaId,contentId:r.contentId,tabIndex:[o]});else if("Page"===r.type){var l=n(r.contentId);l.forEach(function(e){e.tabIndex.unshift(o)}),s=s.concat(l)}}return s.sort(function(e,t){return void 0===e.tabIndex[0]?1:void 0===t.tabIndex[0]?-1:e.tabIndex[0]-t.tabIndex[0]}),s}function a(e){var i=t.call(this,e);return i>=0&&this.chain.splice(i,1),i}function r(e){this.chain=this.chain.filter(function(t){return t.pageId!==e})}function o(e){if("Dialog"===e.type&&!i.call(this,e.pageId))return this.position.widget=void 0,this.position.content=void 0,document.body.focus({preventScroll:!0}),void 0;this.position.content>=this.chain.length&&(this.position.content=m.call(this).start),!brease.pageController.isPageChangeInProgress()&&this.chain.length>0?(this.position.widget=0,this.focusNext(!0,!0)):(this.position.content=void 0,this.position.widget=void 0)}function l(e,t){d.call(this);for(var i,s=0;s<this.chain[e].widgets.length;++s){var n=this.chain[e].widgets[s],a=n.settings.parentCoWiId;if(a&&(n=brease.callWidget(a,"widget")),Utils.compareTabOrder(n,t)>0){i=s;break}}void 0===i?this.chain[e].widgets.push(t):this.chain[e].widgets.splice(i,0,t),e<=this.position.content&&(this.resetted?(this.position.widget=void 0,this.position.content=void 0,this.resetFocus()):e===this.position.content&&i<=this.position.widget&&++this.position.widget)}function d(){this.chain.forEach(function(e){e.widgets=e.widgets.filter(function(e){return null!==e.elem})})}function c(e){if(Object.assign(e,Utils.getContentPageAreaIds(e.contentId)),e.pageId){var t=g.call(this,e.pageId,e.areaId);if(-1===t){if(t=h.call(this,e.pageId,e.areaId),-1===t)return;this.chain.splice(t,0,e)}else e.type=this.chain[t].type,this.chain.splice(++t,0,e);t<=this.position.content&&++this.position.content,p.call(this,t)}}function h(e,t){var i=u(e,t);if(i){for(var s=0,n=0;n<this.chain.length;n+=1){var a=this.chain[n];if(a.pageId!==e||!i.includes(a.areaId))break;s+=1}return s}return-1}function u(e,t){for(var i=n(e),s=[],a=!1,r=0;r<i.length;r+=1){var o=i[r];if(o.pageId===e&&o.areaId===t){a=!0;break}-1===s.indexOf(o.areaId)&&s.push(o.areaId)}return a?s:void 0}function g(e,t){for(var i=this.chain.length-1;i>=0;i--)if(this.chain[i].pageId===e&&this.chain[i].areaId===t)return i;return-1}function m(){var e={};return void 0===this.chainCircle.start?(e.start=0,e.length=this.chain.length):e=this.chainCircle,e.end=e.start+e.length-1,e}function p(e){void 0!==this.chainCircle.start&&(e<this.chainCircle.start?++this.chainCircle.start:this.chainCircle.length++)}function f(e){var t=m.call(this);return e>=t.start&&e<=t.end}function b(e){for(var t={},i=this.chain.length-1;i>=0;--i)if(this.chain[i].pageId===e&&void 0===t.end&&(t.end=i),void 0!==t.end&&e!==this.chain[i].pageId){t.start=i+1;break}return t.length=t.end-t.start+1,t}function v(){var e=s.call(this);e&&Utils.hasModalWindow()?this.chainCircle=b.call(this,e):this.chainCircle.start=void 0}function y(e){var t=this.modalWidgets[this.modalWidgets.length-1];return void 0===t||-1!==t.widgetIds.indexOf(e)}return FocusChain}),define("brease/controller/libs/MsgBoxFocusChainStack",[],function(){"use strict";var MsgBoxFocusChainStack=function(){this.stack=[],this.position=void 0};return MsgBoxFocusChainStack.prototype.isEmpty=function(){return 0===this.stack.length},MsgBoxFocusChainStack.prototype.push=function(e){this.stack.push(e),this.resetFocus()},MsgBoxFocusChainStack.prototype.pop=function(){this.stack.pop(),this.isEmpty()?document.activeElement.blur():this.resetFocus()},MsgBoxFocusChainStack.prototype.peek=function(){return this.stack[this.stack.length-1]},MsgBoxFocusChainStack.prototype.resetFocus=function(){this.peek()[0].focus(),this.position=0},MsgBoxFocusChainStack.prototype.focusNext=function(){this.position++;var e=this.peek();this.position>=e.length&&(this.position=0),e[this.position].focus()},MsgBoxFocusChainStack.prototype.focusPrevious=function(){this.position--;var e=this.peek();this.position<0&&(this.position=e.length-1),e[this.position].focus()},MsgBoxFocusChainStack.prototype.focus=function(e){var t=this.peek();this.position=t.findIndex(function(t){return e.isSameNode(t)})},MsgBoxFocusChainStack}),define("brease/events/ClientSystemEvent",["brease/core/Utils"],function(Utils){"use strict";var ClientSystemEvent={};return Utils.defineProperty(ClientSystemEvent,"CONTENT_LOADED","ContentLoaded"),Utils.defineProperty(ClientSystemEvent,"DISABLED_CLICK","DisabledClick"),Utils.defineProperty(ClientSystemEvent,"DIALOG_CLOSED","DialogClosed"),Utils.defineProperty(ClientSystemEvent,"DIALOG_OPENED","DialogOpened"),Utils.defineProperty(ClientSystemEvent,"KEY_DOWN","KeyDown"),Utils.defineProperty(ClientSystemEvent,"KEY_PRESS","KeyPress"),Utils.defineProperty(ClientSystemEvent,"KEY_UP","KeyUp"),Utils.defineProperty(ClientSystemEvent,"LOGIN_FAILED","LoginFailed"),Utils.defineProperty(ClientSystemEvent,"LOGIN_SUCCESS","LoginSuccess"),Utils.defineProperty(ClientSystemEvent,"SYSTEM_SWIPE","SystemSwipe"),Utils.defineProperty(ClientSystemEvent,"TOOLTIPMODE_ACTIVATED","TooltipModeActivated"),Utils.defineProperty(ClientSystemEvent,"TOOLTIPMODE_DEACTIVATED","TooltipModeDeactivated"),Utils.defineProperty(ClientSystemEvent,"CHANGEPASSWORDDIALOG_CLOSED","ChangePasswordDialogClosed"),ClientSystemEvent}),define("brease/controller/FocusManager",["brease/controller/libs/FocusChain","brease/controller/libs/MsgBoxFocusChainStack","brease/events/BreaseEvent","brease/core/Utils","brease/events/ClientSystemEvent","brease/controller/libs/Utils"],function(FocusChain,MsgBoxFocusChainStack,BreaseEvent,Utils,ClientSystemEvent,e){"use strict";var t=new FocusChain,i=!1,s,n,a=new MsgBoxFocusChainStack,r=[];const o={DIALOG:0,MSGBOX:1};var FocusManager={start:function(){i=!0,document.body.addEventListener(BreaseEvent.PAGE_LOADED,l),brease.appElem.addEventListener(ClientSystemEvent.CONTENT_LOADED,d),brease.appElem.addEventListener(ClientSystemEvent.DIALOG_OPENED,u),brease.appElem.addEventListener(ClientSystemEvent.DIALOG_CLOSED,g),document.body.addEventListener(BreaseEvent.WIDGET_READY,y),document.body.addEventListener(BreaseEvent.FOCUS_ELEM_READY,c),document.body.addEventListener(BreaseEvent.FOCUS_ELEM_DISPOSED,h),document.body.addEventListener(BreaseEvent.WINDOW_SHOW,w),document.body.addEventListener(BreaseEvent.CLOSED,x),document.body.addEventListener(BreaseEvent.CONTENT_REMOVED,E),document.body.addEventListener(BreaseEvent.MESSAGE_BOX_OPENED,f),document.body.addEventListener(BreaseEvent.MESSAGE_BOX_CLOSED,b),document.body.addEventListener("focusin",C),document.body.addEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,_),document.body.addEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,S),document.body.addEventListener(BreaseEvent.SHOW_MODAL,P),document.body.addEventListener(BreaseEvent.HIDE_MODAL,O),document.body.addEventListener(BreaseEvent.TABINDEX_CHANGED,N),window.addEventListener("keydown",I)},stop:function(){i=!1,document.body.removeEventListener(BreaseEvent.PAGE_LOADED,l),brease.appElem.removeEventListener(ClientSystemEvent.CONTENT_LOADED,d),brease.appElem.removeEventListener(ClientSystemEvent.DIALOG_OPENED,u),brease.appElem.removeEventListener(ClientSystemEvent.DIALOG_CLOSED,g),document.body.removeEventListener(BreaseEvent.WIDGET_READY,y),document.body.removeEventListener(BreaseEvent.WINDOW_SHOW,w),document.body.removeEventListener(BreaseEvent.CLOSED,x),document.body.removeEventListener(BreaseEvent.CONTENT_REMOVED,E),document.body.removeEventListener(BreaseEvent.MESSAGE_BOX_OPENED,f),document.body.removeEventListener(BreaseEvent.MESSAGE_BOX_CLOSED,b),document.body.removeEventListener("focusin",C),document.body.removeEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,_),document.body.removeEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,S),document.body.removeEventListener(BreaseEvent.SHOW_MODAL,P),document.body.removeEventListener(BreaseEvent.HIDE_MODAL,O),document.body.removeEventListener(BreaseEvent.TABINDEX_CHANGED,N),window.removeEventListener("keydown",I)},focusNext:function(){i&&(p()?a.focusNext():t.focusNext())},focusPrevious:function(){i&&(p()?a.focusPrevious():t.focusPrevious())},getFocusedElem:function(){return t.getFocusedElem()},showTabOrder:function(e){window.cancelAnimationFrame(n),n=window.requestAnimationFrame(k.bind(null,e||function(){}))},hideTabOrder:function(){window.cancelAnimationFrame(n),B(),document.head.contains(s)&&document.head.removeChild(s)}};function l(e){e.detail.pageId===brease.pageController.getCurrentPage(brease.appElem.id)&&(t.sort(e.detail.pageId),e.detail.containerId===brease.appElem.id&&t.resetFocus())}function d(e){var i=e.detail.contentId,s=L(i);t.add(i,s)}function c(e){var i=e.detail;t.addWidget(i.getParentContentId(),i)}function h(e){var i=e.detail;t.removeWidget(i.getParentContentId(),i)}function u(e){r.push({type:o.DIALOG,id:e.detail.dialogId}),t.addDialog(e.detail.dialogId)}function g(e){m(e.detail.dialogId);var i=p();t.removeDialog(e.detail.dialogId,i),i&&a.resetFocus()}function m(e){r=r.filter(function(t){return t.id!==e})}function p(){var e=r[r.length-1];return e&&e.type===o.MSGBOX}function f(e){r.push({type:o.MSGBOX,id:e.detail.id});var t=Array.from(e.target.querySelectorAll("[tabindex]")).filter(function(e){return"none"!==e.style.display});a.push(t)}function b(e){m(e.detail.id),a.pop(),p()||t.focusNext(!0,!0)}function v(e,t){return e&&e.settings.focusEvent?e.settings.focusEvent[t]:void 0}function y(e){var i=brease.callWidget(e.target.id,"widget"),s=i.getParentContentId();v(i,"start")===e.type?(r.push({type:o.DIALOG,id:e.target.id}),t.addGenericDialog(e.target.id)):(i.settings._dynamicallyCreated||s===brease.settings.globalContent)&&t.addWidget(s,i)}function w(e){var i=brease.callWidget(e.target.id,"widget");v(i,"start")===e.type&&(r.push({type:o.DIALOG,id:e.target.id}),t.addGenericDialog(e.target.id),i.el.find("[data-brease-widget]").each(function(e,i){t.addWidget(brease.settings.globalContent,brease.callWidget(this.id,"widget"))}))}function x(e){if(v(brease.callWidget(e.detail.id,"widget"),"end")===e.type){m(e.detail.dialogId);var i=p();t.removeGenericDialog(e.detail.id,i),i&&a.resetFocus()}}function E(e){t.remove(e.detail.contentId)}function I(e){"Tab"===e.key&&(e.preventDefault(),e.shiftKey?FocusManager.focusPrevious():FocusManager.focusNext())}function C(e){if(p())a.focus(e.target);else if(!t.focus(e.target)){var i=Utils.closestWidgetElem(e.target);t.focus(i)}}function _(e){T(e)}function S(e){T(e)}function T(e){if(!1===e.detail.value){var i=t.getFocusedElem();i&&i.isSameNode(e.target)&&t.focusNext()}}function D(t){for(var i={},s=t.length-1;s>=0;s-=1){var n=t[s],a=n.settings.parentCoWiId;if(a){i[a]||(i[a]=[]);var r=brease.uiController.callWidget(a,"getTabIndex");r>=0?i[a].push(n):n.getTabIndex()>=0&&n.setTabIndex(r),delete t[s]}}for(var o in i)i[o].sort(e.compareTabOrder);return i}function A(e,t){var i=[];return e.forEach(function(e){var s=e.elem.id;t[s]?(i.push(e),i.push.apply(i,t[s])):i.push(e)}),i}function L(t){var i=brease.uiController.widgetsController.getWidgetsOfContent(t).map(function(e){return brease.callWidget(e,"widget")}),s=D(i);return i.sort(e.compareTabOrder),i=A(i,s),i=i.filter(function(e){return e.getTabIndex()>=0&&(e.settings.focusable||brease.config.editMode)}),i}function P(e){var i=Array.from(e.target.getElementsByClassName("breaseWidget")).map(function(e){return brease.callWidget(e.id,"widget")}).filter(function(e){return e.getTabIndex()>=0&&e.settings.focusable});t.pushModalWidgets(e.detail.id,i)}function O(e){t.removeModalWidgets(e.detail.id)}function N(e){t.sortContent(e.detail.contentId)}function k(e){var i=[];brease.config.editMode?i=L(brease.settings.globalContent).filter(function(e){return e.settings.hasOwnProperty("parentRefId")}):t.chain.forEach(function(e){i=i.concat(e.widgets)}),M(),B();for(var s=0;s<i.length;++s){var n=s+1,a=i[s].getTabIndex();"svg"===i[s].elem.nodeName?i[s].elem.appendChild(R(n,a)):(i[s].elem.dataset.focuspos=n,i[s].elem.dataset.tabindex=a)}e(i.map(function(e){return e.elem.id}))}function R(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return i.classList.add("svgTabOrderIndicator"),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.dataset.focuspos=e,i.dataset.tabindex=t,i}function B(){var e=document.body.querySelectorAll("[data-focuspos]");Array.prototype.slice.call(e).forEach(function(e){"foreignObject"===e.nodeName?e.remove():(e.removeAttribute("data-focuspos"),e.removeAttribute("data-tabindex"))})}function M(){s||(s=e.injectCSS('[data-focuspos]::after {position: absolute;top: 50%;left: 50%;background: #d5f0cd; font: normal large Arial;border: 3px solid black;border-radius: 3px;text-align: center;transform: translateX(-50%) translateY(-50%);min-width: 2em;z-index: 20000;content: attr(data-focuspos);}[data-tabindex="0"]::after {background: #FFFD9C;}.svgTabOrderIndicator {pointer-events: none;position: absolute;left: 0px;top: 0px;}')),document.head.appendChild(s)}return FocusManager}),define("brease/controller/libs/ErrorCode",["brease/services/libs/ServerCode","brease/enum/Enum"],function(ServerCode,Enum){"use strict";var ErrorCode={getMessageByCode:function(t,i){if(t=""+t,void 0!==e[t]){var s=e[t].message;if(Array.isArray(i))for(var n=0;n<i.length;n+=1)s=s.replace(new RegExp("\\{"+n+"\\}","g"),i[n]);return s}return e[ServerCode.GENERIC_CONNECTION_FAILED].message},getLogIdByCode:function(t){return t=""+t,void 0!==e[t]?e[t].logId:e[ServerCode.GENERIC_CONNECTION_FAILED].logId}},e={2148073484:{message:"Visualization already open on this client, no further sessions allowed",logId:Enum.EventLoggerId.NO_FURTHER_SESSION},2148139020:{message:"Maximum number of clients reached!",logId:Enum.EventLoggerId.MAX_CLIENTS},2148204556:{message:"No more clients allowed, no client license available",logId:Enum.EventLoggerId.NOT_ENOUGH_LICENSES},2148270092:{message:'Not allowed, license not available for visualization (id="{0}")!',logId:Enum.EventLoggerId.NO_LICENSE},"-1":{message:"server connection (register client) error",logId:Enum.EventLoggerId.CLIENT_START_FAIL}};return ErrorCode}),define("brease/helper/Messenger",["brease/enum/Enum","brease/services/libs/ServerCode","brease/controller/libs/ErrorCode"],function(Enum,ServerCode,ErrorCode){"use strict";var Messenger=function(e){
this.systemMessage=e};return Messenger.prototype.announce=function(e,t){switch(e){case Messenger.START_CONTENT:console.log("start with content:"+(t?t.contentId:""));break;case Messenger.START_VISU:console.log("start with visualization:"+(t?t.visuId:""));break;case Messenger.VISU_NOT_FOUND:console.log("visualization (visuId="+(t?t.visuId:"")+") not found");break;case Messenger.VISU_NOT_ACTIVATED:console.log("visualization (visuId="+(t?t.visuId:"")+") not activated"),this.systemMessage.showMessage("visualization (visuId="+(t?t.visuId:"")+") not activated");break;case Messenger.CONFIGURATION_LOAD_ERROR:console.iatWarn("configuration not found; take default values");break;case Messenger.START_SERVICES_SUCCESS:brease.loggerService.log(Enum.EventLoggerId.CLIENT_START_OK,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.SUCCESS,[t.clientId]);break;case Messenger.START_SERVICES_FAILED:var i=void 0!==t.cookies&&!1===t.cookies?"\n(please check if cookies are enabled)":"";console.log("XHR error:"+t.message+i),this.systemMessage.showMessage("server connection error"+i),brease.loggerService.log(Enum.EventLoggerId.CLIENT_START_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[],"XHR error:"+t.message);break;case Messenger.REGISTER_CLIENT_SUCCESS:console.log("registered client with id = "+(t?t.clientId:""));break;case Messenger.REGISTER_CLIENT_FAILED:var s=ErrorCode.getMessageByCode(ServerCode.GENERIC_CONNECTION_FAILED),n=ErrorCode.getLogIdByCode(ServerCode.GENERIC_CONNECTION_FAILED);void 0!==t.response.status&&void 0!==t.response.status.code&&(s=ErrorCode.getMessageByCode(t.response.status.code,[t.visuId]),n=ErrorCode.getLogIdByCode(t.response.status.code)),brease.loggerService.log(n,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[],s),this.systemMessage.showMessage(s),console.log(s);break;case Messenger.SERVER_CONNECTION_START:this.systemMessage.deferMessage("try to establish server connection...",2e3),console.log("try to establish server connection..");break;case Messenger.SERVER_CONNECTION_SUCCESS:this.systemMessage.clear();break;case Messenger.SERVER_CONNECTION_ERROR:this.systemMessage.showMessage("server connection error");break;case Messenger.TEXT_LOAD_START:this.systemMessage.deferMessage("loading texts...",2e3),console.log("loading texts...");break;case Messenger.TEXT_LOAD_SUCCESS:this.systemMessage.clear();break;case Messenger.TEXT_LOAD_ERROR:this.systemMessage.showMessage("error on loading texts");break;case Messenger.WIDGET_LOAD_ERROR:this.systemMessage.showMessage("error on loading system widgets");break}},Messenger.START_CONTENT="START_CONTENT",Messenger.START_VISU="START_VISU",Messenger.VISU_NOT_FOUND="VISU_NOT_FOUND",Messenger.VISU_NOT_ACTIVATED="VISU_NOT_ACTIVATED",Messenger.CONFIGURATION_LOAD_ERROR="CONFIGURATION_LOAD_ERROR",Messenger.START_SERVICES_SUCCESS="START_SERVICES_SUCCESS",Messenger.START_SERVICES_FAILED="START_SERVICES_FAILED",Messenger.REGISTER_CLIENT_SUCCESS="REGISTER_CLIENT_SUCCESS",Messenger.REGISTER_CLIENT_FAILED="REGISTER_CLIENT_FAILED",Messenger.SERVER_CONNECTION_START="SERVER_CONNECTION_START",Messenger.SERVER_CONNECTION_SUCCESS="SERVER_CONNECTION_SUCCESS",Messenger.SERVER_CONNECTION_ERROR="SERVER_CONNECTION_ERROR",Messenger.TEXT_LOAD_START="TEXT_LOAD_START",Messenger.TEXT_LOAD_SUCCESS="TEXT_LOAD_SUCCESS",Messenger.TEXT_LOAD_ERROR="TEXT_LOAD_ERROR",Messenger.WIDGET_LOAD_ERROR="WIDGET_LOAD_ERROR",Messenger}),define("brease/helper/SystemMessage",["brease/controller/PopUpManager"],function(e){"use strict";var SystemMessage={deferMessage:function(e,i){t=window.setTimeout(function(){SystemMessage.showMessage(e)},i)},showMessage:function(e){t&&(window.clearTimeout(t),t=void 0),a(e)},clear:function(){t&&(window.clearTimeout(t),t=void 0),n()}},t,i,s;function n(){i&&i.length>0&&i.hide().off()}function a(t){i=i||$("#systemMessageBox"),0===i.length&&(i=$('<div id="systemMessageBox" style="z-index:1;position:fixed; padding:0px;margin:0px; background-color:rgba(0,0,0,0.18); top:0; left:0;width:100%;height:100%;"><div style="position:absolute; padding:20px; width:400px; margin-left:-220px;color:red; background-color:white;font-size:20px;left:50%;top:50%;text-align:center;white-space:pre-wrap;"></div></div>').appendTo(document.body),s=i.find("div")),s.text(t),i.css("z-index",e.getHighestZindex()+1).show().on("click vclick mousedown mouseup pointerup pointerdown",function(e){e.stopImmediatePropagation(),e.preventDefault()})}return SystemMessage}),define("brease/brease",["brease/controller/objects/Client","brease/core/Utils","brease/events/BreaseEvent","brease/events/SocketEvent","brease/events/SystemGestures","brease/events/VirtualEvents","brease/controller/libs/LogCode","brease/services/libs/ServerCode","brease/helper/Scroller","brease/controller/PopUpManager","brease/controller/ZoomManager","brease/controller/FocusManager","brease/helper/Messenger","brease/helper/SystemMessage","brease/config","brease/settings"],function(Client,Utils,BreaseEvent,SocketEvent,SystemGestures,VirtualEvents,LogCode,ServerCode,Scroller,e,t,i,Messenger,s,config,n){"use strict";var a,r={},o={},l={},Brease=function Brease(){Utils.defineProperty(this,"config",config),Utils.defineProperty(this,"services",{}),this.messenger=new Messenger(s),h.call(this),g.call(this),u.call(this)},d=Brease.prototype;Utils.defineProperty(d,"callWidget",function e(){return brease.uiController.callWidget.apply(brease.uiController,arguments)}),Utils.defineProperty(d,"setOptions",function e(){brease.uiController.setOptions.apply(brease.uiController,arguments)}),Utils.defineProperty(d,"getOption",function e(){return brease.uiController.getOption.apply(brease.uiController,arguments)}),Utils.defineProperty(d,"setOptionsMapping",function e(){brease.uiController.setOptionsMapping.apply(brease.uiController,arguments)}),d.init=function(e,t,i){a=e,Client.init(e),f.call(this,t),m.call(this,i),v.call(this,e),b.call(this,e)},d.startVisu=function(e){this.messenger.announce(Messenger.START_VISU,{visuId:e}),config.visuId=e,config.contentId=void 0,this.appView.html(""),c.call(this)},d.startContent=function(e){this.messenger.announce(Messenger.START_CONTENT,{contentId:e}),config.contentId=e,config.visuId=void 0,c.call(this)},d.getClientId=function(){return Client.id},d.dispatchResize=function(e){document.body.dispatchEvent(new CustomEvent(BreaseEvent.APP_RESIZE,{detail:e}))};function c(){Scroller.init(e),a.registerClient(config.visuId,y)}function h(){Utils.defineProperty(this,"appElem",document.getElementById("appContainer")),Utils.defineProperty(this,"appView",$(this.appElem)),Utils.defineProperty(this,"bodyEl",$(document.body)),Utils.defineProperty(this,"docEl",$(document))}function u(){Utils.addClass(document.body,"system_brease_Scrollbar_style_default"),Utils.addClass(document.body,"system_brease_Body_style_default"),Utils.addClass(document.body,"system_brease_ModalDimmer_style_default")}function g(){Utils.defineProperty(this,"settings",n)}function m(e){for(var t in e)o[t]=e[t];p(this,"formatter",o),p(this,"action",o),p(this,"dialogController",o,"overlayController"),p(this,"overlayController",o),p(this,"pageController",o),p(this,"uiController",o),p(this,"keyboardManager",o),p(this,"focusManager",{focusManager:i})}function p(e,t,i,s){Object.defineProperty(e,t,{get:function(){return i[s||t]},set:function(){},enumerable:!0,configurable:!0})}function f(e){for(var t in e)r[t]=e[t];p(this,"measurementSystem",r),p(this.services,"measurementSystem",r),p(this,"language",r),p(this.services,"language",r),p(this,"user",r),p(this.services,"user",r),p(this,"culture",r),p(this.services,"culture",r),p(this,"textFormatter",r),p(this.services,"textFormatter",r),p(this,"loggerService",r),p(this.services,"logger",r,"loggerService"),p(this.services,"opcua",r)}function b(e){o.bindingController.init(e),o.connectionController.init(e,s),o.infoController.init(e),this.action.init(e),this.pageController.init(e),this.uiController.init(o.bindingController,o.widgetController)}function v(e){this.measurementSystem.init(e),this.language.init(e),this.culture.init(e),this.user.init(e),this.textFormatter.init(e),this.loggerService.init(e),r.configuration.init(e)}function y(e){void 0!==e&&void 0!==e.status&&e.status.code===ServerCode.SUCCESS?(brease.messenger.announce(Messenger.REGISTER_CLIENT_SUCCESS,{clientId:e.ClientId}),Client.setId(e.ClientId),w()):(void 0===Client.isValid&&(Client.setValid(!1),brease.messenger.announce(Messenger.REGISTER_CLIENT_FAILED,{response:e,visuId:config.visuId})),window.setTimeout(function(){a.registerClient(config.visuId,y)},1e3))}function w(){$.when(brease.language.isReady(),brease.measurementSystem.isReady(),brease.user.isReady(),brease.textFormatter.isReady()).then(function(){E()},function(e){brease.messenger.announce(Messenger.START_SERVICES_FAILED,{message:e,cookies:x()})})}function x(){try{document.cookie="testcookie=1; SameSite=Lax";var e=-1!==document.cookie.indexOf("testcookie=");return document.cookie="testcookie=1; SameSite=Lax; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}function E(){brease.culture.isReady().then(function(){brease.messenger.announce(Messenger.START_SERVICES_SUCCESS,{clientId:Client.id}),I()},function(e){brease.messenger.announce(Messenger.START_SERVICES_FAILED,{message:e})})}function I(){config.visuId?o.visuModel.loadVisuData(brease.config.visuId,brease.appElem.id).then(function(e){C(e)},function(e){brease.messenger.announce(LogCode.VISU_NOT_FOUND,{visuId:e}),C()}):C()}function C(e){$.when(r.configuration.loadConfigurations(e),_()).then(S,function(){brease.messenger.announce(Messenger.CONFIGURATION_LOAD_ERROR),S()})}function _(){var e=$.Deferred();return a.getAutoLogOut(function(t){l.autoLogOut=t.enabled,e.resolve()}),e.promise()}function S(){SystemGestures.init(),VirtualEvents.config(),o.eventController.init(a,o.bindingController),t.setBrowserZoom(),brease.config.isKeyboardOperationEnabled()&&(i.start(),document.body.classList.add("system_brease_Focus_style_default"),document.body.classList.add("system_brease_ElementFocus_style_default"),document.body.classList.add("system_brease_Selection_style_default")),T()}function T(){brease.messenger.announce(Messenger.SERVER_CONNECTION_START),a.addEventListener(SocketEvent.SESSION_ACTIVATED,D),$.when(a.socketIsReady()).then(function(){},function(){brease.messenger.announce(Messenger.SERVER_CONNECTION_ERROR)})}function D(){brease.messenger.announce(Messenger.SERVER_CONNECTION_SUCCESS),o.bindingController.startListen(),A()}function A(){brease.messenger.announce(Messenger.TEXT_LOAD_START),$.when(brease.language.loadAllTexts()).then(function(){brease.messenger.announce(Messenger.TEXT_LOAD_SUCCESS),L()},function(){brease.messenger.announce(Messenger.TEXT_LOAD_ERROR)})}function L(){brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.RESOURCES_LOADED)),$.when(P(),brease.overlayController.init()).then(function(){void 0!==config.contentId?(brease.appElem.addEventListener(BreaseEvent.CONTENT_PARSED,O),brease.uiController.parse(brease.appElem,!1)):N()})}function P(){if(void 0!==config.contentId)return Client.setValid(!0),o.bindingController.activateContent(config.contentId);var e=$.Deferred();return e.resolve(),e.promise()}function O(){brease.appElem.removeEventListener(BreaseEvent.CONTENT_PARSED,O),o.bindingController.sendInitialValues(config.contentId,N)}function N(){o.infoController.start(l.autoLogOut||config.visu.activityCount),void 0!==config.visuId&&brease.pageController.start(config.visuId,brease.appElem,config.ContentCaching),brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.APP_READY,{bubbles:!0})),a.startHeartbeat(),console.log("app ready")}var brease=new Brease;return Utils.defineProperty(window,"brease",brease),brease}),define("brease/config/NumberFormat",[],function(){"use strict";var NumberFormat=function(i,s,n){i=isNaN(i)?1:i,s=isNaN(s)?1:s,this.decimalPlaces=Math.min(t.decimalPlaces,Math.max(e.decimalPlaces,i)),this.minimumIntegerDigits=Math.max(e.minimumIntegerDigits,s),n>=e.maximumIntegerDigits&&(this.maximumIntegerDigits=parseInt(n,10))},e={decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:1},t={decimalPlaces:20};return NumberFormat.getFormat=function(i,s){var n=i.default||NumberFormat.defaults,a=i[s]||n,r,o;void 0!==a.decimalPlaces?(a.decimalPlaces<e.decimalPlaces&&console.iatWarn("decimalPlaces has to be >= "+e.decimalPlaces),a.decimalPlaces>t.decimalPlaces&&console.iatWarn("decimalPlaces has to be <= "+t.decimalPlaces),r=Math.min(t.decimalPlaces,Math.max(e.decimalPlaces,a.decimalPlaces))):r=n.decimalPlaces,void 0!==a.minimumIntegerDigits?(a.minimumIntegerDigits<e.minimumIntegerDigits&&console.iatWarn("minimumIntegerDigits has to be >= "+e.minimumIntegerDigits),o=Math.max(e.minimumIntegerDigits,a.minimumIntegerDigits)):o=n.minimumIntegerDigits;var l={decimalPlaces:r,minimumIntegerDigits:o};return a.maximumIntegerDigits>=e.maximumIntegerDigits&&(l.maximumIntegerDigits=parseInt(a.maximumIntegerDigits,10)),l},NumberFormat.defaults={decimalPlaces:1,minimumIntegerDigits:1},NumberFormat.minima={decimalPlaces:e.decimalPlaces,minimumIntegerDigits:e.minimumIntegerDigits,maximumIntegerDigits:e.maximumIntegerDigits},NumberFormat.maxima={decimalPlaces:t.decimalPlaces},NumberFormat}),define("brease/config/SortFunctions",[],function(){"use strict";return{int:function(e,t){return parseInt(e,10)-parseInt(t,10)},number:function(e,t){return parseFloat(e)-parseFloat(t)},date:function(e,t){return Date.parse(e)-Date.parse(t)},string:function(e,t){return e<t?-1:e>t?1:0},"string-ins":function(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),e<t?-1:e>t?1:0}}}),define("brease/config/Types",[],function(){"use strict"}),define("brease/controller/objects/AssignType",["brease/core/Utils"],function(Utils){"use strict";var Types={};return Utils.defineProperty(Types,"CONTENT","Content"),Utils.defineProperty(Types,"PAGE","Page"),Utils.defineProperty(Types,"VISU","Visu"),Types}),define("brease/controller/objects/ContentStatus",["brease/enum/EnumObject"],function(EnumObject){"use strict";return new EnumObject({notExistent:-3,aborted:-2.5,deactivated:-2,deactivatePending:-1,initialized:0,inQueue:.5,activatePending:1,active:2,preCached:3})}),define("brease/controller/objects/VisuStatus",["brease/core/Utils"],function(Utils){"use strict";var VisuStatus={};return Utils.defineProperty(VisuStatus,"LOADED","LOADED"),Utils.defineProperty(VisuStatus,"MALFORMED","MALFORMED"),Utils.defineProperty(VisuStatus,"NOT_FOUND","NOT_FOUND"),Utils.defineProperty(VisuStatus,"ACTIVATE_FAILED","ACTIVATE_FAILED"),VisuStatus}),define("brease/objects/Content",[],function(){"use strict";var e=function(e,i,s){this.id=e,this.visuId=i,s&&void 0!==s.path&&(this.path=s.path),s&&void 0!==s.virtual&&(this.virtual=s.virtual),this.width=s&&void 0!==s.width?parseInt(s.width,10):t.width,this.height=s&&void 0!==s.height?parseInt(s.height,10):t.height,this.configurations=s.configurations},t={width:800,height:600};return Object.defineProperty(e.prototype,"serverId",{get:function(){return this.id},enumerable:!1,configurable:!1}),e}),define("brease/objects/Page",["brease/core/Utils"],function(Utils){"use strict";return function(e,t,i,s){for(var n in s)"assignments"!==n&&(this[n]=s[n]);this.id=e,this.visuId=i,this.type=t,this.assignments=Utils.arrayToObject(s.assignments,"areaId")}}),define("brease/objects/Visualization",["brease/controller/objects/VisuStatus"],function(VisuStatus){"use strict";return function(e,t,i){this.id=e,this.startPage=t,this.status=VisuStatus.LOADED,this.containerId=i}}),define("brease/objects/Area",["brease/core/Utils"],function(Utils){"use strict";var e=function(e,s){t.call(this,"id",e),t.call(this,"width",s.width),t.call(this,"height",s.height),t.call(this,"top",s.top),t.call(this,"left",s.left),i.call(this,"zIndex",s.zIndex),i.call(this,"tabIndex",s.tabIndex),i.call(this,"cssWidth",s.cssWidth),i.call(this,"cssHeight",s.cssHeight)};e.prototype.updateSize=function(e){e=e||{};var s={width:void 0!==e.width?e.width:this.width,height:void 0!==e.height?e.height:this.height,cssWidth:void 0!==e.cssWidth?e.cssWidth:this.cssWidth,cssHeight:void 0!==e.cssHeight?e.cssHeight:this.cssHeight};t.call(this,"width",s.width),t.call(this,"height",s.height),i.call(this,"cssWidth",s.cssWidth),i.call(this,"cssHeight",s.cssHeight)},e.prototype.hasPercentageWidth=function(){return Utils.isPercentageValue(this.cssWidth)},e.prototype.hasPercentageHeight=function(){return Utils.isPercentageValue(this.cssHeight)},Object.defineProperty(e.prototype,"styleWidth",{get:function(){return Utils.isPercentageValue(this.cssWidth)?this.cssWidth:this.width+"px"}}),Object.defineProperty(e.prototype,"styleHeight",{get:function(){return Utils.isPercentageValue(this.cssHeight)?this.cssHeight:this.height+"px"}});function t(e,t){if(void 0===t)throw new SyntaxError(e+" is required");this[e]=t}function i(e,t){void 0!==t&&(this[e]=t)}return e}),define("brease/objects/Layout",["brease/objects/Area"],function(e){"use strict";return function(t,i,s,n){this.id=t,this.width=i,this.height=s,this.areas={};for(var a in n)this.areas[a]=new e(a,n[a])}}),define("brease/objects/Navigation",["brease/controller/libs/LogCode"],function(LogCode){"use strict";var e=function(e,t,i){this.id=e,this.pages={},this.swipes={},n(this,t,i)};e.prototype.addPage=function(e,i,s,n){void 0===this.pages[s]&&(this.pages[s]=new a(s,t(e,n.pages),i.displayName,i.image))};function t(e,t){var s=e&&e.targets?e.targets:[];return s=s.filter(function(e){return i(e,t)}),s}function i(e,t){return t&&void 0!==t[e]}function s(e,t,i,s){void 0===t.pages[e]&&t.addPage(i.pages[e],s.pages[e],e,s)}function n(e,t,n){var a=t.navigations[e.id];for(var r in a.pages)if(i(r,t.pages)){e.addPage(a.pages[r],t.pages[r],r,t);var o=a.pages[r].targets;if(o)for(var l=0;l<o.length;l+=1){var d=o[l];i(d,t.pages)?(s(d,e,a,t),e.pages[d].addSource(r)):n.log(LogCode.PAGE_NOT_FOUND,{pageId:d,isStartPage:t&&t.startPage===d})}e.swipes[r]=a.pages[r].swipe}else n.log(LogCode.PAGE_NOT_FOUND,{pageId:r,isStartPage:t&&t.startPage===r})}function a(e,t,i,s){this.id=e,void 0!==s&&(this.image=s),void 0!==i&&(this.displayName=i),this.targets=t,this.reachableFrom=[]}return a.prototype.addSource=function(e){this.reachableFrom.push(e)},e}),define("brease/model/VisuModel",["brease/events/BreaseEvent","brease/events/SocketEvent","brease/core/Utils","brease/controller/objects/PageType","brease/controller/objects/AssignType","brease/controller/objects/ContentStatus","brease/controller/objects/VisuStatus","brease/controller/libs/LogCode","brease/objects/Content","brease/objects/Page","brease/objects/Visualization","brease/objects/Area","brease/objects/Layout","brease/objects/Navigation","brease/services/LoadedByBootstrapper"],function(BreaseEvent,SocketEvent,Utils,PageType,AssignType,ContentStatus,VisuStatus,LogCode,e,t,i,s,n,a,r){"use strict";var o={VISU_ACTIVATION_TIMEOUT:3e4,init:function(e,t){return t&&(l=t),e&&(d=e,d.addEventListener(SocketEvent.VISU_ACTIVATED,I),d.addEventListener(SocketEvent.VISU_DEACTIVATED,_)),u(),h.reset(),this},activateVisu:function(e,t){e=Utils.ensureVisuId(e),t.visuId&&(t.visuId=Utils.ensureVisuId(t.visuId));var i=c.visus[e],s=$.Deferred();return void 0===i||i.status!==VisuStatus.LOADED?s.reject(void 0!==i?i.status:VisuStatus.NOT_FOUND,void 0,t):!0===i.pending?s.reject(void 0!==i?i.status:VisuStatus.NOT_FOUND,void 0,t):!0===i.active?s.resolve(t):(i.activateDeferred=s,i.callbackInfo=t,i.pending=!0,h.push(e),i.timeout=window.setTimeout(x.bind(null,i),o.VISU_ACTIVATION_TIMEOUT),d.activateVisu(e,w,t)),s.promise()},deactivateVisu:function(e){e=Utils.ensureVisuId(e);var t=c.visus[e];t&&t.active&&(d.deactivateVisu(e),t.active=!1,t.containerId=void 0)},loadVisuData:function(e,t){var i=$.Deferred();if(e=Utils.ensureVisuId(e),void 0===e)l.log(LogCode.VISU_NOT_FOUND,{visuId:e,container:brease.appElem}),i.reject(e);else{var s=r.get("visu"),n={visuId:e,deferred:i,isRoot:!0,rootContainerId:t};s&&s.id===e?f({success:!0,visuData:s},n):d.loadVisuData(e,f,n)}return i.promise()},getVisuByStartpage:function(e){var t;for(var i in c.visus)if(c.visus[i].startPage===e){t=c.visus[i];break}return t},getDialogById:function(e){return c.dialogs[e]},getPageById:function(e){return c.pages[e]},getNavById:function(e){return c.navigations[e]},getVisuById:function(e){return c.visus[Utils.ensureVisuId(e)]},getContentById:function(e){return c.contents[e]},getLayoutById:function(e){return c.layouts[e]},isValidContent:function(e){return void 0!==c.contents[e]},getThemes:function(){return c.themes},pageHasArea:function(e,t){var i=!1,s=this.getLayoutById(t.layout);return s&&s.areas&&(i=void 0!==s.areas[e]),i},findAssignment:function(e,t){return e.assignments[t]},findNav4page:function(e){var t;for(var i in c.navigations)if(void 0!==c.navigations[i].pages[e]){t=c.navigations[i];break}return t},parseVisuData:function(e,t){return y(e,t)},allActivated:function(){for(var e=!1,t,i=0;i<h.length();i+=1)if(t=c.visus[h.get(i)],e=void 0!==t&&void 0!==t.active,!1===e)return!1;return h.reset(),!0},addContent:function(e,t){void 0===c.contents[e]&&(t.id||(t.id=e),c.contents[e]=t)},addPage:function(e,t){void 0===c.pages[e]&&(c.pages[e]=t)},removePage:function(e){void 0!==c.pages[e]&&(c.pages[e]=void 0)},addDialog:function(e,i){void 0===c.dialogs[e]&&(c.dialogs[e]=new t(e,PageType.DIALOG,i.visuId,i))},removeDialog:function(e){void 0!==c.dialogs[e]&&(c.dialogs[e]=void 0)},addLayout:function(e,t){void 0===c.layouts[e]&&(c.layouts[e]=t)},removeLayout:function(e){void 0!==c.layouts[e]&&(c.layouts[e]=void 0)},addArea:function(e,t){var i=c.layouts[e];void 0===i.areas[t.id]&&(i.areas[t.id]=new s(t.id,t))},addAssignment:function(e,t,i){var s=c.pages[t];void 0===s.assignments[e]&&(s.assignments[e]=i)},getVisuData:function(){return c},allContents:function(){return c.contents},getContentsOfPage:function(e,t){return S(e,t)},deactivateEmbeddedVisusWithoutActiveContent:function(){if(g()){var e=c.contents,t=new Set;for(var i in e){var s=e[i];s.state>ContentStatus.initialized&&t.add(s.visuId)}for(var n in c.visus)n===c.startVisuId||t.has(n)||o.deactivateVisu(n)}},deactivateEmbeddedVisus:function(){if(g())for(var e in c.visus)e!==c.startVisuId&&o.deactivateVisu(e)}};Object.defineProperty(o,"startPageId",{get:function(){return c.startPageId},enumerable:!0,configurable:!1}),Object.defineProperty(o,"startThemeId",{get:function(){return c.startThemeId},enumerable:!0,configurable:!1}),Object.defineProperty(o,"startVisuId",{get:function(){return c.startVisuId},enumerable:!0,configurable:!1});var l,d,c,h={stack:[],reset:function(){this.stack.length=0},length:function(){return this.stack.length},get:function(e){return this.stack[e]},push:function(e){this.stack.push(e)}};function u(e,t){c={pages:{},dialogs:{},layouts:{},contents:{},navigations:{},visus:{},themes:[]},e&&(c.startPageId=e.startPage,c.startVisuId=t,c.startThemeId=e.startTheme,c.configurations=e.configurations),brease.config&&brease.config.mocked&&(window._visuModel=c)}function g(){return Object.keys(c.visus).length>1}function m(e){var t;for(var i in e.assignments){var s=e.assignments[i];if(s.type===AssignType.VISU&&void 0===c.visus[s.contentId]){t=s.contentId=Utils.ensureVisuId(s.contentId);break}}return t}function p(){var e;for(var t in c.pages)if(e=m(c.pages[t]),e)break;if(void 0===e)for(var i in c.dialogs)if(e=m(c.dialogs[i]),e)break;return e}function f(e,t){!0===e.success&&e.visuData?(Utils.isObject(e.visuData.layouts)&&0!==Object.keys(e.visuData.layouts).length||l.log(LogCode.NO_LAYOUTS_FOUND,{visuId:t.visuId}),Utils.isObject(e.visuData.pages)&&0!==Object.keys(e.visuData.pages).length||l.log(LogCode.NO_PAGES_FOUND,{visuId:t.visuId}),!0===t.isRoot?(u(e.visuData,t.visuId),c.visus[t.visuId]=new i(t.visuId,e.visuData.startPage,t.rootContainerId),b(e.visuData,t.visuId,!0)):(c.visus[t.visuId]=new i(t.visuId,e.visuData.startPage),b(e.visuData,t.visuId))):c.visus[t.visuId]={status:"parsererror"===e.status?VisuStatus.MALFORMED:VisuStatus.NOT_FOUND};var s=p();void 0!==s?d.loadVisuData(s,f,{visuId:s,deferred:t.deferred,isRoot:!1}):t.deferred.resolve(c.configurations)}function b(e,t){v(e.themes),e=y(e,t),$.extend(!0,c,e)}function v(e){if(Array.isArray(e))for(var t=0;t<e.length;t+=1)-1===c.themes.indexOf(e[t])&&c.themes.push(e[t])}function y(i,s){var r={pages:{},dialogs:{},layouts:{},contents:{},navigations:{}};for(var o in i.pages){var d=i.pages[o];r.pages[o]=new t(o,PageType.PAGE,s,d)}for(var c in i.dialogs){var h=i.dialogs[c];r.dialogs[c]=new t(c,PageType.DIALOG,s,h)}for(var u in i.layouts){var g=i.layouts[u];r.layouts[u]=new n(u,g.width,g.height,g.areas)}for(var m in i.contents){var p=i.contents[m];r.contents[m]=new e(m,s,{path:p.path,width:p.width,height:p.height,configurations:p.configurations})}for(var f in i.navigations)r.navigations[f]=new a(f,i,l);return r}function w(e,t){var i=c.visus[t.visuId];if(i){var s=void 0!==e&&void 0!==e.status?e.status.code:void 0;0!==s?x(i,s):(i.callResponse=!0,C(i))}}function x(e,t){t=t||-1,e.activateDeferred.reject(VisuStatus.ACTIVATE_FAILED,t,e.callbackInfo),brease.messenger.announce("VISU_NOT_ACTIVATED",{visuId:e.id}),E(e)}function E(e){window.clearTimeout(e.timeout),delete e.timeout,delete e.callbackInfo,delete e.callResponse,delete e.eventResponse,delete e.activateDeferred,delete e.pending}function I(e){var t=e.detail.visuId,i=c.visus[t];i&&(i.eventResponse=!0,C(i))}function C(e){if(!0===e.callResponse&&!0===e.eventResponse){var t=e.activateDeferred,i=e.callbackInfo;E(e),e.active=!0,document.body.dispatchEvent(new CustomEvent(BreaseEvent.VISU_ACTIVATED,{detail:{visuId:e.id}})),t&&t.resolve(i)}}function _(e){var t=e.detail.visuId;c.visus[t]&&document.body.dispatchEvent(new CustomEvent(BreaseEvent.VISU_DEACTIVATED,{detail:{visuId:t}}))}function S(e,t){var i=[],s=t===PageType.DIALOG?o.getDialogById(e):o.getPageById(e);if(s)for(var n in s.assignments){var a=s.assignments[n];switch(a.type){case AssignType.CONTENT:o.isValidContent(a.contentId)&&i.push(a.contentId);break;case AssignType.PAGE:i.push.apply(i,S(a.contentId));break;case AssignType.VISU:var r=a.contentId,l=o.getVisuById(r);l&&l.status===VisuStatus.LOADED&&i.push.apply(i,S(l.startPage));break}}return i}return o.init()}),define("brease/controller/ContentManager",["brease/events/BreaseEvent","brease/events/SocketEvent","brease/model/VisuModel","brease/objects/Content","brease/controller/objects/ContentStatus"],function(BreaseEvent,SocketEvent,e,t,ContentStatus){"use strict";var i={init:function(e){s&&(s.removeEventListener(SocketEvent.CONTENT_ACTIVATED,n,!0),s.removeEventListener(SocketEvent.CONTENT_DEACTIVATED,a,!0)),s=e,e.addEventListener(SocketEvent.CONTENT_ACTIVATED,n,!0),e.addEventListener(SocketEvent.CONTENT_DEACTIVATED,a,!0)},getContent:function(e){return r(e)},setBindingLoadState:function(e,t){r(e).bindingsLoaded=t},isBindingLoaded:function(e){var t=r(e);return void 0!==t&&!0===t.bindingsLoaded},setActiveState:function(e,t){var i=r(e);i&&(i.state=t)},getActiveState:function(e){return r(e)?r(e).state:ContentStatus.notExistent},isContentActive:function(e){var t=r(e);return void 0!==t&&t.state===ContentStatus.active},allActive:function(e){for(var t=!0,i=0;i<e.length;i+=1)t=t&&this.isContentActive(e[i]);return t},setLatestRequest:function(e,t){var i=r(e);return i&&("activate"===t&&(i.count+=1),i.latestRequest=e+"["+i.count+"]"+t),i},getLatestRequest:function(e){return r(e)?r(e).latestRequest:void 0},setActivateDeferred:function(e,t){var i=r(e);i&&i.state===ContentStatus.active?t.resolve(i.id):i.activateDeferred=t},setDeactivateDeferred:function(e,t){var i=r(e);i&&i.state===ContentStatus.deactivated?t.resolve(i.id):i.deactivateDeferred=t},addVirtualContent:function(i,s){if(void 0===r(i)){var n=new t(i,s,{virtual:!0});o(n),e.addContent(i,n)}},getContents:function(t){var i=[],s=e.allContents();for(var n in s)Array.isArray(t)?-1===t.indexOf(s[n].state)||s[n].virtual||i.push(n):i.push(n);return i},getPendingContents:function(){return i.getContents([ContentStatus.activatePending,ContentStatus.deactivatePending])},isPending:function(e){var t=r(e);return void 0!==t&&(t.state===ContentStatus.activatePending||t.state===ContentStatus.deactivatePending||t.state===ContentStatus.inQueue)},setArea:function(e,t){var i=r(e);i&&(i.areaId=t)}},s;function n(e){var t=r(e.detail.contentId);t&&t.state>ContentStatus.initialized&&(i.setActiveState(e.detail.contentId,ContentStatus.active),void 0!==t.activateDeferred&&(t.activateDeferred.resolve(t.id),t.activateDeferred=void 0),document.body.dispatchEvent(new CustomEvent(BreaseEvent.INITIAL_VALUE_CHANGE_FINISHED,{detail:{contentId:t.id}})),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_ACTIVATED,{detail:{contentId:t.id}})))}function a(e){var t=r(e.detail.contentId);t&&t.state<ContentStatus.initialized&&(i.setActiveState(e.detail.contentId,ContentStatus.deactivated),void 0!==t.deactivateDeferred&&(t.deactivateDeferred.resolve(t.id),t.deactivateDeferred=void 0),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_DEACTIVATED,{detail:{contentId:t.id}})))}function r(t){var i=e.getContentById(t);return void 0!==i&&void 0===i.state&&o(i),i}function o(e){e.state=ContentStatus.initialized,e.count=0}return i}),define("brease/controller/libs/ContentHelper",["brease/controller/ContentManager","brease/controller/objects/ContentStatus","brease/controller/objects/PageType","brease/model/VisuModel","brease/controller/libs/Utils","brease/events/BreaseEvent","brease/events/ClientSystemEvent"],function(e,ContentStatus,PageType,t,Utils,BreaseEvent,ClientSystemEvent){"use strict";var i=new Map,s=0,ContentHelper={activateFinished:function(t){var i=$.Deferred(),s=t.filter(function(t){var i=e.getActiveState(t);return i<ContentStatus.active&&i!==ContentStatus.aborted});return 0===s.length?i.resolve(!0):r(i,s,"activate"),i},deactivateFinished:function(t){var i=$.Deferred(),s=t.filter(function(t){return e.getActiveState(t)>ContentStatus.deactivated});return 0===s.length?i.resolve(!0):r(i,s,"deactivate"),i},abort:function(e){i.forEach(function(t,i){t.def===e&&(window.clearTimeout(t.timeout),o(t.def,!0,i,t.eventTypes,t.listener))},this)},loadFinished:function(e){var t=$.Deferred();if(brease.pageController.getCurrentPage(brease.appElem.id)!==e||brease.pageController.isCycleActive()){var i=window.setTimeout(function(){t.resolve(!1)},ContentHelper.TIMEOUT.loaded);brease.pageController.addCycleFinishedListener(a,{def:t,timeout:i})}else t.resolve(!0);return t.promise()},contentsInDialog:function(e){var t=$('[data-brease-dialogid="'+e+'"]'),i=Utils.findLoaders(t[0]),s=[];return i.forEach(function(e){var t=brease.callWidget(e.id,"getContentId");t&&s.push(t)}),s},activeContentsInDialog:function(t){var i=$('[data-brease-dialogid="'+t+'"]'),s=Utils.findLoaders(i[0]),n=[];return s.forEach(function(t){var i=brease.callWidget(t.id,"getContentId");e.getActiveState(i)===ContentStatus.active&&n.push(i)}),n},extractActive:function(t){return t.filter(function(t){return e.getActiveState(t)===ContentStatus.active})},extractNotActive:function(t){return t.filter(function(t){return e.getActiveState(t)<ContentStatus.active})},contentsToLoadInDialog:function(e){return t.getContentsOfPage(e,PageType.DIALOG)},contentAction:function(e,t){var i={"widgets.brease.ContentControl":["LoadContent","UnloadContent"]};return n(e)&&-1!==i["widgets.brease.ContentControl"].indexOf(t)?"widgets.brease.ContentControl."+t:void 0},contentFinishedStateChange:function(e,t){var i=this,s=$.Deferred(),n;switch(e){case"widgets.brease.ContentControl.LoadContent":t&&Array.isArray(t.activate)&&t.activate.length>0?(n=t.activate[0],$.when(i.activateFinished([n])).then(function(e){s.resolve(e)})):s.resolve(!0);break;case"widgets.brease.ContentControl.UnloadContent":t&&Array.isArray(t.deactivate)&&t.deactivate.length>0?(n=t.deactivate[0],$.when(i.deactivateFinished([n])).then(function(e){s.resolve(e)})):s.resolve(!0);break}return s.promise()},TIMEOUT:{deactivate:5e3,activate:16e3,loaded:3e4}};function n(e){
var t="widgets.brease.ContentControl",i=e.meta&&Array.isArray(e.meta.inheritance)?e.meta.inheritance:[];return(e.defaults&&void 0!==e.defaults.className?e.defaults.className.replace(/\//g,"."):"")===t||-1!==i.indexOf(t)}function a(e){window.clearTimeout(e.data.timeout),brease.pageController.removeCycleFinishedListener(a),e.data.def.resolve(!0)}function r(e,t,n){s+=1;var a="activate"===n?[ClientSystemEvent.CONTENT_LOADED,BreaseEvent.CONTENT_ACTIVATE_ERROR]:[BreaseEvent.CONTENT_DEACTIVATED],r=l.bind(null,s),d=window.setTimeout(o,ContentHelper.TIMEOUT[n],e,!1,s,a,r),c={listener:r,def:e,arContent:t,timeout:d,eventTypes:a};i.set(s,c),a.forEach(function(e){brease.bodyEl.on(e,r)})}function o(e,t,n,a,r){a.forEach(function(e){brease.bodyEl.off(e,r)}),i.delete(n),0===i.size&&(s=0),e.resolve(t)}function l(e,t){var s=i.get(e),n=s.arContent.indexOf(t.detail.contentId);-1!==n&&(s.arContent.splice(n,1),0===s.arContent.length&&(window.clearTimeout(s.timeout),o(s.def,!0,e,s.eventTypes,s.listener)))}return ContentHelper}),define("brease/core/Decorator",[],function(){"use strict";var Decorator=function Decorator(){};Decorator.TYPE_PRE="pre",Decorator.TYPE_POST="post",Decorator.createDecorator=function(e){var t=function(){};return t.prototype=new Decorator,t.prototype.constructor=t,t.prototype.initType=e===Decorator.TYPE_PRE?Decorator.TYPE_PRE:Decorator.TYPE_POST,t},Decorator.prototype.decorate=function(i,s,n){if(n)for(var a in n)i.static[a]=$.extend({},i.static[a],n[a]);var r;for(r in this.methodsToAdd)void 0!==i.prototype[r]?t(i,this.methodsToAdd,r,s,this.initType):"init"===r?e(i,this.methodsToAdd,r,s):i.prototype[r]=this.methodsToAdd[r];for(r in this.addIfNotDefined)void 0===i.prototype[r]&&(i.prototype[r]=this.addIfNotDefined[r]);return i};function e(e,t,i,s){e.prototype[i]=function(){t[i].call(this,s)}}function t(e,t,i,s,n){var a=e.prototype[i];e.prototype[i]=function(){"init"===i?(n===Decorator.TYPE_PRE&&t[i].call(this,s),a.apply(this,arguments),n!==Decorator.TYPE_PRE&&t[i].call(this,s)):(t[i].apply(this,arguments),a.apply(this,arguments))}}return Decorator}),define("brease/decorators/TooltipDependency",["brease/core/Decorator","brease/core/Utils","brease/events/BreaseEvent","brease/enum/Enum","brease/controller/PopUpManager","brease/controller/ZoomManager"],function(Decorator,Utils,BreaseEvent,Enum,PopUpManager,ZoomManager){"use strict";var TooltipDependency=function TooltipDependency(){this.initType=Decorator.TYPE_PRE},e="tooltip",t="language",i="tooltipChangeHandler",s=!1;TooltipDependency.prototype=new Decorator,TooltipDependency.prototype.constructor=TooltipDependency;var n=new TooltipDependency;n.isActivated=function(){return s},n.methodsToAdd={init:function(i){this.dependencies[e]={state:Enum.Dependency.INACTIVE,stored:{tooltipModeActive:!1},suspend:a.bind(this),wake:r.bind(this),event:t},this.tooltip={indicatorAttached:!1,contentAttached:!1},!0===i&&this.setTooltipDependency(i),this.dependencies[e].stored.tooltipModeActive&&this.activateTooltipMode()},tooltipChangeHandler:function(){c.call(this)&&this.tooltip.contentAttached&&(C.call(this,I(this.settings.tooltip)),_.call(this))},setTooltip:function(e){this.settings.tooltip=e},getTooltip:function(){return this.settings.tooltip},showTooltip:function(){this.activateTooltipMode()},activateTooltipMode:function(t){c.call(this)&&!1===this.isHidden&&(v.call(this),y.call(this),this.dependencies[e]&&(this.dependencies[e].stored.tooltipModeActive||(this.dependencies[e].stored.tooltipModeActive=!0,!1===s&&!0!==t&&(s=!0,document.body.dispatchEvent(new CustomEvent(BreaseEvent.TOOLTIPMODE_ACTIVE))))))},deactivateTooltipMode:function(t){x.call(this),S.call(this),this.dependencies[e]&&this.dependencies[e].stored.tooltipModeActive&&(this.dependencies[e].stored.tooltipModeActive=!1,!0===s&&!0!==t&&(s=!1,document.body.dispatchEvent(new CustomEvent(BreaseEvent.TOOLTIPMODE_INACTIVE)))),$(window).off("resize",this._bind("deactivateTooltipMode")).off("mousewheel",this._bind("deactivateTooltipMode"))},setTooltipDependency:function(e){!0===e?o.call(this,Enum.Dependency.ACTIVE):o.call(this,Enum.Dependency.INACTIVE)},_visibleHandler:function(){this.elem&&(this.isHidden&&this.dependencies[e].stored.tooltipModeActive&&this.deactivateTooltipMode(!0),this.isHidden||this.dependencies[e].stored.tooltipModeActive||!s||this.activateTooltipMode(!0))},dispose:function(){this.dependencies[e]=null,d.call(this),brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,this._bind(f)),this.deactivateTooltipMode(),this.tooltip={}}};function a(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored.code=brease.language.getCurrentLanguage(),this.dependencies[e].stored.version=brease.language.getCurrentVersion(),o.call(this,Enum.Dependency.SUSPENDED))}function r(t){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(o.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored.code===brease.language.getCurrentLanguage()&&this.dependencies[e].stored.version===brease.language.getCurrentVersion()||this[i](t))}function o(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?l.call(this):(d.call(this),this.deactivateTooltipMode()))}function l(){document.body.addEventListener(BreaseEvent.LANGUAGE_CHANGED,this._bind(i))}function d(){document.body.removeEventListener(BreaseEvent.LANGUAGE_CHANGED,this._bind(i))}function c(){return this.settings.tooltip&&this.settings.tooltip.length>0&&this.settings.parentContentId&&this.settings.parentContentId!==brease.settings.globalContent}function h(){this.tooltip.indicator=$('<div class="breaseTooltipIndicator system_brease_Tooltip_style_default" data-source="'+this.elem.id+'" style="box-sizing:border-box;width:auto; height:auto; position:absolute !important; z-index:1;"></div>'),this.tooltip.indicatorInner=$('<div class="breaseTooltipIndicatorInner"></div>'),this.tooltip.indicator.append(this.tooltip.indicatorInner)}function u(){this.tooltip.contentWrapper=$('<div class="breaseTooltipWrapper system_brease_Tooltip_style_default" data-source="'+this.elem.id+'" style="max-width:'+brease.appView.get(0).offsetWidth/ZoomManager.getAppZoom()+'px;"></div>'),this.tooltip.content=$('<div class="breaseTooltip"></div>'),this.tooltip.contentText=$('<div class="breaseTooltipText"></div>'),this.tooltip.contentArrow=$('<div class="tooltip-arrow"><div class="tooltip-arrow-border"></div><div class="tooltip-arrow-background"></div></div>'),this.tooltip.contentWrapper.append(this.tooltip.content),this.tooltip.contentWrapper.append(this.tooltip.contentArrow),this.tooltip.content.append(this.tooltip.contentText)}function g(){var e=this;brease.bodyEl.on(BreaseEvent.MOUSE_DOWN,this._bind(f)),this.tooltip.indicator.on(BreaseEvent.CLICK,this._bind(E)),this.tooltip.indicator.on(BreaseEvent.MOUSE_DOWN,function(t){e._handleEvent(t,!0)}),$(window).on("resize",this._bind("deactivateTooltipMode")).on("mousewheel",this._bind("deactivateTooltipMode"))}function m(e){return e.closest(".breaseTooltipWrapper").length>0}function p(e){return e.hasClass("tooltipindicator")}function f(e){var t=$(e.target);p(t)||m(t)||(brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,this._bind(f)),this.deactivateTooltipMode())}function b(){brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,this._bind(f)),this.tooltip.indicator.off()}function v(){this.tooltip.indicatorAttached||(h.call(this),g.call(this),this.tooltip.indicatorAttached=!0),this.tooltip.contentAttached||(u.call(this),C.apply(this,[I(this.settings.tooltip)]))}function y(){var e,t,i=Utils.getMatrix(this.elem),s=T(this.el,this.elem,i),n=Utils.getPositionedParent(this.elem),a=this.elem.getBoundingClientRect(),r=n.getBoundingClientRect(),o=a.left-r.left,l=a.top-r.top,d={w:this.el.outerWidth()||a.width/s,left:o/s,top:l/s};this.el.parent().append(this.tooltip.indicator),e=this.tooltip.indicator.get(0).getBoundingClientRect(),t=this.tooltip.indicatorInner.get(0).getBoundingClientRect();var c=(e.width-t.width)/2/s,h=(e.height-t.height)/2/s;this.tooltip.indicator.css({transform:"matrix("+i.join(",")+")","z-index":parseInt(this.el.css("z-index"),10)+1,top:0,left:0}),e=this.tooltip.indicator.get(0).getBoundingClientRect(),t=this.tooltip.indicatorInner.get(0).getBoundingClientRect();var u={};if(w(i)){this.tooltip.indicatorClone||(this.tooltip.indicatorClone=$('<div class="breaseTooltipIndicator system_brease_Tooltip_style_default" style="box-sizing:border-box;width:auto; height:auto;position:absolute; visibility:hidden;" ></div>'),this.tooltip.indicatorClone.css({right:"-"+c+"px",top:"-"+h+"px"}),this.el.append(this.tooltip.indicatorClone));var g=this.tooltip.indicatorClone.get(0).getBoundingClientRect();u.left=(g.left-e.left)/s,u.top=(g.top-e.top)/s}else u.top=d.top-this.tooltip.indicatorInner.get(0).offsetTop,u.left=d.left+d.w-this.tooltip.indicator.outerWidth()+this.tooltip.indicatorInner.get(0).offsetLeft;this.tooltip.indicator.css(u)}function w(e){return e.length>0&&1!==Number(e[0])}function x(){this.tooltip.indicatorAttached&&(b.call(this),this.tooltip.indicator.remove(),this.tooltip.indicatorClone&&(this.tooltip.indicatorClone.remove(),this.tooltip.indicatorClone=void 0),this.tooltip.indicatorAttached=!1)}function E(e){c.call(this)&&!this.isHidden&&(e&&this._handleEvent(e,!0),this.tooltip.contentAttached?"hidden"===this.tooltip.contentWrapper.css("visibility")?this.tooltip.contentWrapper.css("visibility","visible"):this.tooltip.contentWrapper.css("visibility","hidden"):this.tooltip.contentAttached=!0,"hidden"!==this.tooltip.contentWrapper.css("visibility")&&_.call(this))}function I(e){return brease.language.isKey(e)?brease.language.getTextByKey(brease.language.parseKey(e)):e}function C(e){null!==e.match(/(\r\n|\n|\r)/gm)&&this.tooltip.contentText.css("white-space","pre"),this.tooltip.contentText.text(e)}function _(){var e=ZoomManager.getAppZoom();this.tooltip.contentWrapper.css({transform:"scale("+e+","+e+")","transform-origin":"0 0"}),brease.bodyEl.append(this.tooltip.contentWrapper);var t=!1,i=this.tooltip.contentWrapper.offset();0===i.left&&0===i.top&&(t=!0);var s=this.tooltip.indicatorInner.offset(),n=this.tooltip.indicatorInner.get(0).getBoundingClientRect(),a=this.tooltip.contentArrow.get(0).getBoundingClientRect(),r=this.tooltip.content.get(0).getBoundingClientRect(),o=s.left+n.width/2,l=r.height+a.height,d=window.scrollY,c={top:0,left:0},h=parseFloat(this.tooltip.content.css("border-radius"));h=Math.min(h,20);var u=h/2,g={borderRadius:h+"px"};this.tooltip.content.css(g),c.left=o-r.width/2,o-r.width/2<=0?c.left=0-u/2:o+r.width/2>=brease.appView.get(0).getBoundingClientRect().width&&(c.left=brease.appView.get(0).getBoundingClientRect().width-r.width),c.top=n.top-l+d,n.top-l<=0&&(this.tooltip.contentArrow.addClass("ontop"),c.top=n.top+n.height+a.height+d);var m={"min-width":r.width/e+"px","max-width":brease.appView.get(0).offsetWidth/e+"px","z-index":PopUpManager.getHighestZindex()+1,top:c.top+"px",left:c.left+"px"};this.tooltip.contentWrapper.css(m);var p={left:0};l=this.tooltip.content.get(0).getBoundingClientRect().height+a.height,t&&(n.top-l<=0&&this.tooltip.contentArrow.addClass("ontop"),p.left=this.tooltip.contentArrow.offset().left+(o-this.tooltip.contentWrapper.offset().left)/e,this.tooltip.contentArrow.offset(p))}function S(){this.tooltip.contentAttached&&(this.tooltip.contentWrapper.remove(),this.tooltip.contentWrapper=void 0,this.tooltip.content=void 0,this.tooltip.contentText=void 0,this.tooltip.contentArrow=void 0,this.tooltip.contentAttached=!1)}function T(e,t,i){var s=1,n=e.outerWidth();if(n>0){var a=t.getBoundingClientRect();if(i.length>0){var r=Math.abs(Number(i[0])),o=Math.abs(Number(i[2]));s=0===o?a.width/n:1===o?a.height/n:a.width/(n*r+e.outerHeight()*o)}else s=a.width/n}return Math.abs(s)}return n}),define("brease/controller/libs/ScrollManager",["brease/helper/Scroller","brease/enum/Enum","libs/iscroll-probe"],function(Scroller,Enum,e){"use strict";var ScrollManager={ADD_TIMEOUT:50,REFRESH_TIMEOUT:50,FAIL_TIMEOUT:1e3,init:function(e,t,i,n){s=e,t>0&&(this.FAIL_TIMEOUT=t),i>0&&(this.ADD_TIMEOUT=i),n>0&&(this.REFRESH_TIMEOUT=n)},refresh:function(e){var t=d(e);if(t){t.refreshTimer&&window.clearTimeout(t.refreshTimer);var i=document.getElementById(e);i?i.firstChild&&h(i.firstChild)&&i.firstChild.scrollHeight>0?c(e,i.firstChild):t.refreshTimer=window.setTimeout(ScrollManager.refresh.bind(ScrollManager,e),this.REFRESH_TIMEOUT):o(e)}},remove:function(e){var t=d(e);t&&(t.addTimer&&window.clearTimeout(t.addTimer),t.refreshTimer&&window.clearTimeout(t.refreshTimer),void 0!==t.scroller&&(t.scroller.destroy(),t.scroller=void 0),o(e))},add:function(e){if(!1===ScrollManager.isSuitable(e))console.iatWarn("element not suitable for adding a Scroller!");else if(!0===this.hasScroller(e))console.iatWarn("element has already a Scroller!");else{var t=l(e.id);t.addTimer&&window.clearTimeout(t.addTimer),n(e)?a(e):Date.now()-t.startTime<this.FAIL_TIMEOUT?t.addTimer=window.setTimeout(this.add.bind(this,e),this.ADD_TIMEOUT):r(e)}},hasScroller:function(e){return void 0!==i[e.id]&&void 0!==i[e.id].scroller},getScroller:function(e){return e&&e.id&&i[e.id]?i[e.id].scroller:void 0},scrollTo:function(e,t,s){i[e]&&i[e].scroller&&i[e].scroller.scrollTo(t,s)},scrollToContent:function(t,s,n,a){i[t]&&i[t].scroller&&i[t].scroller.scrollTo(s,n,a,e.utils.ease.quadratic)},getScrollPosition:function(e){return ScrollManager.hasScroller(e)?i[e.id].scroller.getComputedPosition():(console.iatWarn("getScrollPosition: area has no scroller"),void 0)},isSuitable:function(e){return e instanceof HTMLElement&&void 0!==e.id&&""!==e.id&&e.firstChild instanceof HTMLElement},scrollContent:function(e,i,s){var n=$.Deferred(),a=$('[data-brease-contentid="'+e+'"]');if(1===a.length&&Enum.ScrollPosition.hasMember(i)){t(a.closest("[data-brease-areaid]"),i,a,s),n.resolve(!0)}else 0===a.length?(console.iatWarn("Content Id "+e+" is not defined!"),n.resolve(!1)):Enum.ScrollPosition.hasMember(i)||(console.iatWarn("Position value "+i+" is not allowed!"),n.resolve(!1));return n.promise()}};function t(e,t,i,s){s=void 0===s||isNaN(s)?0:parseInt(s,10);var n=e[0],a=ScrollManager.getScrollPosition(n),r=e.height()-i.height(),o=e.width()-i.width(),l,d;Enum.ScrollPosition.TOP===t||Enum.ScrollPosition.BOTTOM===t?(l=a.x,Enum.ScrollPosition.TOP===t?d=0:Enum.ScrollPosition.BOTTOM===t&&(d=r)):Enum.ScrollPosition.LEFT!==t&&Enum.ScrollPosition.RIGHT!==t||(d=a.y,Enum.ScrollPosition.LEFT===t?l=0:Enum.ScrollPosition.RIGHT===t&&(l=o)),ScrollManager.scrollToContent(n.id,l,d,s)}var i={},s=Scroller;function n(e){return e.scrollHeight>0&&e.firstChild.scrollHeight>0}function a(e){i[e.id].scroller=s.addScrollbars(e,{mouseWheel:!0,tap:!0,scrollX:!0,scrollY:!0},!0),i[e.id].addTimer=void 0}function r(e){o(e.id),console.iatWarn("add scroller timed out: "+e.id)}function o(e){i[e]=void 0}function l(e){return i[e]||(i[e]={startTime:Date.now()}),i[e]}function d(e){return i[e]}function c(e,t){void 0!==i[e].scroller&&(i[e].scroller.scroller=t,i[e].scroller.scrollerStyle=t.style,i[e].scroller.refresh()),i[e].refreshTimer=void 0}function h(e){return-1!==e.className.indexOf("systemContentLoader")||-1!==e.className.indexOf("breaseLayout")||-1!==e.className.indexOf("ScrollBox")}return ScrollManager}),define("brease/controller/libs/ScreenManager",[],function(){"use strict";var ScreenManager={captureScreenAndSaveOnClient:function(e){return e=e||"screenshot",this.active=!0,new Promise(function(t,i){ScreenManager.takeScreenshot().then(function i(s){ScreenManager.saveOnClient(s,e).then(function(){ScreenManager.active=!1,t()})},function e(t){ScreenManager.active=!1,i(t)}).catch(function(e){return ScreenManager.active=!1,i(e.message),e})})},captureScreenAndSaveOnServer:function(){},takeScreenshot:function(){return new Promise(function(e,i){ScreenManager.createScreenshotCanvas().then(function(i){e(t(i))},i).catch(function(e){i(e)})})},createScreenshotCanvas:function(){return new Promise(function(t,i){return e({audio:!1,video:{width:screen.width,height:screen.height,frameRate:1}}).then(function e(i){const s=document.createElement("video");s.onloadedmetadata=function(){s.play(),s.pause(),ScreenManager.video={width:s.videoWidth,height:s.videoHeight};const e=document.createElement("canvas");e.width=ScreenManager.video.width,e.height=ScreenManager.video.height,e.getContext("2d").drawImage(s,0,0,ScreenManager.video.width,ScreenManager.video.height),t(e),i.getTracks().forEach(function(e){e.stop()})},s.srcObject=i},function e(t){i(t)}).catch(function(e){return i(e.message),e})})},saveOnClient:function e(t,i){return new Promise(function(e){var s=document.createElement("a");s.download=i,s.rel="noopener",s.href=URL.createObjectURL(t),window.setTimeout(function(){URL.revokeObjectURL(s.href),e()},0),s.dispatchEvent(new MouseEvent("click"))})}};function e(e){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return navigator.mediaDevices.getDisplayMedia(e);if(navigator.getDisplayMedia)return navigator.getDisplayMedia(e);throw new Error("getDisplayMedia is not defined")}function t(e){return new Promise(function(t){e.toBlob(function(e){t(e)},"image/png")})}return ScreenManager}),define("brease/core/Types",["brease/core/Utils"],function(Utils){"use strict";var Types={parseValue:function(n,o,l){var d=n;switch(o){case"Enum":d=e(n,l);break;case"Integer":d=t(n,l);break;case"Number":d=i(n,l);break;case"Boolean":d=s(n,l);break;case"Color":d=a(n);break;case"String":d=r(n,l);break;default:break}return d},objectTypes:["Object","Array","ItemCollection","ContentCollection","GraphicCollection","RoleCollection","brease.config.MeasurementSystemUnit","brease.config.MeasurementSystemFormat","brease.datatype.Notification","brease.datatype.Node","brease.datatype.ArrayNode"]};function e(e,t){var i=e;return!0!==t.Enum.hasMember(e)&&(i=t.default),i}function t(e,t){var i=parseInt(e,10);return isNaN(i)&&(i=void 0===t||isNaN(t.default)?0:parseInt(t.default,10)),void 0!==t&&void 0!==t.min&&(i=Math.max(i,t.min)),void 0!==t&&void 0!==t.max&&(i=Math.min(i,t.max)),i}function i(e,t){var i=parseFloat(e);return isNaN(i)&&(i=void 0===t||isNaN(t.default)?0:parseFloat(t.default)),void 0!==t&&void 0!==t.min&&(i=Math.max(i,t.min)),void 0!==t&&void 0!==t.max&&(i=Math.min(i,t.max)),i}function s(e,t){var i=e;return!0===e||!1===e||1===e||0===e||!t||!0!==t.default&&!1!==t.default||(i=t.default),i=!(!0!==i&&1!==i),i}var n=/(^#[0-9A-Fa-f]{6}$)|(^#[0-9A-Fa-f]{3}$)|(transparent)|(^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$)|(^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$)/;function a(e){var t=""+e;return n.test(t)||(t="#000000"),t}function r(e,t){return void 0===t||void 0===t.default||Utils.isString(e)?""+e:t.default}return Types}),define("brease/controller/libs/DialogQueue",[],function(){"use strict";function DialogQueue(){this.queue={}}DialogQueue.prototype.hasPendingAction=function(t){var i=e(t),s=this.queue[i];return Array.isArray(s)&&s.length>0},DialogQueue.prototype.addAction=function(t){var i=e(t),s=this.queue[i];t.force=!0,Array.isArray(s)?s.push(t):this.queue[i]=[t]},DialogQueue.prototype.finishAction=function(t,i){var s=e(t),n=this.queue[s];if(Array.isArray(n)){var a=n.indexOf(t);-1!==a&&n.splice(a,1),"function"==typeof i&&i(n.shift())}else"function"==typeof i&&i()};function e(e){return e.actionArgs?e.actionArgs.dialogId:void 0}return DialogQueue}),define("brease/controller/ActionController",["brease/controller/objects/Client","brease/controller/libs/ContentHelper","brease/decorators/TooltipDependency","brease/controller/libs/ScrollManager","brease/controller/libs/ScreenManager","brease/core/Utils","brease/core/Types","brease/enum/Enum","brease/events/SocketEvent","brease/controller/libs/DialogQueue","brease/events/BreaseEvent","brease/controller/FocusManager"],function(Client,e,t,ScrollManager,ScreenManager,Utils,Types,Enum,SocketEvent,DialogQueue,BreaseEvent,i){"use strict";var ActionController=function ActionController(){this.serverActionHandler=r.bind(this)},s=ActionController.prototype,n=e,a;s.init=function(e,t){void 0!==a&&a.removeEventListener(SocketEvent.ACTION,this.serverActionHandler),t&&(n=t),a=e,a.addEventListener(SocketEvent.ACTION,this.serverActionHandler),this.dialogQueue=new DialogQueue};function r(e){var t=e.detail,i=o(t);try{switch(i){case"widget":c(t);break;case"clientSystem":l.call(this,t);break;default:M(null,t.actionId,!1);break}}catch(e){V(e,t),M(null,t.actionId,!1)}}function o(e){return-1!==e.action.indexOf("widgets.")?"widget":0===e.action.indexOf("clientSystem.")?"clientSystem":(console.warn("Target:",e.action,"notAvailable"),void 0)}function l(e){switch(e.action){case"clientSystem.Action.ShowMessageBox":v(e);break;case"clientSystem.Action.OpenDialog":!0===Client.isValid?y.call(this,e):(M(null,e.actionId,!1),console.warn('client not valid -> action "OpenDialog" rejected'));break;case"clientSystem.Action.OpenDialogAtTarget":!0===Client.isValid?w.call(this,e):(M(null,e.actionId,!1),console.warn('client not valid -> action "OpenDialogAtTarget" rejected'));break;case"clientSystem.Action.CloseDialog":!0===Client.isValid?x.call(this,e):(M(null,e.actionId,!1),console.warn('client not valid -> action "CloseDialog" rejected'));break;case"clientSystem.Action.Navigate":!0===Client.isValid?(S(e),B()):(M(null,e.actionId,!1),console.warn('client not valid -> action "Navigate" rejected'));break;case"clientSystem.Action.LoadContentInArea":!0===Client.isValid?C(e):(M(null,e.actionId,!1),console.warn('client not valid -> action "LoadContentInArea" rejected'));break;case"clientSystem.Action.LoadContentInDialogArea":!0===Client.isValid?_(e):(M(null,e.actionId,!1),console.warn('client not valid -> action "LoadContentInDialogArea" rejected'));break;case"clientSystem.Action.Logout":A(e);break;case"clientSystem.Action.Login":D(e);break;case"clientSystem.Action.ChangeTheme":!0===Client.isValid?P(e):(M(null,e.actionId,!1),console.warn('client not valid -> action "ChangeTheme" rejected'));break;case"clientSystem.Action.SetLanguage":O(e);break;case"clientSystem.Action.SetMeasurementSystem":N(e);break;case"clientSystem.Action.ScrollContent":!0===Client.isValid?k(e):(M(null,e.actionId,!1),console.warn('client not valid -> action "ScrollContent" rejected'));break;case"clientSystem.Action.ShowTooltips":R(e);break;case"clientSystem.Action.OpenChangePasswordDialog":L(e);break;case"clientSystem.Action.FocusNext":i.focusNext(),M(!0,e.actionId,!0);break;case"clientSystem.Action.FocusPrevious":i.focusPrevious(),M(!0,e.actionId,!0);break;case"clientSystem.Action.GetScreenCapture":T(e);break;default:console.warn("Action:",e.action,"notAvailable"),M(null,e.actionId,!1);break}}function d(e,t,i){if(e.meta&&e.meta.actions){var s=[];for(var n in e.meta.actions[t].parameter)s[e.meta.actions[t].parameter[n].index]=n;return s}return Utils.getFunctionArguments(i)}function c(e){var t=e.target.refId,i=brease.callWidget(t,"widget");if(null===i)return M(null,e.actionId,!1),void 0;var s=e.action.split(".").pop();if(i.state<Enum.WidgetState.INITIALIZED)return console.iatWarn('widget action "'+s+'" for '+e.target.refId+": widget in unavailable state:"+i.state),M(null,e.actionId,!1),void 0;var n=i.constructor,a=n.meta&&n.meta.actions?n.meta.actions[s]:void 0,r=a?a.method:s.substring(0,1).toLowerCase()+s.substring(1),o=i[r];if(void 0===o)return console.iatWarn('Action "'+s+'" not available on type '+n.defaults.className),M(null,e.actionId,!1),void 0;var l=f(o,s,e.actionArgs,n).concat({origin:"action",action:s}),d=o.apply(i,l);if(d&&"function"==typeof d.done?d.done(function(t,i,a){void 0===i&&(i=t),h(t,i,e.actionId,s,n,a)}):h(null!==d,d,e.actionId,s,n),u(r,a)){g(m(a,r),t,n,l[0])}}function h(e,t,i,s,a,r){if(!1===e)M(t,i,!1);else{var o=n.contentAction(a,s);o?$.when(n.contentFinishedStateChange(o,r)).then(function(e){M(e,i,e)}):M(t,i,!0)}}function u(e,t){return 0===e.indexOf("set")||t&&void 0!==t.setterFor}function g(e,t,i,s){var n=brease.uiController.getSubscriptionsForElement(t);if(n&&n[e]&&p(e,t,s),i.meta&&i.meta.properties&&i.meta.properties[e]){var a=i.meta.properties[e].nodeRefId;a&&n&&n[a]&&p(a,t,brease.callWidget(t,Utils.getter(a)))}}function m(e,t){return e&&e.setterFor?e.setterFor:t.substring(3).replace(/^[A-Z]/,function(e){return e.toLowerCase()})}function p(e,t,i){var s={};s[e]=i,brease.uiController.bindingController.attributeChangeForwarder({target:{id:t},detail:s})}function f(e,t,i,s){var n=[],a=Object.keys(i);if(a.length>1){var r=d(s,t,e);r&&(a=r)}for(var o=0;o<a.length;o+=1)n.push(b(i[a[o]],a[o],s,t));return n}function b(e,t,i,s){if(!Utils.isString(e))return e;if(void 0===i.meta||void 0===i.meta.actions||void 0===i.meta.actions[s])return e;var n=i.meta.actions[s].parameter[t];if(!n||-1===Types.objectTypes.indexOf(n.type))return e;var a=Utils.parsePseudoJSON(e,"illegal data in attribute "+t+" for action "+s);return a||e}function v(e){var t=e.actionArgs;$.when(brease.overlayController.showMessageBox(t.type,t.header,t.message,t.icon,t.buttonText,t.style)).then(function(t){M(t,e.actionId,!0)})}function y(e){var t=this,i=!0===e.force||!this.dialogQueue.hasPendingAction(e);if(this.dialogQueue.addAction(e),i){var s=e.actionArgs,a=n.contentsToLoadInDialog(s.dialogId);$.when(brease.overlayController.openDialog(s.dialogId,s.mode,s.horizontalPos,s.verticalPos,void 0,s.headerText,s.autoClose,s.autoRaise)).then(function(i){if(!0===i){var s=n.activateFinished(a),r=E.bind(t,s);document.body.addEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,r),$.when(s).then(function(i){document.body.removeEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,r),I.call(t,e,i,i)})}else I.call(t,e,!1,!1)})}}function w(e){var t=this,i=!0===e.force||!this.dialogQueue.hasPendingAction(e);if(this.dialogQueue.addAction(e),i){var s=e.actionArgs,r=document.getElementById(s.target),o=n.contentsToLoadInDialog(s.dialogId);W(s)&&a.logEvents(-2134803119,0,"",[[s.horizontalPos,s.verticalPos,s.horizontalDialogAlignment,s.verticalDialogAlignment]]),null!==r?$.when(brease.overlayController.openDialogAtTarget(s.dialogId,s.mode,s.horizontalPos,s.verticalPos,r,s.headerText,s.autoClose,s.horizontalDialogAlignment,s.verticalDialogAlignment,s.autoRaise)).then(function(i){if(!0===i){var s=n.activateFinished(o),a=E.bind(t,s);document.body.addEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,a),$.when(s).then(function(i){document.body.removeEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,a),I.call(t,e,i,i)})}else I.call(t,e,!1,!1)}):I.call(t,e,!1,!1)}}function x(e){var t=this,i=!0===e.force||!this.dialogQueue.hasPendingAction(e);if(this.dialogQueue.addAction(e),i){var s=e.actionArgs,a=n.activeContentsInDialog(s.dialogId);brease.overlayController.closeDialog(s.dialogId),$.when(n.deactivateFinished(a)).then(function(i){I.call(t,e,i,i)})}}function E(e){n.abort(e)}function I(e,t,i){var s=this;M(t,e.actionId,i),this.dialogQueue.finishAction(e,function(e){e&&l.call(s,e)})}function C(e){var t=e.actionArgs;brease.pageController.loadContentInArea(t.contentId,t.areaId,t.pageId).done(function(i){!0===i?$.when(n.activateFinished([t.contentId])).then(function(t){M(t,e.actionId,t)}):M(i,e.actionId,i)})}function _(e){var t=e.actionArgs;brease.pageController.loadContentInDialogArea(t.contentId,t.areaId,t.dialogId).done(function(i){!0===i?$.when(n.activateFinished([t.contentId])).then(function(t){M(t,e.actionId,t)}):M(i,e.actionId,i)})}function S(e){var t=e.actionArgs,i,s=brease.pageController.getVisuById(brease.pageController.getVisu4Page(t.pageId));void 0!==s?(i=document.getElementById(s.containerId),$.when(brease.pageController.loadPage(t.pageId,i)).then(function(i){!0===i.success?$.when(n.loadFinished(t.pageId)).then(function(t){M(t,e.actionId,t)}):M(!1,e.actionId,!1)})):M(!1,e.actionId,!1)}function T(e){ScreenManager.active?(console.iatDebug("GetScreenCapture action rejected: action already in progress"),M(!1,e.actionId,!1)):ScreenManager.captureScreenAndSaveOnClient(e.actionArgs.preFix).then(function t(){M(!0,e.actionId,!0)},function t(i){console.iatDebug("GetScreenCapture action rejected:"+i),M(!1,e.actionId,!1)})}function D(e){var t=e.actionArgs;$.when(brease.user.loginAction(t.userName,t.password)).then(function(t){M(t.success,e.actionId,!0)})}function A(e){$.when(brease.user.setDefaultUser()).then(function(){M(!0,e.actionId,!0)})}function L(e){e.actionArgs.showPolicy=Types.parseValue(e.actionArgs.showPolicy,"Boolean",{default:!1}),e.actionArgs.userName=Utils.isString(e.actionArgs.userName)?e.actionArgs.userName:"",$.when(brease.overlayController.openChangePasswordDialog(e.actionArgs.userName,e.actionArgs.showPolicy)).then(function(t){M(t,e.actionId,!0)})}function P(e){var t=e.actionArgs;$.when(brease.pageController.setTheme(t.theme)).then(function(){M(!0,e.actionId,!0)})}function O(e){var t=e.actionArgs;$.when(brease.language.switchLanguage(t.value)).then(function(t){M({},e.actionId,t.success)})}function N(e){var t=e.actionArgs;$.when(brease.measurementSystem.switchMeasurementSystem(t.value)).then(function(){M({},e.actionId,!0)})}function k(e){var t=e.actionArgs;"ontouchstart"in window||navigator.msMaxTouchPoints?setTimeout(function(){$.when(ScrollManager.scrollContent(t.contentId,t.position,t.duration)).then(function(t){M(t,e.actionId,!0)})},0):$.when(ScrollManager.scrollContent(t.contentId,t.position,t.duration)).then(function(t){M(t,e.actionId,!0)})}function R(e){var t=e.actionArgs;"true"===t.value||!0===t.value?$("[data-brease-widget]").each(function(){brease.callWidget(this.id,"activateTooltipMode")}):"false"!==t.value&&!1!==t.value||B(),M(!0,e.actionId,!0)}function B(){t.isActivated()&&$("[data-brease-widget]").each(function(){brease.callWidget(this.id,"deactivateTooltipMode")})}function M(e,t,i){var s={actionId:t,actionResult:{result:e,success:i}};a.actionResponse(s)}function V(e,t){var i='Error in action "'+t.action+(t.target&&t.target.refId?'" for widget "'+t.target.refId+'"':"");console.log(i+":"),console.log(e.message)}function W(e){return H(e.horizontalPos,"HorizontalPosition")||H(e.verticalPos,"VerticalPosition")||H(e.horizontalDialogAlignment,"HorizontalPosition")||H(e.verticalDialogAlignment,"VerticalPosition")}function H(e,t){return void 0!==e&&!Enum[t].hasMember(e)}return new ActionController}),define("brease/objects/Subscription",[],function(){"use strict";var e=function(e,t,i){this.elemId=e,this.attribute=t,this.contentId=i};return e.fromServerData=function(t,i){var s=new e(t.refId,t.attribute,i);return void 0!==t.dynamic&&(s.dynamic=!!t.dynamic),void 0!==t.active&&(s.active=!!t.active),void 0!==t.count&&(s.count=parseInt(t.count,10)),s},e.toServerData=function(e,t){return{refId:e.elemId,data:[{attribute:e.attribute,value:t}]}},e.isValid=function(e){return void 0!==e&&void 0!==e.elemId&&void 0!==e.attribute&&void 0!==e.contentId},e}),define("brease/model/BindingModel",["brease/objects/Subscription"],function(e){"use strict";var t,i,s,n={addSubscription:function(t){if(e.isValid(t)){var s=t.elemId,n=t.contentId;void 0===i.elements.get(s)&&i.elements.set(s,{}),void 0===i.elements.get(s)[t.attribute]?i.elements.get(s)[t.attribute]=t:!0===i.elements.get(s)[t.attribute].dynamic&&(i.elements.get(s)[t.attribute].count+=1),void 0===i.contents.get(n)&&i.contents.set(n,new Map),i.contents.get(n).set(s,i.elements.get(s))}},deleteSubscription:function(e,t){var s=i.elements.get(e);void 0!==s&&delete s[t]},addDynamicBinding:function(e,t){var i=r(e.target);e.contentId=t,s.elements.set(i,e),void 0===s.contents.get(t)&&s.contents.set(t,new Map),s.contents.get(t).set(i,e)},getDynamicBinding:function(e){return s.elements.get(r(e))},hasDynamicBinding:function(e){for(var t=s.elements.entries(),i=t.next();!i.done;){var n=i.value[1];if(o(n.target,e)||o(n.source,e))return!0;i=t.next()}return!1},removeDynamicBinding:function(e){var t=r(e),i=s.elements.get(t);i&&(a(e.refId,e.attribute),"brease"===i.source.type&&a(i.source.refId,i.source.attribute),s.elements.delete(t),s.contents.get(i.contentId).delete(t))},addDynamicSubscription:function(t,i,s){var a=e.fromServerData({attribute:i,refId:t,dynamic:!0,count:1,active:!0},s);return n.addSubscription(a),a},removeDynamicBindings:function(e){var t=s.contents.get(e);if(t&&t.size>0){var i=[]
;t.forEach(function(t,s){t.contentId===e&&(i.push(s),a(t.target.refId,t.target.attribute),"brease"===t.source.type&&a(t.source.refId,t.source.attribute))});for(var n=0;n<i.length;n+=1)s.elements.delete(i[n]),s.contents.get(e).delete(i[n])}},getSubscriptionsForElement:function(e,t){var s=i.elements.get(e);if(void 0!==s)return void 0!==t?s[t]:s},getSubscriptionsForContent:function(e){return i.contents.get(e)},getEventSubscriptionsForContent:function(e){return t.contents.get(e)},contentHasSubscriptions:function(e){var t=i.contents.get(e);return void 0!==t&&t.size>0},deactivateSubscriptions:function(e){var t=i.contents.get(e);t&&t.forEach(function(e){for(var t in e)e[t].active=!1})},addEventSubscription:function(e){var i=e.elemId,s=e.event,n=t.elements.get(i);void 0===n&&(t.elements.set(i,{}),n=t.elements.get(i)),void 0===n[s]&&(n[s]={}),n[s]=e,t.contents.set(e.scopeId,!0)},getEventsForElement:function(e,i){var s=t.elements.get(e);if(void 0!==s)return void 0!==i?s[i]:s},addSessionEventSubscription:function(e,i){void 0===t.session[i]&&(t.session[i]=[]),-1===t.session[i].indexOf(e.event)&&t.session[i].push(e.event)},getSessionEvents:function(){return t.session},reset:function(){l()}};function a(e,t){var i=n.getSubscriptionsForElement(e,t);i&&(!0===i.dynamic&&(i.count-=1),0===i.count&&n.deleteSubscription(e,t))}function r(e){return e.type+"||"+e.refId+"||"+e.attribute}function o(e,t){return e.type===t.type&&e.refId===t.refId&&e.attribute===t.attribute}function l(){t={session:{_client:[]},contents:new Map,elements:new Map},i={contents:new Map,elements:new Map},s={contents:new Map,elements:new Map},brease.config&&brease.config.mocked&&(window.bindingModel={subscriptions:i,bindings:s,events:t})}return l(),n}),define("brease/controller/BindingLoader",["brease/events/BreaseEvent","brease/enum/Enum","brease/objects/Subscription","brease/controller/objects/ContentStatus"],function(BreaseEvent,Enum,e,ContentStatus){"use strict";var BindingLoader={init:function(e,n,a){t=e,i=n,s=a},startListen:function(){document.body.addEventListener(BreaseEvent.VISU_ACTIVATED,c),document.body.addEventListener(BreaseEvent.VISU_DEACTIVATED,c)},loadSubscriptions:function(e,t){var i=s.setLatestRequest(e,"loadSubscriptions");return i&&!0!==s.isBindingLoaded(e)?$.when(n(e,i.latestRequest),a(e,i.latestRequest)).then(function(){s.getActiveState(e)>ContentStatus.initialized&&(s.setBindingLoadState(e,!0),document.body.dispatchEvent(new CustomEvent(BreaseEvent.BINDING_LOADED,{detail:{contentId:e}})),document.body.dispatchEvent(new CustomEvent(BreaseEvent.EVENTBINDING_LOADED,{detail:{contentId:e}})),t.resolve(e))}):t.resolve(e),t.promise()}},t,i,s;function n(e,i){var n=$.Deferred(),a=s.getContent(e);return t.getSubscription(a.serverId,a.visuId,r,{requestId:i,contentId:e,deferred:n}),n.promise()}function a(e,i){var n=$.Deferred(),a=s.getContent(e);return t.getEventSubscription(a.serverId,a.visuId,o,{requestId:i,contentId:e,deferred:n}),n.promise()}function r(t,n){if(n.requestId===s.getLatestRequest(n.contentId)){if(!0===t.success&&Array.isArray(t.subscriptions))for(var a=0,r=t.subscriptions.length;a<r;a+=1)i.addSubscription(e.fromServerData(t.subscriptions[a],n.contentId));else console.iatInfo('no subscription for content "'+n.contentId+'" available!'),brease.loggerService.log(Enum.EventLoggerId.CLIENT_BINDING_ID_NOTFOUND,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.WARNING,[n.contentId]);n.deferred.resolve()}else console.iatWarn('loadSubscriptions for content "'+n.contentId+'" aborted!')}function o(e,t){t.requestId===s.getLatestRequest(t.contentId)?(!0===e.success&&Array.isArray(e.eventSubscriptions)?l(t.contentId,e.eventSubscriptions):console.iatInfo('no event subscription for content "'+t.contentId+'" available!'),t.deferred.resolve()):console.iatWarn('loadEventSubscription for content "'+t.contentId+'" aborted!')}function l(e,t){var s=t.length,n;if(s>0)for(var a=0;a<s;a+=1)n=t[a],void 0!==n.refId?i.addEventSubscription({scopeId:e,elemId:n.refId,eventId:n.refId,event:n.event}):i.addSessionEventSubscription({scopeId:e,event:n.event},e)}function d(e){if(!0===e.success&&Array.isArray(e.eventSubscriptions))for(var t=0;t<e.eventSubscriptions.length;t+=1)i.addSessionEventSubscription(e.eventSubscriptions[t],"_client");else console.iatInfo("no event subscription for session available!")}function c(){t.getSessionEventSubscription(d)}return BindingLoader}),define("brease/datatype/Notification",[],function(){"use strict";var Notification=function(e,t){this.action=e,this.row=t},e=Notification.prototype;return e.setAction=function(e){this.action=e},e.getAction=function(){return this.action},e.setRow=function(e){this.row=e},e.getRow=function(){return this.row},Notification}),define("brease/controller/BindingController",["brease/model/BindingModel","brease/controller/BindingLoader","brease/events/BreaseEvent","brease/events/SocketEvent","brease/services/libs/ServerCode","brease/enum/Enum","brease/core/Utils","brease/datatype/Notification","brease/objects/Subscription","brease/controller/ContentManager","brease/core/Types","brease/controller/objects/ContentStatus"],function(e,t,BreaseEvent,SocketEvent,ServerCode,Enum,Utils,i,s,n,Types,ContentStatus){"use strict";var a={init:function(i){r&&(r.removeEventListener(SocketEvent.PROPERTY_VALUE_CHANGED,m),r.removeEventListener(SocketEvent.SUBSCRIBE,_),r.removeEventListener(SocketEvent.UNSUBSCRIBE,S)),r=i,r.addEventListener(SocketEvent.PROPERTY_VALUE_CHANGED,m),r.addEventListener(SocketEvent.SUBSCRIBE,_),r.addEventListener(SocketEvent.UNSUBSCRIBE,S),n.init(i),t.init(i,e,n)},startListen:function(){t.startListen()},activateVirtualContent:function(e,t){return n.addVirtualContent(e,t),a.activateContent(e)},activateContent:function(e){var t=$.Deferred(),i=n.setLatestRequest(e,"activate");return i?(n.setActiveState(e,ContentStatus.activatePending),r.activateContent(i.serverId,i.visuId,d,{requestId:i.latestRequest,contentId:e,deferred:t})):t.resolve(e),t.promise()},isBindingLoaded:function(e){return n.isBindingLoaded(e)},isContentActive:function(e){return n.isContentActive(e)},getContentState:function(e){return n.getActiveState(e)},setContentState:function(e,t){return n.setActiveState(e,t)},sendInitialValues:function(t,i){var s=[],a=$.Deferred();n.setLatestRequest(t,"attach")?(e.contentHasSubscriptions(t)?(e.getSubscriptionsForContent(t).forEach(function(e,t){for(var i in e){var n=e[i];void 0!==n&&s.push(u(n,t,i))}}),n.setActivateDeferred(t,a),E(s)):a.resolve(t),a.done(function(e){"function"==typeof i&&i(e)})):"function"==typeof i&&i(t)},deactivateContent:function(t,i){var s=$.Deferred(),a=n.setLatestRequest(t,"detach");if(a&&a.state!==ContentStatus.aborted){n.setActiveState(t,ContentStatus.deactivatePending),n.setDeactivateDeferred(t,s);var o=!0!==brease.config.preLoadingState;r.deactivateContent(a.serverId,a.visuId,c,{requestId:a.latestRequest,contentId:t},o),e.removeDynamicBindings(t),e.deactivateSubscriptions(t),s.done(function(e){"function"==typeof i&&i(e)})}else"function"==typeof i&&i(t)},getSubscriptionsForElement:function(t,i){return e.getSubscriptionsForElement(t,i)},getEventsForElement:function(t,i){return e.getEventsForElement(t,i)},isActiveSessionEvent:function(t){var i=e.getSessionEvents(),s=!1;if(-1!==i._client.indexOf(t))return!0;for(var a in i)if("_client"!==a&&n.isContentActive(a)&&-1!==i[a].indexOf(t)){s=!0;break}return s},eventIsSubscribed:function(e,t,i){return-1!==e.indexOf("widgets.")?void 0!==a.getEventsForElement(i,t):0===e.indexOf("clientSystem.")&&a.isActiveSessionEvent(t)},allActive:function(e){return n.allActive(e)},createBindings:function(t,i,s){var n=$.Deferred();return s.forEach(function(i){e.addDynamicBinding(i,t)}),r.createBindings(t,i,s,l,{contentId:t,bindings:s,deferred:n}),n.promise()},deleteBindings:function(e,t,i){var s=$.Deferred();return r.deleteBindings(e,t,i,o,{contentId:e,targets:i,deferred:s}),s.promise()},attributeChangeForwarder:function(e){v(e)},nodeAttributeChangeForwarder:function(e){y(e)}},r;function o(t,i){if(t.status.code===ServerCode.SUCCESS){for(var s=0;s<i.targets.length;s+=1)t.bindingsStatus[s].code===ServerCode.SUCCESS&&e.removeDynamicBinding(i.targets[s]);i.deferred.resolve(t.bindingsStatus)}else i.deferred.reject(t.status)}function l(t,i){var s,n,a=[];if(t.status.code===ServerCode.SUCCESS){for(var r=0;r<i.bindings.length;r+=1)s=i.bindings[r],t.bindingsStatus[r].code===ServerCode.SUCCESS?(n=e.addDynamicSubscription(s.target.refId,s.target.attribute,i.contentId),a.push(u(n,s.target.refId,s.target.attribute)),"brease"===s.source.type&&(n=e.addDynamicSubscription(s.source.refId,s.source.attribute,i.contentId),a.push(u(n,s.source.refId,s.source.attribute)))):e.removeDynamicBinding(s.target);i.deferred.resolve(t.bindingsStatus),a.length>0&&E(a)}else i.deferred.reject(t.status)}function d(e,i){i.requestId===n.getLatestRequest(i.contentId)&&n.getActiveState(i.contentId)>ContentStatus.initialized?!0===e.success?(t.loadSubscriptions(i.contentId,i.deferred),brease.loggerService.log(Enum.EventLoggerId.CLIENT_BINDING_ATTACH_OK,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.SUCCESS,[i.contentId])):(console.iatWarn('activateContent for content "'+i.contentId+'" failed, possibly no binding defined!'),i.deferred.reject(i.contentId),brease.loggerService.log(Enum.EventLoggerId.CLIENT_BINDING_ATTACH_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[i.contentId])):console.iatWarn('activateContent for content "'+i.contentId+'" aborted!')}function c(e,t){!0===e.success?brease.loggerService.log(Enum.EventLoggerId.CLIENT_BINDING_DETACH_OK,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.SUCCESS,[t.contentId]):brease.loggerService.log(Enum.EventLoggerId.CLIENT_BINDING_DETACH_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.ERROR,[t.contentId])}function h(e,t){var i=brease.uiController.callWidget(t,"widget");if(i){var s=i.constructor,n=s.meta&&s.meta.properties?s.meta.properties[e]:void 0;return n&&n.getter?n.getter:Utils.getter(e)}return Utils.getter(e)}function u(e,t,s){if(brease.uiController.getWidgetState(t)<=Enum.WidgetState.NON_EXISTENT)return g(e,'subscription: widget does not exist (widgetId:"'+t+'", attribute:"'+s+'")');var n=s,a,r;if(-1!==s.indexOf("::")){var o=s.split("::");n=o[0],a=o[1]}if(!0===Utils.isStructuredProperty(n)){var l=Utils.parseStructuredProperty(n);r=brease.uiController.callWidget(t,h(l.attribute,t),t+l.path,l.subAttribute)}else r=brease.uiController.callWidget(t,h(n,t),a);return void 0===r?g(e,'subscription: undefined value (widgetId:"'+t+'", attribute:"'+s+'")'):null===r?g(e,'subscription: getter returns null (widgetId:"'+t+'", attribute:"'+s+'")'):i.prototype.isPrototypeOf(r)?{subscription:e,data:[],type:"notification"}:{subscription:e,data:r}}function g(e,t){return console.iatWarn(t),{subscription:e,data:null}}function m(t){var i=t.detail,s=i.length;if(s>0)for(var n=0;n<s;n+=1)for(var a=i[n].refId,r=i[n].data,o=0,l=r.length;o<l;o+=1)try{var d=e.getSubscriptionsForElement(a,r[o].attribute);d?f(a,r[o].attribute,r[o].value,d):console.iatWarn('no subscription for attribute "'+r[o].attribute+", widgetId="+a)}catch(e){console.warn("error processing property",e)}}function p(e,t){var i=t.constructor,s=i.meta&&i.meta.properties?i.meta.properties[e]:void 0;return s&&s.setter?s.setter:Utils.setter(e)}function f(e,t,i,s){if(void 0===t)console.iatWarn("binding for widget["+e+"]: no binding attribute given");else{var n=brease.callWidget(e,"widget");if(null!==n&&(n.state===Enum.WidgetState.INITIALIZED||n.state===Enum.WidgetState.READY)){var a={origin:"server"};if(-1!==t.indexOf("::")){var r=t.split("::");a.attribute=r[0],a.refAttribute=r[1]}else a.attribute=t;var o=p(a.attribute,n);if(void 0!==n[o]){if(a.value=b(i,n.constructor,o,a.attribute,e),s.active=!0,Utils.isStructuredProperty(t)){var l=Utils.parseStructuredProperty(t);n[o](s.elemId+l.path,l.subAttribute,a.value,a)}else n[o](a.value,a);n.dispatchEvent(new CustomEvent(BreaseEvent.PROPERTY_CHANGED,{detail:{attribute:a.attribute,value:a.value}}))}else console.iatWarn("binding for widget["+e+']: unknown binding method "'+o+'"')}}}function b(e,t,i,s,n){if(!Utils.isString(e))return e;var a=i.substring(0,1).toUpperCase()+i.substring(1);if(void 0===t.meta||void 0===t.meta.actions||void 0===t.meta.actions[a]&&void 0===t.meta.actions[i])return e;var r=t.meta.actions[a]?t.meta.actions[a]:t.meta.actions[i],o=r.parameter;if(!o)return console.iatWarn('action "'+t.name+"."+a+'" has no parameters'),e;var l=o[Object.keys(o)[0]];if(!l||-1===Types.objectTypes.indexOf(l.type))return e;var d=Utils.parsePseudoJSON(e,"illegal data in binding: attribute: "+s+", widgetId:"+n);return d||e}function v(t){var i=t.target.id,s=t.detail;w(e.getSubscriptionsForElement(i),function(e){return s.hasOwnProperty(e)}).forEach(function(e){x(e.data)&&I(e.data,s[e.attribute])})}function y(t){var i=t.target.id,s=t.detail;w(e.getSubscriptionsForElement(i),function(e){return s.attribute===e}).forEach(function(e){x(e.data)&&C(e.data,s.nodeAttribute,s.value)})}function w(e,t){var i=[];if(!Utils.isObject(e)||"function"!=typeof t)return i;for(var s in e)!0===t(s,e[s])&&i.push({attribute:s,data:e[s]});return i}function x(e){return void 0!==e&&(n.isContentActive(e.contentId)||e.active)}function E(e){var t={event:SocketEvent.PROPERTY_VALUE_CHANGED,eventArgs:[]},i;for(t.eventArgs=e.map(function(e){return void 0!==e.type?{refId:e.subscription.elemId,data:[{attribute:e.subscription.attribute,value:e.data,type:e.type}]}:{refId:e.subscription.elemId,data:[{attribute:e.subscription.attribute,value:e.data}]}}),r.sendUpdate([t]),i=0;i<e.length;i+=1)e[i].subscription.active=!0}function I(e,t){r.sendUpdate([{event:SocketEvent.PROPERTY_VALUE_CHANGED,eventArgs:[s.toServerData(e,t)]}])}function C(e,t,i){var s={refId:e.elemId,data:[{attribute:e.attribute}]},n={eventArgs:[s]};"unit"===t&&(n.event="PropertyUnitChanged",s.data[0][t]=i,r.sendUpdate([n]))}function _(t){if(t.detail&&!e.hasDynamicBinding(Object.assign(t.detail,{type:"brease"}))){e.addSubscription(s.fromServerData({attribute:t.detail.attribute,refId:t.detail.refId},t.detail.contentId));var i=e.getSubscriptionsForElement(t.detail.refId,t.detail.attribute);i&&E([u(i,i.elemId,i.attribute)])}}function S(t){t.detail&&e.deleteSubscription(t.detail.refId,t.detail.attribute)}return a}),define("brease/controller/ConnectionController",["brease/events/SocketEvent"],function(SocketEvent){"use strict";var ConnectionController={init:function(e,a,r){t=r||window.location.reload.bind(window.location),e.addEventListener(SocketEvent.CONNECTION_STATE_CHANGED,i.bind(this)),e.addEventListener(SocketEvent.TRANSFER_START,s.bind(this,a)),e.addEventListener(SocketEvent.TRANSFER_FINISH,n.bind(this,a))}},e=!1,t;function i(t){!0!==e?(document.body.dispatchEvent(new CustomEvent(SocketEvent.CONNECTION_STATE_CHANGED,{detail:{state:t.detail.state}})),window._connectionErrorHandler(!0,brease.language.getSystemTextByKey("BR/IAT/brease.common.connectionError.text"))):window._tryReconnect()}function s(t){e=!0,window._connectionErrorHandler=function(){},t.showMessage(brease.language.getSystemTextByKey("BR/IAT/brease.common.transferStart"))}function n(i){e=!1,i.clear(),t()}return ConnectionController}),define("brease/controller/ContentControlObserver",["brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/controller/libs/LogCode"],function(BreaseEvent,Enum,Utils,LogCode){"use strict";var ContentControlObserver=function(){},e=ContentControlObserver.prototype,t=!1,i,s=1e3;e.init=function(){t||this.addEventListeners()},e.findNestedContentControls=function(){$(".breaseContentControl .breaseContentControl").each(function(){var e=$(this).parents(".breaseContentControl").attr("id"),t=brease.callWidget(e,"getParentContentId");a(Utils.getWidgetId(t,e),t,brease.callWidget(e,"getContentId"))})},e.addEventListeners=function(e){var i=!0===e?"removeEventListener":"addEventListener";document.body[i](BreaseEvent.CONTENT_ACTIVATED,n),document.body[i](BreaseEvent.CONTENT_DEACTIVATED,n),t=!e},e.dispose=function(){t&&this.addEventListeners(!0)};function n(){i&&(window.clearTimeout(i),i=0),i=window.setTimeout(r.findNestedContentControls,s)}function a(e,t,i){var s=LogCode.getConfig(LogCode.NESTED_CONTENT_CONTROL_FOUND);document.body.dispatchEvent(new CustomEvent(BreaseEvent.LOG_MESSAGE,{detail:{customer:Enum.EventLoggerCustomer.BUR,verbose:s.verboseLevel,severity:s.severity,code:s.code,text:"",args:[e,t,i]},bubbles:!0}))}var r=new ContentControlObserver;return r}),define("brease/events/EventHandler",["brease/events/ClientSystemEvent"],function(ClientSystemEvent){"use strict";var e,t,EventHandler=function(e,t,i,s,n){this.data={event:i,source:{type:e,refId:t},eventArgs:s||{}},this.elem=e!==EventHandler.DummyType?n:void 0},i=EventHandler.prototype;return EventHandler.init=function(i,s){e=i,t=s},EventHandler.DummyType="dummy.Event",i.dispose=function(){this.elem=void 0,this.data=void 0},i.setEventArgs=function(e){this.data.eventArgs=e||{}},i.getEventArgs=function(){return this.data.eventArgs},i.dispatch=function(t){this.isSubscribed()&&(this.data.event===ClientSystemEvent.CONTENT_LOADED&&!0===brease.config.preLoadingState||"function"==typeof e.sendEvent&&e.sendEvent(this.data)),!1!==t&&void 0!==this.elem&&this.elem.dispatchEvent(new CustomEvent(this.data.event,{detail:this.data.eventArgs,bubbles:!0}))},i.isSubscribed=function(){return this.data.source.type!==EventHandler.DummyType&&t.eventIsSubscribed(this.data.source.type,this.data.event,this.data.source.refId)},EventHandler}),define("brease/controller/libs/AreaManager",["brease/enum/Enum","brease/controller/objects/PageType","brease/controller/libs/ScrollManager"],function(Enum,PageType,ScrollManager){"use strict";var e=function(e,t){this.id=e,this.init(t)},t=new RegExp(".*_style_.*");e.prototype.init=function(e){this.div=s(this.id,e),this.innerBox=n(this.id,e),this.div.appendChild(this.innerBox),this.$innerBox=$(this.innerBox),this.$div=$(this.div),this.info=e},Object.defineProperty(e.prototype,"contentContainer",{get:function(){return this.innerBox}}),Object.defineProperty(e.prototype,"$contentContainer",{get:function(){return this.$innerBox}}),e.prototype.setStyle=function(e){var i="system_brease_Area_style_"+e,s=this.div.classList;if(!1===s.contains(i)){for(var n in s)t.test(s[n])&&this.$div.removeClass(s[n]);this.$div.addClass(i)}},e.prototype.show=function(){this.$div.css("display","block")},e.prototype.hide=function(){this.$div.css("display","none")},e.prototype.dispose=function(){AreaManager.scrollManager.remove(this.id),this.div=null,this.$div=null,this.innerBox=null,this.$innerBox=null,this.info=null},e.prototype.addScrollbars=function(e,t){var i=e&&e.width*t>this.info.width&&!this.info.hasPercentageWidth(),s=e&&e.height*t>this.info.height&&!this.info.hasPercentageHeight();this.$innerBox.css({width:e.width*t,height:e.height*t}),(i||s)&&!1===AreaManager.scrollManager.hasScroller(this.div)?AreaManager.scrollManager.add(this.div):AreaManager.scrollManager.refresh(this.div.id)},e.prototype.setProperties=function(e,t,s,n){var a={};void 0!==t.areaId&&(a["background-color"]=t.backColor?t.backColor:"",a=i(a,t)),this.$div.css(a),this.addScrollbars(e,s),!1!==n&&AreaManager.scrollManager.hasScroller(this.div)&&(AreaManager.scrollManager.refresh(this.id),AreaManager.scrollManager.scrollTo(this.id,0,0))},e.prototype.refresh=function(){AreaManager.scrollManager.hasScroller(this.div)?(AreaManager.scrollManager.refresh(this.id),AreaManager.scrollManager.scrollTo(this.id,0,0)):AreaManager.scrollManager.add(this.div)};function i(e,t){return t.backGround||t.backGroundGradient?(e["background-image"]="",t.backGroundGradient&&(e["background-image"]+=t.backGroundGradient),t.backGround&&(e["background-image"]+=(""!==e["background-image"]?", ":"")+"url("+t.backGround+")",e["background-repeat"]="no-repeat")):e["background-image"]="",t.sizeMode&&(e["background-size"]=Enum.SizeMode.convertToCSS(t.sizeMode)),e}function s(e,t){var i=document.createElement("div");return i.setAttribute("id",e),i.setAttribute("style","position:absolute;"+(void 0!==t.zIndex?"z-index:"+t.zIndex+";":"")+"overflow:hidden; top:"+t.top+"px; left:"+t.left+"px; width:"+t.styleWidth+"; height:"+t.styleHeight+"; box-sizing: border-box;display:block;"),i.setAttribute("class","LayoutArea"),i.setAttribute("data-brease-areaId",t.id),i}function n(e,t){var i=document.createElement("div");return i.setAttribute("id",a(e)),i.setAttribute("class","ScrollBox"),i.setAttribute("style","position:absolute;top:0px; left:0px; width:"+t.width+"px; height:"+t.height+"px; box-sizing: border-box;display:block;"),i}function a(e){return e+"_box"}var AreaManager={scrollManager:ScrollManager,injectDependencies:function(e,t){this.scrollManager=e,this.rootContainerId=t},add:function(t,i,s,n){var a=this.getAreaDivId(t,i,s.id,n),o=r[a];return void 0===o?r[a]=o=new e(a,s):o.init(s),o},remove:function(e){var t=r[e];t&&(t.dispose(),r[e]=void 0)},get:function(e){return r[e]},getArea:function(e,t,i,s){return r[this.getAreaDivId(e,t,i,s)]},getAreaDivId:function(e,t,i,s){return e=e===this.rootContainerId?"root":s===PageType.DIALOG?e:a(e),e+"_"+t+"_"+i},reset:function(){r={}}},r={};return AreaManager}),define("brease/controller/EventController",["brease/events/EventHandler","brease/events/ClientSystemEvent","brease/events/BreaseEvent","brease/events/SystemGestures","brease/core/Utils","brease/controller/objects/ContentStatus","brease/model/VisuModel","brease/controller/libs/AreaManager"],function(EventHandler,ClientSystemEvent,BreaseEvent,SystemGestures,Utils,ContentStatus,e,AreaManager){"use strict";var EventController={init:function(t,i,s){return s&&(e=s),T={},EventHandler.init(t,i),a(!0),a(),this},getAreaForPoint:function(e){var t=brease.pageController.getCurrentPage(brease.appElem.id),i=brease.pageController.getPageById(t),s=[];for(var n in i.assignments){var a=AreaManager.getArea(brease.appElem.id,i.layout,n),r=a.div.getBoundingClientRect();r.left<=e.left&&e.left<=r.left+r.width&&r.top<=e.top&&e.top<=r.top+r.height&&s.push(a)}return s.length>1&&s.sort(function(e,t){return t.info.zIndex-e.info.zIndex}),s.length>0?s[0].info.id:void 0}},t=[],i=[],s=[],n={};function a(e){r(e),o(e),l(e),d(e),c(e),h(e)}function r(e){var t={capture:!0};e?(document.removeEventListener("keypress",x,t),document.removeEventListener("keyup",E,t),document.removeEventListener("keydown",w,t)):(document.addEventListener("keypress",x,t),document.addEventListener("keyup",E,t),document.addEventListener("keydown",w,t))}function o(e){var t=SystemGestures.GESTURES.SystemGesture1,i=SystemGestures.GESTURES.SystemGesture3;e?(t.touchPoints!==i.touchPoints?(SystemGestures.off(t.Type,N),SystemGestures.off(i.Type,k)):SystemGestures.off(t.Type,O),brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,p)):(t.touchPoints!==i.touchPoints?(SystemGestures.on(t.Type,N),SystemGestures.on(i.Type,k)):SystemGestures.on(t.Type,O),brease.bodyEl.on(BreaseEvent.MOUSE_DOWN,p))}function l(e){e?(document.body.removeEventListener(BreaseEvent.FRAGMENT_SHOW,f),document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,v),document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATE_ERROR,y),document.body.removeEventListener(BreaseEvent.DISABLED_CLICK,I)):(document.body.addEventListener(BreaseEvent.FRAGMENT_SHOW,f),document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,v),document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATE_ERROR,y),document.body.addEventListener(BreaseEvent.DISABLED_CLICK,I))}function d(e){e?(document.body.removeEventListener(BreaseEvent.DIALOG_OPEN,C),document.body.removeEventListener(BreaseEvent.DIALOG_CLOSED,_),document.body.removeEventListener(BreaseEvent.FRAGMENT_SHOW,S),document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,S)):(document.body.addEventListener(BreaseEvent.DIALOG_OPEN,C),document.body.addEventListener(BreaseEvent.DIALOG_CLOSED,_),document.body.addEventListener(BreaseEvent.FRAGMENT_SHOW,S),document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,S))}function c(e){e?(document.body.removeEventListener(BreaseEvent.TOOLTIPMODE_ACTIVE,u),document.body.removeEventListener(BreaseEvent.TOOLTIPMODE_INACTIVE,g)):(document.body.addEventListener(BreaseEvent.TOOLTIPMODE_ACTIVE,u),document.body.addEventListener(BreaseEvent.TOOLTIPMODE_INACTIVE,g))}function h(e){e?document.body.removeEventListener(BreaseEvent.CHANGEPASSWORDDIALOG_CLOSED,m):document.body.addEventListener(BreaseEvent.CHANGEPASSWORDDIALOG_CLOSED,m)}function u(){D(ClientSystemEvent.TOOLTIPMODE_ACTIVATED,{})}function g(){D(ClientSystemEvent.TOOLTIPMODE_DEACTIVATED,{})}function m(e){D(ClientSystemEvent.CHANGEPASSWORDDIALOG_CLOSED,{userName:e.detail.userName,result:e.detail.result})}function p(e){n.startPoint={left:e.clientX,top:e.clientY}}function f(t){var i=t.detail.contentId,s=e.getContentById(i);void 0!==s&&(s.state===ContentStatus.active?D(ClientSystemEvent.CONTENT_LOADED,{contentId:i,visuId:s.visuId}):b.add(i))}var b={queue:new Map,add:function(e){this.queue.set(e,e)},contains:function(e){return void 0!==this.queue.get(e)},remove:function(e){this.queue.delete(e)}};function v(t){var i=t.detail.contentId;if(b.contains(i)){b.remove(i);var s=e.getContentById(i);void 0!==s&&D(ClientSystemEvent.CONTENT_LOADED,{contentId:i,visuId:s.visuId})}}function y(t){var i=t.detail.contentId;b.contains(i)&&b.remove(i),e.getContentById(i).state=ContentStatus.aborted,document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_LOAD_ABORTED,{detail:{contentId:i}}))}function w(e){if(void 0!==e.key&&-1===t.indexOf(e.key)){var i=L(e);void 0!==i&&(t.push(e.key),D(ClientSystemEvent.KEY_DOWN,{key:e.key,keyASCII:i}))}}function x(e){if(void 0!==e.key&&-1===i.indexOf(e.key)){var t=L(e);void 0!==t&&(i.push(e.key),D(ClientSystemEvent.KEY_PRESS,{key:e.key,keyASCII:t}))}}function E(e){if(void 0!==e.key){A(t,e.key),A(i,e.key);var s=L(e);void 0!==s&&D(ClientSystemEvent.KEY_UP,{key:e.key,keyASCII:s})}}function I(e){var t=e.detail;if(void 0!==t&&t.widgetId===t.origin){var i=P(t.contentId,t.widgetId);D(ClientSystemEvent.DISABLED_CLICK,{contentId:t.contentId,widgetId:i,hasPermission:t.hasPermission})}}function C(e){var t=brease.pageController.getDialogById(e.detail.dialogId),i={id:e.detail.dialogId,contents:[]};if(t&&t.assignments){for(var n in t.assignments)i.contents.push({id:t.assignments[n].contentId,count:0});s.push(i)}}function _(e){var t=s.filter(function(t){return t.id!==e.detail.dialogId});s=t,D(ClientSystemEvent.DIALOG_CLOSED,{dialogId:e.detail.dialogId,horizontalPos:e.detail.horizontalPos,verticalPos:e.detail.verticalPos})}function S(e){if(0!==s.length){var t=e.detail.contentId,i=s.map(function(e){return{id:e.id,contents:e.contents.filter(function(e){return e.id===t&&(e.count+=1),e.id!==t||e.id===t&&e.count<2})}});s=i.filter(function(e){return 0!==e.contents.length||(D(ClientSystemEvent.DIALOG_OPENED,{dialogId:e.id}),!1)})}}var T={};function D(e,t){void 0!==T[e]?T[e].setEventArgs(t):T[e]=new EventHandler("clientSystem.Event",null,e,t,brease.appElem),T[e].dispatch()}function A(e,t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}function L(e){return void 0!==e.key&&1===e.key.length?e.key.charCodeAt(0):void 0!==e.which?e.which:e.keyCode}function P(e,t){var i;return i=e?t.slice(e.length>0?1+e.length:0,t.length):t,i}function O(e){!1===Utils.hasClass(e.target,"breaseModalDimmer")&&(n.direction=e.detail.direction,n.startArea=EventController.getAreaForPoint(n.startPoint),n.endArea=EventController.getAreaForPoint({left:e.clientX,top:e.clientY}),brease.pageController.swipeNavigation(n.direction)||D(ClientSystemEvent.SYSTEM_SWIPE,{direction:n.direction,areaId:void 0!==n.startArea&&n.startArea===n.endArea?n.startArea:""}))}function N(e){!1===Utils.hasClass(e.target,"breaseModalDimmer")&&(n.direction=e.detail.direction,n.startArea=EventController.getAreaForPoint(n.startPoint),n.endArea=EventController.getAreaForPoint({left:e.clientX,top:e.clientY}),brease.pageController.swipeNavigation(n.direction))}function k(e){!1===Utils.hasClass(e.target,"breaseModalDimmer")&&(n.direction=e.detail.direction,n.startArea=EventController.getAreaForPoint(n.startPoint),n.endArea=EventController.getAreaForPoint({left:e.clientX,top:e.clientY}),D(ClientSystemEvent.SYSTEM_SWIPE,{direction:n.direction,areaId:void 0!==n.startArea&&n.startArea===n.endArea?n.startArea:""}))}return EventController}),define("brease/core/libs/Deferred",[],function(){"use strict";var Deferred=function(e,t){this.type=e,Array.isArray(t)&&(this.loopParams=t.slice(0)),this._done=[],this._fail=[],this._then=[]};return Deferred.TYPE_SINGLE="singleShot",Deferred.TYPE_MULTI="multiShot",Deferred.prototype={execute:function(e,t){for(var i=e.length-1;i>=0;)e[i].apply(null,t),i-=1;for(i=this._then.length-1;i>=0;)this._then[i].apply(null,t),i-=1;this.type===Deferred.TYPE_SINGLE&&(e.length>0||Array.isArray(this._then)&&this._then.length>0)&&this.terminate(),this._then=null,this._done=null,this._fail=null},resolve:function(){if(void 0===this.state){this.state=1,Array.isArray(this.loopParams)?this.doneData=this.loopParams:this.doneData=[];for(var e=arguments.length-1;e>=0;e-=1)this.doneData.unshift(arguments[e]);this.loopParams=null,this.execute(this._done,this.doneData)}},reject:function(){if(void 0===this.state){this.state=-1,Array.isArray(this.loopParams)?this.failData=this.loopParams:this.failData=[];for(var e=arguments.length-1;e>=0;e-=1)this.failData.unshift(arguments[e]);this.loopParams=null,this.execute(this._fail,this.failData)}},done:function(e){return"function"==typeof e&&(this.doneData?(e.apply(null,this.doneData),this.type===Deferred.TYPE_SINGLE&&this.terminate()):this._done&&this._done.push(e)),this},fail:function(e){return"function"==typeof e&&(this.failData?(e.apply(null,this.failData),this.type===Deferred.TYPE_SINGLE&&this.terminate()):this._fail&&this._fail.push(e)),this},then:function(e){return"function"==typeof e&&(this.failData||this.doneData?(this.failData&&(e.apply(null,this.failData),this.type===Deferred.TYPE_SINGLE&&this.terminate()),this.doneData&&(e.apply(null,this.doneData),this.type===Deferred.TYPE_SINGLE&&this.terminate())):this._then&&this._then.push(e)),this},terminate:function(){this.doneData=null,this.failData=null,this.loopParams=null}},Deferred}),define("brease/controller/FileManager",["brease/core/Utils","brease/core/libs/Deferred"],function(Utils,Deferred){"use strict";var e={getPathByType:function(e,t){return v(e,t)},getPathByClass:function(e,t){if(t)return w(e,t);if(void 0!==m[e])return m[e];if(Utils.isString(e)){var i=x(e);return m[e]=m[i.class]=i,m[m[e].type]=i,m[e]}},loadJSFiles:function(e,n){if(e&&e.path&&e.class){var a=[e.path],r=e.class;return!0===n&&a.push(r+"/designer/ClassInfo"),void 0===s[r]&&(s[r]=new Deferred,require(a,t.bind(null,r),i.bind(null,r))),s[r]}var o=new Deferred;return o.reject("undefined widget path"),o},undef:function(e){s[e]=void 0},loadWidgetMeta:function(t){var i=t.class;if(void 0===s[i])return e.loadJSFiles(t,!0);var n=new Deferred;return require([i+"/designer/ClassInfo"],function(e){var t=e.meta.className,i=v(t,"class");s[i].doneData[0].meta=e.meta,n.resolve()},function(e){console.debug(e.message),n.reject()}),n},loadOverlays:function(e){var t=new Deferred(Deferred.TYPE_SINGLE);return require(e,function e(){t.resolve.apply(t,arguments)},function e(){t.reject("script error")}),t},loadHTMLFiles:function(e,t,i){var s=new Deferred(Deferred.TYPE_SINGLE,i),a=g.call(this,e);return a.length>0?n.call(this,a,t).done(function(){s.resolve()}):s.resolve(),s},getHTMLByType:function(e){return o[e]}};function t(e,t,i){t?(i&&void 0===t.meta&&(t.meta=i.meta),t.defaults.className=e,s[e].resolve(t,e)):s[e].reject("script error",e)}function i(e,t){s[e].reject(t.message,e)}var s={};function n(e,t){for(var i="",s=[],n=a(t),o=0;o<e.length;o+=1)i=e[o],n.types.push(i),-1===l.indexOf(i)&&(l.push(i),s.push(i));r();for(var d=0;d<s.length;d+=1)c(s[d]).done(function(){r()}).fail(function(){r()
});return n.def}function a(e){for(var t,i=d.length-1;i>=0;i-=1)d[i].queueId===e&&(t=d[i]);return t||(t={def:new Deferred(Deferred.TYPE_SINGLE),types:[],queueId:e},d.push(t)),t}function r(){for(var e=d.length-1;e>=0;e-=1){var t=d[e];if(t){t.success=!0;for(var i=0;i<t.types.length;i+=1)if(void 0===o[t.types[i]]){t.success=!1;break}!0===t.success&&(d.splice(e,1),t.def.resolve())}}}var o={},l=[],d=[];function c(e){var t=new Deferred(Deferred.TYPE_SINGLE,[e]);return h(t,v(e,"path"),e),t}function h(e,t,i){require(["text!"+t+".html"],function t(s){if(-1!==s.indexOf('data-instruction-inherit="true"')){var n=u(s);h(e,v(n,"path"),i)}else o[i]=s.trim(),e.resolve()},function t(s){o[i]=!1,e.reject(s.message)})}function u(e){var t='data-instruction-superClass="',i=e.substring(e.indexOf(t)+t.length);return i.substring(0,i.indexOf('"')).replace(/\//g,".")}function g(e){for(var t=[],i=0;i<e.length;i+=1)e[i].className&&(e[i].className=v(e[i].className,"type"),-1===t.indexOf(e[i].className)&&t.push(e[i].className));return t}var m={},p=new RegExp("[..]","g"),f=new RegExp("[/.]","g"),b=["class","style","type","path"];function v(e,t){if(Utils.isString(e)){if(-1!==e.indexOf("/"))throw new SyntaxError("wrong widgetType:"+e+"; use dot-notation instead!");if(void 0===m[e]){var i=y(e);m[e]=m[i.type]=i,m[m[e].class]=i}return-1===b.indexOf(t)&&(t=b[0]),m[e][t]}}function y(e){e=-1!==e.indexOf(".")?e:"widgets.brease."+e;var t={style:e.replace(p,"_"),type:e,class:e.replace(p,"/")};return t.path=t.class+t.class.substring(t.class.lastIndexOf("/")),t}function w(e,t){if(void 0!==m[e])return m[e][t];if(Utils.isString(e)){var i=x(e);return m[e]=m[i.class]=i,m[m[e].type]=i,m[e][t]}}function x(e){e=-1!==e.indexOf("/")?e:"widgets/brease/"+e;var t={style:e.replace(f,"_"),type:e.replace(f,"."),class:e};return t.path=t.class+t.class.substring(t.class.lastIndexOf("/")),t}return e}),define("brease/controller/InfoController",["brease/events/BreaseEvent","libs/platform"],function(BreaseEvent,e){"use strict";var InfoController={init:function(e){a=e},start:function(e,r){n=0,window.setTimeout(function(){a.setClientInformation(JSON.stringify(d()))},0),t&&window.clearInterval(t),s=isNaN(r)?i:r,!0===e?(t=window.setInterval(o,s),c("add")):c("remove"),brease.appElem.addEventListener(BreaseEvent.PAGE_LOADED,l)}},t,i=1e3,s=1e3,n=0,a;function r(){n+=1}function o(){a.setClientInformation('{"activityCount":'+n+"}")}function l(e){e.detail.containerId===brease.appElem.id&&a.setClientInformation('{"currentPageId":"'+e.detail.pageId+'"}')}function d(){return{userAgent:navigator.userAgent,screenResolution:screen.width+"x"+screen.height,browserResolution:window.innerWidth+"x"+window.innerHeight,languages:(Array.isArray(navigator.languages)?navigator.languages.join(","):navigator.language)+"",activityCount:n,cookieEnabled:navigator.cookieEnabled,browser:e.name,operatingSystem:e.os.family,isMultiTouch:navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1}}function c(e){var t="add"===e?"addEventListener":"removeEventListener";document.body[t]("click",r),document.body[t]("mousedown",r),document.body[t]("mouseup",r),document.body[t]("touchstart",r),document.body[t]("touchend",r),document.body[t]("touchmove",r),window[t]("keydown",r),window[t]("keyup",r)}return InfoController}),define("system/widgets/KeyBoard/libs/LayoutSelector",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var LayoutSelector=function(){this.currentLayout=""},e=LayoutSelector.prototype;e.init=function(e){this.el=$('<div class="dropdown"></div>'),this.btn=$('<div class="button"></div>'),this.list=$('<div class="dropdownlist"></div>'),this.callback=e,this.btn.on(BreaseEvent.CLICK,{self:this},n),this.list.on(BreaseEvent.CLICK,"[data-value]",{self:this},a),this.el.append([this.btn,this.list])},e.setItems=function(e){var t;this.list.empty();for(var i in e){var s=e[i].displayName,n=e[i].description;t=$('<div data-value="'+i+'" data-displayName="'+(s||"")+'" data-name="'+n+'" data-index="'+e[i].index+'">'+(s||n)+"</div>"),i===this.currentLayout&&(t.addClass("selected"),this.setButtonText(s||i)),this.list.append(t)}},e.getItems=function(e){return e?this.list.children(e):this.list.children()},e.setCurrentLayout=function(e){this.currentLayout=e,this.list||(this.list=$('<div class="dropdownlist"></div>')),this.list.find(".selected").removeClass("selected"),this.list.find('[data-value="'+e+'"]').addClass("selected")},e.setButtonText=function(e){this.btn.text(e)},e.dispose=function(){this.callback=null,this.btn.off(BreaseEvent.CLICK,{self:this},n),this.list.off(BreaseEvent.CLICK,"[data-value]",{self:this},a),$("#breaseKeyBoard").off(BreaseEvent.CLICK,s)},e.close=function(){i.call(this)};function t(){var e=this;this.list.addClass("open"),window.setTimeout(function(){$("#breaseKeyBoard").on(BreaseEvent.CLICK,{selector:e},s)},0)}function i(){this.list.removeClass("open"),$("#breaseKeyBoard").off(BreaseEvent.CLICK,s)}function s(e){var t=e.data.selector;t.getItems().length>2&&t.list.hasClass("open")&&!$.contains(t.el[0],e.target)&&i.call(t)}function n(e){var i=e.data.self;i.getItems().length>2&&!i.list.hasClass("open")?t.call(i):i.list.hasClass("open")?i.list.removeClass("open"):i.list.removeClass("open").find(":not(.selected),:only-child()").trigger(BreaseEvent.CLICK)}function a(e){var t=e.data.self,i=$(this),s=i.attr("data-value"),n=i.attr("data-displayName");t.list.find(".selected").removeClass("selected"),i.addClass("selected"),t.setButtonText(n||s),"function"==typeof t.callback&&t.callback(s),t.list.removeClass("open")}return LayoutSelector}),define("system/widgets/common/keyboards/KeyboardType",["brease/core/Utils"],function(Utils){"use strict";var Types={};return Utils.defineProperty(Types,"ALPHANUMERIC","AlphanumericKeyboard"),Utils.defineProperty(Types,"NUMERIC","NumericKeyboard"),Types}),define("brease/core/ClassUtils",["brease/core/Utils"],function(Utils){"use strict";var ClassUtils={};function e(e){return"function"==typeof e.indexOf&&0===e.indexOf("brease.")}return ClassUtils.className2Path=function(t,i,s){if(!Utils.isString(t))return t;var n=t.split(".");if(n.length<3)return t;var a=t;return!0===s?e(t)&&(a=a.substring(0,a.lastIndexOf("."))):e(t)||(a=a+"."+n[n.length-1]),a=a.replace(/\./g,"/"),!0!==s&&!0===i&&(a+=".js"),a},ClassUtils.path2ClassName=function(e){if(!Utils.isString(e))return e;-1!==e.indexOf(".js")&&(e=e.substring(0,e.lastIndexOf(".")));var t=e.split("/");return t.length<3?e:(t.length=3,t.join("."))},ClassUtils.isDerivedFrom=function(e,t){return e.settings.className===ClassUtils.className2Path(t,!1,!0)||e.constructor&&e.constructor.meta&&e.constructor.meta.inheritance&&-1!==e.constructor.meta.inheritance.indexOf(t)},ClassUtils.parentAllowsChild=function(e,t){var i=e.children,s=t.inheritance;if(!Array.isArray(i))return!1;if(-1!==i.indexOf("*"))return!0;var n=!1;if(Array.isArray(s))for(var a=0;a<s.length;a+=1)if(-1!==i.indexOf(s[a])){n=!0;break}return n},ClassUtils.childAllowsParent=function(e,t){var i=e.parents,s=t.className,n=!1,a=!1,r=!1;if(Array.isArray(i)&&(n=-1!==i.indexOf("*"),a=-1!==i.indexOf(s)),!0===t.isDerived&&Array.isArray(t.inheritance)){var o=t.inheritance[1];r=-1!==i.indexOf(o)}return n||a||r},ClassUtils}),define("brease/core/Class",["brease/core/Utils"],function(Utils){"use strict";var Class=function Class(){this._bound={}};return Class.extend=function(e,t,i){var s=this,n=function(){};if(s.final)throw new SyntaxError("Class is final and cannot be extended!");n.prototype=s.prototype,e.prototype=new n,e.prototype.constructor=e,e.prototype.superClass=s,null!==t&&(void 0!==s.prototype.defaultSettings?e.prototype.defaultSettings=Utils.extendOptionsToNew(s.prototype.defaultSettings,t):e.prototype.defaultSettings=Utils.deepCopy(t)),e.extend=s.extend,e.static={},e.defaults={};for(var a in s.static)e.static[a]=s.static[a];return!0===i&&Utils.defineProperty(e,"final",!0,!1),e},Class.static={},Class.prototype.dispose=function(){this._bound=null},Class.prototype.isDisposed=function(){return null===this._bound},Class.prototype._bind=function(e){if(null!==this._bound){if("function"==typeof e.bind)void 0===this._bound[e]&&(this._bound[e]=e.bind(this));else{if("function"!=typeof this[e])throw new TypeError("Class.prototype._bind - what is trying to be bound is not callable ("+this.constructor.name+")");void 0===this._bound[e]&&(this._bound[e]=this._handlerProxy.bind(this,e))}return this._bound[e]}return console.iatWarn("trying to bind function on disposed widget"),void 0},Class.prototype._getBound=function(e){if(null===this._bound)return console.iatWarn("trying to get bind function on disposed widget"),void 0;if("function"!=typeof e.bind&&"function"!=typeof this[e])throw new TypeError("Class.prototype._getBound - method does not exist ("+this.constructor.name+")");return this._bound[e]},Class.prototype._handlerProxy=function(e){var t=arguments.length,i=1;if(t>1){for(var s=[],n=1;n<t;n+=1)s.push(arguments[n]);this[e].apply(this,s)}else this[e].call(this)},Class}),define("brease/controller/libs/KeyActions",["brease/enum/Enum"],function(Enum){"use strict";const e={Enter:[Enum.KeyAction.Accept],Escape:[Enum.KeyAction.Cancel,Enum.KeyAction.Close],ArrowDown:[Enum.KeyAction.ScrollDown],ArrowUp:[Enum.KeyAction.ScrollUp],ArrowRight:[Enum.KeyAction.ScrollRight],ArrowLeft:[Enum.KeyAction.ScrollLeft],PageDown:[Enum.KeyAction.ScrollDownFast],PageUp:[Enum.KeyAction.ScrollUpFast]};return{getActionForKey:function(t){var i=e[t];return void 0!==i?i[0]:void 0},getActionsForKey:function(t){var i=e[t];return void 0!==i?i:[]}}}),define("brease/decorators/Permissions",["brease/core/Decorator","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,BreaseEvent,Enum){"use strict";var Permissions=function(){this.initType=Decorator.TYPE_PRE},e="roles",t="permissionsChangeHandler";Permissions.prototype=new Decorator;var i=new Permissions;i.methodsToAdd={init:function(t){this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:s.bind(this),wake:n.bind(this)},!0===t&&(this._updatePermissions(),a.call(this,Enum.Dependency.ACTIVE))},dispose:function(){this.dependencies[e]=null,o.call(this)}},i.methodsToAdd[t]=function(){this._updatePermissions(!0)},i.methodsToAdd._setPermission=function(e,t){var i=this.constructor.static.permissions[t];i&&(this.settings[i.property]=e,this._updatePermission(t,!0))},i.methodsToAdd._updatePermissions=function(e){var t=this.constructor.static.permissions;for(var i in t)this._updatePermission(i,e)},i.methodsToAdd._updatePermission=function(e,t){var s=this.constructor.static.permissions[e];void 0!==s&&void 0!==this.settings[s.property]&&(this.settings.permissions[e]=i.getPermission(this.settings[s.property]),!0===t&&this[s.updateMethod]())},i.getPermission=function(e){return null===e||""===e||brease.user.hasOneOfRoles(e)};function s(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored=brease.user.getUserRoles(),a.call(this,Enum.Dependency.SUSPENDED))}function n(){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(a.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored.join(",")!==brease.user.getUserRoles().join(",")&&this[t]())}function a(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?r.call(this):o.call(this))}function r(){document.body.addEventListener(BreaseEvent.ROLES_CHANGED,this._bind(t))}function o(){document.body.removeEventListener(BreaseEvent.ROLES_CHANGED,this._bind(t))}return i}),define("brease/core/libs/AsyncProcess",[],function(){"use strict";var AsyncProcess=function(){this.execute=this.run.bind(this),this.queue=[]};return AsyncProcess.prototype.start=function(){this.started||(this.started=!0,window.requestAnimationFrame(this.execute))},AsyncProcess.prototype.add=function(e){"function"==typeof e&&(-1===this.queue.indexOf(e)&&this.queue.push(e),this.start())},AsyncProcess.prototype.run=function(){for(var e=0,t=this.queue.length;e<t;e+=1)this.queue[e].call();this.queue.length=0,this.started=!1},AsyncProcess}),define("brease/core/BaseWidget",["brease/core/Class","brease/events/BreaseEvent","brease/events/VirtualEvents","brease/core/Utils","brease/enum/Enum","brease/core/Types","brease/controller/libs/KeyActions","brease/events/EventHandler","brease/decorators/Permissions","brease/controller/FileManager","brease/core/libs/AsyncProcess","brease/decorators/TooltipDependency"],function(e,BreaseEvent,VirtualEvents,Utils,Enum,Types,KeyActions,EventHandler,t,i,AsyncProcess,s){"use strict";var n={enable:!0,editable:!0,visible:!0,omitClass:!1,style:"default",stylePrefix:"",permissions:{view:!0,operate:!0},parentVisibleState:!0,parentEnableState:!0,tooltip:"",omitDisabledClick:!1,useFocusWithin:!1,focusable:!0,tabIndex:-1,additionalStyles:[]},BaseWidget=e.extend(function BaseWidget(t,i,s){e.call(this),Utils.defineProperty(this,"dependencies",{}),this.tooltip={},this.events={},this.internalData={isKeyDown:!1},this.initialized=!1,this.settings=void 0!==i&&null!==i?Utils.extendOptions(this.defaultSettings,i):Utils.deepCopy(this.defaultSettings),this.settings.className=this.constructor.defaults.className,null!==t&&void 0!==t&&(this.elem=t,this.applyTabIndexToDom(),this.el=$(t),this.internalData.id=this.elem.id),!0===this.constructor.static.multitouch&&this.el.attr("data-multitouch","true"),this.isDisabled=!1,this.isHidden=!1,this._cssClasses=!0===brease.config.editMode?["editMode","breaseWidget"]:["breaseWidget"],this._cssUpdates={},!0!==s&&(this.omitReadyEvent=!0,this.init())},n),a=new AsyncProcess,r=BaseWidget.prototype;r.init=function(e){this.omitReadyEvent=e,this._internalEnable(),this.updateVisibility(!0),Utils.isString(this.settings.position)&&(this._cssUpdates.position=this.settings.position,this._invalidate()),g(this),this.addInitialClass(this.getStyleAsClassName()),this.addClassNames(this._cssClasses),this._initEventHandler(),!0===brease.config.preLoadingState&&(this.internalData.preLoaded=!0),this._waitForBinding(),!0===brease.config.editMode&&this._initEditor()},r.deferredInit=function(e,t,i){this.el=$(t).prependTo(e),this.elem=this.el[0],this.internalData.id=this.elem.id,this.init(i)},r._initEditor=function(){this.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))},r.addClassNames=function(e){if(void 0!==this.elem&&e.length>0){var t=this.settings.stylePrefix,i=Array.prototype.filter.call(this.elem.classList,function(e){return!e.startsWith(t)});e.forEach(function(e){e.startsWith(t)||i.includes(e)||i.push(e)}),i.push(this.getStyleAsClassName()),this.elem.setAttribute("class",i.join(" "))}this.initialized=!0},r.setStyle=function(e){this.el.removeClass(this.getStyleAsClassName()),this.settings.style=e,this.el.addClass(this.getStyleAsClassName())},r.setAdditionalStyle=function(e){-1===this.settings.additionalStyles.indexOf(e)&&this.settings.additionalStyles.push(e),this.el.addClass(this._createStyleClass(e))},r.removeAdditionalStyle=function(e){var t=this.settings.additionalStyles.indexOf(e);t>=0&&this.settings.additionalStyles.splice(t,1),this.el.removeClass(this._createStyleClass(e))},r._createStyleClass=function(e){return this.settings.stylePrefix+"_style_"+e},r.getAdditionalStyles=function(){return this.settings.additionalStyles},r.getStyle=function(){return this.settings.style},r.getStyleAsClassName=function(){return this._createStyleClass(this.settings.style)},r.resetStyles=function(){this.el&&(this.el.removeClass(this.getStyleAsClassName()),Array.prototype.filter.call(this.elem.classList,function(e){return e.startsWith(this.settings.stylePrefix)},this).forEach(function(e){this.el.removeClass(e)},this),this.settings.style="default",this.el.addClass(this.getStyleAsClassName()))},r._invalidate=function(){this._cssRender()},r._defer=function(e){void 0===this.queue&&(this.queue=[]),-1===this.queue.indexOf(e)&&this.queue.push(e),!0!==this._updatePending&&(this._updatePending=!0,a.add(this._bind("_processDefered")))},r._processDefered=function(){this._updatePending=!1;for(var e=0,t=this.queue.length;e<t;e+=1)this[this.queue[e]]();this.queue.length=0},r._cssRender=function(){Object.keys(this._cssUpdates).length>0&&(this.el.css(this._cssUpdates),this._cssUpdates={})},r._setCSSUpdate=function(e,t,i,s,config){this.settings[i]=Types.parseValue(this.settings[i],s,config),this._cssUpdates[e]=this.settings[i]+t},r._setWidth=function(e){this.settings.width=e},r._setHeight=function(e){this.settings.height=e},r.addInitialClass=function(e){this._cssClasses.includes(e)||this._cssClasses.push(e)},r.removeInitialClass=function(e){var t=this._cssClasses.indexOf(e);-1!==t&&this._cssClasses.splice(t,1)},r.createEvent=function(e,t){if(this.settings.className&&null!==this.elem){if(void 0!==this.events[e])return this.events[e].setEventArgs(t),this.events[e];var s=i.getPathByClass(this.settings.className,"type");return this.events[e]=new EventHandler(s+".Event",this.elem.id,e,t,this.elem),this.events[e]}return console.iatWarn(this.internalData.id+"["+this.state+']:could not create Event "'+e+'", className='+this.settings.className+", this.elem defined: "+(null!==this.elem)),new EventHandler(EventHandler.DummyType)},r.createMouseEvent=function(e,t,i){t=t||{};var s=brease.pageController.getRootZoom();return _.isNumber(s)&&0!==s||(s=1),t.horizontalPos=i.clientX?Math.round(i.clientX/s)+"px":"0px",t.verticalPos=i.clientY?Math.round(i.clientY/s)+"px":"0px",this.createEvent(e,t)},r.dispatchServerEvent=function(e,t){this.createEvent(e,t).dispatch(!1)},r.disable=function(){!1===this.isDisabled&&(this.isDisabled=!0,!0!==this.initialized?this.addInitialClass("disabled"):(this.el.addClass("disabled"),this._enableHandler(!1)),this.applyTabIndexToDom(-1))},r.enable=function(){!0===this.isDisabled&&(this.isDisabled=!1,!0!==this.initialized?this.removeInitialClass("disabled"):(this.el.removeClass("disabled"),this._enableHandler(!0)),this.applyTabIndexToDom())},r.setEnable=function(e){var t=arguments[1];this.settings.enable=Types.parseValue(e,"Boolean"),this._internalEnable();var i=t?t.origin:void 0;"server"!==i&&"action"!==i&&this.sendValueChange({enable:this.getEnable()})},r._enableHandler=function(){},r._visibleHandler=function(){},r.setEditable=function(){},r.getEditable=function(){return this.settings.editable},r.getEnable=function(){return this.settings.enable},r.setVisible=function(e){var t=arguments[1];this.settings.visible=Types.parseValue(e,"Boolean"),this.updateVisibility();var i=t?t.origin:void 0;"server"!==i&&"action"!==i&&this.sendValueChange({visible:this.getVisible()})},r.getVisible=function(){return this.settings.visible},r.setParentCoWiId=function(e){this.settings.parentCoWiId=e},r.getParentCoWiId=function(){return this.settings.parentCoWiId},r.setTabIndex=function(e){this.settings.tabIndex=e,this.applyTabIndexToDom()},r.getTabIndex=function(){return this.settings.tabIndex},r.applyTabIndexToDom=function(e){var t=void 0!==e?e:this.settings.tabIndex;!brease.config.editMode&&this.settings.focusable&&(t>-1&&brease.config.visu.keyboardOperation?(this.elem.tabIndex=t,this._addKeyboardOperationListeners()):(this.elem.removeAttribute("tabIndex"),this._removeKeyboardOperationListeners()))},r.hasFocus=function(){return document.activeElement===this.elem||this.settings.useFocusWithin&&this.elem.contains(document.activeElement)},r._addKeyboardOperationListeners=function(){this._removeKeyboardOperationListeners(),this.addEventListener("keydown",this._bind("_handleFocusKeyDown")),this.addEventListener("keyup",this._bind("_handleFocusKeyUp")),this.settings.useFocusWithin?(this.addEventListener("focusin",this._bind(b)),this.addEventListener("focusout",this._bind(v))):(this.addEventListener("focus",this._bind(p)),this.addEventListener("blur",this._bind(f)))},r._removeKeyboardOperationListeners=function(){this.removeEventListener("keydown",this._getBound("_handleFocusKeyDown")),this.removeEventListener("keyup",this._getBound("_handleFocusKeyUp")),this.removeEventListener("focusin",this._getBound(b)),this.removeEventListener("focusout",this._getBound(v)),this.removeEventListener("focus",this._getBound(p)),this.removeEventListener("blur",this._getBound(f))},r._handleFocusKeyDown=function(e){KeyActions.getActionForKey(e.key)===Enum.KeyAction.Accept&&this.hasFocus()&&(this.internalData.isKeyDown=!0,m.call(this,BreaseEvent.MOUSE_DOWN,e))},r._handleFocusKeyUp=function(e){KeyActions.getActionForKey(e.key)===Enum.KeyAction.Accept&&this.hasFocus()&&(m.call(this,BreaseEvent.MOUSE_UP,e),this.internalData.isKeyDown&&(this.internalData.isKeyDown=!1,m.call(this,BreaseEvent.CLICK,e)))},r.focus=function(){if(brease.config.visu.keyboardOperation){if(!this.isFocusable())return null;this.elem.focus({preventScroll:!0})}},r.isFocusable=function(){return this.settings.focusable&&this.settings.tabIndex>-1&&this.isVisible()&&this.isEnabled()&&Utils.isVisible(this.elem)},r.getSettings=function(){return this.settings},r.getDefaultSettings=function(){return this.defaultSettings},r.isEnabled=function(){return!this.isDisabled},r.isVisible=function(){return!this.isHidden},r.addEventListener=function(e,t){this.elem&&this.elem.addEventListener(e,t)},r.removeEventListener=function(e,t){this.elem&&this.elem.removeEventListener(e,t)},r.dispatchEvent=function(e){try{this.elem.dispatchEvent(e)}catch(t){console.iatWarn(this.settings.className+"["+(this.elem?this.elem.id:"undefined elem")+"].dispatchEvent("+e.type+"):"+t.message)}},r.onBeforeSuspend=function(){},r.suspend=function(){for(var e in this.dependencies)this.dependencies[e].suspend()},r.wake=function(e,t,i){for(var s in this.dependencies)this.dependencies[s].wake(e[this.dependencies[s].event])},r.onBeforeDispose=function(){},r.dispose=function(t){this._removeKeyboardOperationListeners(),this.queue&&(this.queue.length=0);for(var i in this.events)this.events[i].dispose();this.events=null,this.el.off(),this.el.empty(),document.body.removeEventListener(BreaseEvent.BINDING_LOADED,this._getBound(d)),e.prototype.dispose.call(this),brease.uiController.setWidgetState(this.elem.id,Enum.WidgetState.NON_EXISTENT),document.body.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_DISPOSE,{detail:{id:this.elem.id,keepBindingInformation:t},bubbles:!0})),this.el.remove(),this.el=null,this.elem=null},r.sendValueChange=function(e){this.dispatchEvent(new CustomEvent(BreaseEvent.ATTRIBUTE_CHANGE,{detail:e,bubbles:!0})),this.elem&&brease.uiController.bindingController.attributeChangeForwarder({target:{id:this.elem.id},detail:e})},r.sendNodeChange=function(e){this.dispatchEvent(new CustomEvent(BreaseEvent.NODE_ATTRIBUTE_CHANGE,{detail:e,bubbles:!0})),this.elem&&brease.uiController.bindingController.nodeAttributeChangeForwarder({target:{id:this.elem.id},detail:e})},r._handleEvent=function(e,t){e.originalEvent&&e.originalEvent.preventDefault(),!0!==this.isDisabled&&!0!==t||e.stopImmediatePropagation()},r._dispatchReady=function(){this.elem&&brease.uiController.setWidgetState(this.elem.id,Enum.WidgetState.READY),this.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_READY,{detail:{widgetType:this.settings.className},bubbles:!0}))},r._initEventHandler=function(){this.el&&this.el.on(BreaseEvent.CLICK,this._bind("_clickHandler"))},r._clickHandler=function(e,t){if(this.isDisabled)this._disabledClickHandler(e,t);else{var i=o({},t,e.target);this.createMouseEvent("Click",i,e).dispatch(!1)}};function o(e,t,i){var s=_.assign(e,t);return Utils.isString(s.origin)||(s.origin=brease.uiController.parentWidgetId(i)),s}r._disabledClickHandler=function(e,t){if(!this.settings.omitDisabledClick){var i=o({hasPermission:this.settings.editable&&this.settings.permissions.operate},t,e.target),s=this.createMouseEvent("DisabledClick",i,e);s.dispatch(!1);var n=new CustomEvent(BreaseEvent.DISABLED_CLICK,{detail:{contentId:this.getParentContentId(),hasPermission:i.hasPermission,origin:i.origin,widgetId:this.elem.id,horizontalPos:s.data.eventArgs.horizontalPos,verticalPos:s.data.eventArgs.verticalPos},bubbles:!0});l.call(this,n,e),document.body.dispatchEvent(n),this._handleEvent(e)}};function l(e,t){Utils.transferProperties(t,e,["clientX","clientY","pageX","pageY","screenX","screenY"])}r._internalEnable=function(){c.call(this)},r.updateVisibility=function(e){u.call(this,this.settings.visible,this.settings.permissions.view,this.settings.parentVisibleState,brease.config.editMode,e),this._visibleHandler(this.isVisible())},r.setParentVisibleState=function(e){this.settings.parentVisibleState=e,this.updateVisibility()},r.setParentEnableState=function(e){this.settings.parentEnableState=e,this._internalEnable()},r._waitForBinding=function(){void 0===this.getParentContentId()||this.getParentContentId()===brease.settings.globalContent?this._initialValueHandling():brease.uiController.bindingController.isBindingLoaded(this.getParentContentId())?this._initialValueHandling(brease.uiController.bindingController.getSubscriptionsForElement(this.elem.id)):document.body.addEventListener(BreaseEvent.BINDING_LOADED,this._bind(d))},r._initialValueHandling=function(e){this.bindings=e},r.getParentContentId=function(){return this.settings.parentContentId},r.setOmitDisabledClick=function(e){this.settings.omitDisabledClick=e},r.getOmitDisabledClick=function(){return this.settings.omitDisabledClick};function d(e){e.detail.contentId===this.getParentContentId()&&(document.body.removeEventListener(BreaseEvent.BINDING_LOADED,this._getBound(d)),this._initialValueHandling(brease.uiController.bindingController.getSubscriptionsForElement(this.elem.id)))}function c(){var e=this.isDisabled;!0==(!0!==this.settings.enable||!0!==this.settings.editable||!0!==this.settings.permissions.operate||!0!==this.settings.parentEnableState)?(h.call(this,!1,!e,BreaseEvent.BEFORE_ENABLE_CHANGE),this.disable()):(h.call(this,!0,!e,BreaseEvent.BEFORE_ENABLE_CHANGE),this.enable()),this.isDisabled!==e&&this.createEvent(BreaseEvent.ENABLE_CHANGED,{value:!this.isDisabled}).dispatch()}function h(e,t,i){e!==t&&this.dispatchEvent(new CustomEvent(i,{detail:{value:e},bubbles:!0}))}function u(e,t,i,s,n){if(!0!==s){var a=this.isHidden;!0===(!0!==e||!0!==t||!0!==i)?(h.call(this,!1,!a,BreaseEvent.BEFORE_VISIBLE_CHANGE),n?this.addInitialClass("remove"):!1===this.isHidden&&this.el.addClass("remove"),this.isHidden=!0):(h.call(this,!0,!a,BreaseEvent.BEFORE_VISIBLE_CHANGE),n||(!0===this.isHidden&&this.el.removeClass("remove"),this.isHidden=!1)),this.isHidden!==a&&this.createEvent(BreaseEvent.VISIBLE_CHANGED,{value:!this.isHidden}).dispatch()}}function g(e){e.settings.stylePrefix||(void 0===e.constructor.defaults.stylePrefix&&(e.constructor.defaults.stylePrefix=i.getPathByClass(e.settings.className,"style")),e.settings.stylePrefix=e.constructor.defaults.stylePrefix)}function m(e,t){var i=this.elem.getBoundingClientRect(),s=new MouseEvent(e.substring(1),{bubbles:!0,cancelable:!0,clientX:i.left,clientY:i.top,view:window});s.originalEvent=t,VirtualEvents.triggerVirtualEvent(this.elem,e,s,{pointerId:0})}function p(){this.createEvent(BreaseEvent.FOCUS_IN).dispatch()}function f(e){this.internalData.isKeyDown&&(this.internalData.isKeyDown=!1,m.call(this,BreaseEvent.MOUSE_UP,e)),this.createEvent(BreaseEvent.FOCUS_OUT).dispatch()}function b(){this.elem.classList.contains("focusWithin")||(this.elem.classList.add("focusWithin"),this.createEvent(BreaseEvent.FOCUS_IN).dispatch())}function v(e){this.internalData.isKeyDown&&(this.internalData.isKeyDown=!1,m.call(this,BreaseEvent.MOUSE_UP,e)),this.elem.contains(e.relatedTarget)||(this.elem.classList.remove("focusWithin"),this.createEvent(BreaseEvent.FOCUS_OUT).dispatch())}return t.decorate(BaseWidget,!0!==brease.config.editMode,{permissions:{view:{property:"permissionView",updateMethod:"updateVisibility"},operate:{property:"permissionOperate",updateMethod:"_internalEnable"}}}),s.decorate(BaseWidget,!0),BaseWidget}),define("widgets/brease/Window/libs/Config",["brease/enum/Enum"],function(Enum){"use strict";return{html:"widgets/brease/Window/Window.html",modal:!0,arrow:{show:!1,width:12,position:Enum.Position.left},forceInteraction:!1,showCloseButton:!0,position:{horizontal:"center",vertical:"middle"},pointOfOrigin:Enum.PointOfOrigin.APP,headerHeight:42,autoRaise:Enum.AutoRaise.ENABLED}}),define("widgets/brease/Window/libs/DragHandler",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var DragHandler=function(n){this.start=e.bind(this,n),this.headerMoveHandler=t.bind(this,n),this.headerUpHandler=s.bind(this,n),this.updatePosition=i.bind(this,n);var a=window.devicePixelRatio>1?window.devicePixelRatio:1;this.tolerance=40*a};DragHandler.prototype.dispose=function(){this.active=!1,window.cancelAnimationFrame(this.animationFrame),brease.bodyEl.off(BreaseEvent.MOUSE_MOVE,this.headerMoveHandler),brease.bodyEl.off(BreaseEvent.MOUSE_UP,this.headerUpHandler),this.start=null,this.headerMoveHandler=null,this.headerUpHandler=null,this.updatePosition=null};function e(e,t){brease.bodyEl.on(BreaseEvent.MOUSE_MOVE,this.headerMoveHandler),brease.bodyEl.on(BreaseEvent.MOUSE_UP,this.headerUpHandler),this.startPoint={left:t.pageX,top:t.pageY};var i=e.el.css(["left","top"]);this.startWidget=this.actPos={left:parseInt(i.left,10),top:parseInt(i.top,10)},this.boundary={top:0,right:window.innerWidth-this.tolerance,bottom:window.innerHeight-e.header.height()*e.dimensions.scale,left:this.tolerance-e.dimensions.width*e.dimensions.scale}}function t(e,t){var i={left:this.startWidget.left+(t.pageX-this.startPoint.left),top:this.startWidget.top+(t.pageY-this.startPoint.top)};if(i.left<this.boundary.left||i.left>this.boundary.right||i.top<this.boundary.top||i.top>this.boundary.bottom)return this.newPos||(this.newPos={left:this.startWidget.left,top:this.startWidget.top}),void 0;this.newPos=i,this.active||(this.active=!0,this.animationFrame=window.requestAnimationFrame(this.updatePosition))}function i(e){this.actPos.left===this.newPos.left&&this.actPos.top===this.newPos.top||(e.el.css(this.newPos),this.actPos={left:this.newPos.left,top:this.newPos.top}),this.active&&(this.animationFrame=window.requestAnimationFrame(this.updatePosition))}function s(){this.active=!1,brease.bodyEl.off(BreaseEvent.MOUSE_MOVE,this.headerMoveHandler),brease.bodyEl.off(BreaseEvent.MOUSE_UP,this.headerUpHandler),window.cancelAnimationFrame(this.animationFrame)}return DragHandler}),define("brease/decorators/LanguageDependency",["brease/core/Decorator","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,BreaseEvent,Enum){"use strict";var LanguageDependency=function LanguageDependency(){this.initType=Decorator.TYPE_PRE},e="language",t="language",i="langChangeHandler";LanguageDependency.prototype=new Decorator,LanguageDependency.prototype.constructor=LanguageDependency;var s=new LanguageDependency;s.methodsToAdd={init:function(r){if(void 0===this[i])throw new Error("widget »"+this.elem.id+'«: decoration with "'+s.constructor.name+'" requires method "'+i+'"');this.dependencies[e]={state:Enum.Dependency.INACTIVE,stored:{},suspend:n.bind(this),wake:a.bind(this),event:t},!0===r&&this.setLangDependency(r)},setLangDependency:function(e){!0===e?r.call(this,Enum.Dependency.ACTIVE):r.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,l.call(this)}};function n(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored.code=brease.language.getCurrentLanguage(),this.dependencies[e].stored.version=brease.language.getCurrentVersion(),r.call(this,Enum.Dependency.SUSPENDED))}function a(t){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(r.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored.code===brease.language.getCurrentLanguage()&&this.dependencies[e].stored.version===brease.language.getCurrentVersion()||this[i](t))}function r(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?o.call(this):l.call(this))}function o(){document.body.addEventListener(BreaseEvent.LANGUAGE_CHANGED,this._bind(i))}function l(){document.body.removeEventListener(BreaseEvent.LANGUAGE_CHANGED,this._bind(i))}return s}),
define("widgets/brease/Window/Window",["brease/core/BaseWidget","widgets/brease/Window/libs/Config","widgets/brease/Window/libs/DragHandler","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/decorators/LanguageDependency","brease/controller/PopUpManager"],function(e,t,DragHandler,BreaseEvent,Enum,Utils,i,s){"use strict";var n=t,a=e.extend(function Window(t,i,s,n){e.call(this,t,i,void 0===s||s,!0),this.readyDeferred=$.Deferred(),!0!==n&&C(this)},n),r=a.prototype;r.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseWindow"),this.settings.stylePrefix=this.settings.stylePrefix||this.el.attr("data-brease-widget"),this.settings.className=this.settings.className||this.el.attr("data-brease-widget"),e.prototype.init.apply(this,arguments),this.arrow=this.el.find(".breaseWindowArrow"),this.closeButton=this.el.find(".breaseWindowClose"),this.header=this.el.find("> header"),this.dimensions={scale:1},this.settings.parentContentId=brease.settings.globalContent,this.instanceSettings=Utils.deepCopy(this.settings),this.debouncedHide=_.debounce(this._bind("onBeforeHide"),10),this.dragHandler=new DragHandler(this)},r.langChangeHandler=function(){this._setContent()},r.show=function(e,t){var i=this;this.closeDeferred=$.Deferred(),s.addWindow(i.elem.id,i.settings.windowType),this.refElement=t?t.jquery?t:$(t):void 0,this.el.removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),this.settings=$.extend(!0,{},this.instanceSettings,e),void 0!==this.settings.header&&brease.language.isKey(this.settings.header.text)&&(this.settings.header.textkey=brease.language.parseKey(this.settings.header.text)),void 0!==this.settings.content&&brease.language.isKey(this.settings.content.text)&&(this.settings.content.textkey=brease.language.parseKey(this.settings.content.text));var n=s.getHighestZindex();this.el.css({display:"block","z-index":n+2}),this._setModal(n),void 0!==this.settings.cssClass&&this.el.addClass(this.settings.cssClass),this.setStyle(this.settings.style),this._setCloseButton(),this._setDimensions(),this._setContent(),this._setPosition(),this._afterCalculationHook(),S(),brease.bodyEl.on(BreaseEvent.CLICK+" "+BreaseEvent.DISABLED_CLICK,i._bind("_documentClickHandler")),this.dispatchEvent(new CustomEvent(BreaseEvent.WINDOW_SHOW,{detail:{id:this.elem.id},bubbles:!0})),this.header.on(BreaseEvent.MOUSE_DOWN,this._bind("_headerDownHandler")),this.settings.autoRaise===Enum.AutoRaise.ENABLED&&this.el.on(BreaseEvent.MOUSE_DOWN,this._bind("_windowInFrontHandler"))},r._afterCalculationHook=function(){},r.closeOnLostContentListener=function(){this.onBeforeHide()},r.closeOnLostContent=function(e){this.opener=brease.pageController.getLoaderForElement(e),this.opener&&this.opener.addEventListener(BreaseEvent.FRAGMENT_HIDE,this._bind("closeOnLostContentListener"))},r.removeCloseOnLostContent=function(){this.opener&&(this.opener.removeEventListener(BreaseEvent.FRAGMENT_HIDE,this._bind("closeOnLostContentListener")),this.opener=void 0)},r.setModal=function(e){if(this.settings.modal=e,!1===e)this._removeModal();else if(!this.dimmer){var t=s.getHighestZindex();this._setModal(t)}},r.setForceInteraction=function(e){this.settings.forceInteraction=e},r.onBeforeHide=function(){this.hide()},r.hide=function(){var e=this;this.el.css({display:"none"}),void 0!==this.settings.cssClass&&this.el.removeClass(this.settings.cssClass),this.resetStyles(),brease.bodyEl.off(BreaseEvent.CLICK+" "+BreaseEvent.DISABLED_CLICK,e._bind("_documentClickHandler")),this.removeCloseOnLostContent(),this._removeModal(),s.removeWindow(e.elem.id),this.refElement=null,this.dispatchEvent(new CustomEvent(BreaseEvent.CLOSED,{detail:{id:this.elem.id},bubbles:!0})),this.closeDeferred&&this.closeDeferred.resolve(),this.header.off(BreaseEvent.MOUSE_DOWN,this._bind("_headerDownHandler")),this.el.off(BreaseEvent.MOUSE_DOWN,this._bind("_windowInFrontHandler")),this.closeButton.off(BreaseEvent.CLICK,this._bind("_closeButtonClickhandler")),A.call(this),d=void 0},r._removeModal=function(){this.dimmer&&(this.dimmer.removeClass("active"),this.dimmer.hide(),S(),o(this))};function o(e){var t=e._bind(c);e.dimmer[0].removeEventListener("pointerdown",t,!0),e.dimmer[0].removeEventListener("pointerup",t,!0),e.dimmer[0].removeEventListener("touchstart",t,!BreaseEvent.support.options||{capture:!0,passive:!0}),e.dimmer[0].removeEventListener("touchend",t,!0),e.dimmer[0].removeEventListener("mousedown",t,!0),e.dimmer[0].removeEventListener("mouseup",t,!0),e.dimmer.off(BreaseEvent.CLICK,e._bind("_dimmerClickHandler"))}function l(e){var t=e._bind(c);e.dimmer[0].addEventListener("pointerdown",t,!0),e.dimmer[0].addEventListener("pointerup",t,!0),e.dimmer[0].addEventListener("touchstart",t,!BreaseEvent.support.options||{capture:!0,passive:!0}),e.dimmer[0].addEventListener("touchend",t,!0),e.dimmer[0].addEventListener("mousedown",t,!0),e.dimmer[0].addEventListener("mouseup",t,!0),e.dimmer.on(BreaseEvent.CLICK,e._bind("_dimmerClickHandler"))}var d;function c(e){var t=!0;"mouseup"===e.type&&d&&$.containsOrEquals(this.elem,d)&&(t=!1,d=void 0),!0===t&&(e.stopPropagation(),e.stopImmediatePropagation())}r._setArrow=function(e,t,i,s,n,a,r,o){var l=12,d=0;switch(this.arrow.length>0?this.arrow.show():this._addArrow(),this.el.removeClass("arrowRight arrowLeft arrowTop arrowBottom"),this.settings.arrow.position){case Enum.Position.right:this.el.addClass("arrowRight"),d=12+parseInt(this.el.css("border-right"),10);break;case Enum.Position.left:this.el.addClass("arrowLeft"),d=12+parseInt(this.el.css("border-left"),10);break;case Enum.Position.top:this.el.addClass("arrowTop"),d=12+parseInt(this.el.css("border-top"),10);break;case Enum.Position.bottom:this.el.addClass("arrowBottom"),d=12+parseInt(this.el.css("border-bottom"),10);break}void 0!==this.arrow&&!0===e&&h.call(this,d,a,n,r,o,t,i,s)};function h(e,t,i,s,n,a,r,o){var l={},d=brease.pageController.getRootZoom();if("middle"===this.settings.position.vertical){var c=Math.abs(t-a.top)-parseInt(this.el.css("border-top-width"),10)-this.settings.arrow.width+o/2*d;c<0&&(c=0),c+2*this.settings.arrow.width>n&&(c=n-2*this.settings.arrow.width),l.top=c/this.dimensions.scale+"px",this.settings.arrow.position===Enum.Position.left?(l.left=-e+"px",l.right=""):(l.right=-e+"px",l.left="")}else{var h=Math.abs(i-a.left)-this.settings.arrow.width+r/2;h<0&&(h=0),h+2*this.settings.arrow.width>s&&(h=s-2*this.settings.arrow.width),l.left=h+"px",this.settings.arrow.position===Enum.Position.top?(l.top=-e+"px",l.bottom=""):(l.bottom=-e+"px",l.top="")}this.arrow.css(l)}r._setDimensions=function(){if(void 0!==this.settings.width?(this.el.css("width",this.settings.width+"px"),this.dimensions.width=this.settings.width):(this.el.css("width","auto"),this.dimensions.width=this.el.outerWidth()),void 0!==this.settings.height){this.el.css("height",this.settings.height+"px");var e=parseInt(this.el.css("border-bottom"),10);this.el.find(".contentBox").css("height",this.settings.height-this.el.find("header").height()-(isNaN(e)?0:e)),this.dimensions.height=this.settings.height}else this.el.css("height","auto"),this.dimensions.height=this.el.outerHeight();this.settings.scale2fit&&this._scale2fit()},r._scale2fit=function(){var e=s.getDimensions(),t=1;(this.dimensions.width>e.winWidth||this.dimensions.height>e.winHeight)&&(t=Math.min(e.winWidth/this.dimensions.width,e.winHeight/this.dimensions.height)),this._applyScale(t)},r._applyScale=function(e){this.dimensions.scale=e,1!==e?this.el.css({transform:"scale("+e+","+e+")","transform-origin":"0 0"}):this.el.css({transform:"none"})},r._setCloseButton=function(){!0===this.settings.showCloseButton?this.closeButton.length>0?(this.closeButton.show(),u.call(this)):this._addCloseButton():this.closeButton.hide()},r._setContent=function(){var e=this.settings.header?this.settings.header.textkey?brease.language.getTextByKey(this.settings.header.textkey):this.settings.header.text:"";void 0===this.headerEl&&(this.headerEl=this.el.find("header > div")),this.headerEl.text(e);var t=this.settings.content?this.settings.content.textkey?brease.language.getTextByKey(this.settings.content.textkey):this.settings.content.text:"";this.el.find(".content").text(t)},r.getElemExtension=function(){return{left:0,right:0,top:0,bottom:0}},r._setPosition=function(){var e=0,t,i=this.elem.getBoundingClientRect(),n=this.getElemExtension(i,this.settings.style),a=i.width,r=i.height,o=s.getDimensions(),l=this.settings.pointOfOrigin===Enum.PointOfOrigin.WINDOW,d=E(this.settings.pointOfOrigin,this.refElement,!0===l?o.winWidth:o.appWidth),c=I(this.settings.pointOfOrigin,this.refElement,!0===l?o.winHeight:o.appHeight),h=this.settings.pointOfOrigin===Enum.PointOfOrigin.ELEMENT&&void 0!==this.refElement,u,g,m;if(this.settings.position.hasOwnProperty("horizontalDialog")?(m=x(this.settings.pointOfOrigin,this.refElement),t=b(this.settings,a,r,m,d,c)):(m=w(this.settings.pointOfOrigin,this.refElement),t=f(this.settings,a,r,m,d,c,h)),t=y(t,a,r,n,this.settings.pointOfOrigin),e=this._getOffset(),u=t.x+e,g=t.y+e,this.settings.position.hasOwnProperty("horizontalDialog")){var p=brease.pageController.getRootZoom();this.el.css({display:"block",position:"fixed",left:u+"px",top:g+"px",transform:"scale("+p+", "+p+")",margin:0,"margin-left":"0","margin-top":"0"})}else u=Math.round(u),g=Math.round(g),this.el.css({display:"block",position:"fixed",left:u+"px",top:g+"px",margin:0,"margin-left":"0","margin-top":"0"});!1===this.settings.arrow.show?this.arrow.hide():this._setArrow(h,m,d,c,t.x+e,t.y+e,a,r)},r._getOffset=function(){return 0},r._addArrow=function(){this.arrow=$("<i/>").addClass("breaseWindowArrow"),this.el.append(this.arrow)},r._addCloseButton=function(){this.closeButton=$("<a/>").addClass("breaseWindowClose"),this.el.find("header").append(this.closeButton),u.call(this)};function u(){var e=this;e._addCloseListenerTimeout=window.setTimeout(function(){e.isDisposed()||e.closeButton.on(BreaseEvent.CLICK,e._bind("_closeButtonClickhandler"))},0)}r._closeButtonClickhandler=function(e){this._handleEvent(e,!0),this.debouncedHide()},r._setModal=function(e){!0===this.settings.modal&&(void 0===this.dimmer&&(this.dimmer=$("<div/>").attr("id",Utils.uniqueID("dimmer")).addClass("breaseModalDimmer").appendTo(document.body)),this.dimmer.css({"z-index":e+1,display:"block"}),l(this),D.call(this))},r._documentClickHandler=function(e){if(!0!==this.settings.forceInteraction){var t=Utils.isNumeric(e.clientX)&&Utils.isNumeric(e.clientY)?document.elementFromPoint(e.clientX,e.clientY):e.target;p.call(this,t)||m(this.el,$(e.target))||g.call(this,e.target)||$.containsOrEquals(this.elem,t)||this.debouncedHide()}};function g(e){return!!this.refElement&&$.containsOrEquals(this.refElement[0],e)}function m(e,t){var i=parseFloat(e.css("z-index")),s=parseFloat(t.css("z-index"));return s=isNaN(s)?0:s,s>i}function p(e){for(var t=s.overlays(this.elem.id),i=0,n=t.length;i<n;i+=1)if(!1!==$.containsOrEquals(document.getElementById(t[i]),e))return!0;return!1}r._clickHandler=function(e){e.stopPropagation()},r._dimmerClickHandler=function(e){!0!==this.settings.forceInteraction&&"none"!==this.el.css("display")&&this.debouncedHide(),e.stopPropagation()},r._windowInFrontHandler=function(e){if(-1!==e.type.indexOf("mousedown")&&(d=e.target),!(s.getNumberOfWindowsOfType("NumPad")>0)){var t=s.getHighestZindex();t>parseInt(this.el.css("z-index"),10)+1&&(this.dimmer?(this.dimmer.css({"z-index":t+1}),this.el.css({display:"block","z-index":t+2}),s.updateIndex(this.elem.id,t+2)):(this.el.css({display:"block","z-index":t+1}),s.updateIndex(this.elem.id,t+1)))}},r._headerDownHandler=function(e){e.target!==this.closeButton[0]&&this.dragHandler.start(e)},r.dispose=function(){this.header&&this.header.off(),this.closeButton&&this.closeButton.off(),brease.bodyEl.off(BreaseEvent.CLICK+" "+BreaseEvent.DISABLED_CLICK,this._bind("_documentClickHandler")),this.dimmer&&this.dimmer.remove(),this.debouncedHide.cancel(),this.removeCloseOnLostContent(),this.closeDeferred=null,window.clearTimeout(this._addCloseListenerTimeout),e.prototype.dispose.apply(this,arguments)},r.isReady=function(){return this.readyDeferred.promise()},r.onClose=function(){return this.closeDeferred.promise()},r.readyHandler=function(){brease.uiController.addWidget(this),this.readyDeferred.resolve(this),this._dispatchReady()};function f(e,t,i,s,n,a,r){var o={x:0,y:0},l=brease.pageController.getRootZoom();if(!0===r){switch(e.position.horizontal){case Enum.Position.left:o.x=s.left-t;break;case Enum.Position.right:o.x=s.left+n;break;default:o.x=s.left+n/2-t/2;break}switch(e.position.vertical){case Enum.Position.top:o.y=s.top-i;break;case Enum.Position.bottom:o.y=s.top+a;break;default:o.y=s.top+a/2-40;break}o=v(o,e)}else{if(_.isNumber(e.position.horizontal))o.x=s.left+l*e.position.horizontal;else switch(e.position.horizontal){case Enum.Position.left:o.x=s.left;break;case Enum.Position.right:o.x=s.left+n-t;break;default:o.x=s.left+(n-t)/2;break}if(_.isNumber(e.position.vertical))o.y=s.top+l*e.position.vertical;else switch(e.position.vertical){case Enum.Position.top:o.y=s.top;break;case Enum.Position.bottom:o.y=s.top+a-i;break;default:o.y=s.top+(a-i)/2;break}}return o}function b(e,t,i,s,n,a){var r={x:0,y:0};if(e.position.horizontal===Enum.Position.left)switch(e.position.horizontalDialog){case Enum.Position.left:r.x=s.left;break;case Enum.Position.right:r.x=s.left-t;break;default:r.x=s.left-t/2;break}else if(e.position.horizontal===Enum.Position.right)switch(e.position.horizontalDialog){case Enum.Position.left:r.x=s.left+n;break;case Enum.Position.right:r.x=s.left+n-t;break;default:r.x=s.left+n-t/2;break}else switch(e.position.horizontalDialog){case Enum.Position.left:r.x=s.left+n/2;break;case Enum.Position.right:r.x=s.left+n/2-t;break;default:r.x=s.left+n/2-t/2;break}if(e.position.vertical===Enum.Position.top)switch(e.position.verticalDialog){case Enum.Position.top:r.y=s.top;break;case Enum.Position.bottom:r.y=s.top-i;break;default:r.y=s.top-i/2;break}else if(e.position.vertical===Enum.Position.bottom)switch(e.position.verticalDialog){case Enum.Position.top:r.y=s.top+a;break;case Enum.Position.bottom:r.y=s.top+a-i;break;default:r.y=s.top+a-i/2;break}else switch(e.position.verticalDialog){case Enum.Position.top:r.y=s.top+a/2;break;case Enum.Position.bottom:r.y=s.top+a/2-i;break;default:r.y=s.top+a/2-i/2;break}return r}function v(e,t){switch(t.arrow.position){case Enum.Position.top:e.y+=t.arrow.width,e.y+=void 0!==t.position.offset?t.position.offset:0;break;case Enum.Position.bottom:e.y-=t.arrow.width,e.y-=void 0!==t.position.offset?t.position.offset:0;break;case Enum.Position.right:e.x-=t.arrow.width,e.x-=void 0!==t.position.offset?t.position.offset:0;break;default:e.x+=t.arrow.width,e.x+=void 0!==t.position.offset?t.position.offset:0;break}return e}function y(e,t,i,n,a){var r=s.getDimensions(),o=brease.appElem.getBoundingClientRect(),l=a!==Enum.PointOfOrigin.WINDOW?Math.min(E(Enum.PointOfOrigin.APP,void 0,o.width),r.winWidth):r.winWidth,d=a!==Enum.PointOfOrigin.WINDOW?Math.min(I(Enum.PointOfOrigin.APP,void 0,o.height),r.winHeight):r.winHeight;return e.x+t+n.right>l&&(e.x=l-(t+n.right)),e.x-n.left<0&&(e.x=n.left),e.y+i+n.bottom>d&&(e.y=d-(i+n.bottom)),e.y-n.top<0&&(e.y=n.top),e}function w(e,t){if(void 0!==t&&e!==Enum.PointOfOrigin.APP&&e!==Enum.PointOfOrigin.WINDOW){var i=t[0].getBoundingClientRect();return{top:i.top,left:i.left}}return{top:0,left:0}}function x(e,t){return void 0!==t&&e!==Enum.PointOfOrigin.APP&&e!==Enum.PointOfOrigin.WINDOW?t.offset():{top:0,left:0}}function E(e,t,i){return void 0!==t&&e!==Enum.PointOfOrigin.APP&&e!==Enum.PointOfOrigin.WINDOW?t[0].getBoundingClientRect().width:i>100?i:window.innerWidth}function I(e,t,i){return void 0!==t&&e!==Enum.PointOfOrigin.APP&&e!==Enum.PointOfOrigin.WINDOW?t[0].getBoundingClientRect().height:i>100?i:window.innerHeight}function C(e){require(["text!"+e.settings.html],function(t){var i=e.settings.id||Utils.uniqueID("window");t=t.replace("WIDGETID",i),e.deferredInit(document.body,t),e.headerEl=e.el.find("header > div"),e.readyHandler(),brease.uiController.parse(e.elem)})}function S(){for(var e,t=0,i,s,n=$(".breaseModalDimmer:visible"),a=0;a<n.length;a+=1)i=$(n[a]),i.removeClass("active"),e=parseInt(i.css("z-index"),10),e>t&&(t=e,s=i);s&&s.addClass("active")}var T;function D(){this.dimmer.on("mousewheel DOMMouseScroll",L),T||(T={x:brease.bodyEl.css("overflow-x"),y:brease.bodyEl.css("overflow-y")}),document.body.style.overflow="hidden"}function A(){0===$(".breaseModalDimmer:visible").length&&this.dimmer&&(this.dimmer.off("mousewheel DOMMouseScroll",L),brease.bodyEl.css("overflow-x",T.x),brease.bodyEl.css("overflow-y",T.y))}function L(e){e.preventDefault()}return i.decorate(a,!0)}),define("brease/decorators/MeasurementSystemDependency",["brease/core/Decorator","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,BreaseEvent,Enum){"use strict";var MeasurementSystemDependency=function(){this.initType=Decorator.TYPE_PRE},e="mms",t="mms",i="measurementSystemChangeHandler";MeasurementSystemDependency.prototype=new Decorator,MeasurementSystemDependency.prototype.constructor=MeasurementSystemDependency;var s=new MeasurementSystemDependency;s.methodsToAdd={init:function(t){if(void 0===this[i])throw new Error("widget »"+this.elem.id+'«: decoration with "'+s.constructor.name+'" requires method "'+i+'"');this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:n.bind(this),wake:a.bind(this),event:"mms"},!0===t&&this.setMeasurementSystemDependency(t)},setMeasurementSystemDependency:function(e){!0===e?r.call(this,Enum.Dependency.ACTIVE):r.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,l.call(this)}};function n(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored=brease.measurementSystem.getCurrentMeasurementSystem(),r.call(this,Enum.Dependency.SUSPENDED))}function a(t){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(r.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored!==brease.measurementSystem.getCurrentMeasurementSystem()&&this[i](t))}function r(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?o.call(this):l.call(this))}function o(){document.body.addEventListener(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,this._bind(i))}function l(){document.body.removeEventListener(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,this._bind(i))}return s}),define("brease/events/EventDispatcher",["brease/core/Utils"],function(Utils){"use strict";var EventDispatcher=function EventDispatcher(){},e=EventDispatcher.prototype;e.getListeners=function(){return this._listeners||(this._listeners={}),this._listeners},e.addData=function(e,t,i){this._data||(this._data={}),void 0===this._data[e]&&(this._data[e]={}),this._data[e][t]=i},e.getData=function(e,t){return this._data&&void 0!==this._data[e]?this._data[e][t]:void 0},e.addEventListener=function(e,t,i,s){if(Utils.isString(e)&&""!==e){var n=this.getListeners();void 0===n[e]&&(n[e]=[]),s&&this.addData(e,t,s),-1===n[e].indexOf(t)&&(!0===i?n[e].unshift(t):n[e].push(t))}},e.hasEventListener=function(e,t){var i=this.getListeners();return void 0!==i[e]&&-1!==i[e].indexOf(t)},e.hasListenersOfType=function(e){var t=this.getListeners();return void 0!==t&&void 0!==t[e]&&t[e].length>0},e.removeEventListener=function(e,i){var s=this.getListeners();if("function"==typeof i){if(s[e]){var n=s[e].indexOf(i);this.getData(e,i)&&t.call(this,e,i),-1!==n&&s[e].splice(n,1)}}else s[e]=[]},e.dispatchEvent=function(e,t){var i=this,s=void 0!==t?t:e.type;if(Utils.isString(s)&&""!==s){void 0===e.type&&(e.type=s);var n=this.getListeners()[s];void 0!==n&&n.slice(0).forEach(function(t){var n=i.getData(s,t);n&&(e.data=n),t(e)})}};function t(e,t){void 0!==this._data[e]&&(this._data[e][t]=void 0)}return EventDispatcher}),define("system/widgets/NumPad/libs/NumPadSlider",["brease/events/BreaseEvent","brease/core/Utils","brease/core/Types","brease/enum/EnumObject","brease/events/EventDispatcher","libs/d3/d3"],function(BreaseEvent,Utils,Types,EnumObject,EventDispatcher,e){"use strict";var NumPadSlider=function(e){this.el=e,this.init()};NumPadSlider.TRACKCLICKBEHAVIOR=new EnumObject({changeValueByInterval:"changeValueByInterval",changeValueToClickPoint:"changeValueToClickPoint"}),NumPadSlider.createInstances=function(e){var t=[],i=e.find(".breaseNumpadSlider");return i.length>0&&i.each(function(){t.push(new NumPadSlider($(this)))}),t},NumPadSlider.defaultSettings={numberFormat:{decimalPlaces:1},tickPadding:12,axisHeight:50,axisPadding:30,thumbHeight:62,trackPadding:5,arrowHeight:6,arrowMargin:3,boxHeight:42},NumPadSlider.elementOptions={thumbSize:{type:"UInteger",default:22},trackSize:{type:"UInteger",default:6},majorTicks:{type:"UInteger",default:5},minorTicks:{type:"UInteger",default:0},showTicks:{type:"Boolean",default:!1},showTickNumbers:{type:"Boolean",default:!1},showValueDisplay:{type:"Boolean",default:!0},trackClickBehavior:{type:"Enum",default:NumPadSlider.TRACKCLICKBEHAVIOR.changeValueByInterval,enum:NumPadSlider.TRACKCLICKBEHAVIOR}};for(var t in NumPadSlider.elementOptions)NumPadSlider.defaultSettings[t]=NumPadSlider.elementOptions[t].default;NumPadSlider.prototype=new EventDispatcher,NumPadSlider.prototype.init=function(){this.settings=$.extend({},NumPadSlider.defaultSettings,o(this.el)),l.call(this),this.settings.width=this.track.outerWidth(),this.settings.zoomFactor=f.call(this),!0!==this.settings.showTicks&&!0!==this.settings.showTickNumbers||s.call(this),d.call(this)},NumPadSlider.prototype.dispose=function(){this.el=void 0,this.thumb&&(this.thumb.off(),this.thumb=void 0),this.track&&(this.track.off(),this.track=void 0),this.outputVal=void 0},NumPadSlider.prototype.getLimit=function(e,t,i){return isNaN(e)||null===e?e:(e<t&&(e=t),e>i&&(e=i),e-0)},NumPadSlider.prototype.update=function(){this.settings.zoomFactor=f.call(this),this.updateTickAxis()},NumPadSlider.prototype.updateTickAxis=function(){var e=this.getNrOfMajorTicks(),t=this.getNrOfMinorTicks(e,this.settings.minorTicks),config={minValue:this.settings.minValue,maxValue:this.settings.maxValue,numberFormat:this.settings.numberFormat,useDigitGrouping:this.settings.useDigitGrouping,separators:this.settings.separators},i=this.calcMajorTickValues($.extend(config,{ticks:e})),s=this.calcMinorTickValues($.extend(config,{ticks:t}));s=s.filter(function(e){return!i.includes(e)}),a.call(this,s,config),n.call(this,i,config)},NumPadSlider.prototype.calcMajorTickValues=function(config){if(!c(config)||config.ticks<2)return[];for(var e=(config.maxValue-config.minValue)/(config.ticks-1),t=[],s=0;s<config.ticks;s+=1)t[s]=i(config.minValue+s*e,config);return t},NumPadSlider.prototype.calcMinorTickValues=function(config){if(0===config.ticks)return[];if(1===config.ticks)return[0];for(var e=(config.maxValue-config.minValue)/(config.ticks-1),t=[],s=0;s<config.ticks;s+=1)t[s]=i(config.minValue+s*e,config);return t};function i(e,config){var t=brease.formatter.formatNumber(e,config.numberFormat,config.useDigitGrouping,config.separators);return brease.formatter.parseFloat(t,config.separators)}NumPadSlider.prototype.setConfig=function(config){for(var e in config)this.settings[e]=config[e]},NumPadSlider.prototype.setValue=function(e,t){if(void 0!==e&&(this.value=e,null!==this.value)){var i=Math.round(e/this.settings.smallChange)*this.settings.smallChange,s;i=this.getLimit(i,this.settings.minValue,this.settings.maxValue),s=x.call(this,i),i>=this.settings.minValue&&i<=this.settings.maxValue&&(this.value=i,I.call(this,s),!0===t&&this.dispatchEvent({type:"ValueChanged",detail:{value:this.value}}))}},NumPadSlider.prototype.setValueAsString=function(e){this.outputVal&&this.outputVal.text(e)},NumPadSlider.prototype.setError=function(e){this.outputVal&&this.outputVal.toggleClass("error",e)},NumPadSlider.prototype.getNrOfMinorTicks=function(e,t){return e<2||t<0?0:1+(e-1)*(t+1)},NumPadSlider.prototype.getNrOfMajorTicks=function(){return this.settings.majorTicks+2};function s(){this.axisElement=e.select(this.el.get(0)).append("svg").attr("class","axisElement").attr("width",this.settings.width+2*this.settings.axisPadding).attr("height",this.settings.axisHeight).attr("transform","translate(-"+this.settings.axisPadding+","+(-this.settings.axisHeight+this.settings.trackPadding+this.settings.trackSize)+")"),this.tickAxisClasses={major:"majorTickAxis"+(!0===this.settings.showTicks?" showTicks":"")+(!0===this.settings.showTickNumbers?" showTickNumbers":""),minor:"minorTickAxis"+(!0===this.settings.showTicks?" showTicks":"")}}function n(t,config){!0!==this.settings.showTicks&&!0!==this.settings.showTickNumbers||(this.axisScale=e.scale.linear().domain([config.minValue,config.maxValue]).range([0,this.settings.width]),this.majorTickAxis=e.svg.axis().scale(this.axisScale).tickValues(t).innerTickSize(this.settings.trackSize).tickPadding(this.settings.tickPadding).tickFormat(e.format("."+this.settings.numberFormat.decimalPlaces+"f")).orient("top"),null!==this.axisElement.select(".majorTickAxis")[0][0]?this.axisElement.select(".majorTickAxis").call(this.majorTickAxis):this.axisElement.append("g").attr("class",this.tickAxisClasses.major).attr("transform","translate("+this.settings.axisPadding+","+this.settings.axisHeight+")").call(this.majorTickAxis))}function a(t,config){if(!0===this.settings.showTicks&&this.settings.minorTicks>0){var i=e.scale.linear().domain([config.minValue,config.maxValue]).range([0,this.settings.width]);this.minorTickAxis=e.svg.axis().scale(i).tickValues(t).innerTickSize(this.settings.trackSize).tickPadding(this.settings.tickPadding).tickFormat("").orient("top"),null!==this.axisElement.select(".minorTickAxis")[0][0]?this.axisElement.select(".minorTickAxis").call(this.minorTickAxis):this.axisElement.append("g").attr("class",this.tickAxisClasses.minor).attr("transform","translate("+this.settings.axisPadding+","+this.settings.axisHeight+")").call(this.minorTickAxis)}}function r(e,t,i){var s=t[0].dataset[e.toLowerCase()];return void 0===s?i.default:"UInteger"===i.type?Types.parseValue(s,"Integer",{min:0,default:i.default}):"Integer"===i.type?Types.parseValue(s,"Integer",{default:i.default}):"Boolean"===i.type?-1!==["true","false"].indexOf(s)?"true"===s:i.default:"String"===i.type?s:"Enum"===i.type?Types.parseValue(s,"Enum",{Enum:i.enum,default:i.default}):void 0}function o(e){var t={};for(var i in NumPadSlider.elementOptions)t[i]=r(i,e,NumPadSlider.elementOptions[i]);return t}function l(){var config=this.settings,e=NumPadSlider.defaultSettings,t=e.thumbHeight+(config.thumbSize-e.thumbSize)/2,i=config.trackSize,s=i+2*e.trackPadding,n=-config.thumbSize/2,a=-(e.boxHeight+e.arrowHeight+e.arrowMargin+config.thumbSize/2-e.trackPadding-config.trackSize/2),r='<div class="numpadSlider_thumb" style="height:'+t+"px;top:"+a+'px;"><div class="numpadSlider_knob" style="bottom:'+n+"px;width:"+config.thumbSize+"px;height:"+config.thumbSize+'px;"></div>';this.settings.showValueDisplay&&(r+='<div class="numpadSlider_output"><span></span></div>'),r+="</div>",this.thumb=$(r).appendTo(this.el),this.track=$('<div class="numpadSlider_track" style="height:'+s+'px;"><div class="numpadSlider_track_inner" style="height:'+i+'px;"></div></div>').appendTo(this.el),this.settings.showValueDisplay&&(this.outputVal=this.el.find(".numpadSlider_output span"))}function d(){this.thumb.on(BreaseEvent.MOUSE_DOWN,g.bind(this)),this.track.on(BreaseEvent.CLICK,b.bind(this)),this.bound_onMouseMove=m.bind(this),this.bound_onMouseUp=p.bind(this)}function c(e){return!(isNaN(e.minValue)||isNaN(e.maxValue)||isNaN(e.ticks))&&(!(e.minValue>e.maxValue)&&!!Number.isInteger(e.ticks))}function h(e){var t=Utils.getOffsetOfEvent(e).x,i=t-this.trackOffset*this.settings.zoomFactor,s=w.call(this,i);this.setValue(s,!0)}function u(){this.trackOffset=this.track.offset().left}function g(){this.mouseMove=!0,u.call(this),brease.bodyEl.on(BreaseEvent.MOUSE_MOVE,this.bound_onMouseMove),brease.bodyEl.on(BreaseEvent.MOUSE_UP,this.bound_onMouseUp)}function m(e){h.call(this,e)}function p(e){this.mouseMove=!1,brease.bodyEl.off(BreaseEvent.MOUSE_MOVE),brease.bodyEl.off(BreaseEvent.MOUSE_UP),h.call(this,e)}function f(){var e=brease.bodyEl.css("zoom");return void 0===e||"normal"===e||"auto"===e?1:parseFloat(e)}function b(e){var t=this.value,i;if(!this.mouseMove){if(this.settings.trackClickBehavior===NumPadSlider.TRACKCLICKBEHAVIOR.changeValueToClickPoint)i=w.call(this,e.offsetX);else{var s=v.call(this,e);i=y.call(this,s,t),i=this.getLimit(i,this.settings.minValue,this.settings.maxValue)}this.setValue(i,!0)}this.mouseMove=!1}function v(e){var t=this.thumb.offset().left;return Utils.getOffsetOfEvent(e).x/this.settings.zoomFactor-t}function y(e,t){var i=t;return e>0?i=t+this.settings.largeChange:e<0&&(i=t-this.settings.largeChange),i}function w(e){var t=this.settings.width*this.settings.zoomFactor,i=e*(this.settings.maxValue/t-this.settings.minValue/t)+this.settings.minValue;return this.getLimit(i,this.settings.minValue,this.settings.maxValue)}function x(e){var t;return e=this.getLimit(e,this.settings.minValue,this.settings.maxValue),t=this.settings.maxValue===-this.settings.minValue?this.settings.width/this.settings.maxValue/2*e-E.call(this,this.settings.minValue):this.settings.width*e/(this.settings.maxValue-this.settings.minValue)-E.call(this,this.settings.minValue),t}function E(e){var t;return t=this.settings.maxValue===-this.settings.minValue?e/2/this.settings.maxValue*this.settings.width:e*this.settings.width/(this.settings.maxValue-this.settings.minValue),t}function I(e){this.thumb.css("left",e+"px")}return NumPadSlider}),define("system/widgets/NumPad/libs/NumPadNumericValue",[],function(){"use strict";var e=function(e){return this.init(e)};return e.prototype.init=function(e){return this.numericValueVal=e.el.find(".breaseNumpadNumericValue"),this.numericValueVal.length>0?this:{}},e.prototype.setValueAsString=function(e){this.numericValueVal.text(e)},e.prototype.setError=function(e){this.numericValueVal.toggleClass("error",e)},e}),define("system/widgets/NumPad/libs/ValueProcessor",["brease/events/EventDispatcher"],function(EventDispatcher){"use strict";var e=function(){this.settings={},this.sign=1,this.strValue=""};e.prototype=new EventDispatcher,e.prototype.setConfig=function(config){for(var e in config)this.settings[e]=config[e]},e.prototype.changeListener=function(e){this.initialSetValue(e.detail.value)},e.prototype.initialSetValue=function(e){this.value=void 0,this.setValue(e),this.outputIsInitialized=!1},e.prototype.setValue=function(e){o.call(this,e)},e.prototype.getValue=function(){return this.value},e.prototype.getStringValue=function(){return this.strValue},e.prototype.actionListener=function(e){t.call(this,e.detail.action,e.detail.value)},e.prototype.stripLeadingZeros=function(e){e=""+e;var t=this.settings.separators.dsp,i=0===e.indexOf("-")?"-":"",s=e.substring(""!==i?1:0);return 0===s.indexOf("00")&&(s=s.substring(1)),0===s.indexOf("0")&&1!==s.indexOf(t)&&(s=s.substring(1)),i+s};function t(e,t){switch(e){case"delete":i.call(this,this.strValue);break;case"comma":s.call(this,this.strValue);break;case"sign":n.call(this,this.strValue);break;case"clear":a.call(this);break;case"value":r.call(this,this.strValue,t);break}}function i(e){e===brease.settings.noValueString&&!1===this.outputIsInitialized?o.call(this,0):l.call(this,e.substring(0,e.length-1))}function s(e){!1===this.outputIsInitialized&&(e="0"),-1===e.indexOf(this.settings.separators.dsp)&&l.call(this,e+this.settings.separators.dsp)}function n(e){var t;-1===this.sign?(t=e.replace("-",""),d.call(this,1)):(t="-"+e,d.call(this,-1)),l.call(this,t,!0)}function a(){l.call(this,"0")}function r(e,t){if(!isNaN(t))if(!1===this.outputIsInitialized)l.call(this,("-"===e.substring(0,1)?"-":"")+t);else{var i=e+t,s=i.indexOf(this.settings.separators.dsp),n=-1!==s?i.substring(s+1):"";n.length<=this.settings.numberFormat.decimalPlaces&&l.call(this,e+t)}}function o(e){var t=this.value,i=this.strValue;this.value=parseFloat(e),this.strValue=c.call(this,this.value),
this.value>=0?d.call(this,1):d.call(this,-1),this.value===t&&this.strValue===i||this.dispatchEvent({type:"ValueChanged",detail:{value:this.value,strValue:this.strValue}})}function l(e,t){e=this.stripLeadingZeros(e),""===e&&(e="0"),"-"===e&&(e="-0"),this.strValue=e,this.value=brease.formatter.parseFloat(this.strValue,this.settings.separators),"-"===this.strValue.substring(0,1)?d.call(this,-1):d.call(this,1),this.dispatchEvent({type:"ValueChanged",detail:{value:this.value,strValue:this.strValue}}),!0!==t&&(this.outputIsInitialized=!0)}function d(e){var t=this.sign;this.sign=e,this.sign!==t&&this.dispatchEvent({type:"SignChanged",detail:{sign:this.sign}})}function c(e){return isNaN(e)?brease.settings.noValueString:brease.formatter.formatNumber(e,this.settings.numberFormat,this.settings.useDigitGrouping,this.settings.separators)}return e}),define("system/widgets/NumPad/libs/Validator",["brease/events/EventDispatcher"],function(EventDispatcher){"use strict";var Validator=function(){this.valid=!0,this.settings={}};return Validator.prototype=new EventDispatcher,Validator.prototype.setConfig=function(config){for(var e in config)this.settings[e]=config[e]},Validator.prototype.changeListener=function(e){this.check(e.detail.value)},Validator.prototype.check=function(e){e<this.settings.minValue?this.valid=!1:e>this.settings.maxValue?this.valid=!1:this.valid=!0,this.dispatchEvent({type:"Validation",detail:{valid:this.valid}})},Validator}),define("system/widgets/NumPad/libs/InputElements",["brease/events/EventDispatcher"],function(EventDispatcher){"use strict";var InputElements=function(){this.elements=[],this.valueChangedListener=this.valueChangedListener.bind(this)};return InputElements.prototype=new EventDispatcher,InputElements.prototype.addElement=function(e){-1===this.elements.indexOf(e)&&(this.elements.push(e),"function"==typeof e.addEventListener&&e.addEventListener("ValueChanged",this.valueChangedListener))},InputElements.prototype.valueChangedListener=function(e){var t=e&&e.detail?e.detail.value:void 0;this.dispatchEvent({type:"ValueChanged",detail:{value:t}})},InputElements.prototype.dispose=function(){this.removeEventListener("ValueChanged"),this.elements.forEach(function(e){"function"==typeof e.dispose&&e.dispose()})},InputElements}),define("system/widgets/NumPad/libs/OutputElements",[],function(){"use strict";var OutputElements=function(){this.elements=[]};return OutputElements.prototype.addElement=function(e){-1===this.elements.indexOf(e)&&this.elements.push(e)},OutputElements.prototype.changeListener=function(e){this.walkElements("setValue",[e.detail.value]),this.walkElements("setValueAsString",[e.detail.strValue])},OutputElements.prototype.validListener=function(e){this.walkElements("setError",[!e.detail.valid])},OutputElements.prototype.setValue=function(e){this.walkElements("setValue",[e])},OutputElements.prototype.setValueAsString=function(e){this.walkElements("setValueAsString",[e])},OutputElements.prototype.setConfig=function(config){this.walkElements("setConfig",[config])},OutputElements.prototype.update=function(){this.walkElements("update",[])},OutputElements.prototype.dispose=function(){this.walkElements("dispose",[])},OutputElements.prototype.walkElements=function(e,t){this.elements.forEach(function(i){"function"==typeof i[e]&&i[e].apply(i,t)})},OutputElements}),define("system/widgets/NumPad/libs/ButtonElements",["brease/events/EventDispatcher","brease/events/BreaseEvent","brease/core/Utils"],function(EventDispatcher,BreaseEvent,Utils){"use strict";var ButtonElements=function(e){this.buttons={},this.widget=e,this.el=e.el,this.buttonClickHandler=this.buttonClickHandler.bind(this),this.buttonDownHandler=this.buttonDownHandler.bind(this),this.buttonUpHandler=this.buttonUpHandler.bind(this)};ButtonElements.prototype=new EventDispatcher,ButtonElements.prototype.init=function(){this.buttons={sign:this.el.find('[data-action="sign"]'),comma:this.el.find('[data-action="comma"]'),delete:this.el.find('[data-action="delete"]'),enter:this.el.find('[data-action="enter"]'),close:this.el.find('[data-action="close"]'),clear:this.el.find('[data-action="clear"]')},this.clickEventName=e(brease.config.virtualKeyboards)},ButtonElements.prototype.get=function(e){return this.buttons[e]},ButtonElements.prototype.signChangeListener=function(e){this.buttons.sign&&(-1===e.detail.sign?this.buttons.sign.addClass("active"):this.buttons.sign.removeClass("active"))},ButtonElements.prototype.addListeners=function(){this.clickEventName=e(brease.config.virtualKeyboards),this.el.find("[data-action]").on(BreaseEvent.MOUSE_DOWN,this.buttonDownHandler).on(this.clickEventName,this.buttonClickHandler)},ButtonElements.prototype.removeListeners=function(){this.el.find("[data-action]").off(),brease.docEl.off(BreaseEvent.MOUSE_UP,this.buttonUpHandler)},ButtonElements.prototype.reset=function(){this.activeButton&&Utils.removeClass(this.activeButton,"active"),this.activeButton=void 0,this.startButton=void 0},ButtonElements.prototype.buttonDownHandler=function(e){this.activeButton&&Utils.removeClass(this.activeButton,"active"),this.activeButton=this.startButton=e.currentTarget,Utils.addClass(this.activeButton,"active"),brease.docEl.on(BreaseEvent.MOUSE_UP,this.buttonUpHandler)},ButtonElements.prototype.buttonUpHandler=function(){brease.docEl.off(BreaseEvent.MOUSE_UP,this.buttonUpHandler),Utils.removeClass(this.activeButton,"active"),this.activeButton=void 0},ButtonElements.prototype.buttonClickHandler=function(e){this.widget._handleEvent(e,!0);var t=$(e.currentTarget),i=""+t.attr("data-action"),s=t.attr("data-value");void 0!==this.startButton&&this.startButton!==e.currentTarget||this.triggerAction(i,s),this.startButton=void 0},ButtonElements.prototype.triggerAction=function(e,t){this.dispatchEvent({type:"ButtonAction",detail:{action:e,value:t}})};function e(e){return e&&e.InputProcessing&&!0===e.InputProcessing.onKeyDown?BreaseEvent.MOUSE_DOWN:BreaseEvent.CLICK}return ButtonElements}),define("brease/services/libs/SocketResponse",["brease/services/libs/ServerCode"],function(ServerCode){"use strict";var SocketResponse=function(e,t){this.queue=new Map,this.eventType=t,this.boundListener=this.socketListener.bind(this),this.socket=e,this.socket.addEventListener(t,this.boundListener)},e=SocketResponse.prototype;return e.init=function(e){this.socket&&this.socket.removeEventListener(this.eventType,this.boundListener),this.socket=e,this.socket.addEventListener(this.eventType,this.boundListener)},e.add=function(e,t){this.queue.set(e,t)},e.socketListener=function(e){var t=e.detail?e.detail.contentId:void 0,i=this.queue.get(t);if(i){var s=e.detail&&e.detail.status&&e.detail.status.code===ServerCode.SUCCESS;i.callbackInfo?i.callback({success:s},i.callbackInfo):i.callback({success:s}),this.queue.delete(t)}},SocketResponse}),define("brease/services/RuntimeService",["brease/services/libs/SocketResponse"],function(SocketResponse){"use strict";var RuntimeService=function RuntimeService(){},e=RuntimeService.prototype;return e.init=function(e,t){this.services=e,this.socket=t,this.activateResponse&&this.activateResponse.init(t),this.deactivateResponse&&this.deactivateResponse.init(t)},e.socketIsReady=function(){var e=this,t=$.Deferred();return this.socket.start(function(i){!0===i?(t.resolve(),e.activateResponse=new SocketResponse(e.socket,e.socket.COMMAND.ACTIVATE_CONTENT),e.deactivateResponse=new SocketResponse(e.socket,e.socket.COMMAND.DEACTIVATE_CONTENT)):t.reject()}),t.promise()},e.startHeartbeat=function(){this.socket.startHeartbeat.apply(this.socket,arguments)},e.addEventListener=function(){this.socket.addEventListener.apply(this.socket,arguments)},e.removeEventListener=function(){this.socket.removeEventListener.apply(this.socket,arguments)},e.checkFileExists=function(){return this.services.checkFileExists.apply(this.services,arguments)},e.loadLanguages=function(){this.services.loadLanguages.apply(this.services,arguments)},e.loadTexts=function(){this.services.loadTexts.apply(this.services,arguments)},e.loadSystemTexts=function(){this.services.loadSystemTexts.apply(this.services,arguments)},e.switchLanguage=function(){this.services.switchLanguage.apply(this.services,arguments)},e.getAllUnitSymbols=function(){this.services.getAllUnitSymbols.apply(this.services,arguments)},e.getUnitSymbols=function(){this.services.getUnitSymbols.apply(this.services,arguments)},e.loadCultures=function(){this.services.loadCultures.apply(this.services,arguments)},e.switchCulture=function(){this.services.switchCulture.apply(this.services,arguments)},e.loadMeasurementSystemList=function(){this.services.loadMeasurementSystemList.apply(this.services,arguments)},e.switchMeasurementSystem=function(){this.services.switchMeasurementSystem.apply(this.services,arguments)},e.authenticateUser=function(){this.services.authenticateUser.apply(this.services,arguments)},e.setCurrentUser=function(){this.services.setCurrentUser.apply(this.services,arguments)},e.loadCurrentUser=function(){this.services.loadCurrentUser.apply(this.services,arguments)},e.setDefaultUser=function(){this.services.setDefaultUser.apply(this.services,arguments)},e.userHasRoles=function(){this.services.userHasRoles.apply(this.services,arguments)},e.loadUserRoles=function(){this.services.loadUserRoles.apply(this.services,arguments)},e.changePassword=function(){this.services.changePassword.apply(this.services,arguments)},e.loadPasswordPolicies=function(){this.services.loadPasswordPolicies.apply(this.services,arguments)},e.loadUserList=function(){this.services.loadUserList.apply(this.services,arguments)},e.loadUserData=function(){this.services.loadUserData.apply(this.services,arguments)},e.addUserToMpUserX=function(){this.services.addUserToMpUserX.apply(this.services,arguments)},e.deleteUserFromMpUserX=function(){this.services.deleteUserFromMpUserX.apply(this.services,arguments)},e.modifyUserFromMpUserX=function(){this.services.modifyUserFromMpUserX.apply(this.services,arguments)},e.loadAvailableRoles=function(){this.services.loadAvailableRoles.apply(this.services,arguments)},e.getUserSettingsFromMpUserX=function(){this.services.getUserSettingsFromMpUserX.apply(this.services,arguments)},e.formatText=function(){this.services.formatText.apply(this.services,arguments)},e.logEvents=function(e,t,i,s,n){var a=[];if(void 0!==e){var r={eventId:e,verboseLvl:t,text:i||"",args:s||[]};a.push(r)}this.services.logEvents(a,n)},e.getSubscription=function(){this.services.getSubscription.apply(this.services,arguments)},e.activateContent=function(e,t,i,s){this.activateResponse.add(e,{callback:i,callbackInfo:s}),this.socket.send({Command:this.socket.COMMAND.ACTIVATE_CONTENT,Parameter:{contentId:e,visuId:t}})},e.deactivateContent=function(e,t,i,s,n){this.deactivateResponse.add(e,{callback:i,callbackInfo:s});var a={contentId:e,visuId:t};!0===n&&(a.force=!0),this.socket.send({Command:this.socket.COMMAND.DEACTIVATE_CONTENT,Parameter:a})},e.activateVisu=function(){this.services.activateVisu.apply(this.services,arguments)},e.deactivateVisu=function(){this.services.deactivateVisu.apply(this.services,arguments)},e.sendUpdate=function(e){void 0!==e&&this.socket.send({Command:this.socket.COMMAND.UPDATE,Data:e})},e.createBindings=function(){this.services.createBindings.apply(this.services,arguments)},e.deleteBindings=function(){this.services.deleteBindings.apply(this.services,arguments)},e.getBindingSourceProperties=function(){this.services.getBindingSourceProperties.apply(this.services,arguments)},e.getEventSubscription=function(){this.services.getEventSubscription.apply(this.services,arguments)},e.getSessionEventSubscription=function(){this.services.getSessionEventSubscription.apply(this.services,arguments)},e.sendEvent=function(e){void 0!==e&&this.socket.send({Command:this.socket.COMMAND.EVENT,Data:e})},e.actionResponse=function(e){void 0!==e&&this.socket.send({Command:this.socket.COMMAND.ACTION_RESPONSE,Data:e})},e.setClientInformation=function(){this.services.setClientInformation.apply(this.services,arguments)},e.registerClient=function(){this.services.registerClient.apply(this.services,arguments)},e.loadVisuData=function(){this.services.loadVisuData.apply(this.services,arguments)},e.loadConfiguration=function(){this.services.loadConfiguration.apply(this.services,arguments)},e.getAutoLogOut=function(){this.services.getAutoLogOut.apply(this.services,arguments)},e.opcuaReadNodeHistory=function(){this.services.opcuaReadNodeHistory.apply(this.services,arguments)},e.opcuaReadHistoryCount=function(){this.services.opcuaReadHistoryCount.apply(this.services,arguments)},e.opcuaReadHistoryStart=function(){this.services.opcuaReadHistoryStart.apply(this.services,arguments)},e.opcuaReadHistoryEnd=function(){this.services.opcuaReadHistoryEnd.apply(this.services,arguments)},e.opcuaBrowse=function(){this.services.opcuaBrowse.apply(this.services,arguments)},e.opcuaCallMethod=function(){this.services.opcuaCallMethod.apply(this.services,arguments)},e.opcuaRead=function(){this.services.opcuaRead.apply(this.services,arguments)},new RuntimeService}),define("system/widgets/common/keyboards/NodeInfo",["brease/services/RuntimeService","brease/model/VisuModel","brease/controller/BindingController","brease/enum/EnumObject","brease/core/Types"],function(e,t,i,EnumObject,Types){"use strict";var NodeInfo=function(e){this.elements=[],this.el=e.el,this.init()},s=new EnumObject({displayName:"displayName",description:"description"}),n="displayName";NodeInfo.prototype.init=function(){this.elements=Array.prototype.map.call(this.el.find(".nodeInfo"),function(e){return{element:e,nodeAttribute:Types.parseValue(e.getAttribute("data-nodeattribute"),"Enum",{Enum:s,default:"displayName"})}})},NodeInfo.prototype.dispose=function(){this.elements=null,this.el=null},NodeInfo.prototype.show=function(s){if(a.call(this),s&&s.bindingAttributes&&s.contentId&&s.widgetId){var n=s.contentId,r=t.getContentById(n);if(r){var o=r.visuId,l=s.widgetId,d=s.bindingAttributes,c=i.getSubscriptionsForElement(l),h;if(c)for(var u=0;u<d.length;u+=1){var g=d[u];if(void 0!==c[g]){h=g;break}}void 0!==h&&this.elements.forEach(function(t){e.getBindingSourceProperties(n,o,l,h,t.nodeAttribute,function(e,t){void 0!==e[0][t.nodeAttribute]?t.element.innerText=e[0][t.nodeAttribute]:(t.element.innerText="",console.iatWarn('attribute "'+t.nodeAttribute+'" of bound variable not found!'+(e[0].status&&e[0].status.message?" (server response: "+e[0].status.message+")":"")))},{element:t.element,nodeAttribute:t.nodeAttribute})})}}};function a(){this.elements.forEach(function(e){e.element.innerText=""})}return NodeInfo}),define("system/widgets/common/keyboards/UnitInfo",[],function(){"use strict";var UnitInfo=function(e){this.elements=[],this.parentEl=e,this.init()};UnitInfo.prototype.init=function(){this.elements=this.parentEl.find(".unitInfo")},UnitInfo.prototype.setError=function(e){this.elements.toggleClass("error",e)},UnitInfo.prototype.validListener=function(e){this.setError(!e.detail.valid)},UnitInfo.prototype.dispose=function(){this.elements=null,this.parentEl=null},UnitInfo.prototype.show=function(t){var i=this;e.call(this);var s=brease.services.measurementSystem.getCurrentMeasurementSystem(),n=t?t[s]:void 0;brease.language.pipeAsyncUnitSymbol(n,function(e){i.elements&&void 0!==e&&i.elements.text(e)})};function e(){this.elements.text("")}return UnitInfo}),define("system/widgets/NumPad/NumPad",["widgets/brease/Window/Window","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/config/NumberFormat","brease/decorators/MeasurementSystemDependency","system/widgets/NumPad/libs/NumPadSlider","system/widgets/NumPad/libs/NumPadNumericValue","system/widgets/NumPad/libs/ValueProcessor","system/widgets/NumPad/libs/Validator","system/widgets/NumPad/libs/InputElements","system/widgets/NumPad/libs/OutputElements","system/widgets/NumPad/libs/ButtonElements","system/widgets/common/keyboards/NodeInfo","system/widgets/common/keyboards/UnitInfo"],function(e,BreaseEvent,Enum,Utils,NumberFormat,t,NumPadSlider,i,ValueProcessor,Validator,InputElements,OutputElements,ButtonElements,NodeInfo,UnitInfo){"use strict";var s={modal:!0,showCloseButton:!0,forceInteraction:!1,limitViolationPolicy:Enum.LimitViolationPolicy.NO_SUBMIT,format:{default:{decimalPlaces:2,minimumIntegerDigits:1}},arrow:{show:!0,position:"left",width:12},positionOffset:5,scale2fit:!0,precision:6},n=e.extend(function t(i,s,n,a){!0===a?e.call(this,null,null,!0,!0):e.call(this,i,s,!1,!0)},s),a=n.prototype;const r="ROUND_UP",o="ROUND_DOWN",l="ROUND_DEFAULT";a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseNumPad"),this.settings.windowType="NumPad",e.prototype.init.call(this,!0),this.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.settings.numberFormat=NumberFormat.getFormat(this.settings.format,this.settings.mms),this.settings.separators=brease.user.getSeparators(),this.settings.roundedMinValue=this.settings.minValue,this.settings.roundedMaxValue=this.settings.maxValue,this.minEl=this.el.find(".minValue"),this.maxEl=this.el.find(".maxValue"),this.numRegExp=new RegExp("[0-9]"),this.value=new ValueProcessor,this.validator=new Validator,this.outputElements=new OutputElements,this.inputElements=new InputElements,this.buttons=new ButtonElements(this),this.nodeInfo=new NodeInfo(this),this.unitInfo=new UnitInfo(this.el),this.validator.addEventListener("Validation",this.outputElements.validListener.bind(this.outputElements)),this.validator.addEventListener("Validation",this.unitInfo.validListener.bind(this.unitInfo)),this.inputElements.addEventListener("ValueChanged",this.value.changeListener.bind(this.value)),this.value.addEventListener("ValueChanged",this.outputElements.changeListener.bind(this.outputElements)),this.value.addEventListener("ValueChanged",this.validator.changeListener.bind(this.validator)),this.value.addEventListener("SignChanged",this.buttons.signChangeListener.bind(this.buttons)),this.buttons.addEventListener("ButtonAction",this.value.actionListener.bind(this.value)),this.buttons.addEventListener("ButtonAction",y.bind(this))},a._setContent=function(){},a.validatePositions=function(e){if(e.arrow=e.arrow||{},e.position){var t=e.position;"left"===t.horizontal?(e.position.vertical="middle",e.arrow.position="right",e.arrow.show=!0):"right"===t.horizontal?(e.position.vertical="middle",e.arrow.position="left",e.arrow.show=!0):"top"===t.vertical?(e.position.horizontal="center",e.arrow.position="bottom",e.arrow.show=!0):"bottom"===t.vertical?(e.position.horizontal="center",e.arrow.position="top",e.arrow.show=!0):(e.position.vertical="middle",e.position.horizontal="center",e.arrow.show=!1)}else e.position={vertical:"middle",horizontal:"center"},e.arrow.show=!1;return e},a.show=function(t,i){var s=this.validatePositions(t);e.prototype.show.call(this,s,i),this.nodeInfo.show(s),this.unitInfo.show(s.unit),this.closeOnLostContent(i),this.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.settings.numberFormat=NumberFormat.getFormat(this.settings.format,this.settings.mms),this.settings.separators=brease.user.getSeparators(),this.settings.smallChange=this.settings.numberFormat.decimalPlaces>0?1/Math.pow(10,this.settings.numberFormat.decimalPlaces):1,this.settings=d(this.settings),void 0!==this.settings.minValue&&void 0!==this.settings.maxValue?this.settings.largeChange=Math.pow(10,Math.round(Math.log10(this.settings.maxValue/10-this.settings.minValue/10))):this.settings.largeChange=10*this.settings.smallChange,this.settings.roundedMinValue=m(this.settings.minValue,this.settings.numberFormat.decimalPlaces),this.settings.roundedMaxValue=p(this.settings.maxValue,this.settings.numberFormat.decimalPlaces),this.minEl.text(u.call(this,this.settings.roundedMinValue)),this.maxEl.text(u.call(this,this.settings.roundedMaxValue)),this.validator.setConfig({minValue:this.settings.roundedMinValue,maxValue:this.settings.roundedMaxValue}),this.outputElements.setConfig({minValue:this.settings.roundedMinValue,maxValue:this.settings.roundedMaxValue,smallChange:this.settings.smallChange,largeChange:this.settings.largeChange,numberFormat:this.settings.numberFormat,useDigitGrouping:this.settings.useDigitGrouping,separators:this.settings.separators}),this.outputElements.update(),this.value.setConfig({numberFormat:this.settings.numberFormat,useDigitGrouping:this.settings.useDigitGrouping,separators:this.settings.separators});var n=v(this.settings.value,this.settings.numberFormat.decimalPlaces,l);this.value.initialSetValue(n),!0!==this.eventsAttached&&c.call(this)},a.setStyle=function(t){var i=this;this.el.removeClass(function(e,t){var s=new RegExp("\\b"+i.settings.stylePrefix+"\\S+","g");return(t.match(s)||[]).join(" ")}),"default"!==t&&Utils.addClass(this.el,this.settings.stylePrefix+"_style_default"),e.prototype.setStyle.call(this,t)},a.hide=function(){!0===this.eventsAttached&&h.call(this),this.buttons.reset(),e.prototype.hide.call(this)},a.dispose=function(){h.call(this),this.nodeInfo.dispose(),this.unitInfo.dispose(),this.validator.removeEventListener("Validation"),this.inputElements.dispose(),this.outputElements.dispose(),this.value.removeEventListener("ValueChanged"),this.value.removeEventListener("SignChanged"),this.buttons.removeEventListener("ButtonAction"),e.prototype.dispose.apply(this,arguments)},a.setValue=function(e){this.value.setValue(e)},a.getValue=function(){return this.value.getValue()},a._keyDownHandler=function(e){8===e.keyCode?(e.preventDefault(),this._keyUpHandler(e)):brease.config.visu.keyboardOperation&&"Escape"===e.key&&this.hide()},a._keyUpHandler=function(e){var t=String.fromCharCode(e.keyCode||e.charCode);this.numRegExp.test(t)?this.buttons.triggerAction("value",t):","===t||"."===t?this.buttons.triggerAction("comma"):"-"===t||"+"===t?this.buttons.triggerAction("sign"):8===e.keyCode?this.buttons.triggerAction("delete"):13===e.keyCode&&this.buttons.triggerAction("enter")},a.measurementSystemChangeHandler=function(){this.hide()},a.loadHTML=function(){var e=this;require(["text!"+e.settings.html],function(t){e.deferredInit(document.body,t,!0),NumPadSlider.createInstances(e.el).forEach(function(t){e.outputElements.addElement(t),e.inputElements.addElement(t)});var s=new i(e);e.outputElements.addElement(s),e.buttons.init(),e.readyHandler()})};function d(e){var t=parseFloat(e.minValue);e.minValue=isNaN(t)?-Number.MAX_VALUE:t;var i=parseFloat(e.maxValue);return e.maxValue=isNaN(i)?Number.MAX_VALUE:i,e}function c(){this.buttons.addListeners(),brease.bodyEl.on("keydown",this._bind("_keyDownHandler")),brease.bodyEl.on("keypress",this._bind("_keyUpHandler")),this.eventsAttached=!0}function h(){this.buttons.removeListeners(),brease.bodyEl.off("keydown",this._bind("_keyDownHandler")),brease.bodyEl.off("keypress",this._bind("_keyUpHandler")),this.eventsAttached=!1}function u(e){return isNaN(e)?brease.settings.noValueString:brease.formatter.formatNumber(e,this.settings.numberFormat,this.settings.useDigitGrouping,this.settings.separators)}function g(e){return!(e%1!=0&&!isNaN(e)&&null!==e&&void 0!==e)}function m(e,t){return g(e)?e:f(e,t,"min")}function p(e,t){return g(e)?e:f(e,t,"max")}function f(e,t,i){var s=b(e,t),n=v(s,t,l)-s,a=Math.pow(10,-(t+2)),d;return d=n<=a&&n>=-1*a?s:"min"===i?s>0?v(s,t,r):v(s,t,o):s>0?v(s,t,o):v(s,t,r),d}function b(e,t){var i=e.toString(),s=i.split(".");return parseFloat(s[0]+"."+s[1].slice(0,t+1))}function v(e,t,i){var s=Math.pow(10,t),n=e*s;switch(i){case r:n=n<0?Math.ceil(n-1):Math.floor(n+1);break;case o:n=n<0?Math.ceil(n):Math.floor(n);break;case l:n=n<0?Math.ceil(n-.5):Math.floor(n+.5);break}return n/s}function y(e){if("close"===e.detail.action)this.debouncedHide();else if("enter"===e.detail.action){var t=!1,i=!1,s=this.getValue();if(s>=this.settings.roundedMinValue&&s<=this.settings.roundedMaxValue)t=!0,i=!0;else switch(this.settings.limitViolationPolicy){case Enum.LimitViolationPolicy.NO_SUBMIT:t=!1,i=!1;break;case Enum.LimitViolationPolicy.NO_SUBMIT_AND_CLOSE:t=!1,i=!0;break;case Enum.LimitViolationPolicy.SUBMIT_ALL:t=!0,i=!0;break;case Enum.LimitViolationPolicy.SET_TO_LIMIT:Math.abs(s-this.settings.roundedMaxValue)<Math.abs(s-this.settings.roundedMinValue)?this.value.setValue(this.settings.maxValue):this.value.setValue(this.settings.minValue),t=!1,i=!1;break;case Enum.LimitViolationPolicy.SET_TO_LIMIT_AND_SUBMIT:Math.abs(s-this.settings.roundedMaxValue)<Math.abs(s-this.settings.roundedMinValue)?this.value.setValue(this.settings.maxValue):this.value.setValue(this.settings.minValue),t=!0,i=!0;break}!0===t&&this.dispatchEvent(new CustomEvent(BreaseEvent.SUBMIT,{detail:{value:this.getValue()}})),!0===i&&this.hide()}}return t.decorate(n,!0)}),define("widgets/brease/NumPad/NumPad",["system/widgets/NumPad/NumPad","brease/enum/Enum","brease/core/Utils"],function(e,Enum,Utils){"use strict";var t={html:"widgets/brease/NumPad/NumPad.html",stylePrefix:"widgets_brease_NumPad",limitViolationPolicy:Enum.LimitViolationPolicy.NO_SUBMIT,format:{default:{decimalPlaces:1,minimumIntegerDigits:1}},width:354,arrow:{show:!0,position:"left",width:12},positionOffset:5,modal:!0,showCloseButton:!0,scale2fit:!0,precision:6,maxBtnMargin:20},i,s=e.extend(function NumPad(t,s,n,a){var r=this;if(!0===a)e.call(this,null,null,!0,!0),this.loadHTML(this);else{if(void 0!==i)return i;e.call(this,null,null,!0,!0),this.loadHTML(this),i=r}},t),n=s.prototype;n.init=function(){this.btnsInARow=4,e.prototype.init.apply(this,arguments)},n.dispose=function(){e.prototype.dispose.apply(this,arguments),i=void 0},n._afterCalculationHook=function(){o(this)},n.hide=function(){r.call(this),e.prototype.hide.apply(this,arguments)},n.show=function(){e.prototype.show.apply(this,arguments),a.call(this,this.settings.separators)};function a(e){var t=this.buttons.get("comma");t&&e&&Utils.isString(e.dsp)&&t.html(e.dsp)}function r(){var e=this.el.find(".numpadHeader")[0];e.style.borderTopLeftRadius="",e.style.borderTopRightRadius="";var t=this.el.find(".numpadWrapper")[0];t.style.borderBottomLeftRadius="",t.style.borderBottomRightRadius=""}function o(e){var t=e.buttons.get("sign"),i=parseInt(t.css("margin-left"),10),s=parseInt(t.css("margin-right"),10),n=parseInt(t.css("margin-top"),10),a=parseInt(t.css("margin-bottom"),10),r=$("button",".numpad .breaseNumPadButtons"),o=r.outerWidth(),l=$('button[data-value="0"]',".numpad .breaseNumPadButtons"),d=$(".breaseNumPadEnter",".numpad .breaseNumPadButtons");if(0!==i||0!==s){i>=e.maxBtnMargin&&(r.css("margin-left",e.maxBtnMargin+"px"),i=e.maxBtnMargin),s>=e.maxBtnMargin&&(r.css("margin-right",e.maxBtnMargin+"px"),s=e.maxBtnMargin);var c=0!==i?i*e.btnsInARow:0,h=0!==s?s*e.btnsInARow:0;e.el.width(e.el.width()+c+h),l.outerWidth(2*o+i+s),d.outerHeight(2*l.outerHeight()+n+a),$(".numpad",e.el).addClass("solidBtnBorder")}else $(".numpad",e.el).removeClass("solidBtnBorder"),l.outerWidth(2*o),d.outerHeight(2*l.outerHeight());var u=$(".breaseNumpadNumericValueOutterWrapper",".numpad").eq(0).is(":visible");e.el.toggleClass(e.settings.stylePrefix+"_style_slider_invisible",u);var g=parseInt(e.el.css("border-radius"),10);g>12&&($(".numpadHeader").css("border-top-left-radius",g+"px"),$(".numpadHeader").css("border-top-right-radius",g+"px"),$(".numpadWrapper").css("border-bottom-left-radius",.7*g+"px"),$(".numpadWrapper").css("border-bottom-right-radius",.7*g+"px"),g>24&&e.closeButton.css("right","-4px"));var m=e.elem.getBoundingClientRect().width/e.dimensions.scale,p=Math.round(m);e.settings.width=p,p<m&&(e.settings.width+=1),e._setDimensions(),e._setPosition(),(e.el.outerHeight()-2*e.settings.arrow.width)%parseInt(e.arrow.css("top"),10)<=1&&g>0&&e.arrow.css("top",parseInt(e.arrow.css("top"),10)-g+"px")}return s}),define("system/widgets/common/keyboards/KeyboardOptions",[],function(){"use strict";var KeyboardOptions=function(){};return KeyboardOptions.isValid=function(e){return e&&(void 0!==e.minWidth||void 0!==e.minHeight)&&(void 0!==e.maxWidth||void 0!==e.maxHeight)},KeyboardOptions}),define("system/widgets/common/keyboards/Docking",["system/widgets/common/keyboards/KeyboardOptions","brease/enum/Enum"],function(KeyboardOptions,Enum){"use strict";var Docking={getOptions:function(i){if(!e[i]){var s=new KeyboardOptions,config;brease.config&&brease.config.virtualKeyboards&&(config=brease.config.virtualKeyboards[i]);for(var n in Docking.defaults)s[n]=t(n,config,Docking.defaults);e[i]=s}return e[i]},applyConfig:function(e,t){var i=this.getOptions(e),s=t&&t.pointOfOrigin?t.pointOfOrigin:void 0,n=t&&t.position?t.position:{};switch(i.docking){case Enum.Docking.BOTTOM:n.horizontal=Enum.Position.center,n.vertical=Enum.Position.bottom,s=Enum.PointOfOrigin.WINDOW;break}return t?(t.position=n,t.pointOfOrigin=s):t={position:n,pointOfOrigin:s},t},reset:function(){e={}},defaults:new KeyboardOptions},e={};Docking.defaults.docking=Enum.Docking.NONE;function t(e,config,t){var i=t[e];if(config){var s=config[e];if(void 0!==s)return s}return i}return Docking}),define("system/widgets/KeyBoard/KeyBoard",["widgets/brease/Window/Window","brease/controller/PopUpManager","brease/events/BreaseEvent","system/widgets/common/keyboards/NodeInfo","system/widgets/common/keyboards/Docking","system/widgets/common/keyboards/KeyboardType"],function(e,PopUpManager,BreaseEvent,NodeInfo,Docking,KeyboardType){"use strict";var t={modal:!0,showCloseButton:!1,forceInteraction:!1},i=e.extend(function t(i,s,n,a){!0===a?e.call(this,null,null,!0,!0):e.call(this,i,s,!1,!0)},t),s=i.prototype;s.init=function(){this.data={open:!1},this.settings.windowType="KeyBoard",this.nodeInfo=new NodeInfo(this),e.prototype.init.apply(this,arguments)},s.show=function(t,i){t=Docking.applyConfig(KeyboardType.ALPHANUMERIC,t),e.prototype.show.call(this,t,i),this.inputEl||(this.inputEl=this.el.find(".ValueOutput")),this.nodeInfo.show(t),o.call(this),this.data.open=!0},s.hide=function(){this.data.open=!1,l.call(this),e.prototype.hide.apply(this,arguments)},s.dispose=function(){l.call(this),this.nodeInfo.dispose(),e.prototype.dispose.apply(this,arguments)},s.inputFocus=function(){this.inputEl.focus()},s.inputBlur=function(){this.inputEl.blur()},s.langChangeHandler=function(){this.hide()},s._keyDownHandler=function(e){brease.config.visu.keyboardOperation&&"Escape"===e.key&&this.hide()};function n(){this.inputBlur()}function a(){0===PopUpManager.getNumberOfWindowsOfType("MessageBox")&&this.inputFocus()}function r(){this.hide()}function o(){document.body.addEventListener(BreaseEvent.DIALOG_OPEN,this._bind(r)),document.body.addEventListener(BreaseEvent.CLOSED,this._bind(a)),document.body.addEventListener(BreaseEvent.WINDOW_SHOW,this._bind(n)),document.body.addEventListener("keydown",this._bind("_keyDownHandler"))}function l(){document.body.removeEventListener(BreaseEvent.DIALOG_OPEN,this._bind(r)),document.body.removeEventListener(BreaseEvent.CLOSED,this._bind(a)),document.body.removeEventListener(BreaseEvent.WINDOW_SHOW,this._bind(n)),document.body.removeEventListener("keydown",this._bind("_keyDownHandler"))}return i}),define("widgets/brease/KeyBoard/libs/AboutDisplay",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var AboutDisplay=function(){},e=AboutDisplay.prototype;return e.init=function(e){this.parentEl=e,this.frameEl=e.find(".keyBoardAbout"),this.frameEl&&(this.frameEl.find("button").on(BreaseEvent.CLICK,{self:this},this.onButtonCLick),this.parentEl.on(BreaseEvent.CLICK,"[data-href]",{self:this},this.onSpanCLick))},e.onSpanCLick=function(e){var t=e.data.self;t.frameEl.find("iframe").attr("src",$(this).attr("data-href").replace("http://www.edrdg.org/","widgets/brease/KeyBoard/assets/doc/KanjiDic/")),t.frameEl.find("span").text($(this).attr("data-href")),t.frameEl.show()},e.onButtonCLick=function(e){e.data.self.frameEl.hide()},e.dispose=function(){this.frameEl&&(this.frameEl.find("button").off(BreaseEvent.CLICK,{self:this},this.onButtonCLick),this.parentEl.off(BreaseEvent.CLICK,"[data-href]",{self:this},this.onSpanCLick)),this.frameEl=null,this.parentEl=null},AboutDisplay}),
define("widgets/brease/KeyBoard/KeyBoard",["system/widgets/KeyBoard/KeyBoard","brease/events/BreaseEvent","brease/core/Utils","brease/controller/PopUpManager","system/widgets/KeyBoard/libs/LayoutSelector","widgets/brease/KeyBoard/libs/AboutDisplay"],function(e,BreaseEvent,Utils,t,LayoutSelector,AboutDisplay){"use strict";var i={layout:{default:"widgets/brease/KeyBoard/assets/KeyBoardEn.html",en:"widgets/brease/KeyBoard/assets/KeyBoardEn.html",de:"widgets/brease/KeyBoard/assets/KeyBoardDe.html",es:"widgets/brease/KeyBoard/assets/KeyBoardEs.html",fr:"widgets/brease/KeyBoard/assets/KeyBoardFr.html",it:"widgets/brease/KeyBoard/assets/KeyBoardIt.html",nl:"widgets/brease/KeyBoard/assets/KeyBoardNl.html",ar:"widgets/brease/KeyBoard/assets/KeyBoardAr.html",ar_en:"widgets/brease/KeyBoard/assets/KeyBoardArEn.html",bg:"widgets/brease/KeyBoard/assets/KeyBoardBg.html",bg_en:"widgets/brease/KeyBoard/assets/KeyBoardBgEn.html",cs:"widgets/brease/KeyBoard/assets/KeyBoardCs.html",da:"widgets/brease/KeyBoard/assets/KeyBoardDa.html",fi:"widgets/brease/KeyBoard/assets/KeyBoardFi.html",hu:"widgets/brease/KeyBoard/assets/KeyBoardHu.html",ja:"widgets/brease/KeyBoard/assets/KeyBoardJa.html",ja_en:"widgets/brease/KeyBoard/assets/KeyBoardJaEn.html",ko:"widgets/brease/KeyBoard/assets/KeyBoardKo.html",ko_en:"widgets/brease/KeyBoard/assets/KeyBoardKoEn.html",no:"widgets/brease/KeyBoard/assets/KeyBoardNo.html",pl:"widgets/brease/KeyBoard/assets/KeyBoardPl.html",pt:"widgets/brease/KeyBoard/assets/KeyBoardPt.html",ru:"widgets/brease/KeyBoard/assets/KeyBoardRu.html",ru_en:"widgets/brease/KeyBoard/assets/KeyBoardRuEn.html",sk:"widgets/brease/KeyBoard/assets/KeyBoardSk.html",sl:"widgets/brease/KeyBoard/assets/KeyBoardSl.html",sv:"widgets/brease/KeyBoard/assets/KeyBoardSv.html",tr:"widgets/brease/KeyBoard/assets/KeyBoardEn.html",zh:"widgets/brease/KeyBoard/assets/KeyBoardZh.html",zh_en:"widgets/brease/KeyBoard/assets/KeyBoardZhEn.html",ro:"widgets/brease/KeyBoard/assets/KeyBoardRo.html",lv:"widgets/brease/KeyBoard/assets/KeyBoardLv.html",sr:"widgets/brease/KeyBoard/assets/KeyBoardSr.html",he:"widgets/brease/KeyBoard/assets/KeyBoardHe.html",he_en:"widgets/brease/KeyBoard/assets/KeyBoardHeEn.html",hr:"widgets/brease/KeyBoard/assets/KeyBoardHr.html",ca:"widgets/brease/KeyBoard/assets/KeyBoardCa.html",is:"widgets/brease/KeyBoard/assets/KeyBoardIs.html",vi:"widgets/brease/KeyBoard/assets/KeyBoardVi.html","zh-CHS":"widgets/brease/KeyBoard/assets/KeyBoardZhCHS.html","zh-CHS_en":"widgets/brease/KeyBoard/assets/KeyBoardZhCHS_en.html"},modal:!0,showCloseButton:!0,showShiftValues:!0,forceInteraction:!1,capsLock:!1,alternativeLayouts:{ar:{ar:{index:0,description:"العربية"},ar_en:{index:1,description:"English"}},ar_en:{ar:{index:0,description:"العربية"},ar_en:{index:1,description:"English"}},bg:{bg:{index:0,description:"български"},bg_en:{index:1,description:"English"}},bg_en:{bg:{index:0,description:"български"},bg_en:{index:1,description:"English"}},he:{he:{index:0,description:"עברית"},he_en:{index:1,description:"English"}},he_en:{he:{index:0,description:"עברית"},he_en:{index:1,description:"English"}},ja:{ja:{index:0,description:"日本語"},ja_en:{index:1,description:"English"}},ja_en:{ja:{index:0,description:"日本語"},ja_en:{index:1,description:"English"}},ko:{ko:{index:0,description:"한국어"},ko_en:{index:1,description:"English"}},ko_en:{ko:{index:0,description:"한국어"},ko_en:{index:1,description:"English"}},ru:{ru:{index:0,description:"русский"},ru_en:{index:1,description:"English"}},ru_en:{ru:{index:0,description:"русский"},ru_en:{index:1,description:"English"}},zh:{zh:{index:0,description:"中文"},zh_en:{index:1,description:"English"}},zh_en:{zh:{index:0,description:"中文"},zh_en:{index:1,description:"English"}},"zh-CHS":{"zh-CHS":{index:0,description:"中文"},"zh-CHS_en":{index:1,description:"English"}},"zh-CHS_en":{"zh-CHS":{index:0,description:"中文"},"zh-CHS_en":{index:1,description:"English"}}},plugin:{zh:"widgets/brease/KeyBoard/libs/external/PluginPinyin",ko:"widgets/brease/KeyBoard/libs/external/PluginHangul",ja:"widgets/brease/KeyBoard/libs/external/PluginWanaKana","zh-CHS":"widgets/brease/KeyBoard/libs/external/PluginZhCHS",es:"widgets/brease/KeyBoard/libs/external/PluginEs",ca:"widgets/brease/KeyBoard/libs/external/PluginEs",pt:"widgets/brease/KeyBoard/libs/external/PluginEs"},stylePrefix:"widgets_brease_KeyBoard",scale2fit:!0},s=1,n,a=e.extend(function KeyBoard(t,i,s,a){var r=this;if(!0===a)e.call(this,null,i||null,!0,!0),m(this);else{if(void 0!==n)return this.output&&n.setValue(""),n.settings=$.extend(!0,{},n.settings,i),n;e.call(this,null,i||null,!0,!0),m(this),n=r}},i),r=a.prototype;r.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseKeyBoard"),this.settings.windowType="KeyBoard",e.prototype.init.call(this,!0),this.value="",this.getElements(),this.aboutDisplay=new AboutDisplay,this.aboutDisplay.init(this.el),!1===brease.config.detection.mobile&&this.output[0].removeAttribute("readonly"),this.loadPlugin()},r.getElements=function(){this.output=this.el.find("input"),this.clear=this.el.find(".keyBoardBtnClear"),this.valueButtons=this.el.find("button[data-value]"),this.actionButtons=this.el.find("button[data-action]"),this.shift=this.el.find("[data-action=shift]"),this.special=this.el.find("[data-action=special]")},r.getCursor=function(){return T.call(this)},r.setCursor=function(e){S.call(this,e)},r.setValue=function(e,t,i){this.value=e||"",""!==this.value?this.clear.show():this.clear.hide(),!0!==t&&this.output.val(this.value),!0!==i&&o.call(this)};function o(){var e=this.cursor;this.output.focus(),this.output[0].setSelectionRange(e,e)}function l(){var e=this,t=this.output[0].value.length;this.cursor=t,this.output.one("focusin",function(){e.output[0].setSelectionRange(t,t)}),this.output.focus()}r.showPlugin=function(e){void 0!==this.plugin&&(!0===e?this.plugin.onDelete(this.value,T.call(this)):this.plugin.onInput(this.value,T.call(this)))},r.getPluginItems=function(){return this.plugin&&"function"==typeof this.plugin.getItems?this.plugin.getItems():[]},r.getValue=function(){return this.value},r.show=function(t,i){var s=this;!0!==this.eventsAttached&&h.call(this),this._setLayout(),this.options=$.extend(!0,{},t),e.prototype.show.call(this,t,i),this.setAlternativeLayouts(this.settings.alternativeLayouts),this.closeOnLostContent(i),void 0!==t.type&&this.output.attr("type",t.type),void 0!==t.maxLength?this.output.attr("maxlength",parseInt(t.maxLength,10)):this.output.removeAttr("maxlength"),this.setValue(this.settings.text,!1,!0),void 0!==this.plugin&&this.plugin.show(),void 0!==this.settings.restrict?this.settings.regexp=new RegExp(this.settings.restrict):this.settings.regexp=void 0,this.output.one("focusout",function(){o.call(s)}),l.call(s)},r.hide=function(){!0===this.eventsAttached&&u.call(this),1!==s&&I.call(this,1),e.prototype.hide.call(this),void 0!==this.plugin&&this.plugin.hide(),this.el.removeClass("keyBoardSm keyBoardMd keyBoardFull")},r.langChangeHandler=function(){var e=brease.language.getCurrentLanguage();this.settings.language=e,this.selector&&this.selector.setCurrentLayout(this.settings.language),this.loadLayout()},r.loadPlugin=function(){var e=this.settings.plugin[this.settings.language],t=this;void 0!==e?(void 0!==this.plugin&&this.plugin.dispose(),require([e],function(e){t.plugin=e,t.pluginReady()})):(this.plugin=void 0,this.pluginReady())},r.pluginReady=function(){this.plugin&&(this.plugin.init(this),this.dispatchEvent(new CustomEvent(BreaseEvent.PLUGIN_LOADED,{bubbles:!0})))},r.loadLayout=function(){var e=this.settings.language,t=this.settings.layout[e];if(void 0===t&&(t=this.settings.layout.default),void 0!==t&&t!==this.settings.html)this.settings.html=t,p(this),this.hide();else{var i=this;window.setTimeout(function(){i.loadPlugin(),i._dispatchReady()},0)}},r.setAlternativeLayouts=function(e){this.settings.alternativeLayouts=e,this.selector||(this.selector=new LayoutSelector,this.selector.setCurrentLayout(this.settings.language),this.selector.init(this._bind(g),this.settings.alternativeLayouts[this.settings.language])),this.selector.setItems(this.settings.alternativeLayouts[this.settings.language]),this.selector.getItems().length>0&&(this.el.find(".alt-lt-Wrapper").length>0?this.selector.el.appendTo(this.el.find(".alt-lt-Wrapper")):this.el.append(this.selector.el))},r.dispose=function(){this.plugin&&this.plugin.dispose(),e.prototype.dispose.apply(this,arguments),n=void 0},r._onValueButtonClick=function(e){this._handleEvent(e,!0);var t=$(e.currentTarget),i;switch(s){case 1:i=t.attr("data-value");break;case 2:i=t.attr("data-shift-value");break;case 3:i=t.attr("data-special-value");break}if(!(void 0!==this.settings.maxLength&&this.getValue().length>=this.settings.maxLength)){if(void 0!==this.settings.regexp)for(var n=this.getValue()+i,a=n.length-1;a>=0;a-=1)if(!0!==this.settings.regexp.test(n[a]))return o.call(this),void 0;b.call(this,i,T.call(this))}};function d(e){this.activeButton&&Utils.removeClass(this.activeButton,"active"),this.activeButton=e.currentTarget,Utils.addClass(this.activeButton,"active"),brease.docEl.on(BreaseEvent.MOUSE_UP,this._bind(c))}function c(){brease.docEl.off(BreaseEvent.MOUSE_UP,this._bind(c)),Utils.removeClass(this.activeButton,"active"),this.activeButton=void 0}r._setLayout=function(){var e=t.getDimensions(),i=Math.min(e.appWidth,e.winWidth);i>=1e3?this.el.addClass("keyBoardFull"):i<=640?this.el.addClass("keyBoardSm"):this.el.addClass("keyBoardMd")},r._onActionButtonClick=function(e){switch(this._handleEvent(e,!0),$(e.currentTarget).attr("data-action")){case"delete":v.call(this,T.call(this)-1);break;case"enter":w.call(this);break;case"left":C.call(this);break;case"right":_.call(this);break;case"shift":x.call(this);break;case"close":this.hide();break;case"special":E.call(this);break;default:console.iatWarn(a.name+" action not supported!");break}},r._keyUpHandler=function(e){if(13===e.which)w.call(this);else{var t=this.output.val(),i=this.getValue();if(t!==i){var s="";if(t.length-i.length>0){if(void 0!==this.settings.regexp)for(var n=0,a=t.length;n<a;n+=1)!0===this.settings.regexp.test(t[n])&&(s+=t[n]);else s=t;this.cursor=T.call(this)-(t.length-s.length),this.setValue(s)}else this.setValue(t,!0,!0);this.showPlugin(8===e.which)}}},r._onClear=function(e){this._handleEvent(e,!0),this.setValue(""),this.plugin&&this.plugin.onClear&&this.plugin.onClear(this.value,T.call(this))},r.postProcessHTML=function(e){return e=e.replace('<i class="icon-left"></i>','<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12px" height="20px" viewBox="0 0 12 20" enable-background="new 0 0 12 20" xml:space="preserve"><path d="M0,8.569L12,0v3.931L3.336,10L12,16.069V20L0,11.431V8.569z"/></svg>'),e=e.replace('<i class="icon-right"></i>','<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12px" height="20px" viewBox="0 0 12 20" enable-background="new 0 0 12 20" xml:space="preserve"><path d="M12,11.431L0,20v-3.931L8.664,10L0,3.931V0l12,8.569V11.431z"/></svg>'),e=e.replace('<i class="icon-down"></i>','<svg version="1.1" class="icon-down" viewBox="0 0 38 31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="m21.132 28.871-1.8234 2.3711-4.4449-6.2422h8.1362l1.0719-0.052352-1.1164 1.5524-1.8234 2.3711zm-2.1321-5.8711h-19v-23h38v23zm-0.5-2h12.5v-5h-25v5zm-6-7h2.5v-5h-5v5zm7 0h2.5v-5h-5v5zm7 0h2.5v-5h-5v5zm-18-7h2.5v-5h-5v5zm7 0h2.5v-5h-5v5zm7 0h2.5v-5h-5v5zm7 0h2.5v-5h-5v5z"/></svg>'),e=e.replace('<i class="icon-delete">&times;</i>','<svg class="icon-delete" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M44 6h-30c-1.38 0-2.47.7-3.19 1.76l-10.81 16.23 10.81 16.23c.72 1.06 1.81 1.78 3.19 1.78h30c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm-6 25.17l-2.83 2.83-7.17-7.17-7.17 7.17-2.83-2.83 7.17-7.17-7.17-7.17 2.83-2.83 7.17 7.17 7.17-7.17 2.83 2.83-7.17 7.17 7.17 7.17z"/></svg>'),e};function h(){this.eventName=D(brease.config.virtualKeyboards),this.clear.on(this.eventName,this._bind("_onClear")),this.el.on(BreaseEvent.MOUSE_DOWN,"button",this._bind(d)),this.el.on(this.eventName,"button[data-value]",this._bind("_onValueButtonClick")),this.el.on(this.eventName,"button[data-action]",this._bind("_onActionButtonClick")),this.output.on("keyup",this._bind("_keyUpHandler")),this.eventsAttached=!0}function u(){this.selector&&this.selector.el.detach(),this.clear.off(),this.el.off(BreaseEvent.MOUSE_DOWN,"button",this._bind(d)),this.el.off(this.eventName,"button[data-value]",this._bind("_onValueButtonClick")),this.el.off(this.eventName,"button[data-action]",this._bind("_onActionButtonClick")),this.output.off(),this.eventsAttached=!1}function g(e){var t=this.settings.layout[e],i=this;this.settings.language=e,void 0===t?t=this.settings.layout.default:i.selector&&i.selector.setCurrentLayout(e),void 0!==t&&t!==this.settings.html&&(this.settings.html=t,this.instanceSettings.html=t,i.options.value=i.value,i.options.text=i.value,this.instanceSettings.value=i.value,this.instanceSettings.text=i.value,u.call(i),void 0!==this.plugin&&this.plugin.dispose(),i.el.children(":not(.keyBoardHeader)").remove(),require(["text!"+i.settings.html],function(e){e=i.postProcessHTML(e),i.el.append($(e).children(":not(.keyBoardHeader)")),i.el.attr("data-lang",$(e).attr("data-lang")),i.getElements(),i.aboutDisplay=new AboutDisplay,i.aboutDisplay.init(i.el),!0!==i.eventsAttached&&h.call(i),!1===brease.config.detection.mobile&&i.output[0].removeAttribute("readonly"),i.setValue(i.value),i.loadPlugin(),i.setAlternativeLayouts(i.settings.alternativeLayouts),I.call(i,1)}))}function m(e){var t=brease.language.getCurrentLanguage(),i=e.settings.layout[t];e.settings.language=t,void 0===i&&(i=e.settings.layout.default),e.settings.html=i,require(["text!"+e.settings.html],function(t){t=e.postProcessHTML(t),e.deferredInit(document.body,t),I.call(e,1),e.readyHandler()})}function p(e){u.call(e),e.aboutDisplay.dispose(),e.el.remove(),require(["text!"+e.settings.html],f.bind(e,e.settings.html))}function f(e,t){n&&e===n.settings.html&&(t=n.postProcessHTML(t),$("#breaseKeyBoard").remove(),n.el=$(t).prependTo(document.body),n.elem=n.el[0],window.setTimeout(function(){n&&n._dispatchReady()},0),n.init(),I.call(n,1))}function b(e,t){this.value=this.value.slice(0,t)+e+this.value.slice(t),this.setValue(this.value),S.call(this,t+1),this.showPlugin(),2!==s||this.settings.capsLock||I.call(this,1)}function v(e){var t=this.value.substr(0,e)+this.value.substr(e+1);this.setValue(t),S.call(this,e),this.plugin&&this.plugin.onDelete(this.value,T.call(this))}function y(e){return e.replace(/[\u00A0]/g," ")}function w(){this.dispatchEvent(new CustomEvent(BreaseEvent.SUBMIT,{detail:y(this.getValue())})),this.output.trigger("blur"),this.hide()}function x(){2!==s?I.call(this,2):1===s||this.settings.capsLock?this.settings.capsLock&&I.call(this,1):(this.settings.capsLock=!0,I.call(this,2))}function E(){3!==s?I.call(this,3):this.settings.capsLock?I.call(this,2):I.call(this,1)}function I(e){var t,i,n,a,r,o;switch(e){case 1:t="value",n="shift-value",this.shift.removeClass("selected"),this.special.removeClass("selected"),this.settings.capsLock=!1;break;case 2:t="shift-value",n="special-value",this.shift.addClass("selected"),this.special.removeClass("selected");break;case 3:t="special-value",n="shift-value",this.special.addClass("selected"),this.shift.removeClass("selected");break}for(var l=0;l<this.valueButtons.length;l+=1)o=this.valueButtons.eq(l),i=o.data(t),a=o.data(n),r=(void 0!==i?i:"")+(!0===this.settings.showShiftValues&&"value"===t?"<sub>"+(void 0!==a?a:"")+"</sub>":""),o.html(r);s=e}function C(){S.call(this,T.call(this)-1),this.output.focus()}function _(){S.call(this,T.call(this)+1),this.output.focus()}function S(e){this.cursor=e,this.output.get(0).setSelectionRange(e,e)}function T(){return this.output.get(0).selectionStart}function D(e){return e&&e.InputProcessing&&!0===e.InputProcessing.onKeyDown?BreaseEvent.MOUSE_DOWN:BreaseEvent.CLICK}return a}),define("brease/controller/KeyboardManager",["brease/events/BreaseEvent","system/widgets/KeyBoard/libs/LayoutSelector","system/widgets/common/keyboards/KeyboardType","brease/core/ClassUtils","widgets/brease/NumPad/NumPad","widgets/brease/KeyBoard/KeyBoard"],function(BreaseEvent,LayoutSelector,KeyboardType,ClassUtils,e){"use strict";var t={getKeyboard:function(){return s},getLayoutSelector:function(){return l},getNumPad:function(){return a},isCurrentKeyboard:function(e){return e===s},reset:function(){x.initialized=!1,a&&(a.dispose(),a=null),s&&(s.dispose(),s=null)}},i={},s,n,a,r,o,l,d;function c(e){var t="";if(brease.config&&brease.config.virtualKeyboards){var i=brease.config.virtualKeyboards[e];if(i){var s=i.refId;s&&(t=ClassUtils.className2Path(s,!1,!1))}}return t}function h(){var e={};return brease.config&&brease.config.virtualKeyboards&&brease.config.virtualKeyboards[KeyboardType.ALPHANUMERIC]&&brease.config.virtualKeyboards[KeyboardType.ALPHANUMERIC].mappings&&(e=brease.config.virtualKeyboards[KeyboardType.ALPHANUMERIC].mappings),e}function u(e){var t=r!==e;r=e,a&&!t||(a&&a.dispose(),a=new r)}function g(e){var t=n!==e;n=e,s&&!t||(s&&s.dispose(),s=new n)}function m(){var e=[];for(var t in o){o[t].forEach(function(t){-1===e.indexOf(t)&&"widgets.brease.KeyBoard"!==t&&e.push(t)})}if(brease.config&&brease.config.virtualKeyboards&&brease.config.virtualKeyboards[KeyboardType.ALPHANUMERIC]){var s=brease.config.virtualKeyboards[KeyboardType.ALPHANUMERIC].refId;"widgets.brease.KeyBoard"!==s&&-1===e.indexOf(s)&&e.push(s)}e.length>0?require(e.map(function(e){return ClassUtils.className2Path(e,!1,!0)+"/designer/ClassInfo"}),function(){for(var e=0;e<arguments.length;e+=1){var t=arguments[e].meta;i[t.className]=t.keyboard&&t.keyboard.displayName?t.keyboard.displayName:"XX"}f({detail:{currentLanguage:brease.language.getCurrentLanguage()}})}):f({detail:{currentLanguage:brease.language.getCurrentLanguage()}})}function p(e,t){var s="",n=c(KeyboardType.ALPHANUMERIC),a={},r=void 0!==t?t:0;if(o[e]&&o[e][r])s=ClassUtils.className2Path(o[e][r]),o[e].forEach(function(e,t){a[ClassUtils.className2Path(e)]={index:t,displayName:i[e]}},a),l.setCurrentLayout(s),l.setItems(a);else if(n){s=n;var d=ClassUtils.path2ClassName(s);l.setCurrentLayout(s),a[n]={index:0,displayName:i[d]},l.setItems(a)}else l.setCurrentLayout(""),l.setItems(a),l.setButtonText("");return s}function f(e){var t=e.detail&&"string"==typeof e.detail.currentLanguage?e.detail.currentLanguage:"",i=p(t);v(i||"widgets/brease/KeyBoard/KeyBoard")}var b;function v(e){b=s&&s.getValue?s.getValue():"",e&&e!==d&&require([e],function(t){l.el.detach(),g(t),void 0!==d&&(document.body.removeEventListener(BreaseEvent.WIDGET_READY,y),document.body.addEventListener(BreaseEvent.WIDGET_READY,y)),d=e},function e(){})}function y(e){s.elem&&s.elem.id===e.target.id&&(document.body.dispatchEvent(new CustomEvent(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,{detail:{currentValue:b}})),document.body.removeEventListener(BreaseEvent.WIDGET_READY,y))}function w(){l=new LayoutSelector,l.init(v);var t=c(KeyboardType.NUMERIC);t?require([t],function e(t){u(t)},function e(){}):u(e),o=h(),m()}var x={config:!1,resources:!1,initialized:!1,init:function(){x.config&&x.resources&&!x.initialized&&(x.initialized=!0,document.body.addEventListener(BreaseEvent.LANGUAGE_CHANGED,f),w.call(t))}};return document.body.addEventListener(BreaseEvent.CONFIG_LOADED,function(){x.config=!0,x.init()}),brease.appElem.addEventListener(BreaseEvent.RESOURCES_LOADED,function(){x.resources=!0,x.init()}),t}),define("brease/controller/libs/Containers",["brease/events/BreaseEvent","brease/controller/objects/ContentStatus"],function(BreaseEvent,ContentStatus){"use strict";var e={getCurrentPage:function(e){return i(e).currentPage},setCurrentPage:function(e,t){i(e).currentPage=t},setLatestRequest:function(e,t){var s=i(e);s.latestRequest=t,s.status="active"},getLatestRequest:function(e){return i(e).latestRequest},dispose:function(e){void 0!==t[e]&&(t[e].status="disposed")},reset:function(){t={}},getContainerForPage:function(e){var i;for(var s in t)if(t[s]&&t[s].currentPage===e){i=s;break}return i},addContainer:function(e,i){void 0===t[e]&&(t[e]=i)},removeContainer:function(e){void 0!==t[e]&&(t[e]=void 0)},resetCurrentPage:function(e){void 0!==t[e]&&(t[e].currentPage=void 0)},resetCurrentPages:function(t){for(var i=$("#"+t).find(".LayoutArea"),s=0,n=i.length;s<n;s+=1)e.resetCurrentPage(i[s].id);$("#"+t).hasClass("LayoutArea")&&e.resetCurrentPage(t)},initPageLoadEvent:function(e){new s(i(e.containerId),e)}},t={};function i(e){return void 0===t[e]&&(t[e]={id:e,status:"active"}),t[e]}var s=function(e,t){this.container=e,this.pageId=t.pageId,this.contentsToLoad=n(t.contentsToLoad),this.contentsToRemove=a(t.contentsToRemove),this.embedded=t.embedded,this.boundActivatedListener=this.activatedListener.bind(this),this.boundDectivatedListener=this.deactivatedListener.bind(this),document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,this.boundActivatedListener),document.body.addEventListener(BreaseEvent.CONTENT_DEACTIVATED,this.boundDectivatedListener),this.check()};s.prototype.activatedListener=function(e){var t=this.contentsToLoad.indexOf(e.detail.contentId);t>-1&&this.contentsToLoad.length>0&&this.contentsToLoad.splice(t,1),this.check()},s.prototype.deactivatedListener=function(e){var t=this.contentsToRemove.indexOf(e.detail.contentId);t>-1&&this.contentsToRemove.length>0&&this.contentsToRemove.splice(t,1),this.check()},s.prototype.check=function(){if(this.container&&"active"===this.container.status&&this.pageId===e.getLatestRequest(this.container.id)){if(0===this.contentsToLoad.length&&0===this.contentsToRemove.length){if(r(this.pageId,this.container.id),Array.isArray(this.embedded))for(var t=0;t<this.embedded.length;t+=1)r(this.embedded[t].pageId,this.embedded[t].containerId);this.dispose()}}else this.dispose()},s.prototype.dispose=function(){this.container=null,this.contentsToLoad=null,this.contentsToRemove=null,this.embedded=null,document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this.boundActivatedListener),document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,this.boundDectivatedListener)};function n(e){var t=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)!0!==brease.uiController.bindingController.isContentActive(e[i])&&t.push(e[i]);return t}function a(e){var t=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)brease.uiController.bindingController.getContentState(e[i])!==ContentStatus.deactivated&&t.push(e[i]);return t}function r(e,t){brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.PAGE_LOADED,{bubbles:!0,cancelable:!0,detail:{pageId:e,containerId:t}}))}return e}),define("brease/controller/libs/ContentValidator",["brease/controller/libs/LogCode","brease/controller/libs/AreaManager","brease/objects/Area","brease/controller/libs/Containers","brease/controller/objects/PageType","brease/core/Utils"],function(LogCode,AreaManager,e,t,PageType,Utils){"use strict";var ContentValidator={};ContentValidator.injectDependencies=function(e){e.visuModel&&(this.visuModel=e.visuModel),e.contentManager&&(this.contentManager=e.contentManager),e.loaderPool&&(this.loaderPool=e.loaderPool)},ContentValidator.getTargetForContent=function(e,t){var o=!0!==t?n(e.contentId):{success:!0};if(!o.success)return o;var l,d;if(o=a(e.pageId,e.pageType),!o.success)return o;d=o.data.page,l=o.data.containerId;var c;if(o=r(e,d,l),!o.success)return o;c=o.data.area;var h=s(c,d),u=ContentValidator.contentManager.getContent(h),g=h&&u.areaId===c.id&&ContentValidator.contentManager.isPending(h),m=e.contentId;if(ContentValidator.contentManager.isPending(m)||g)return o.success=!1,o.statusCode=LogCode.CONTENT_LOADING_IN_PROCESS,o.data={areaId:e.areaId,pageId:e.pageId,layoutId:d.layout,contentId:g?h:m},o;var p=i(d,e.areaId,e.contentId);return o.data={area:c,assignment:p},o},ContentValidator.getTargetForWidget=function(i,s,n,a,r,o){var l="A0",d=i,c="virtualPage_"+i,h=new e("A0",{width:r.realWidth,cssWidth:r.cssWidth,height:r.realHeight,cssHeight:r.cssHeight,top:0,left:0}),u=ContentValidator.visuModel.getContentById(n),g;if(0===o.length){ContentValidator.visuModel.addLayout(d,{id:d,areas:{}}),ContentValidator.visuModel.addArea(d,h),ContentValidator.visuModel.addPage(c,{id:c,layout:d,type:"Page",visuId:u?u.visuId:ContentValidator.visuModel.startVisuId,assignments:{}}),ContentValidator.visuModel.addAssignment("A0",c,{areaId:"A0",contentId:s,type:"Content",zoomMode:a}),t.addContainer(i,{currentPage:c}),g=AreaManager.add(i,d,h,"Page");var m=document.getElementById(i);m&&m.appendChild(g.div)}else g=AreaManager.getArea(i,d,"A0","Page"),g.$div=o,g.div=o[0],g.$innerBox=o.find(" > .ScrollBox"),g.innerBox=g.$innerBox[0],g.info=h;return{areaDivId:g?g.id:void 0,areaId:"A0",pageId:c}};function i(e,t,i){var s={},n=ContentValidator.visuModel.findAssignment(e,t);return n&&(s=Utils.deepCopy(n)),s.contentId=i,s}function s(e,t){var i=document.querySelectorAll("#"+e.id+' [data-brease-widget="system/widgets/ContentLoader"]'),s;return s=0===i.length?t.assignments[e.info.id].contentId:i[0].getAttribute("data-brease-contentid"),s||t.assignments[e.info.id].contentId}function n(e){var t=ContentValidator.visuModel.getContentById(e);return void 0===t||!0===t.virtual?{success:!1,statusCode:LogCode.CONTENT_NOT_FOUND,data:{contentId:e}}:!0===ContentValidator.loaderPool.isContentLoaded(e)?{success:!1,statusCode:LogCode.CONTENT_IS_ACTIVE,data:{contentId:e}}:{success:!0,statusCode:0,data:{}}}function a(e,i){var s={success:!0,statusCode:0,data:{}};if(i===PageType.PAGE){if(s.data.page=ContentValidator.visuModel.getPageById(e),!s.data.page)return s.success=!1,s.statusCode=LogCode.PAGE_NOT_FOUND,s.data={pageId:e,isStartPage:!1},s}else if(i===PageType.DIALOG&&(s.data.page=ContentValidator.visuModel.getDialogById(e),!s.data.page))return s.success=!1,s.statusCode=LogCode.DIALOG_NOT_FOUND,s.data={dialogId:e},s;return s.data.containerId=t.getContainerForPage(e),void 0===s.data.containerId&&(s.success=!1,s.statusCode=LogCode.PAGE_NOT_CURRENT,s.data={pageId:e}),s}function r(e,t,i){if(!1===ContentValidator.visuModel.pageHasArea(e.areaId,t))return{success:!1,statusCode:LogCode.AREA_NOT_FOUND,data:{areaId:e.areaId,pageId:e.pageId,layoutId:t.layout}};var s=AreaManager.getArea(i,t.layout,e.areaId,t.type);return s?{success:!0,statusCode:0,data:{area:s}}:{success:!1,statusCode:LogCode.AREA_NOT_FOUND,data:{areaId:e.areaId,pageId:e.pageId,layoutId:t.layout}}}return ContentValidator}),define("brease/controller/libs/FactoryUtils",["brease/core/Utils","brease/enum/Enum"],function(Utils,Enum){"use strict";return{wrapper:document.createElement("div"),createNode:function(e,t,i,s,n,a){var r=!1,o=-1!==e.indexOf(">CONTENT<");this.wrapper.innerHTML=e.replace(/{WIDGET_ID}/g,t);var l=this.wrapper.firstChild;if(l.id=t,l.setAttribute("data-brease-widget",s),n)for(var d in n)l.setAttribute(d,n[d]);var c=l.getAttribute("data-instruction-addStyleClass"),h=l.getAttribute("data-instruction-useDOM");return"true"===c&&void 0!==i.style&&(Utils.addClass(l,s.replace(/\//g,"_")+"_style_"+i.style),i.styleClassAdded=!0),"true"===h||o||(l.innerHTML="",r=!0),null!==h&&l.removeAttribute("data-instruction-useDOM"),null!==c&&l.removeAttribute("data-instruction-addStyleClass"),Utils.addClass(l,"breaseWidget"),o&&this.setInitialContent(l,a,r),l},setInitialContent:function(e,t,i){void 0!==t?void 0!==t.text?e.textContent=t.text+"":void 0!==t.html?e.innerHTML=t.html+"":!0!==i&&(e.innerHTML=""):!0!==i&&(e.innerHTML="")},getElem:function(e){return void 0!==e&&null!==e?void 0!==e.jquery?e=e.length>0?e[0]:null:"function"!=typeof e.querySelectorAll&&(e=null):e=null,e},ensureContentId:function(e,t,i){if(Utils.isString(e)&&""!==e)return e;if(i>Enum.WidgetState.NON_EXISTENT){var s=brease.callWidget(t.id,"getSettings");if(s&&void 0!==s.parentContentId)return s.parentContentId}if(e=t.attributes["data-brease-contentid"],void 0!==e)return e.value;var n=$(t).closest("[data-brease-contentid]");return e=n.length>0?n.attr("data-brease-contentid"):brease.settings.globalContent,e},ensureElemId:function(e){return e||(e=Utils.uniqueID("generatedWidgetId")),e}}}),define("brease/controller/libs/FocusElem",["brease/events/BreaseEvent","brease/core/Utils"],function(BreaseEvent,Utils){"use strict";var e=function(e,n){this.elem=e,this.settings={tabIndex:n.tabIndex,focusable:!0,parentContentId:n.parentContentId,enable:void 0===n.enable||n.enable,visible:void 0===n.visible||n.visible},n.omitFocusStyle?(e.classList.remove("breaseFocusable"),e.style.outline="none"):(e.classList.add("breaseFocusable"),e.style.removeProperty("outline")),s.call(this),document.body.dispatchEvent(new CustomEvent(BreaseEvent.FOCUS_ELEM_READY,{detail:this})),this._bindedOnFocus=t.bind(this),this._bindedOnBlur=i.bind(this),this.elem.addEventListener("focus",this._bindedOnFocus),this.elem.addEventListener("blur",this._bindedOnBlur)};e.prototype.dispose=function(){this.elem.removeEventListener("focus",this._bindedOnFocus),this.elem.removeEventListener("blur",this._bindedOnBlur),document.body.dispatchEvent(new CustomEvent(BreaseEvent.FOCUS_ELEM_DISPOSED,{detail:this})),this.elem.style.removeProperty("outline"),this.elem.classList.remove("breaseFocusable"),this.elem=null},e.prototype.getParentContentId=function(){return this.settings.parentContentId},e.prototype.getTabIndex=function(){return this.settings.tabIndex},e.prototype.isEnabled=function(){return this.settings.enable},e.prototype.disable=function(){this.settings.enable&&(n.call(this,BreaseEvent.BEFORE_ENABLE_CHANGE,!1),this.settings.enable=!1,s.call(this))},e.prototype.enable=function(){this.settings.enable||(n.call(this,BreaseEvent.BEFORE_ENABLE_CHANGE,!0),this.settings.enable=!0,s.call(this))},e.prototype.hide=function(){this.settings.visible&&(n.call(this,BreaseEvent.BEFORE_VISIBLE_CHANGE,!1),this.settings.visible=!1)},e.prototype.show=function(){this.settings.visible||(n.call(this,BreaseEvent.BEFORE_VISIBLE_CHANGE,!0),this.settings.visible=!0)},e.prototype.isFocusable=function(){return this.settings.tabIndex>-1&&this.isEnabled()&&Utils.isVisible(this.elem)};function t(){this.elem.dispatchEvent(new CustomEvent(BreaseEvent.FOCUS_IN,{bubbles:!0}))}function i(){this.elem.dispatchEvent(new CustomEvent(BreaseEvent.FOCUS_OUT,{bubbles:!0}))}function s(){!brease.config.editMode&&brease.config.visu.keyboardOperation&&this.settings.tabIndex>-1&&this.settings.enable?this.elem.tabIndex=this.settings.tabIndex:this.elem.removeAttribute("tabIndex")}function n(e,t){this.elem.dispatchEvent(new CustomEvent(e,{detail:{value:t},bubbles:!0}))}return e}),define("brease/controller/libs/LoadCycle",["brease/events/BreaseEvent","brease/events/ClientSystemEvent"],function(BreaseEvent,ClientSystemEvent){"use strict";var LoadCycle=function(){this.inProgress=!1,this.contentsToLoad=[],this.contentsToRemove=[],this.contentLoadededListener=s.bind(this),this.dialogAbortedListener=i.bind(this),this.contentDeactivatedListener=n.bind(this),this.timeoutCallback=d.bind(this),document.body.addEventListener(ClientSystemEvent.CONTENT_LOADED,this.contentLoadededListener),document.body.addEventListener(BreaseEvent.CONTENT_LOAD_ABORTED,this.contentLoadededListener),document.body.addEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,this.dialogAbortedListener),document.body.addEventListener(BreaseEvent.CONTENT_SUSPENDED,this.contentDeactivatedListener),document.body.addEventListener(BreaseEvent.CONTENT_DISPOSED,this.contentDeactivatedListener)},e={deactivate:5e3,activate:16e3},t=new Map;LoadCycle.prototype.add=function(e,t){this.inProgress=!0,a(this.contentsToLoad,e),o.call(this,e,"activate"),t&&(a(this.contentsToRemove,t),o.call(this,t,"deactivate"))},LoadCycle.prototype.reset=function(){this.inProgress=!1,this.contentsToLoad=[],this.contentsToRemove=[]};function i(e){var t=this;e.detail&&Array.isArray(e.detail.arContentId)&&e.detail.arContentId.forEach(function(e){l(e),r(t.contentsToLoad,e)}),c.call(this)}function s(e){
l(e.detail.contentId),r(this.contentsToLoad,e.detail.contentId),c.call(this)}function n(e){l(e.detail.contentId),r(this.contentsToRemove,e.detail.contentId),-1!==this.contentsToLoad.indexOf(e.detail.contentId)&&r(this.contentsToLoad,e.detail.contentId),c.call(this)}function a(e,t){if(Array.isArray(e)){-1===e.indexOf(t)&&e.push(t)}}function r(e,t){if(Array.isArray(e)){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}}function o(i,s){var n=window.setTimeout(this.timeoutCallback,e[s],i);t.set(i,{timeout:n,type:s})}function l(e){var i=t.get(e);i&&i.timeout&&(window.clearTimeout(i.timeout),t.delete(e))}function d(e){var i=t.get(e);i&&("activate"===i.type?r(this.contentsToLoad,e):r(this.contentsToRemove,e),t.delete(e),c.call(this))}function c(){0===this.contentsToLoad.length&&0===this.contentsToRemove.length&&(this.inProgress=!1)}return LoadCycle}),define("brease/controller/libs/Queue",["brease/core/Utils","brease/core/libs/Deferred"],function(Utils,Deferred){"use strict";var Queue=function Queue(e,t){e.id||e.setAttribute("id",Utils.uniqueID(t+"_queue")),this.id=e.id,this.elem=e,this.queue=[],this.idQueue=[],this.runningQueue=[],this.processLength=0,this.task=t,this.isRunning=!1,void 0===a[this.task]&&(a[this.task]=new Map),a[this.task].set(this.id,this)},e=Queue.prototype;e.add=function(e){if(Array.isArray(e))for(var i=0;i<e.length;i+=1)t.call(this,e[i]);else t.call(this,e);!0===this.isRunning&&this.queue.length>0&&n.call(this)};function t(e){i(e)&&!s.call(this,e)&&(this.queue.push(e),this.idQueue.push(e.id),this.processLength+=1)}function i(e){return Utils.isString(e.id)&&""!==e.id}function s(e){return-1!==this.idQueue.indexOf(e.id)}e.start=function(e,t){return!0!==this.isRunning&&(this.isRunning=!0,this.runMethod=e,this.deferred=new Deferred(Deferred.TYPE_SINGLE,t),0===this.queue.length?(this.stop(),this.finish()):n.call(this)),this.deferred};function n(){var e=this.queue.slice(0),t=this;this.queue=[],e.forEach(function(e){t.runningQueue.push(e),t.runMethod(e,t)})}e.finish=function(){this.deferred&&(this.deferred.resolve(this.elem,this.runningQueue),this.queue=[],this.idQueue=[],this.runningQueue=[],this.processLength=0,this.runMethod=null,this.elem=null,a[this.task].delete(this.id))},e.finishItem=function(){!0===this.isRunning&&(this.processLength-=1,0===this.processLength&&(this.isRunning=!1,this.finish()))},e.stop=function(){this.processLength=0,this.isRunning=!1,this.pending=!1};var a={};return Queue.getQueue=function(e,t,i){var s;return void 0!==e.id&&void 0!==a[t]&&(s=a[t].get(e.id),void 0!==s&&(s.elem=e)),!0===i&&void 0===s&&(s=new Queue(e,t)),s},Queue}),define("brease/objects/WidgetObject",[],function(){"use strict";var e=function(e){var t=this;["id","contentId","state","suspendedState","widget","options"].forEach(function(i){void 0!==e[i]&&(t[i]=e[i])})};return e.prototype.toJSON=function(){var e={},t=this;return["id","contentId","state","suspendedState","options"].forEach(function(i){void 0!==t[i]&&(e[i]=t[i])}),e.widget=this.widget?"[object widget]":null===this.widget?"null":"undefined",e},e}),define("brease/model/WidgetModel",["brease/objects/WidgetObject","brease/core/Utils","brease/enum/Enum"],function(e,Utils,Enum){"use strict";function t(){this.initialState=Enum.WidgetState.IN_QUEUE,this.reset()}return t.prototype.reset=function(e){var t=this;if(this.items=new Map,!0!==e)this.contents={};else{var i=brease.settings.globalContent,s=this.contents[i];this.contents={},this.contents[i]=s,s.forEach(function(e,i){t.items.set(i,e)})}brease.config&&brease.config.mocked&&(window.widgetModel={items:this.items,contents:this.contents})},t.prototype.add=function(t){if(!t||!1===Utils.isString(t))throw new SyntaxError("cannot create widget without id");return this.items.set(t,new e({id:t,state:this.initialState})),this.items.get(t)},t.prototype.getWidget=function(e){return e&&!1!==Utils.isString(e)?this.items.get(e):void 0},t.prototype.getOrCreate=function(e){if(e&&!1!==Utils.isString(e))return void 0===this.items.get(e)&&this.add(e),this.items.get(e);throw new SyntaxError("cannot create widget without id")},t.prototype.deleteWidget=function(e){var t=this.items.get(e);if(t){var i=this.contents[t.contentId];i&&i.delete(e),this.items.delete(e)}},t.prototype.addToContent=function(e,t){var i=this.items.get(e);i&&(i.contentId=t,void 0===this.contents[t]&&(this.contents[t]=new Map),this.contents[t].set(e,i))},t.prototype.getWidgetsOfContent=function(e){return this.contents[e]},t}),define("brease/controller/WidgetController",["brease/core/Utils","brease/controller/libs/FactoryUtils","brease/enum/Enum","brease/events/BreaseEvent","brease/controller/libs/Queue","brease/model/WidgetModel"],function(Utils,e,Enum,BreaseEvent,Queue,t){"use strict";var i=new t,s={reset:function(e){i.reset(e)},getOptions:function(e,t){var s=i.getWidget(e);if(void 0!==s){var n=s.options;return t&&(s.options=void 0),n}},setOptions:function(e,t,s,n){var a=i.getOrCreate(e);a.options?a.options=!0===s?!0===n?Utils.deepCopy(t):t:Utils.extendOptions(a.options,t):a.options=!0===n?Utils.deepCopy(t):t,t&&void 0!==t.parentContentId&&i.addToContent(e,t.parentContentId)},optionsExist:function(e){var t=i.getWidget(e);return void 0!==t&&void 0!==t.options},addOption:function(e,t,s){var n=i.getOrCreate(e);void 0===n.options&&(n.options={}),n.options[t]=s},addWithState:function(e,t){i.add(e).state=t},setState:function(e,t){if(t===Enum.WidgetState.NON_EXISTENT)s.deleteWidget(e);else{var n=i.getWidget(e);n&&(n.state=t,void 0!==n.widget&&(n.widget.state=t))}},getState:function(e){if(!e)return Enum.WidgetState.NON_EXISTENT;var t=i.getWidget(e);return void 0!==t?t.state:Enum.WidgetState.NON_EXISTENT},setSuspendedState:function(e,t){var s=i.getWidget(e);s&&(s.suspendedState=t)},getSuspendedState:function(e){var t=i.getWidget(e);return void 0!==t?t.suspendedState:Enum.WidgetState.NON_EXISTENT},allPreviouslyReady:function(e){for(var t=!0,i,n=l(e),a=0;a<n.length;a+=1)if(i=s.getSuspendedState(n[a]),i!==Enum.WidgetState.READY){t=!1;break}return t},addWidget:function(e){var t=i.getOrCreate(e.elem.id);t.widget=e,(void 0===t.state||t.state<Enum.WidgetState.INITIALIZED)&&(t.state=Enum.WidgetState.INITIALIZED),e.settings&&e.settings.parentContentId&&i.addToContent(e.elem.id,e.settings.parentContentId)},getWidget:function(e){return i.getWidget(e)},deleteWidget:function(e){i.deleteWidget(e)},getWidgetsOfContent:function(e,t){return l(e,t)},disposeWidget:function(e){s.getState(e)>=Enum.WidgetState.INITIALIZED&&s.callWidget(e,"dispose")},dispose:function t(i,a,r,l){i=e.getElem(i),null!==i?(n(i),s.walkWidgets(i,a,"dispose",[l]),"function"==typeof r&&r()):o("dispose")},disposeInContent:function t(i,a,r){if(i=e.getElem(i),null!==i){n(i);for(var l=s.getWidgetsOfContent(a,Enum.WidgetState.ABORTED),d,c,h=0,u=l.length;h<u;h+=1)d=s.getState(l[h]),c=s.getSuspendedState(l[h]),d>Enum.WidgetState.IN_QUEUE&&(d<Enum.WidgetState.SUSPENDED||c>Enum.WidgetState.IN_QUEUE)&&s.callWidget(l[h],"dispose"),s.deleteWidget(l[h]);"function"==typeof r&&r()}else o("dispose")},suspend:function t(i,a,r,l){i=e.getElem(i),null!==i?(n(i),s.walkWidgets(i,a,"suspend",l),"function"==typeof r&&r()):o("suspend")},suspendInContent:function t(i,a,r){i=e.getElem(i),null!==i&&n(i);var o=s.getWidgetsOfContent(a,Enum.WidgetState.IN_QUEUE),l=o.length,d=0;for(d=0;d<l;d+=1)s.callWidget(o[d],"suspend");for(d=0;d<l;d+=1)s.setSuspendedState(o[d],s.getState(o[d])),s.setState(o[d],Enum.WidgetState.SUSPENDED);"function"==typeof r&&r()},wake:function t(i,n,a){if(i=e.getElem(i),null!==i){var r=new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:brease.language.getCurrentLanguage()}}),l=new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,{detail:{currentMeasurementSystem:brease.measurementSystem.getCurrentMeasurementSystem()}}),d=new CustomEvent(BreaseEvent.USER_CHANGED,{detail:brease.user.getCurrentUser()}),c=new CustomEvent(BreaseEvent.CULTURE_CHANGED,{detail:brease.culture.getCurrentCulture().key});s.walkWidgets(i,n,"wake",[{language:r,mms:l,user:d,culture:c}]),"function"==typeof a&&a()}else o("wake")},wakeWidget:function e(t,i){if(s.getState(t)>=Enum.WidgetState.INITIALIZED){var n=new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:brease.language.getCurrentLanguage()}}),a=new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,{detail:{currentMeasurementSystem:brease.measurementSystem.getCurrentMeasurementSystem()}}),r=new CustomEvent(BreaseEvent.USER_CHANGED,{detail:brease.user.getCurrentUser()}),o=new CustomEvent(BreaseEvent.CULTURE_CHANGED,{detail:brease.culture.getCurrentCulture().key});s.callWidget(t,"wake",[{language:n,mms:a,user:r,culture:o}]),"function"==typeof i&&i()}},wakeInContent:function e(t,i){var n=new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:brease.language.getCurrentLanguage()}}),a=new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,{detail:{currentMeasurementSystem:brease.measurementSystem.getCurrentMeasurementSystem()}}),r=new CustomEvent(BreaseEvent.USER_CHANGED,{detail:brease.user.getCurrentUser()}),o=new CustomEvent(BreaseEvent.CULTURE_CHANGED,{detail:brease.culture.getCurrentCulture().key}),l=s.getWidgetsOfContent(t,Enum.WidgetState.IN_QUEUE),d=0,c=l.length,h=["","wake",{language:n,mms:a,user:r,culture:o},brease.config.ContentCaching.preserveOldValues],u;for(d=0;d<c;d+=1)s.setState(l[d],Enum.WidgetState.READY);for(d=0;d<c;d+=1)u=brease.uiController.bindingController.getSubscriptionsForElement(l[d]),h[0]=l[d],u?h[4]=u:h.length=4,s.callWidget.apply(null,h);h.length=0,"function"==typeof i&&i()},walkWidgets:function e(t,i,n,a){var r=s.findWidgets(t,i);if(r.length>0)for(var o=0,l=r.length;o<l;o+=1)if("suspend"===n&&(s.setSuspendedState(r[o],s.getState(r[o])),s.setState(r[o],Enum.WidgetState.SUSPENDED)),"wake"===n){s.setState(r[o],Enum.WidgetState.READY);var d=brease.uiController.bindingController.getSubscriptionsForElement(r[o]);s.callWidget.apply(null,a?[r[o],n].concat(a,d?[brease.config.ContentCaching.preserveOldValues,d]:[brease.config.ContentCaching.preserveOldValues]):[r[o],n])}else s.callWidget.apply(null,a?[r[o],n].concat(a):[r[o],n])},walkWidgetsInContent:function e(t,i,n){for(var a=s.getWidgetsOfContent(t,n||Enum.WidgetState.INITIALIZED),r=0,o=a.length;r<o;r+=1)s.callWidget(a[r],i)},callWidget:function e(t,i){var n=s.getWidget(t);if(void 0!==n&&void 0!==n.widget){var a=n.widget;if(void 0!==a[i]){if(c(i,n.state)){var r=[],o=arguments.length,l=2;if(o>2)for(var d=2;d<o;d+=1)r.push(arguments[d]);return a[i].apply(a,r)}return console.iatInfo("[callWidget:"+i+"] widget '"+t+"' in unavailable state:"+n.state),null}return"widget"===i?a:(console.iatWarn("[callWidget] widget '"+t+"' has no method '"+i+"'"),null)}return console.iatWarn('[callWidget] no widget with id "'+t+'" (method call "'+i+'")'),null},isWidgetCallable:function(e){var t=s.getState(e);return t===Enum.WidgetState.READY||t===Enum.WidgetState.INITIALIZED},findWidgets:function t(i,n,a){var r=[],l,d;if(a=void 0!==a?a:Enum.WidgetState.INITIALIZED,i=e.getElem(i),null!==i){if(l=i.querySelectorAll("[data-brease-widget]"),!0===n&&null!==i.getAttribute("data-brease-widget")&&s.getState(i.id)>=a&&r.push(i.id),l.length>0)for(var c=l.length-1;c>=0;c-=1)d=l[c],s.getState(d.id)>=a&&r.push(l[c].id)}else o("findWidgets");return r}};function n(e){var t=Queue.getQueue(e,"parse"),i=Queue.getQueue(e,"create"),s=0;if(void 0!==i&&(!0===i.isRunning||!0===i.pending)){for(i.stop(),s=0;s<i.runningQueue.length;s+=1)a(i.runningQueue[s]);i.finish()}if(void 0!==t&&!0===t.isRunning){for(t.stop(),s=0;s<t.runningQueue.length;s+=1)a(t.runningQueue[s]);for(s=0;s<t.runningQueue.length;s+=1)r(e,t.runningQueue[s]);t.finish()}}function a(e){e.state<Enum.WidgetState.INITIALIZED&&(e.state=Enum.WidgetState.ABORTED)}function r(e,t){try{t.state!==Enum.WidgetState.ABORTED&&t.state!==Enum.WidgetState.FAILED||void 0!==e.children[t.elem.id]&&e.removeChild(t.elem)}catch(e){console.log("%c"+e.message,"color:red;")}}function o(e,t){var i=t||"["+e+"] target of wrong type";console.iatWarn(i),brease.loggerService.log(Enum.EventLoggerId.CLIENT_PARSE_ERROR,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.WARNING,[],i)}function l(e,t){var s=[],n=i.getWidgetsOfContent(e);return t=void 0!==t?t:Enum.WidgetState.INITIALIZED,void 0!==n&&n.forEach(function(i,n){void 0!==i&&i.contentId===e&&i.state>=t&&s.push(n)}),s}function d(e){return Utils.isString(e)&&0===e.indexOf("get")}function c(e,t){return t===Enum.WidgetState.READY||t===Enum.WidgetState.INITIALIZED||t===Enum.WidgetState.SUSPENDED&&("dispose"===e||"onBeforeDispose"===e||d(e))}return s}),define("brease/controller/objects/LoaderItem",[],function(){"use strict";return function(e,t){this.id=e,this.contentId=t}}),define("brease/controller/libs/LoaderPool",["brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/controller/WidgetController","brease/controller/libs/Utils","brease/controller/objects/LoaderItem","brease/settings"],function(BreaseEvent,Enum,e,t,Utils,LoaderItem,i){"use strict";var LoaderPool=function(e){this.slots=0,void 0!==e?this.setSlots(e):this.maxSlots=i.cachingSlotsDefault,this.locker=document.createDocumentFragment(),this.pool={},this.createPool=new Map,this.contentCount={}},s=0;LoaderPool.prototype.dispose=function(){for(var e in this.pool)brease.uiController.getWidgetState(e)>Enum.WidgetState.NON_EXISTENT&&brease.callWidget(e,"dispose");this.pool={},this.slots=0,this.contentsToLoad=[],this.contentCount={},this.setCounter(0)},LoaderPool.prototype.setSlots=function(e){this.maxSlots=void 0!==e?Math.max(0,parseInt(e,10)):i.cachingSlotsDefault,this.maxSlots=Math.min(this.maxSlots,i.cachingSlotsMax)},LoaderPool.prototype.loadContent=function(e,i,s){if(!e||void 0===e.path)return n.call(this,s,i),void 0;c.call(this,e);var o=i.find(".systemContentLoader"),l=o.length,d=!1;if(l>0){var u=o[0],g=u.id;if(t.callWidget(g,"getUrl")===e.path)s.resolve(g,!1),d=!0;else if(l>1){Utils.resetContentControls(i[0]);for(var m=Utils.findLoaders(i[0]),p=0,f=m.length;p<f;p+=1)r.call(this,m[p])}else r.call(this,u)}else a.call(this,i);d||h.call(this,e,i[0],s)};function n(e,t){var i=t.find(".systemContentLoader");i.length>0?r.call(this,i[0]):a.call(this,t),e.reject("CONTENT_NOT_FOUND",t[0])}function a(e){var t=this.createPool.get(e[0].id);t&&r.call(this,{id:t.loaderId})}function r(e){if(t.getState(e.id)<Enum.WidgetState.INITIALIZED){t.setOptions(e.id,{url:"",contentId:""});var i=this.createPool.get(e.id);i&&(i.contentId="")}else this.suspendLoader(e)}LoaderPool.prototype.isContentLoaded=function(e){for(var i in this.pool)if(!0===this.pool[i].inUse&&e===t.callWidget(i,"getContentId"))return!0;return!1},LoaderPool.prototype.suspendLoader=function(e,i){if(!0===this.tagMode&&!0!==i){var s=t.callWidget(e.id,"getContentId"),n=o.call(this,s),a=this.pool[e.id];a&&(n?a.tag="parked":(a.tag="suspend",t.callWidget(e.id,"onBeforeSuspend")),this.locker.appendChild(e),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_REMOVED,{detail:{contentId:s}})))}else t.callWidget(e.id,"onBeforeSuspend"),l.call(this,e)},LoaderPool.prototype.flushLoader=function(e,i){if(!0===this.tagMode&&!0!==i){var s=t.callWidget(e.id,"getContentId"),n=o.call(this,s),a=this.pool[e.id];a&&(n?a.tag="parked":(a.tag="flush",t.callWidget(e.id,"onBeforeDispose")),this.locker.appendChild(e),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_REMOVED,{detail:{contentId:s}})))}else t.callWidget(e.id,"onBeforeDispose"),d.call(this,e)},LoaderPool.prototype.removeLoader=function(e,t){this.slots<=this.maxSlots?this.suspendLoader(e,t):this.flushLoader(e,t)};function o(e){return-1!==this.contentsToLoad.indexOf(e)}LoaderPool.prototype.startTagMode=function(e){if(!0!==this.tagMode){for(var t in this.pool)this.pool[t].tag="";this.tagMode=!0,this.contentsToLoad=void 0!==e?e:[]}},LoaderPool.prototype.endTagMode=function(){this.tagMode=!1;for(var e in this.pool)"suspend"===this.pool[e].tag&&(0===this.maxSlots?d.call(this,this.locker.querySelector("#"+e)):l.call(this,this.locker.querySelector("#"+e))),"flush"===this.pool[e].tag&&d.call(this,this.locker.querySelector("#"+e))},LoaderPool.prototype.createNew=function(e,t,i){f.call(this,e,t,i)},LoaderPool.prototype.getCounter=function(){return s},LoaderPool.prototype.setCounter=function(e){return s=e,!0},LoaderPool.prototype.findContentLoaderWithContent=function(e){var i,s=this.pool;for(var n in s)if(t.callWidget(n,"getUrl")===e){i=s[n];break}return i};function l(i){var s=this.pool[i.id];if(void 0!==s)try{t.callWidget(i.id,"suspend")}catch(t){e.logError(t)}finally{var n=t.callWidget(i.id,"getContentId");s.tag="",s.inUse=!1,this.locker.contains(i)||(this.locker.appendChild(i),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_REMOVED,{detail:{contentId:n}})))}else console.iatWarn("no loader with id="+i.id+" found!")}function d(i){var s=this.pool[i.id];if(void 0!==s)try{t.callWidget(i.id,"flush")}catch(t){e.logError(t)}finally{s.tag="",s.inUse=!1,s.contentId="",this.locker.appendChild(i)}else console.iatWarn("no loader with id="+i.id+" found!")}function c(e){void 0===this.contentCount[e.id]&&(this.contentCount[e.id]=0),this.contentCount[e.id]+=1}function h(i,s,n){var a=m.call(this,i.path);if(a){e.prependChild(s,this.locker.querySelector("#"+a.id));try{"parked"!==a.tag?t.allPreviouslyReady(i.id)?t.callWidget(a.id,"wake"):t.callWidget(a.id,"load",i.path,i.id,!0):t.callWidget(a.id,"widget").suspended&&t.callWidget(a.id,"wake")}catch(t){e.logError(t)}finally{a.tag="",a.inUse=!0,a.contentId=i.id,n.resolve(a.id,!0)}}else u.call(this,s,i,n)}function u(e,t,i){if(this.slots<this.maxSlots)f.call(this,e,t,i);else{var s=g.call(this,t.id);void 0!==s?p.call(this,s,e,t,i):f.call(this,e,t,i)}}function g(e){var i,s,n,a=Number.POSITIVE_INFINITY,r=this.pool;for(var o in r)if(!0!==r[o].inUse||"suspend"===r[o].tag||"flush"===r[o].tag){if(n=this.contentCount[r[o].contentId],e===t.callWidget(o,"getContentId")){s=o;break}n<a&&(a=n,s=o)}return s&&(i=r[s]),i}function m(e){var i,s=this.pool;for(var n in s)if(t.callWidget(n,"getUrl")===e&&(!0!==s[n].inUse||"suspend"===s[n].tag||"flush"===s[n].tag||"parked"===s[n].tag)){i=s[n];break}return i}function p(i,s,n,a){var r=i.tag;i.tag="",i.inUse=!0,brease.pageController.emptyContainer(s),e.prependChild(s,this.locker.querySelector("#"+i.id)),"flush"!==r&&t.callWidget(i.id,"onBeforeDispose"),i.contentId=n.id,t.callWidget(i.id,"load",n.path,n.id),a.resolve(i.id,!0)}function f(e,t,n){var a="SystemLoader"+(s+=1),r=this,o={contentReadyHandler:b.bind(r,e.id),initializedHandler:v.bind(r,e.id),deferred:n,containerId:e.id,contentId:t.id,loaderId:a};this.slots+=1,this.createPool.set(e.id,o),e.addEventListener(BreaseEvent.CONTENT_READY,o.contentReadyHandler),brease.uiController.createWidgets(e,[{className:"system.widgets.ContentLoader",id:a,options:{url:t.path,contentId:t.id},HTMLAttributes:{style:"box-sizing: border-box; position:relative; overflow:hidden;visibility:hidden;",class:"systemContentLoader"}}],!0,i.globalContent,"#"+e.id+" > :first-child")}function b(e,t){var i=this.createPool.get(e);if(t.target.id===e){t.target.removeEventListener(BreaseEvent.CONTENT_READY,i.contentReadyHandler);var s=document.getElementById(i.loaderId);s?s.addEventListener(BreaseEvent.WIDGET_INITIALIZED,i.initializedHandler):this.createPool.delete(e)}}function v(e,t){var i=this.createPool.get(e);if(i){var s=i.loaderId;t.target.id===s&&(t.target.removeEventListener(BreaseEvent.WIDGET_INITIALIZED,i.initializedHandler),this.pool[s]=new LoaderItem(s,i.contentId),this.pool[s].inUse=!0,i.deferred.resolve(s,!0),this.createPool.delete(e))}}return LoaderPool}),define("brease/controller/libs/PageCycle",["brease/events/EventDispatcher","brease/events/BreaseEvent","brease/events/ClientSystemEvent","brease/controller/ContentManager"],function(EventDispatcher,BreaseEvent,ClientSystemEvent,e){"use strict";var PageCycle=function(t){this.inProgress=!1,this.loadStack=[],this.contentsToLoad=[],this.contentManager=t||e,this.contentLoadededListener=s.bind(this),this.contentDeactivatedListener=n.bind(this),this.dialogAbortedListener=a.bind(this)};PageCycle.prototype=new EventDispatcher,PageCycle.prototype.reset=function(){this.inProgress=!1,this.contentsToLoad=[],this.loadStack=[]},PageCycle.prototype.start=function(e,i,s,n){var a=n&&!0===n.embedCall;!1===this.inProgress?(this.inProgress=!0,this.callback=e,this.callbackInfo=n||{},this.contentsToRemove=s||[],document.body.addEventListener(ClientSystemEvent.CONTENT_LOADED,this.contentLoadededListener),document.body.addEventListener(BreaseEvent.CONTENT_SUSPENDED,this.contentDeactivatedListener),document.body.addEventListener(BreaseEvent.CONTENT_DISPOSED,this.contentDeactivatedListener),document.body.addEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,this.dialogAbortedListener)):a&&(void 0===this.callbackInfo&&(this.callbackInfo={}),void 0===this.callbackInfo.embedded&&(this.callbackInfo.embedded=[]),this.callbackInfo.embedded.push({containerId:n.containerId,pageId:n.pageId})),a||(t(this.loadStack,i),t(this.contentsToLoad,i),0===this.loadStack.length&&0===this.contentsToRemove.length&&o.call(this))},PageCycle.prototype.remove=function(e,t){!0===t?i(this.loadStack,e):this.contentManager.isContentActive(e)&&i(this.loadStack,e),!0===t&&this.callbackInfo&&Array.isArray(this.callbackInfo.contentsToLoad)&&i(this.callbackInfo.contentsToLoad,e),0===this.loadStack.length&&!0===this.inProgress&&r.call(this)};function t(e,t){if(Array.isArray(t))for(var i=0;i<t.length;i+=1)-1===e.indexOf(t[i])&&e.push(t[i])}function i(e,t){if(Array.isArray(e)){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}}function s(e){i(this.loadStack,e.detail.contentId),0===this.loadStack.length&&!0===this.inProgress&&r.call(this)}function n(e){i(this.contentsToRemove,e.detail.contentId),i(this.loadStack,e.detail.contentId),0===this.loadStack.length&&!0===this.inProgress&&r.call(this)}function a(e){var t=this;e.detail&&Array.isArray(e.detail.arContentId)&&e.detail.arContentId.forEach(function(e){i(t.loadStack,e)}),0===this.loadStack.length&&!0===this.inProgress&&r.call(this)}Object.defineProperty(PageCycle.prototype,"isEmpty",{get:function(){return 0===this.length},enumerable:!0,configurable:!1}),Object.defineProperty(PageCycle.prototype,"length",{get:function(){return this.loadStack.length},enumerable:!0,configurable:!1});function r(){if("function"==typeof this.callback){var e=this.callback;this.callback=null,e(this.callbackInfo),this.callbackInfo=null}0===this.loadStack.length&&0===this.contentsToRemove.length&&!0===this.inProgress&&o.call(this)}function o(){this.inProgress=!1,this.loadStack=[],this.contentsToLoad=[],document.body.removeEventListener(ClientSystemEvent.CONTENT_LOADED,this.contentLoadededListener),document.body.removeEventListener(BreaseEvent.CONTENT_SUSPENDED,this.contentDeactivatedListener),document.body.removeEventListener(BreaseEvent.CONTENT_DISPOSED,this.contentDeactivatedListener),document.body.removeEventListener(BreaseEvent.DIALOG_OPEN_ABORTED,this.dialogAbortedListener),this.dispatchEvent({type:"CycleFinished"}),this.removeEventListener("CycleFinished")}return PageCycle}),define("brease/controller/libs/PageLogger",["brease/enum/Enum","brease/config","brease/controller/libs/LogCode"],function(Enum,config,LogCode){"use strict";var PageLogger=function(e,i){this.controller=e,this.settings={clientMessage:void 0!==i&&void 0!==i.clientMessage?i.clientMessage:t.clientMessage}},e=PageLogger.prototype,t={clientMessage:!0};e.log=function(e,t){var n=[],a=Promise.resolve();switch(e){case LogCode.PAGE_NOT_FOUND:console.iatWarn("referenced page ("+t.pageId+") does not exist!"),i(e,[t.pageId]),!0===t.isStartPage&&(a=s.call(this,e,[t.pageId||"undefined"]));break;case LogCode.CONTAINER_NOT_FOUND:console.iatWarn("referenced page ("+t.pageId+") does not exist!"),i(e,[t.pageId]),!0===t.isStartPage&&(a=s.call(this,e,[t.pageId||"undefined"]));break;case LogCode.DIALOG_NOT_FOUND:console.iatWarn("referenced dialog ("+t.dialogId+") does not exist!"),i(e,[t.dialogId]);break;case LogCode.NO_PAGES_FOUND:console.iatWarn('no pages in in visualisation (id="'+t.visuId+'") referenced!'),a=s.call(this,e,[t.visuId]),i(e,[t.visuId]);break;case LogCode.NO_LAYOUTS_FOUND:console.iatWarn('no layouts in in visualisation (id="'+t.visuId+'") referenced!'),a=s.call(this,e,[t.visuId],t.container),i(e,[t.visuId]);break;case LogCode.VISU_MALFORMED:a=s.call(this,e,[t.visuId],t.container),console.log("%cVisu file ("+t.visuId+".json) ist kein gueltiges JSON!","color:red;"),i(e,[t.visuId]);break;case LogCode.VISU_NOT_FOUND:a=s.call(this,e,[t.visuId],t.container),console.log("%cVisu file ("+t.visuId+".json) nicht gefunden","color:red;"),i(e,[t.visuId]);break;case LogCode.LAYOUT_NOT_FOUND:console.iatWarn('layout (id="'+t.layoutId+'") does not exist!'),i(e,[t.layoutId,t.pageId]),!0===t.isStartPage&&(a=s.call(this,e,[t.layoutId,t.pageId]));break;case LogCode.CONTENT_NOT_FOUND:console.iatWarn("content (id="+t.contentId+") not found!"),i(e,[t.contentId]);break;case LogCode.CONTENT_LOADING_IN_PROCESS:console.iatWarn("content loading in process!"),t.contentId?n.push(t.contentId):t.pageId&&n.push(t.pageId),i(e,n);break;case LogCode.CONTENT_IS_ACTIVE:console.iatWarn("content (id="+t.contentId+") already loaded!"),i(e,[t.contentId]);break;case LogCode.AREA_NOT_FOUND:console.iatWarn('area (id="'+t.areaId+'") not found! (pageId:"'+t.pageId+'", layoutId:"'+t.layoutId+")"),i(e,[t.areaId,t.layoutId,t.pageId]);break;case LogCode.PAGE_IS_CURRENT:console.iatWarn('page (id="'+t.pageId+'") is current! no need to load');break;case LogCode.PAGE_NOT_CURRENT:console.iatWarn('page (id="'+t.pageId+'") is currently not loaded'),i(e,[t.pageId]);break;case LogCode.NO_VISUDATA_FOUND:console.log("%cPageController.start, no visuData found","color:red;");break;case LogCode.THEME_NOT_FOUND:console.iatWarn("Theme (id="+t.themeId+") not found!"),i(e,[t.themeId],"themeId:"+t.themeId);break;case LogCode.VISU_ACTIVATE_FAILED:console.iatWarn("activate visu (id="+t.visuId+") denied,code="+t.code),a=s.call(this,e,[t.visuId,t.code],t.container);break}return a},e.message=function(){n.apply(this,arguments)};function i(e,t,i){var s=LogCode.getConfig(e);brease.loggerService.log(s.code,Enum.EventLoggerCustomer.BUR,s.verboseLevel,s.severity,t,i)}function s(e,t,i){var s=LogCode.getConfig(e).messageKey,a=this.controller.rootContainer;return!0===this.settings.clientMessage?n(s,t).then(function(e){i?($(i).html("<label>"+e+"</label>"),"appContainer"===i.id&&$("#splashscreen").remove()):($(a).html("<label>"+e+"</label>"),$("#splashscreen").remove())}):Promise.resolve()}function n(e,t){var i=brease.language.getSystemTextByKey("BR/IAT/"+e);return i===config.undefinedTextReturnValue&&(i=a[e]),void 0!==i?brease.textFormatter.format(i,t):Promise.resolve()}var a={"brease.error.STARTPAGE_NOT_FOUND":'startpage (id="{1}") not found!',"brease.error.NO_PAGES_FOUND":'no pages in visualization (id="{1}")!',"brease.error.NO_LAYOUTS_FOUND":'no layouts in visualization (id="{1}")!',"brease.error.INCORRECT_VISU":'Visualization (id="{1}") cannot be displayed!',"brease.error.VISU_NOT_FOUND":'Visualization (id="{1}") not found!',"brease.error.LAYOUT_NOT_FOUND":'Layout (id="{1}") for Page (id="{2}") not found!',"brease.error.CONTENT_NOT_FOUND":'content (id="{1}") not found!',"brease.error.ACTIVATE_VISU_FAILED":'Not allowed! License not available for visualization "{1}"!'};return PageLogger}),define("brease/controller/libs/PreCacheInfo",[],function(){"use strict";var PreCacheInfo=function(e,i,s,n){this.finishCallback=i,this.showProgressBar=e,this.messageDelay=n,this.preloadingInfo={},this.progressBar={width:100,step:100/(s-1)},t.call(this,s)};PreCacheInfo.prototype.updateCount=function(t,i){var s=this;s.showProgressBar&&(this.preloadingInfo.span.html(t),void 0!==i&&this.preloadingInfo.inner.html(i),e.call(this)),0===t&&(delete s.rejectedContents,s.showProgressBar&&(this.preloadingInfo.main.html("All contents have been precached"),this.progressBar.$el.slideUp("slow")),window.setTimeout(function(){s.showProgressBar&&s.preloadingInfo.wrapper.remove(),s.finishCallback()},this.messageDelay))};function e(){this.progressBar.width-=this.progressBar.step,this.progressBar.$el.width(this.progressBar.width+"%")}function t(e){var t="preLoadingInfo";if(this.showProgressBar){var i=$('<div class="preLoadingInfoWrapper"></div>');this.preloadingInfo.main=$('<div class="preLoadingInfo"><span>'+e+'</span> contents to preload: <div style="display: inline-block" class="preLoadingInfo_inner"></div></div>'),i.append(this.preloadingInfo.main),this.preloadingInfo.span=$("span",this.preloadingInfo.main).eq(0),this.preloadingInfo.inner=$(".preLoadingInfo_inner",this.preloadingInfo.main).eq(0),this.preloadingInfo.wrapper=$('<div class="system_brease_StartupProgressBar_style_default startupProgressBarWrapper" style="z-index:3;"></div>'),this.progressBar.$el=$('<div class="startupProgressBar"></div>'),this.preloadingInfo.wrapper.prepend(i),this.preloadingInfo.wrapper.append(this.progressBar.$el),$(document.body).prepend(this.preloadingInfo.wrapper)}}return PreCacheInfo}),define("brease/controller/libs/Themes",["brease/events/BreaseEvent","brease/core/Utils"],function(BreaseEvent,Utils){"use strict";var Themes={setTheme:function(e){var s=t?r(t):"",n=r(e),o=Utils.getStylesheetByHref(s),l=Utils.getStylesheetByHref(n);e!==t&&(t=e,void 0!==l?(void 0!==o&&(o.disabled=!0),l.disabled=!1,a(e)):i(n,e,o))},themeId2Url:function(e){return r(e)},getCurrentTheme:function(){return t}},e={},t;function i(t,i,a){window.clearTimeout(e.timeout),e.themeId=i,e.themeURL=t,e.time=Date.now(),e.timeout=window.setTimeout(s,100),e.oldTheme=a;var r=$('<link id="theme_'+i+'" href="'+t+'" rel="stylesheet" ></link');r[0].addEventListener("load",n,!1),r.appendTo($("head"))}function s(){var t=Utils.getStylesheetByHref(e.themeURL);t&&t.rules&&t.rules.length>0?n():Date.now()-e.time<5e3&&(e.timeout=window.setTimeout(s,100))}function n(){window.clearTimeout(e.timeout),void 0!==e.oldTheme&&(e.oldTheme.disabled=!0),a(e.themeId)}function a(){document.body.dispatchEvent(new CustomEvent(BreaseEvent.THEME_CHANGED,{detail:{themeId:t}}))}function r(e){return brease.config.themeFolder+e+".min.css"}return Themes}),define("brease/controller/objects/WidgetItem",[],function(){"use strict";return function(e,t,i){this.id=e.id,this.elem=e,this.state=t,this.parentContentId=i}}),define("brease/helper/SimpleQueue",[],function(){"use strict";function SimpleQueue(){this.queue=[]}return SimpleQueue.prototype.add=function(e){-1===this.queue.indexOf(e)&&this.queue.push(e)},SimpleQueue.prototype.remove=function(e){var t=this.queue.indexOf(e);-1!==t&&this.queue.splice(t,1)},SimpleQueue.prototype.contains=function(e){return-1!==this.queue.indexOf(e)},Object.defineProperty(SimpleQueue.prototype,"length",{get:function(){return this.queue.length}}),SimpleQueue.prototype.dispose=function(){this.queue.length=0},SimpleQueue}),define("system/widgets/ChangePasswordDialog/libs/Message",[],function(){"use strict";function Message(e,t){this.content=e||"",this.type=t||Message.Type.INFO}return Object.defineProperty(Message,"Type",{enumerable:!0,configurable:!1,writable:!1,value:{SUCCESS:"success",INFO:"info",WARNING:"warning",ERROR:"error"}}),Message}),define("brease/core/StringUtils",["brease/core/Utils"],function(Utils){"use strict";var StringUtils={};StringUtils.containsNumericAndAlphanumeric=function(e){if(!Utils.isString(e))return!1;for(var t=!1,n=!1,a=0;a<e.length;a+=1){var r=e[a];if(s(r)&&(t=!0),i(r)&&(n=!0),t&&n)return!0}return!1},StringUtils.containsSpecial=function(e){if(!Utils.isString(e))return!1;for(var t=0;t<e.length;t+=1){if(n(e[t]))return!0}return!1},StringUtils.containsMixedCase=function(i){if(!Utils.isString(i))return!1;for(var n=!1,a=!1,r=0;r<i.length;r+=1){var o=i[r];if(s(o)&&(e(o)&&(n=!0),t(o)&&(a=!0)),n&&a)return!0}return!1},StringUtils.testMinLength=function(e,t){return!!Utils.isString(e)&&(!!_.isInteger(t)&&e.length>=t)},StringUtils.testEquality=function(e,t){return e===t};function e(e){return e=""+e,e.toUpperCase()===e}function t(e){
return e=""+e,e.toLowerCase()===e}function i(e){return e=""+e,-1!=="0123456789".indexOf(e)}function s(e){return e=""+e,-1!=="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e)}function n(e){return e=""+e,!i(e)&&!s(e)}return StringUtils}),define("brease/services/libs/PasswordPolicies",["brease/core/Types"],function(Types){"use strict";var PasswordPolicies=function(e,t,i,s){this.alphanumeric=!0===e,this.mixedCase=!0===t,this.minLength=Types.parseValue(i,"Integer",{min:0,default:1}),this.specialChar=!0===s};return PasswordPolicies.fromServerData=function(e){return e?new PasswordPolicies(e.PasswordAlphanumeric,e.PasswordCase,e.PasswordMinLength,e.PasswordSpecialChar):new PasswordPolicies},PasswordPolicies}),define("system/widgets/ChangePasswordDialog/libs/Validator",["system/widgets/ChangePasswordDialog/libs/Message","brease/core/StringUtils","brease/services/libs/PasswordPolicies"],function(Message,StringUtils,PasswordPolicies){"use strict";var Validator=function(){},e=Validator.prototype;e.validate=function(e,i,s){var n=this,a=[],r=[],o=!0,l;e=Array.isArray(e)?e:[],s=void 0!==s?s:1,e.forEach(function(e){l=t.call(n,e,i,s),l.isValid||(a=a.concat(l.messages),r.push(e)),o=o&&l.isValid},this);var d={isValid:o,arError:a,arInputs:r};return l&&l.policiesResult&&(d.policiesResult=l.policiesResult),d};function t(e,t,s){var n={messages:[]},a;switch(e){case"userName":a=StringUtils.testMinLength(t.userName,s),a||(n.message=new Message(i("IAT/System/Dialog/CHANGEPASSWORD_USERNAME_EMPTY"),Message.Type.ERROR));break;case"oldPassword":a=StringUtils.testMinLength(t.oldPassword,1),a||n.messages.push(new Message(i("IAT/System/Dialog/CHANGEPASSWORD_OLDPASSWORD_EMPTY"),Message.Type.ERROR));break;case"confirmPassword":a=StringUtils.testEquality(t.confirmPassword,t.newPassword),a||n.messages.push(new Message(i("IAT/System/Dialog/CHANGEPASSWORD_PASSWORDS_DIFFERENT"),Message.Type.ERROR));break;case"newPassword":a=!StringUtils.testEquality(t.oldPassword,t.newPassword),a||n.messages.push(new Message(i("IAT/System/Dialog/CHANGEPASSWORD_NEWPASSWORD_NOTEQUAL_OLD"),Message.Type.ERROR)),this.policies?(n.policiesResult=this.testPolicies(t.newPassword,this.policies),a=a&&Object.keys(n.policiesResult).reduce(function(e,t){return e&&n.policiesResult[t]},!0),a||n.messages.push(new Message(i("IAT/System/Dialog/CHANGEPASSWORD_POLICIES_NOT_MET"),Message.Type.ERROR))):(a=a&&StringUtils.testMinLength(t.newPassword,1),a||n.messages.push(new Message(i("IAT/System/Dialog/CHANGEPASSWORD_NEWPASSWORD_EMPTY"),Message.Type.ERROR)));break}return n.isValid=a,n}e.setPolicies=function(e){e instanceof PasswordPolicies&&(this.policies=e)},e.testPolicies=function(e,t){var i={alphanumeric:!0,mixedCase:!0,minLength:!0,specialChar:!0};return t.alphanumeric&&(i.alphanumeric=StringUtils.containsNumericAndAlphanumeric(e)),t.mixedCase&&(i.mixedCase=StringUtils.containsMixedCase(e)),t.minLength&&(i.minLength=StringUtils.testMinLength(e,t.minLength)),t.specialChar&&(i.specialChar=StringUtils.containsSpecial(e)),i},e.dispose=function(){};function i(e){return brease.language.getText(e)}return Validator}),define("system/widgets/ChangePasswordDialog/libs/Elements",[],function(){"use strict";function Elements(e){for(var t in e)this[t]=e[t],this[t].elemId&&(this[t].$el=$("#"+this[t].elemId))}return Object.defineProperty(Elements.prototype,"dispose",{enumerable:!1,configurable:!1,writable:!1,value:function(){for(var e in this)this[e].$el&&this[e].$el.off(),this[e]=void 0}}),Object.defineProperty(Elements.prototype,"getMemberIdByElemId",{enumerable:!1,configurable:!1,writable:!1,value:function(e){var t;for(var i in this)if(this[i].elemId===e){t=i;break}return t}}),Object.defineProperty(Elements.prototype,"forEach",{enumerable:!1,configurable:!1,writable:!1,value:function(e){var t=this;Object.keys(this).forEach(function(i){e(t[i],i)})}}),Object.defineProperty(Elements.prototype,"map",{enumerable:!1,configurable:!1,writable:!1,value:function(e){var t=this,i=[];return Object.keys(this).map(function(s){i.push(e(t[s],s))}),i}}),Elements}),define("system/widgets/ChangePasswordDialog/libs/PolicyView",["brease/services/libs/PasswordPolicies"],function(PasswordPolicies){"use strict";var PolicyView=function(){this.lines={}},e={alphanumeric:"IAT/System/Dialog/POLICY_DESC_ALPHANUMERIC",mixedCase:"IAT/System/Dialog/POLICY_DESC_MIXEDCASE",minLength:"IAT/System/Dialog/POLICY_DESC_MINLENGTH",specialChar:"IAT/System/Dialog/POLICY_DESC_SPECIALCHAR"},t=PolicyView.prototype;return t.init=function(e,t){var i,s;e&&"function"==typeof e.querySelector&&(i=e.querySelector("#passwordPolicyTemplate")),i&&i.content&&"function"==typeof i.content.cloneNode&&(s=i.content.cloneNode(!0)),t&&"function"==typeof t.append&&(t.append(s),this.$policyBox=t.find(".policyBox")),this.viewPolicies()},t.setPolicies=function(e){e instanceof PasswordPolicies&&(this.policies=e,this.viewPolicies())},t.viewPolicies=function(){if(this.policies&&this.$policyBox){this.$policyBox.find(".policyBoxHeader").text(brease.language.getText("IAT/System/Dialog/POLICY_HEADER"));for(var t in this.policies)if(this.lines[t]=this.$policyBox.find("."+t),"minLength"===t){var i=brease.language.getText(e[t]);i=i.replace("{1}",""+this.policies[t]),this.lines[t].find("p").text(i)}else this.lines[t].toggle(this.policies[t]),this.lines[t].find("p").text(brease.language.getText(e[t]))}},t.applyValidationResult=function(e){for(var t in this.policies)this.lines[t]&&(e[t]?this.lines[t].removeClass("fail").addClass("success"):this.lines[t].removeClass("success").addClass("fail"))},t.hide=function(){this.$policyBox&&this.$policyBox.hide()},t.dispose=function(){this.$policyBox=void 0,this.lines=void 0},PolicyView}),define("system/widgets/ChangePasswordDialog/ChangePasswordDialog",["widgets/brease/Window/Window","brease/controller/PopUpManager","brease/controller/ZoomManager","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/helper/SimpleQueue","system/widgets/ChangePasswordDialog/libs/Validator","system/widgets/ChangePasswordDialog/libs/Message","system/widgets/ChangePasswordDialog/libs/Elements","system/widgets/ChangePasswordDialog/libs/PolicyView"],function(e,t,i,BreaseEvent,Enum,Utils,SimpleQueue,Validator,Message,Elements,PolicyView){"use strict";var s={modal:!0,arrow:{show:!1},forceInteraction:!0,showCloseButton:!0,position:{horizontal:"center",vertical:"middle"},pointOfOrigin:Enum.PointOfOrigin.CONTAINER,html:"system/widgets/ChangePasswordDialog/ChangePasswordDialog.html",stylePrefix:"system_brease_ChangePasswordDialog",width:342,height:524,hideTimeout:5e3,messageInterval:1e3,focusEvent:{start:BreaseEvent.WINDOW_SHOW,end:BreaseEvent.CLOSED},windowType:"ChangePasswordDialog"},n=e.extend(function ChangePasswordDialog(t,i){e.call(this,null,i,!0,!0),this.parsedDeferred=$.Deferred(),l.call(this)},s,!0),a=n.prototype;n.RESULT={success:1,aborted:0,not_supported:-2},a.init=function(){this.addInitialClass("breaseChangePasswordDialog"),this.$outputArea=this.el.find(".outputArea"),this.internalData.changeInProgress=!1,this.internalData.changeSuccess=!1,this.validator=new Validator,this.policyView=new PolicyView(this),e.prototype.init.call(this,!0)},a.show=function(t,i){t=Utils.isString(t)?t:"",i=!!Utils.isBoolean(i)&&i,this.loadPolicies();var s=E(t?"IAT/System/Dialog/CHANGEPASSWORD_DIALOG_HEADER_USERNAME":"IAT/System/Dialog/CHANGEPASSWORD_DIALOG_HEADER");t&&(s=s.replace("{1}",t));var n={header:{text:s}};if(this.internalData.userName=t,this.internalData.showPolicy=i,e.prototype.show.call(this,n),t&&(brease.uiController.setWidgetPropertyIndependentOfState(this.inputs.userName.elemId,"value",t),brease.uiController.setWidgetPropertyIndependentOfState(this.inputs.userName.elemId,"visible",!1),brease.uiController.setWidgetPropertyIndependentOfState(this.labels.userName.elemId,"visible",!1)),this.internalData.showPolicy){var a=$("#chpwd_GroupBox").position(),r=this.buttons.change.$el.position(),o=this.inputs.oldPassword.$el.position();this.buttons.cancel.$el.css({position:"absolute",top:r.top/this.dimensions.scale,left:300}),this.policyView.$policyBox.css({top:(o.top+a.top)/this.dimensions.scale})}brease.config.isKeyboardOperationEnabled()&&this._initFocus()},a._initFocus=function(e){this.inputs.userName.$el.get(0).focus()},a.loadPolicies=function(){var e=this;brease.user.loadPasswordPolicies().then(function(t){e.setPolicies(t)},function(e){console.iatWarn("loadPasswordPolicies.fail,status=",e)})},a.setPolicies=function(e){this.validator.setPolicies(e),this.internalData.showPolicy&&this.policyView.setPolicies(e)};function r(e,t){var i=parseInt(e.css(t),10);return isNaN(i)&&(i=0),i}a._setDimensions=function(){this.internalData.showPolicy&&this.$contentBox.addClass("showPolicy");var e=r(this.$contentBox,"border-top"),t=r(this.$contentBox,"border-right"),i=r(this.$contentBox,"border-bottom"),s=r(this.$contentBox,"border-left");this.dimensions.width=this.el.outerWidth(),this.dimensions.height=this.el.outerHeight(),this.internalData.userName&&(this.dimensions.height-=60);var n=this.dimensions.width+s+t,a=this.dimensions.height+e+i;this.internalData.showPolicy&&(n=2*this.dimensions.width+s+t-40,a-=40),this.el.width(n),this.el.height(a),this.dimensions.width=n,this.dimensions.height=a;var l=this.el.find("header").outerHeight();this.$contentBox.css({width:n-s-t,height:a-l-i-e+1,"margin-top":"-1px"}),this.internalData.showPolicy&&this.policyView.init(this.elem,this.$contentBox),o.call(this)};function o(){var e=brease.pageController.getRootZoom(),s=t.getDimensions(),n=i.zoomFitContainerSize(e,this.dimensions,{width:s.winWidth,height:s.winHeight});this._applyScale(n)}a._setCloseButton=function(){e.prototype._setCloseButton.apply(this,arguments),this.closeButton.css("display","")},a.readyHandler=function(){var t=this;this.buttons.forEach(function(e){e.$el.on(BreaseEvent.CLICK,t._bind(g))}),this.inputs.forEach(function(e){e.$el.on("ValueChanged",t._bind(b))}),e.prototype.readyHandler.apply(this,arguments)},a.isParsed=function(){return this.parsedDeferred.promise()},a.getForm=function(){return{userName:brease.callWidget(this.inputs.userName.elemId,"getValue"),oldPassword:brease.callWidget(this.inputs.oldPassword.elemId,"getValue"),newPassword:brease.callWidget(this.inputs.newPassword.elemId,"getValue"),confirmPassword:brease.callWidget(this.inputs.confirmPassword.elemId,"getValue")}},a.formValidation=function(){var e=this.getForm(),t=this.validator.validate(this.testInputs,e);return t.policiesResult&&-1!==this.testInputs.indexOf("newPassword")&&this.policyView.applyValidationResult(t.policiesResult),this.showMessages(t.arError),this.highlightInputs(t.arInputs),{isValid:t.isValid,form:e}},a.setInputLabel=function(e,t){var i=this.inputs.getMemberIdByElemId(e);t?brease.callWidget(this.labels[i].elemId,"setText",this.labels[i].textKey):brease.callWidget(this.labels[i].elemId,"setText","")},a.enableTestAll=function(){this.internalData.testAll||(this.internalData.testAll=!0,this.testInputs=Object.keys(this.inputs))},a.showMessages=function(e){var t="";e.forEach(function(e){t+='<p class="'+e.type+'">'+e.content+"</p>"}),this.$outputArea.html(t)},a.highlightInputs=function(e){this.inputs.forEach(function(t,i){t.$el.removeClass("error"),-1!==e.indexOf(i)&&t.$el.addClass("error")})},a.sendChange=function(e){var t=this;return brease.user.changePassword(e.userName,e.oldPassword,e.newPassword).then(function(e,i){t.internalData.changeInProgress=!1,v.call(t,"success",e,i)},function(e,i){t.internalData.changeInProgress=!1,v.call(t,"error",e,i)})},a.hide=function(){e.prototype.hide.apply(this,arguments),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CHANGEPASSWORDDIALOG_CLOSED,{detail:{result:this.internalData.changeSuccess?n.RESULT.success:n.RESULT.aborted,userName:this.internalData.userName?this.internalData.userName:""}})),this.dispose()},a.dispose=function(){window.clearTimeout(this.internalData.timer),window.clearInterval(this.internalData.interval),this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind(u)),this.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,this._bind(h)),this.validator.dispose(),this.buttons.dispose(),this.inputs.dispose(),this.labels.dispose(),this.$contentBox=void 0,this.$outputArea=void 0,brease.uiController.dispose(this.elem,!1),e.prototype.dispose.apply(this,arguments)};function l(){var e=this;require(["text!"+e.settings.html],function t(i){e.deferredInit(document.body,i),d.call(e),c.call(e),brease.uiController.parse(e.elem)})}function d(){this.elem.addEventListener(BreaseEvent.CONTENT_PARSED,this._bind(h))}function c(){var e=this;this.children=new SimpleQueue,this.el.find("[data-brease-widget]").each(function(t,i){e.children.add(i.id)}),this.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind(u))}function h(){brease.uiController.addWidget(this),this.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,this._bind(h)),this.buttons=new Elements({change:{elemId:"brease_chpwd_btn_change"},cancel:{elemId:"brease_chpwd_btn_cancel"},confirm:{elemId:"brease_chpwd_btn_confirm"}}),this.inputs=new Elements({userName:{elemId:"brease_chpwd_userName"},oldPassword:{elemId:"brease_chpwd_oldPassword"},newPassword:{elemId:"brease_chpwd_newPassword"},confirmPassword:{elemId:"brease_chpwd_confirmPassword"}}),this.testInputs=[],this.labels=new Elements({userName:{elemId:"brease_chpwd_userName_label",textKey:"$IAT/System/Dialog/USERNAME"},oldPassword:{elemId:"brease_chpwd_oldPassword_label",textKey:"$IAT/System/Dialog/OLD_PASSWORD"},newPassword:{elemId:"brease_chpwd_newPassword_label",textKey:"$IAT/System/Dialog/NEW_PASSWORD"},confirmPassword:{elemId:"brease_chpwd_confirmPassword_label",textKey:"$IAT/System/Dialog/CONFIRM_PASSWORD"}}),this.$contentBox=this.el.find(".contentBox"),this.parsedDeferred.resolve(this)}function u(e){this.children.remove(e.target.id),0===this.children.length&&(this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind(u)),this.readyHandler())}function g(e){switch(e.target.id){case this.buttons.confirm.elemId:m.call(this);break;case this.buttons.change.elemId:p.call(this);break;case this.buttons.cancel.elemId:f.call(this);break}}function m(){this.internalData.changeInProgress=!1,this.debouncedHide()}function p(){if(!this.internalData.changeInProgress){this.internalData.changeInProgress=!0,this.enableTestAll();var e=this.formValidation();e.isValid?this.sendChange(e.form):this.internalData.changeInProgress=!1}}function f(){this.internalData.changeInProgress=!1,this.debouncedHide()}function b(e){var t=this.inputs.getMemberIdByElemId(e.target.id);-1===this.testInputs.indexOf(t)&&this.testInputs.push(t),this.setInputLabel(e.target.id,e.detail.value),this.formValidation()}function v(e,t,i){if("error"===e)this.internalData.changeSuccess=!1,this.showMessages([new Message(E("IAT/System/Dialog/CHANGEPASSWORD_FAIL")+"<br/>"+C(t.message),Message.Type.ERROR)]);else{this.internalData.changeSuccess=!0,this.internalData.userName=i,this.buttons.change.$el.hide(100),this.buttons.cancel.$el.hide(100),this.inputs.forEach(function(e){e.$el.hide(100)}),this.policyView.hide(),this.el.find('[data-brease-widget="widgets/brease/Label"]').hide(100);var s=this.buttons.confirm.$el.outerWidth(),n=this.$contentBox.innerWidth(),a=this.$outputArea.outerWidth(),r=$("#chpwd_GroupBox").position().left;this.buttons.confirm.$el.css({top:220,left:(n-s)/2,margin:"0px",position:"absolute"}),this.$outputArea.css({top:120,left:(n-a)/2-r/this.dimensions.scale,margin:"0px",position:"absolute"}),brease.callWidget(this.buttons.confirm.elemId,"setVisible",!0);var o=new Message(E("IAT/System/Dialog/CHANGEPASSWORD_SUCCESS"),Message.Type.SUCCESS);this.showMessages([o]),y.call(this,o)}}function y(e){this.internalData.countdown=5,this.internalData.timer=window.setTimeout(w,this.settings.hideTimeout,this),this.internalData.interval=window.setInterval(x,this.settings.messageInterval,this,e)}function w(e){e.hide()}function x(e,t){if(e.internalData.countdown-=1,e.internalData.countdown>0){var i=E("IAT/System/Dialog/DIALOG_CLOSES"),s=new Message("<br/>"+i.replace("{1}",e.internalData.countdown),Message.Type.INFO);e.showMessages([t,s])}}function E(e){return brease.language.getText(e)}var I={InvalidCredentials:"IAT/System/Dialog/CHANGEPASSWORD_INVALID_CREDENTIALS",NotSupported:"IAT/System/Dialog/CHANGEPASSWORD_SERVICE_NOTAVAILABLE",PasswordPoliciesNotMet:"IAT/System/Dialog/CHANGEPASSWORD_POLICIES_NOT_MET",TimeOut:"IAT/System/Dialog/CHANGEPASSWORD_TIMEOUT",UnknownError:"IAT/System/Dialog/CHANGEPASSWORD_UNKNOWN_ERROR","Command error":"IAT/System/Dialog/CHANGEPASSWORD_UNKNOWN_ERROR"};function C(e){var t=I.UnknownError;return void 0!==I[e]?t=I[e]:console.iatWarn("unknown server response"),brease.language.getText(t)}return n}),define("brease/controller/OverlayController",["brease/events/BreaseEvent","brease/core/Utils","brease/enum/Enum","brease/core/Types","brease/model/VisuModel","brease/controller/FileManager","brease/controller/libs/ContentHelper","system/widgets/ChangePasswordDialog/ChangePasswordDialog"],function(BreaseEvent,Utils,Enum,Types,e,t,i,ChangePasswordDialog){"use strict";var DialogWindow,MessageBox,s={openDialog:{horizontalPos:"center",verticalPos:"middle",mode:"modal",autoClose:!1,autoRaise:Enum.AutoRaise.ENABLED},openDialogAtTarget:{horizontalPos:"right",verticalPos:"top",horDialogAlignment:"left",verDialogAlignment:"top",mode:"modeless",autoClose:!1,autoRaise:Enum.AutoRaise.ENABLED}},n={defaults:s,init:function(){this.ready=$.Deferred(),this.ChangePasswordDialogClass=ChangePasswordDialog;var e=["widgets/brease/DialogWindow/DialogWindow","widgets/brease/MessageBox/MessageBox","widgets/brease/DateTimePicker/DateTimePicker","system/widgets/ContentLoader/ContentLoader"];return t.loadOverlays(e).done(function(e,t){DialogWindow=e,MessageBox=t,a.push({widget:new MessageBox,used:!1,type:"MessageBox"}),a.push({widget:new DialogWindow,used:!1,type:"DialogWindow"}),n.ready.resolve()}).fail(d),this.ready.promise()},showMessageBox:function(e,t,i,s,n,a){var r=$.Deferred();return $.when(this.getWindow("MessageBox")).then(function(o){var l={};l.header={text:t||""},l.content={text:i||""},s&&(l.icon=s),n&&(l.buttonText=n),e&&(l.type=e),o.widget.resetStyles(),a&&(l.style=a),o.widget.show(l).then(function(e){r.resolve(e),o.used=!1})}),r.promise()},getWindow:function(e){var t,i=this,s;for(var n in a)if(!1===a[n].used&&a[n].type===e)return a[n].used=!0,a[n];switch(t=$.Deferred(),e){case"MessageBox":s=MessageBox;break;case"DialogWindow":s=DialogWindow;break}return(new s).isReady().then(function(s){a.push({widget:s,used:!1,type:e}),t.resolve(i.getWindow(e))}),t.promise()},openDialog:function(e,t,i,n,a,l,d,h){var u=$.Deferred(),g={};return void 0!==r[e]||o.has(e)?(u.resolve(!0),u.promise()):(o.add(e),d=Types.parseValue(d,"Boolean",{default:s.openDialog.autoClose}),g.forceInteraction=!d,t=Types.parseValue(t,"Enum",{Enum:Enum.DialogMode,default:s.openDialog.mode}),g.modal=t===Enum.DialogMode.MODAL,h=Types.parseValue(h,"Enum",{Enum:Enum.AutoRaise,default:s.openDialog.autoRaise}),g.autoRaise=h,g.position=g.position||{},void 0!==i?(i=c(i),Utils.isString(i)?g.position.horizontal=Types.parseValue(i,"Enum",{Enum:Enum.HorizontalPosition,default:s.openDialog.horizontalPos}):g.position.horizontal=i):g.position.horizontal=s.openDialog.horizontalPos,void 0!==n?(n=c(n),Utils.isString(n)?g.position.vertical=Types.parseValue(n,"Enum",{Enum:Enum.VerticalPosition,default:s.openDialog.verticalPos}):g.position.vertical=n):g.position.vertical=s.openDialog.verticalPos,void 0!==l&&(g.headerText=l),$.when(this.getWindow("DialogWindow")).then(function(t){g.id=e,r[e]=t,o.delete(e),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DIALOG_OPEN,{bubbles:!0,cancelable:!0,detail:{dialogId:e}}));var i=t.widget.show(g,a);u.resolve(i)}),u.promise())},openDialogAtTarget:function(e,t,i,n,a,l,d,c,h,u){var g=$.Deferred(),m={};return void 0!==r[e]||o.has(e)?(g.resolve(!0),g.promise()):(o.add(e),d=Types.parseValue(d,"Boolean",{default:s.openDialogAtTarget.autoClose}),m.forceInteraction=!d,t=Types.parseValue(t,"Enum",{Enum:Enum.DialogMode,default:s.openDialogAtTarget.mode}),m.modal=t===Enum.DialogMode.MODAL,u=Types.parseValue(u,"Enum",{Enum:Enum.AutoRaise,default:s.openDialogAtTarget.autoRaise}),m.autoRaise=u,m.position={horizontal:Types.parseValue(i,"Enum",{Enum:Enum.HorizontalPosition,default:s.openDialogAtTarget.horizontalPos}),vertical:Types.parseValue(n,"Enum",{Enum:Enum.VerticalPosition,default:s.openDialogAtTarget.verticalPos}),horizontalDialog:Types.parseValue(c,"Enum",{Enum:Enum.HorizontalPosition,default:s.openDialogAtTarget.horDialogAlignment}),verticalDialog:Types.parseValue(h,"Enum",{Enum:Enum.VerticalPosition,default:s.openDialogAtTarget.verDialogAlignment})},Utils.isString(l)&&(m.headerText=l),$.when(this.getWindow("DialogWindow")).then(function(t){m.id=e,r[e]=t,o.delete(e),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DIALOG_OPEN,{bubbles:!0,cancelable:!0,detail:{dialogId:e}}));var i=t.widget.show(m,a);g.resolve(i)}),g.promise())},closeDialog:function(t){var s=r[t];if(s){var n=i.contentsInDialog(t),a=l(s.widget.elem),o=i.extractNotActive(n);o.length>0&&(console.iatWarn("Dialog "+t+" open aborted! Not active contents: "+o),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DIALOG_OPEN_ABORTED,{detail:{arContentId:o}})));var d=i.extractActive(n);$.when(s.widget.onClose(),i.deactivateFinished(d)).then(function(){e.deactivateEmbeddedVisusWithoutActiveContent(),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DIALOG_CLOSED,{bubbles:!0,cancelable:!0,detail:{dialogId:t,horizontalPos:a.x,verticalPos:a.y}}))}),s.widget.hide(),r[t]=void 0,s.used=!1}},openChangePasswordDialog:function(e,t){var i=$.Deferred(),s=new this.ChangePasswordDialogClass;return $.when(s.isParsed()).then(function(){s.show(e,t),i.resolve(!0)}),i.promise()}},a=[],r=[],o=new Set;function l(e){var t={x:"0px",y:"0px"},i=e?{x:e.style.left,y:e.style.top}:t,s=brease.pageController.getRootZoom();return _.isNumber(s)&&0!==s||(s=1),t.x=Math.round(parseInt(i.x,10)/s)+"px",t.y=Math.round(parseInt(i.y,10)/s)+"px",t}function d(){brease.messenger.announce("WIDGET_LOAD_ERROR")}function c(e){return/\d+px/g.test(e)?parseInt(e,10):e}return n}),define("brease/datatype/ZoomType",["brease/core/Utils"],function(Utils){"use strict";var ZoomType={};return Utils.defineProperty(ZoomType,"original","original"),Utils.defineProperty(ZoomType,"contain","contain"),Utils.defineProperty(ZoomType,"cover","cover"),ZoomType}),define("brease/controller/Preloader",["brease/controller/libs/PreCacheInfo","brease/enum/Enum","brease/events/BreaseEvent","brease/model/VisuModel","brease/core/Utils","brease/controller/WidgetController","brease/controller/objects/AssignType"],function(PreCacheInfo,Enum,BreaseEvent,e,Utils,t,AssignType){"use strict";var Preloader=function(t,s,n,a){this.contentManager=t,this.loaderPool=s,this.visuModel=a||e,this.showProgressBar=n,this.contentQueue=[],this.settings=Utils.deepCopy(i),this.widgetReadyListener=u.bind(this)},i={timeoutForDeactivate:5e3,timeoutForActivate:16e3,timeoutForWidgetReady:1e4,showAllContentsLoaded:500},s=Preloader.prototype;s.init=function(){var e=this,t=$.Deferred();this.infoScreen=new PreCacheInfo(this.showProgressBar,a.bind(this),this.contentsToPreload.length,this.settings.showAllContentsLoaded),this.preloadingContainer=$('<div style="position:fixed" id="preloadingContainer"></div>').appendTo("body"),this.contentQueue=this.contentsToPreload;var i=[];return this.embeddedVisuIds=b.call(this),this.embeddedVisuIds.forEach(function(t){var s=v.call(e,t);s.promise(),i.push(s)}),$.when.apply($,i).then(function(){t.resolve()}),t},s.getContentsToPreload=function(){return this.contentsToPreload=n.call(this),this.contentsToPreload},s.startProcessingQueue=function(){return this.readyDef=$.Deferred(),r.call(this),this.readyDef.promise()},s.start=function(){var e=this.getContentsToPreload(),t=$.Deferred(),i=this;return e.length>0?(brease.config.preLoadingState=!0,i.init().then(function(){i.startProcessingQueue().done(function(){brease.config.preLoadingState=!1,t.resolve()})})):t.resolve(),t.promise()};function n(){var e=this.visuModel.allContents(),t={},i=this.visuModel.getPageById(this.visuModel.startPageId),s=this.visuModel.getContentsOfPage(i.id,i.type),n=[],a,r;for(a in e)r=e[a],void 0!==r&&void 0!==r.configurations&&!1!==r.configurations.hasOwnProperty("preCache")&&!1!==r.configurations.preCache&&(t[a]=Utils.deepCopy(r));s.forEach(function(e){var i=t[e];void 0!==i&&n.push(i)});for(a in t)r=t[a],-1===n.indexOf(r)&&n.push(r);return n.length>this.loaderPool.maxSlots&&(brease.loggerService.log(Enum.EventLoggerId.CLIENT_PRECACHING_CONTENT_SLOTS_EXCEEDED,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.WARNING,[]),n=n.slice(0,this.loaderPool.maxSlots)),n}function a(){e.deactivateEmbeddedVisus(),this.preloadingContainer.remove(),this.readyDef.resolve()}function r(){var e=$.Deferred(),i=this,s=this.contentQueue.shift();s&&(this.infoScreen.updateCount(this.contentQueue.length+1,s.id),this.loaderPool.createNew(this.preloadingContainer.get(0),s,e),$.when(e).done(function(e,n){if(n){var a=t.callWidget(e,"widget");a&&d.call(i,a.settings.contentId,e).done(function(e){o.call(i,e)})}else i.contentQueue.unshift(s),r.call(i)}))}function o(e){var i=t.callWidget(e,"widget"),s=this,n=t.getWidgetsOfContent(i.settings.contentId,Enum.WidgetState.IN_QUEUE),a=t.findWidgets(i.elem,!1,0),r=Utils.uniqueArray(n.concat(a)),o=r.filter(function(e){return t.getState(e)!==Enum.WidgetState.READY});0===o.length?l.call(this,i):c.call(this,o,i.settings.contentId,i.elem).done(function e(){l.call(s,i)}).fail(function e(){g.call(s,i)})}function l(e){var t=this;window.setTimeout(function(){m.call(t,e)},0)}function d(e,t){var i=$.Deferred();if(this.contentManager.isContentActive(e))i.resolve(t);else{var s=function(a){a.detail.contentId===e&&(document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,s),window.clearTimeout(n),i.resolve(t))},n=window.setTimeout(function(){document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,s),i.resolve(t)},this.settings.timeoutForActivate);document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,s)}return i}function c(e,t,i){return this.widgetReadyQueue={contentId:t,contentLoaderElem:i,deferred:$.Deferred(),widgets:e.slice(0)},i.addEventListener(BreaseEvent.WIDGET_READY,this.widgetReadyListener),this.widgetReadyQueue.widgetReadyTimeout=window.setTimeout(h.bind(this),this.settings.timeoutForWidgetReady),this.widgetReadyQueue.deferred}function h(){this.widgetReadyQueue.contentLoaderElem.removeEventListener(BreaseEvent.WIDGET_READY,this.widgetReadyListener),this.widgetReadyQueue.deferred.reject(this.widgetReadyQueue.contentId),this.widgetReadyQueue=void 0}function u(e){var t=e.target.id,i=this.widgetReadyQueue.widgets.indexOf(t);i>=0&&(this.widgetReadyQueue.widgets.splice(i,1),0===this.widgetReadyQueue.widgets.length&&(window.clearTimeout(this.widgetReadyQueue.widgetReadyTimeout),this.widgetReadyQueue.contentLoaderElem.removeEventListener(BreaseEvent.WIDGET_READY,this.widgetReadyListener),this.widgetReadyQueue.deferred.resolve(),this.widgetReadyQueue=void 0))}function g(e){this.loaderPool.flushLoader(e.elem),p.call(this)}function m(e){var t=this,i=e.settings.contentId,s=function(e){e.detail.contentId===i&&(window.clearTimeout(n),document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,s),p.call(t))},n=window.setTimeout(function(){document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,s),p.call(t)},this.settings.timeoutForDeactivate);document.body.addEventListener(BreaseEvent.CONTENT_DEACTIVATED,s),t.loaderPool.suspendLoader(e.elem)}function p(){0!==this.contentQueue.length?r.call(this):this.infoScreen.updateCount(0)}function f(e,t){var i=[];for(var s in e.assignments){var n=e.assignments[s];if(n.type===AssignType.VISU&&void 0!==t.visus[n.contentId]){var a=n.contentId=Utils.ensureVisuId(n.contentId);i.push(a)}}return i}function b(){var e=this.visuModel.getVisuData(),t=[];for(var i in e.pages){var s=e.pages[i],n=f(s,e);t=t.concat(n)}for(var a in e.dialogs){var r=e.dialogs[a],o=f(r,e);t=t.concat(o)}return t=Utils.uniqueArray(t),t}function v(e){var t=$.Deferred();return $.when(this.visuModel.activateVisu(e,{visuId:e})).then(function e(){t.resolve()},function e(i,s,n){brease.loggerService.log(Enum.EventLoggerId.CLIENT_VISU_ACTIVATE_FAILED,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.WARNING,[n.visuId]),t.reject()}),t}return Preloader}),define("brease/controller/PageController",["brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/controller/libs/Utils","brease/core/libs/Deferred","brease/model/VisuModel","brease/controller/libs/LoaderPool","brease/controller/libs/PageLogger","brease/controller/libs/PageCycle","brease/controller/libs/LoadCycle","brease/controller/libs/ScrollManager","brease/controller/ZoomManager","brease/controller/libs/AreaManager","brease/controller/libs/Containers","brease/controller/libs/Themes","brease/controller/libs/LogCode","brease/controller/objects/Client","brease/controller/objects/PageType","brease/controller/objects/AssignType","brease/controller/objects/VisuStatus","brease/datatype/ZoomType","brease/controller/Preloader","brease/controller/ContentManager","brease/controller/objects/ContentStatus","brease/controller/ContentControlObserver","brease/controller/libs/ContentValidator","brease/controller/libs/ContentHelper"],function(BreaseEvent,Enum,e,Utils,Deferred,t,LoaderPool,PageLogger,PageCycle,LoadCycle,ScrollManager,i,AreaManager,s,Themes,LogCode,Client,PageType,AssignType,VisuStatus,ZoomType,Preloader,n,ContentStatus,ContentControlObserver,ContentValidator,a){"use strict";var PageController={init:function e(i,config,s,a,r){void 0===this.logger&&(brease.appElem.addEventListener(BreaseEvent.PAGE_CHANGE,ie.bind(this)),brease.appElem.addEventListener(BreaseEvent.PAGE_LOADED,se.bind(this)),this.logger=new PageLogger(this,config)),h=r||new LoaderPool(200),u=t.init(i,this.logger),this.contentManager=a||n,this.contentManager.init(i),ContentValidator.injectDependencies({visuModel:u,contentManager:this.contentManager,loaderPool:h}),c=new PageCycle(this.contentManager),void 0!==s&&(ScrollManager=s),ContentControlObserver.init()},reset:function(){h&&h.dispose(),d&&d.reset(),c&&c.reset(),s.reset(),AreaManager.reset()},start:function t(i,s,n){this.reset(),i=e.ensureVisuId(i),h=new LoaderPool(n?n.cachingSlots:void 0),ContentValidator.injectDependencies({visuModel:u,contentManager:this.contentManager,loaderPool:h}),document.body.removeEventListener(BreaseEvent.VISU_ACTIVATED,R),AreaManager.injectDependencies(ScrollManager,s.id),$.when(u.activateVisu(i,{visuId:i,rootContainer:s})).then(m,p)},swipeNavigation:function e(t){var i=s.getCurrentPage(this.rootContainer.id),n=u.findNav4page(i);return!!(n&&n.swipes&&n.swipes[i]&&n.swipes[i][t])&&(PageController.loadPage(n.swipes[i][t],this.rootContainer),!0)},loadPage:function e(t,i,n){var a;if(!0===brease.config.preLoadingState)a={success:!1,code:LogCode.PRELOADING_ACTIVE};else if(i){var r=u.getPageById(t);if(void 0!==r){var o=s.getLatestRequest(i.id);s.setLatestRequest(i.id,t),a=A.call(this,r,i,n),!0!==a.success&&s.setLatestRequest(i.id,o)}else a={success:!1,code:LogCode.PAGE_NOT_FOUND},this.logger.log(a.code,{pageId:t,isStartPage:u.startPageId===t})}else a={success:!1,code:LogCode.CONTAINER_NOT_FOUND},this.logger.log(a.code,{pageId:t,isStartPage:u.startPageId===t});return a},loadDialog:function e(t,i){var n=u.getDialogById(t);if(void 0!==n){s.setLatestRequest(i.id,t);return!0===A.call(this,n,i).success?n:void 0}return this.logger.log(LogCode.DIALOG_NOT_FOUND,{dialogId:t}),void 0},loadContentInArea:function e(t,i,s,n,a){var r=this,o=new Deferred(Deferred.TYPE_SINGLE,[n]),l=ContentValidator.getTargetForContent.call(this,{contentId:t,areaId:i,pageId:s,pageType:PageType.PAGE},a);if(!0===l.success)ae.call(this,"loadContentInArea",o,l.data.area,l.data.assignment,a);else{var d=l.data
;l.statusCode===LogCode.CONTENT_LOADING_IN_PROCESS&&(console.iatDebug('could not load content "'+t+'" in area "'+i+'" of page "'+s+'", because content "'+l.data.contentId+'" has not been loaded completely in area "'+l.data.areaId+'"'),d={contentId:t}),L.call(r,o,!1,l.statusCode,d)}return o},loadContentInDialogArea:function e(t,i,s){var n=this,a=new Deferred(Deferred.TYPE_SINGLE),r=ContentValidator.getTargetForContent.call(this,{contentId:t,areaId:i,pageId:s,pageType:PageType.DIALOG});if(!0===r.success)ae.call(this,"loadContentInDialogArea",a,r.data.area,r.data.assignment);else{var o=r.data;r.statusCode===LogCode.CONTENT_LOADING_IN_PROCESS&&(console.iatDebug('could not load content "'+t+'" in area "'+i+'" of dialog "'+s+'", because content "'+r.data.contentId+'" has not been loaded completely in area "'+r.data.areaId+'"'),o={contentId:t}),L.call(n,a,!1,r.statusCode,o)}return a},loadContentInWidget:function e(t,i,s,n,a,r,o){var l=ContentValidator.getTargetForWidget(t,i,s,n,a,r),d=new Deferred(Deferred.TYPE_SINGLE,l.areaDivId?[l.areaDivId]:void 0);return PageController.isContentToBeRemoved(s)?(this.logger.log(LogCode.CONTENT_LOADING_IN_PROCESS,{contentId:i}),d.resolve(!1)):c.inProgress&&!0!==o?(ce.add("loadContentInWidget",{widgetId:t,contentId:i,areaId:l.areaId,areaDivId:l.areaDivId,pageId:l.pageId},d),c.addEventListener("CycleFinished",ce.process)):PageController.loadContentInArea(i,l.areaId,l.pageId,null,o).done(function(e){d.resolve(e)}).fail(function(){d.resolve(!1)}),d},disposeContentInWidget:function(e){var t="A0",i=e,n="virtualPage_"+e,a=AreaManager.getArea(e,i,"A0","Page");a&&(a.div&&brease.pageController.emptyContainer(a.div),AreaManager.remove(a.id)),u.removeLayout(i),u.removePage(n),s.removeContainer(e)},getContentScrollOffset:function(e){var t=$('[data-brease-contentid="'+e+'"]').closest(".LayoutArea");return t.length>0?AreaManager.scrollManager.getScrollPosition(t[0]):(console.iatWarn("getContentScrollOffset: no layout found for content "+e),void 0)},setTheme:function e(t){if(void 0!==t){if(-1===u.getThemes().indexOf(t))return this.logger.log(LogCode.THEME_NOT_FOUND,{themeId:t}),void 0;Themes.setTheme(t)}},themeId2Url:function e(t){return Themes.themeId2Url(t)},getCurrentTheme:function e(){return Themes.getCurrentTheme()},getThemes:function e(){return u.getThemes()},emptyContainer:function e(t,i){t&&t.childNodes&&t.id&&(ne.call(this,t,i),s.resetCurrentPage(t.id))},getNavById:function e(t){return u.getNavById(t)},getPageById:function e(t){return u.getPageById(t)},getLayoutById:function t(i){return e.deepCopy(u.getLayoutById(i))},getDialogById:function e(t){return u.getDialogById(t)},getVisuById:function e(t){return u.getVisuById(t)},getCurrentPage:function e(t){return s.getCurrentPage(t)},getVisu4Page:function e(t){return void 0!==u.getPageById(t)?u.getPageById(t).visuId:void 0!==u.getDialogById(t)?u.getDialogById(t).visuId:void 0},getContentUrlById:function e(t){var i,s=u.getContentById(t);return s&&(i=s.path),i},getLoaderForElement:function e(t){return $(t).closest(".systemContentLoader")[0]},getContentId:function e(t){var i,s=this.getLoaderForElement(t);return void 0!==s&&(i=s.getAttribute("data-brease-contentid")),i},getLayoutDivId:function e(t,i){return"Layout_"+(this.rootContainer.id===t?"":t+"_")+i},getAreaDivId:function e(t,i,s,n){return AreaManager.getAreaDivId(t,i,s,n)},loadHTML:function e(t,i){var s=new Deferred(Deferred.TYPE_SINGLE,i);return require(["text!"+t],function e(t){s.resolve(t)},function e(t){s.reject(t)}),s},getRootZoom:function e(){return i.getAppZoom()},parseVisuData:function e(t,i){return u.parseVisuData(t,i)},refreshArea:function(e){var t=AreaManager.get(e);t&&t.refresh()},updateContentSizeInWidget:function(e,t){var i="A0",s=e,n="virtualPage_"+e,a=AreaManager.getArea(e,s,"A0","Page"),r=u.getPageById(n),o=a.innerBox.firstChild?a.innerBox.firstChild.id:void 0,l=u.findAssignment(r,"A0"),d=!1;o&&(a.info.updateSize({width:t.realWidth,cssWidth:t.cssWidth,height:t.realHeight,cssHeight:t.cssHeight}),ee(o,!1,a,l))},isContentToBeRemoved:function(e){return this.isPageChangeInProgress()&&-1!==r.indexOf(e)},isCycleActive:function(){return c.inProgress},isPageChangeInProgress:function(){return c.inProgress||l},addCycleFinishedListener:function(e,t){c.addEventListener("CycleFinished",e,!1,t)},removeCycleFinishedListener:function(e){c.removeEventListener("CycleFinished",e)},loadContent:function(e,t){n.setArea(t.contentId,e.id);var i=new Deferred(Deferred.TYPE_SINGLE,[e,t]),a=u.getContentById(t.contentId);return s.resetCurrentPages(e.div.id),h.loadContent(a,e.$contentContainer,i),i}},r=[],o=[],l=!1,d=new LoadCycle,c,h,u,g;Object.defineProperty(PageController,"rootContainer",{get:function(){return g},set:function(e){g=e,PageController.$rootContainer=$(g)},enumerable:!0,configurable:!0});function m(e){var t=e.rootContainer;PageController.rootContainer=t,PageController.setTheme(u.startThemeId),new Preloader(PageController.contentManager,h,brease.config.visu.bootProgressBar).start().then(function(){$("#splashscreen").remove(),PageController.loadPage(u.startPageId,t)})}function p(e,t,i){var s={visuId:i.visuId,container:i.rootContainer};void 0!==t&&(s.code=t),$("#splashscreen").remove(),PageController.logger.log("VISU_"+e,s)}function f(e){var t,i=u.getContentById(e);if(i){var s=h.findContentLoaderWithContent(i.path);s&&(t=document.getElementById(s.id))}return t}function b(e){return!1===$.contains(brease.appElem,e)}function v(e,t){var i=!1,s=$(e).closest(".breaseContentControl");if(s.length>0){var n=brease.callWidget(s[0].id,"getSettings");n&&(i=-1!==t.indexOf(n.parentContentId))}return i}function y(e,t){return t===brease.appElem||!0===$.contains(t,e)}function w(e,t,i){return e.filter(function(e){return-1===t.indexOf(e)}).filter(function(e){var s=f(e);return s&&!b(s)&&y(s,i)&&!v(s,t)})}function x(e){if(e.type===PageType.DIALOG){var t=u.getContentsOfPage(e.id,e.type);if(0===_.intersection(c.contentsToLoad,t).length)return!0}return!1}function E(e,t,i){return this.logger.log(t,i),{success:e,code:t}}function I(){return!0===c.inProgress||!0===d.inProgress||this.contentManager.getPendingContents().length>0}function C(e,t){return void 0!==t&&t.id===e.id}function S(e,t){var i=s.getCurrentPage(t.id);return e.type===PageType.DIALOG?u.getDialogById(i):u.getPageById(i)}function T(e){return void 0!==u.getLayoutById(e.layout)}function D(e){e.map(function(e){return f(e).closest(".breaseContentControl")}).forEach(function(e){brease.callWidget(e.id,"reset"),h.removeLoader(Utils.findLoaders(e)[0])})}function A(e,t,i){var n=[];if(!0!==i&&I.call(this)&&!0!==x(e))return E.call(this,!1,LogCode.CONTENT_LOADING_IN_PROCESS,{pageId:e.id});!1===c.inProgress&&e.type!==PageType.DIALOG&&(n=this.contentManager.getContents([ContentStatus.active]));var a=S(e,t);if(C(e,a)){for(var d=u.getContentsOfPage(e.id,e.type),g=0;g<d.length;g+=1)c.remove(d[g]);return E.call(this,!1,LogCode.PAGE_IS_CURRENT,{pageId:e.id})}if(!T(e))return E.call(this,!1,LogCode.LAYOUT_NOT_FOUND,{pageId:e.id,layoutId:e.layout,isStartPage:u.startPageId===e.id});var m=u.getContentsOfPage(e.id,e.type),p=w(n,m,t),b=!1;e.type===PageType.PAGE&&(r=p.slice(0)),h.startTagMode(m),t.isSameNode(this.rootContainer)&&(l=!0),o=n.map(function(e){return{contentId:e,ccElem:f(e).closest(".breaseContentControl")}}).filter(function(e){return null!==e.ccElem&&!brease.appElem.contains(e.ccElem)}).filter(function(e){var t=brease.callWidget(e.ccElem.id,"getSettings");return!t||p.includes(t.parentContentId)}).map(function(e){return e.contentId}),p=p.concat(o.filter(function(e){return!m.includes(e)&&!p.includes(e)})),void 0!==a&&e.layout===a.layout||(D(o),ne.call(this,t),b=!0);var v=W.call(this,e.layout,t,e.type);return V(v,e),s.setCurrentPage(t.id,e.id),c.addEventListener("CycleFinished",O),c.start(N,m,p,{embedCall:i,pageId:e.id,containerId:t.id,contentsToLoad:m,contentsToRemove:p}),b||(D(o),F.call(this,a,e,t)),G.call(this,e,t,b),Utils.setPageStyle(e.style||"default",v,e.type),M.call(this,e,a,t),{success:!0}}function L(e,t,i,s){i?(this.logger.log(i,s),e.resolve(t,i)):e.resolve(t)}function P(){$(".breaseContentControl").each(function(){var e=brease.uiController.isWidgetCallable(this.id)?brease.callWidget(this.id,"getPreviousState"):void 0;e&&e.loadedContentId&&(brease.callWidget(this.id,"loadContent",e.loadedContentId,!0),brease.callWidget(this.id,"updateVisibility"))})}function O(){h.endTagMode()}function N(e){P(),e.pageId===u.startPageId&&k(),h.endTagMode(),u.deactivateEmbeddedVisusWithoutActiveContent(),s.initPageLoadEvent(e)}function k(){u.allActivated()?Client.setValid(!0):document.body.addEventListener(BreaseEvent.VISU_ACTIVATED,R)}function R(){u.allActivated()&&(document.body.removeEventListener(BreaseEvent.VISU_ACTIVATED,R),Client.setValid(!0))}function B(e,t,i){return void 0!==t&&e.layout!==t.layout&&i.id!==this.rootContainer.id}function M(e,t,i){if(B.call(this,e,t,i)){var s=$(i).closest("div[data-brease-areaId]")[0],n,a,r;s&&(n=s.id,a=s.getAttribute("data-brease-areaId"));var o=$(i).closest("div[data-brease-layoutId]")[0],l,d;o&&(l=o.getAttribute("data-brease-layoutId"),d=u.getLayoutById(l)),a&&d&&(r=d.areas[a]);var c=$(i).closest("div[data-brease-pageId]")[0],h,g,m;c&&(h=c.getAttribute("data-brease-pageId"),g=u.getPageById(h),g&&(m=g.assignments[a])),e&&n&&s&&r&&m&&X.call(this,e,AreaManager.get(n),m)}}function V(e,t){e.setAttribute("data-brease-pageId",t.id);var i={"background-image":"","background-color":t.backColor?t.backColor:""};(t.backGround||t.backGroundGradient)&&(i["background-image"]="",t.backGroundGradient&&(i["background-image"]+=t.backGroundGradient),t.backGround&&(i["background-image"]+=(""!==i["background-image"]?", ":"")+"url("+t.backGround+")",i["background-repeat"]="no-repeat")),t.sizeMode&&(i["background-size"]=Enum.SizeMode.convertToCSS(t.sizeMode)),$(e).css(i)}function W(t,s,n){var a=s.id;s.id!==this.rootContainer.id&&n!==PageType.DIALOG&&(s=AreaManager.get(s.id).contentContainer);var r=this.getLayoutDivId(s.id,t),o=$("#"+s.id).find("#"+r)[0];if(!o){var l=u.getLayoutById(t);l.id=t,o=document.createElement("div"),o.setAttribute("style","width:"+l.width+"px;height:"+l.height+"px;display:block;position:absolute;z-index:0;"),o.setAttribute("id",r),o.setAttribute("class","breaseLayout"),o.setAttribute("data-brease-layoutId",t);for(var d in l.areas)o.appendChild(AreaManager.add(a,t,l.areas[d],n).div);ScrollManager.remove(a),e.prependChild(s,o),a===this.rootContainer.id&&(i.setRootLayoutSize(o,l,this.$rootContainer),i.iosBodyFix())}return o}function H(e,t){var i;for(var s in e.assignments){var n=e.assignments[s];if(n.areaId===t){i=n;break}}return i}function F(e,t,i){if(e){var s=u.getLayoutById(t.layout),n=Object.keys(s.areas);for(var a in t.assignments){var r=t.assignments[a];if(void 0!==s.areas[a]){var o=H(e,r.areaId);if(r&&o&&(o.contentId!==r.contentId||o.type!==r.type)){var l=AreaManager.getArea(i.id,e.layout,a,e.type);ne.call(this,l.div)}n.splice(n.indexOf(a),1)}}n.length>0&&U.call(this,n,i,t)}}function U(e,t,i){for(var s=0;s<e.length;s+=1){var n=AreaManager.getArea(t.id,i.layout,e[s],i.type);n.hide(),ne.call(this,n.div)}}function G(e,t,i){var s=u.getLayoutById(e.layout),n=Object.keys(s.areas);for(var a in e.assignments){var r=e.assignments[a];if(void 0!==s.areas[a]){var o=AreaManager.getArea(t.id,e.layout,r.areaId,e.type);K.call(this,r,o),o.setStyle(r.style||"default"),o.show(),n.splice(n.indexOf(a),1)}else r.type===AssignType.CONTENT&&c.remove(r.contentId),this.logger.log(LogCode.AREA_NOT_FOUND,{contentId:r.contentId,layoutId:e.layout,pageId:e.id,areaId:r.areaId,isStartPage:u.startPageId===e.id})}i&&n.length>0&&U.call(this,n,t,e)}function z(e,t){$(e).html(t)}function K(e,t){var i=this;switch(e.type){case AssignType.CONTENT:this.contentManager.getActiveState(e.contentId)<=ContentStatus.initialized&&this.contentManager.setActiveState(e.contentId,ContentStatus.inQueue),PageController.loadContent(t,e).done(function e(t,i,s,n){ee.apply(null,arguments),c.remove(n.contentId)}).fail(function e(t,s,n,a){t===LogCode.CONTENT_NOT_FOUND&&(i.logger.log(t,{contentId:a.contentId}),s&&i.logger.message("brease.error.CONTENT_NOT_FOUND",[a.contentId],z.bind(null,s)))});break;case AssignType.PAGE:var s=e.contentId;te.call(this,s,t.div),X.call(this,u.getPageById(s),t,e),J(u.getVisuByStartpage(s));break;case AssignType.VISU:var n=e.contentId;$.when(u.activateVisu(n,{visuId:n,area:t,assignment:e})).then(j,Y);break}}function j(e){var t=u.getVisuById(e.visuId);$.when(Z.call(PageController,e.area,e.assignment)).then(function i(s){X.call(PageController,u.getPageById(s),e.area,e.assignment),J(t)},function i(s,n){s===LogCode.PAGE_IS_CURRENT&&(X.call(PageController,u.getPageById(n),e.area,e.assignment),J(t))})}function Y(e,t,i){if(e===VisuStatus.ACTIVATE_FAILED)for(var s=u.getContentsOfPage(u.getVisuById(i.visuId).startPage),n=0;n<s.length;n+=1)c.remove(s[n],!0);var a={visuId:i.visuId};void 0!==t&&(a.code=t),Q.call(PageController,"VISU_"+e,a,i.area.div)}function X(e,t,i){if(void 0!==e){var s=e.layout,n=u.getLayoutById(s),a=this.getLayoutDivId(t.contentContainer.id,s),r=q(a,{width:n.width,height:n.height},{width:t.info.width,height:t.info.height},i.zoomMode);t.setProperties({width:n.width,height:n.height},i,r,!0)}}function q(e,t,i,s){var n=i.width/t.width,a=i.height/t.height,r=1,o={};return s===ZoomType.contain?r=Math.min(n,a):s===ZoomType.cover&&(r=Math.max(n,a)),o.width=t.width,o.height=t.height,o.transform="scale("+r+","+r+")",o["transform-origin"]="0 0",$("#"+e).css(o),r}function Z(e,t){var i=$.Deferred(),s=t.contentId,n,a=u.getVisuById(s);return a.status===VisuStatus.LOADED?(void 0===Themes.getCurrentTheme()&&this.setTheme(u.startThemeId),n=te.call(this,a.startPage,e.div),n.success?(u.getVisuById(s).containerId=e.div.id,i.resolve(a.startPage)):i.reject(n.code,a.startPage)):(Q.call(this,"VISU_"+a.status,{visuId:s},e.div),i.reject("VISU_"+a.status)),i.promise()}function Q(e,t,i){ne.call(this,i),t.container=$(i).find(".ScrollBox")[0],this.logger.log(e,t)}function J(e){if(e&&e.containerId){var t=1,i=$("#"+e.containerId).find(".breaseLayout");i.length>0&&(t=i[0].getBoundingClientRect().width/i.outerWidth()),e.zoomFactor=t}}function ee(e,t,i,s){var n=u.getContentById(s.contentId);if(n&&i.info){var a=q(e,{width:n.width,height:n.height},{width:i.info.width,height:i.info.height},s.zoomMode);i.setProperties({width:n.width,height:n.height},s,a,t)}}function te(e,t){return this.loadPage(e,t,!0)}function ie(e){null!==document.getElementById(e.detail.containerId)&&this.loadPage(e.detail.pageId,document.getElementById(e.detail.containerId))}function se(e){var t=void 0!==this.rootContainer?this.rootContainer.id:brease.appElem.id;e.detail.containerId===t&&(l=!1)}function ne(e,t){if(e.childNodes.length>0){var i,n,a,r=$(e);for(a=r.find(".LayoutArea"),i=0,n=a.length;i<n;i+=1){var o=AreaManager.get(a[i].id);o&&o.dispose(),s.dispose(a[i].id)}for(Utils.resetContentControls(r[0]),a=Utils.findLoaders(r[0]),i=0,n=a.length;i<n;i+=1)h.removeLoader(a[i],t),s.dispose(a[i].id);s.resetCurrentPages(e.id),e!==this.rootContainer?brease.uiController.dispose(e):s.resetCurrentPage(e.id),r.children().not(".iScrollLoneScrollbar,.iScrollBothScrollbars,.ScrollBox").remove(),r.children(".ScrollBox").empty()}}function ae(e,t,i,s,n){c.inProgress&&!0!==n?(ce.add(e,{area:i,assignment:s},t),c.addEventListener("CycleFinished",ce.process)):re.call(this,i,s,t)}function re(e,t,i){var s=this,n=Utils.findLoaders(e.div),a=t.contentId,r;if(n.length>0&&(r=brease.callWidget(n[n.length-1].id,"getContentId")),d.add(a,r),n.length>1){var o=n.slice(0,n.length-1);Utils.resetContentControls(e.div),oe(o).done(function(){le.call(s,e,t,i)})}else le.call(s,e,t,i)}function oe(e){var t=new Deferred(Deferred.TYPE_SINGLE),i=[];return e.forEach(function(e){var t=brease.callWidget(e.id,"getContentId");null===t?$(e).closest(".breaseContentControl").each(function(){var e=brease.callWidget(this.id,"widget");if(e){var t=e.settings.contentId;document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_LOAD_ABORTED,{detail:{contentId:t}}))}}):n.getActiveState(t)===ContentStatus.active&&i.push(t),h.removeLoader(e,!0),s.dispose(e.id)}),$.when(a.deactivateFinished(i)).then(function(){t.resolve()}),t}function le(e,t,i){var s=this;this.contentManager.getActiveState(t.contentId)<=ContentStatus.initialized&&this.contentManager.setActiveState(t.contentId,ContentStatus.inQueue),PageController.loadContent(e,t).done(function e(){u.deactivateEmbeddedVisusWithoutActiveContent(),ee.apply(null,arguments),L.call(s,i,!0)}).fail(function e(){L.call(s,i,!1)})}function de(){var e=this;this.pool=[],this.add=function(t,i,s){e.pool.push({method:t,args:i,def:s})},this.process=function(){var t=e.pool.slice(0);e.pool=[],t.forEach(function(e){if("loadContentInArea"===e.method||"loadContentInDialogArea"===e.method)re.call(PageController,e.args.area,e.args.assignment,e.def);else if("loadContentInWidget"===e.method){var t=brease.callWidget(e.args.widgetId,"widget");t&&!t.isAllowedToLoad()?e.def.resolve(!1):document.getElementById(e.args.areaDivId)?PageController.loadContentInArea(e.args.contentId,e.args.areaId,e.args.pageId,{def:e.def}).done(function(e){var t=arguments[arguments.length-1];t.def&&t.def.resolve(e)}):e.def.resolve(!1)}})}}var ce=new de;return PageController}),define("brease/controller/WidgetParser",["brease/controller/FileManager","brease/controller/libs/FactoryUtils","brease/controller/objects/WidgetItem","brease/core/Utils","brease/events/BreaseEvent","brease/enum/Enum","brease/controller/libs/Queue"],function(e,t,WidgetItem,Utils,BreaseEvent,Enum,Queue){"use strict";var i={init:function e(t){void 0!==t&&(n=t)},start:function(e){e.start(r).done(a)},parse:function e(s,a,r){if(s=t.getElem(s),null!==s){var l=Queue.getQueue(s,"parse",!0),d=s.querySelectorAll("[data-brease-widget]"),c=[],h=[],u,m,p=d.length;for(m=p-1;m>=0;m-=1)u=d[m],u.id=t.ensureElemId(u.id),-1===h.indexOf(u.id)?(c.push(u),h.push(u.id)):(console.iatWarn("[parse] HTML element has duplicate id ("+u.id+") and will be removed"),u.parentNode.removeChild(u));for(r=t.ensureContentId(r,s,n.getState(s.id)),m=0,p=c.length;m<p;m+=1)o(c[m],l,r);!0===a&&null!==s.getAttribute("data-brease-widget")&&o(s,l,r),i.start(l)}else g("parse")}},s={},n;function a(e){e.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_PARSED))}function r(t,i){var s,a;if(n.getState(t.id)<Enum.WidgetState.INITIALIZED){n.optionsExist(t.id)?(s=n.getOptions(t.id),a=e.getPathByClass(s.className),void 0===s.parentContentId&&n.addOption(t.id,"parentContentId",t.parentContentId)):(s=Utils.parseElementData(t.elem,"brease-options"),a=e.getPathByClass(t.elem.getAttribute("data-brease-widget")),void 0===s.parentContentId&&(s.parentContentId=t.parentContentId),n.setOptions(t.id,s,!0));var r=(!0===brease.config.editMode||!0!==brease.config.mocked)&&!0!==brease.config.testMode;e.loadJSFiles(a,r).done(function(e){c({method:"loadWidgetFileSuccess",WidgetClass:e,widgetPath:a,widgetItem:t,queue:i})}).fail(function(e){u(e,a,t,i)})}else console.iatInfo("createWidget:"+t.id+" already initialized")}function o(e,t,i){var s=n.getState(e.id);s>=Enum.WidgetState.ABORTED&&s<=Enum.WidgetState.NON_EXISTENT?(n.addWithState(e.id,Enum.WidgetState.IN_PARSE_QUEUE),t.add(new WidgetItem(e,Enum.WidgetState.IN_PARSE_QUEUE,i))):s<Enum.WidgetState.IN_PARSE_QUEUE?(n.setState(e.id,Enum.WidgetState.IN_PARSE_QUEUE),t.add(new WidgetItem(e,Enum.WidgetState.IN_PARSE_QUEUE,i))):console.iatInfo("[parse] HTML element already parsed (id="+e.id+"),state="+s)}var l=!1,d=[];function c(e){d.push(e),!0!==l&&(l=!0,window.requestAnimationFrame(h))}function h(){for(var e=0;e<d.length;e+=1){var t=d[e];s[t.method].call(null,t.WidgetClass,t.widgetPath,t.widgetItem,t.queue)}d=[],l=!1}s.loadWidgetFileSuccess=function(e,t,i,s){if(i.state===Enum.WidgetState.IN_PARSE_QUEUE&&null!==s.elem)try{var a=new e(i.elem,n.getOptions(i.id,!0));a.state=Enum.WidgetState.INITIALIZED,n.addWidget(a),a.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_INITIALIZED)),!0!==a.omitReadyEvent&&a._defer("_dispatchReady"),s.finishItem(i.id)}catch(e){var r="script error for module "+t.path;n.setState(i.id,Enum.WidgetState.FAILED),console.log(r+" ("+e.message+")"),console.error(e.stack),brease.loggerService.log(Enum.EventLoggerId.CLIENT_SCRIPT_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.ERROR,[],r),s.finishItem(i.id)}};function u(e,t,i,s){var a="load error for module "+(t&&t.path?t.path:"undefined")+"("+e+")";n.setState(i.id,Enum.WidgetState.FAILED),console.debug(a),brease.loggerService.log(Enum.EventLoggerId.CLIENT_MODULELOADER_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.ERROR,[],a),s.finishItem(i.id)}function g(e,t){var i=t||"["+e+"] target of wrong type";console.iatWarn(i),brease.loggerService.log(Enum.EventLoggerId.CLIENT_PARSE_ERROR,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.WARNING,[],i)}return i}),define("brease/controller/WidgetFactory",["brease/controller/FileManager","brease/events/BreaseEvent","brease/enum/Enum","brease/controller/libs/FactoryUtils","brease/controller/libs/Queue","brease/controller/WidgetParser","brease/controller/objects/WidgetItem"],function(e,BreaseEvent,Enum,t,Queue,i,WidgetItem){"use strict";var s={init:function e(t){void 0!==t&&(n=t),i.init(t)},createWidgets:function i(s,r,o,l,d){if(s=t.getElem(s),null!==s){var c=Queue.getQueue(s,"create",!0);c.pending=!0,c.autoParse=!1!==o,l=t.ensureContentId(l,s,n.getState(s.id)),c.add(r.filter(u).reverse().map(h.bind(null,l,d))),e.loadHTMLFiles(r,c.id,[c]).done(a).fail(a)}else g("createWidgets")}},n;function a(e){!0===e.pending&&(e.pending=!1,e.start(o,[e.autoParse]).done(r))}function r(e,t,s){e.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_READY));var a=[];if(t.forEach(function(e){e.node&&(n.setState(e.node.id,Enum.WidgetState.IN_PARSE_QUEUE),a.push(new WidgetItem(e.node,Enum.WidgetState.IN_PARSE_QUEUE,e.widgetInfo.options.parentContentId)))}),!0===s){var r=Queue.getQueue(e,"parse",!0);r.add(a),i.start(r)}}function o(t,i){var s=t.widgetInfo,a=s.className;a||c(t,i,s.id,"_loadHTML","[loadHTML] no class name given for widget creation; element[id="+(s.id?s.id:"undefined")+"] not created!");var r=e.getHTMLByType(a);r||c(t,i,s.id,"_loadHTML","[loadHTML] unknown class ("+a+") name given for widget creation; element[id="+(s.id?s.id:"undefined")+"] not created!");var o=s.id,d=s.content,h=s.options?s.options:{},u=e.getPathByType(a,"class");n.setOptions(o,h,!1,!0),n.addOption(o,"className",u),t.state===Enum.WidgetState.IN_QUEUE&&null!==i.elem&&l(t,i,o,u,s,r,d,h)}function l(e,s,a,r,o,l,c,h){var u=t.createNode(l,a,h,r,o.HTMLAttributes,c);h.styleClassAdded&&n.addOption(a,"styleClassAdded",!0);var g=!1;if(o.addBeforeSelector){var m=document.querySelector(o.addBeforeSelector);m&&(m.parentNode.insertBefore(u,m),g=!0)}g||s.elem.appendChild(u),d(c,u)&&i.parse(u,!1,e.widgetInfo.options.parentContentId),e.state=Enum.WidgetState.INITIALIZED,e.node=u,s.finishItem(o.id)}function d(e,t){return e&&e.html&&-1!==e.html.indexOf("data-brease-widget=")||null!==t.querySelector("[data-brease-widget]")}function c(e,t,i,s,n){g(s,n),e.state=Enum.WidgetState.FAILED,t.finishItem(i)}function h(e,i,s){return e&&(s.options?(s.options.parentContentId=e,s.options._dynamicallyCreated=!0):s.options={parentContentId:e,_dynamicallyCreated:!0}),i&&(s.addBeforeSelector=i),s.id=t.ensureElemId(s.id),{state:Enum.WidgetState.IN_QUEUE,widgetInfo:s,id:s.id}}function u(e){var t=n.getState(e.id)<=Enum.WidgetState.IN_QUEUE;return t||console.iatWarn("filtered out:"+e.id),t}function g(e,t){var i=t||"["+e+"] target of wrong type";console.iatWarn(i),brease.loggerService.log(Enum.EventLoggerId.CLIENT_PARSE_ERROR,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.LOW,Enum.EventLoggerSeverity.WARNING,[],i)}return s}),define("brease/controller/UIController",["brease/controller/WidgetFactory","brease/controller/WidgetParser","brease/enum/Enum","brease/core/Utils"],function(e,t,Enum,Utils){"use strict";var UIController=function UIController(){},i=UIController.prototype,s,n=function(e,t,i){Utils.defineProperty(e,t,i,!0,!1,void 0!==window.brease&&void 0!==brease.config&&!0===brease.config.mocked)};return i.init=function t(i,n){s=n,this.bindingController=i,this.widgetsController={getWidget:s.getWidget,getWidgetsOfContent:s.getWidgetsOfContent,getState:s.getState,getSuspendedState:s.getSuspendedState},e.init(s)},n(i,"setOptions",function e(){s.setOptions.apply(s,arguments)}),n(i,"getOption",function e(t,i){var n=s.getOptions(t,!1);if(n){var a=n[i];return Utils.isObject(a)?Utils.deepCopy(a):n[i]}}),n(i,"setOptionsMapping",function e(t,i,n,a){if(Array.isArray(n)){var r=s.getState(t),o;o=r>=Enum.WidgetState.INITIALIZED?this.callWidget(t,"getSettings")[i]:this.getOption(t,i),n.forEach(function(e){if(void 0!==e.id&&void 0!==e.prop){var t={};void 0!==o?t[e.prop]=o:null!==a&&void 0!==a&&(t[e.prop]=a),s.setOptions(e.id,t)}})}}),n(i,"allActive",function e(){return this.bindingController.allActive.apply(this.bindingController,arguments)}),n(i,"loadValuesForContent",function e(t,i){var s=this;$.when(this.bindingController.activateContent(t)).then(function e(){"function"==typeof i&&i(),s.bindingController.sendInitialValues(t)})}),n(i,"loadValuesForVirtualContent",function e(t,i,s){var n=this;$.when(this.bindingController.activateVirtualContent(t,s)).then(function e(){"function"==typeof i&&i(),n.bindingController.sendInitialValues(t)})}),n(i,"getSubscriptionsForElement",function e(t){return this.bindingController.getSubscriptionsForElement(t)}),n(i,"parse",function e(){t.parse.apply(t,arguments)}),n(i,"dispose",function e(){s.dispose.apply(s,arguments)}),n(i,"disposeWidget",function e(){s.disposeWidget.apply(s,arguments)}),n(i,"disposeInContent",function e(){s.disposeInContent.apply(s,arguments)}),n(i,"isWidgetCallable",function e(){return s.isWidgetCallable.apply(s,arguments)}),n(i,"setWidgetPropertyIndependentOfState",function e(t,i,s,n){n=n||Utils.setter(i),(brease.uiController.getWidgetState(t)<Enum.WidgetState.INITIALIZED||null===brease.uiController.callWidget(t,n,s))&&brease.uiController.addWidgetOption(t,i,s)}),n(i,"wake",function e(){s.wake.apply(s,arguments)}),n(i,"suspend",function e(){s.suspend.apply(s,arguments)}),n(i,"wakeInContent",function e(){s.wakeInContent.apply(s,arguments)}),n(i,"suspendInContent",function e(){s.suspendInContent.apply(s,arguments)}),n(i,"callWidget",function e(){return s.callWidget.apply(s,arguments)}),n(i,"createWidgets",function t(){e.createWidgets.apply(e,arguments)}),n(i,"findWidgets",function e(){return s.findWidgets.apply(s,arguments)}),n(i,"walkWidgets",function e(){s.walkWidgets.apply(s,arguments)}),n(i,"addWidget",function e(t){if(!t.elem||!t.elem.id)throw new SyntaxError("widget needs property 'elem' with id");s.addWidget(t)}),n(i,"getWidgetState",function e(t){return s.getState(t)}),n(i,"setWidgetState",function e(t,i){s.setState(t,i)}),n(i,"addWidgetOption",function e(t,i,n){s.addOption(t,i,n)}),n(i,"parentWidgetId",function e(t){if(Utils.hasClass(t,"breaseWidget"))return t.id;var i=$(t).parents(".breaseWidget");return i.length>0?i[0].id:brease.appElem.id}),n(i,"createBindings",function e(){return this.bindingController.createBindings.apply(this.bindingController,arguments)}),n(i,"deleteBindings",function e(){return this.bindingController.deleteBindings.apply(this.bindingController,arguments)}),n(i,"isContentActive",function e(t){return this.bindingController.isContentActive(t)}),new UIController}),define("brease/core/ContainerUtils",["brease/enum/Enum","brease/core/Utils"],function(Enum,Utils){"use strict";var ContainerUtils={};ContainerUtils.inheritProperty=function(t,i,s){t instanceof NodeList?Array.prototype.forEach.call(t,n):t instanceof $&&t.each(function(){n(this)});function n(t){e.call(t,i,s)&&brease.uiController.addWidgetOption(t.id,i,s)}};function e(e,s){return i.call(this)||t.call(this,e,s)}function t(e,t){return null===brease.uiController.callWidget(this.id,Utils.setter(e),t)}function i(){return brease.uiController.getWidgetState(this.id)<Enum.WidgetState.INITIALIZED}return ContainerUtils}),define("brease/core/ContainerWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/core/ContainerUtils"],function(e,BreaseEvent,Enum,Utils,ContainerUtils){"use strict";var t={},i=e.extend(function ContainerWidget(){e.apply(this,arguments)},t),s=i.prototype;i.widgetAddedHandler="widgetAddedHandler",i.widgetRemovedHandler="widgetRemovedHandler",i.widgetChangedHandler="widgetChangedHandler",s.init=function(){this.containerVisibility=!0,this.el.wrapInner('<div class="container" />'),this.getContainer(),n.call(this),this.debouncedRefresh=_.debounce(this._refresh.bind(this),100),e.prototype.init.apply(this,arguments)},s.disable=function(){e.prototype.disable.apply(this,arguments),!0!==this.initialized&&ContainerUtils.inheritProperty(r(this.getContainer()),"parentEnableState",!1)},s._enableHandler=function(){e.prototype._enableHandler.apply(this,arguments);var t=this.isEnabled();ContainerUtils.inheritProperty(r(this.getContainer()),"parentEnableState",t)},s.updateChildrenVisibility=function(){var e=!0===this.containerVisibility&&this.isVisible();ContainerUtils.inheritProperty(r(this.getContainer()),"parentVisibleState",e)},s.updateVisibility=function(){var t=this.isHidden;e.prototype.updateVisibility.apply(this,arguments),(this.isHidden!==t||brease.config.editMode)&&(t=this.isHidden,this.updateChildrenVisibility()),this.elem.dispatchEvent(new CustomEvent(BreaseEvent.VISIBILITY_CHANGED,{bubbles:!1,detail:{visible:this.isVisible()}}))},s.visibilityChangeHandler=function(e){this.scroller&&($.contains(e.target,this.elem)||e.target===this.elem||$.contains(this.elem,e.target))&&this.debouncedRefresh()},s._refresh=function(){this.scroller&&this.isVisible()&&this.scroller.refresh()},s.dispose=function(){a.call(this),this.scroller&&("function"==typeof this.scroller.destroy&&this.scroller.destroy(),this.scroller.wrapper=null,this.scroller=null),e.prototype.dispose.apply(this,arguments)},s.wake=function(){e.prototype.wake.apply(this,arguments),document.body.addEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind("visibilityChangeHandler"),!0)},s.suspend=function(){document.body.removeEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind("visibilityChangeHandler"),!0),e.prototype.suspend.apply(this,arguments)},s.getContainer=function(){return void 0===this.container&&(this.container=this.el.find(">.container")),this.container},s[i.widgetAddedHandler]=function(){},s[i.widgetRemovedHandler]=function(){},s[i.widgetChangedHandler]=function(){this.debouncedRefresh()};function n(){!0===brease.config.editMode&&(this.elem.addEventListener(BreaseEvent.WIDGET_ADDED,this._bind(i.widgetAddedHandler)),this.elem.addEventListener(BreaseEvent.WIDGET_REMOVED,this._bind(i.widgetRemovedHandler)),this.elem.addEventListener(BreaseEvent.WIDGET_PROPERTIES_CHANGED,this._bind(i.widgetChangedHandler))),document.body.addEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind("visibilityChangeHandler"),!0)}function a(){!0===brease.config.editMode&&(this.elem.removeEventListener(BreaseEvent.WIDGET_ADDED,this._bind(i.widgetAddedHandler)),this.elem.removeEventListener(BreaseEvent.WIDGET_REMOVED,this._bind(i.widgetRemovedHandler)),this.elem.removeEventListener(BreaseEvent.WIDGET_PROPERTIES_CHANGED,this._bind(i.widgetChangedHandler))),document.body.removeEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind("visibilityChangeHandler"),!0)}function r(e){var t=e.find("[data-brease-widget]");return t.length>0&&(t=t.first().parent().children("[data-brease-widget]")),t}return i}),define("brease/core/designer/BaseWidget/ClassExtension",["brease/core/Utils"],function(Utils){"use strict";var ClassExtension={extend:function(t){if("BaseWidget"===t.name){e(t);var i=t.prototype;i.isRotatable=function(){return!0},i.isMovable=function(){return!0},i.isResizable=function(){return!0},i.getHandles=function(){return[]};var s=i.init
;i.init=function(){var e=this,t=e.constructor.meta;this.designer={isRotatable:function(){return e.isRotatable.apply(e,arguments)},isMovable:function(){return e.isMovable.apply(e,arguments)},isResizable:function(){return e.isResizable.apply(e,arguments)},isSquare:function(){return!1},getHandles:function(){return e.getHandles.apply(e,arguments)},trySetProperty:function(t,i){var s={};return s[t]=i,e.designer.isSquare()&&("height"===t&&(s.width=i),"width"===t&&(s.height=i),"minHeight"===t&&(s.minWidth=i),"minWidth"===t&&(s.minHeight=i),"maxHeight"===t&&(s.maxWidth=i),"maxWidth"===t&&(s.maxHeight=i)),s}},Object.defineProperty(this.designer,"allowsChild",{enumerable:!0,configurable:!1,writable:!1,value:function(e){if(!Utils.isWidget(e))throw new SyntaxError("argument has to be of type WidgetInstance");var i=t.children,s=e.constructor.meta.inheritance;if(-1!==i.indexOf("*"))return!0;for(var n=!1,a=0;a<s.length;a+=1)if(-1!==i.indexOf(s[a])){n=!0;break}return n}}),Object.defineProperty(this.designer,"isAllowedIn",{enumerable:!0,configurable:!1,writable:!1,value:function(e){if(!Utils.isWidget(e))throw new SyntaxError("argument has to be of type WidgetInstance");var i=t.parents,s=e.constructor.meta.className;return Array.isArray(i)?-1!==i.indexOf("*")||-1!==i.indexOf(s):(console.warn("isAllowedIn: meta data of widget instance missing!"),!1)}}),Object.defineProperty(this.designer,"isAllowedInContent",{enumerable:!0,configurable:!1,writable:!1,value:function(){var e=t.parents;return Array.isArray(e)?-1!==e.indexOf("*")||-1!==e.indexOf("system.brease.Content"):(console.warn("isAllowedInContent: meta data of widget instance missing!"),!1)}}),s.apply(this,arguments)}}}};function e(e){e.static.getInitialProperties=function(e,t){return{left:e,top:t}}}return ClassExtension}),define("brease/core/designer/BaseWidget/ClassInfo",["brease/core/designer/BaseWidget/ClassExtension"],function(){"use strict";return{}}),define("brease/core/designer/Brease/ClassExtension",["brease/core/Utils","brease/core/ClassUtils"],function(Utils,ClassUtils){"use strict";var e={isWidgetAllowedIn:function(e,i,s){var n=$.Deferred(),a=ClassUtils.className2Path(e,!1,!0)+"/designer/ClassInfo.js",r=ClassUtils.className2Path(i,!1,!0)+"/designer/ClassInfo.js";return require([a,r],function(e,i){t(n,s,ClassUtils.parentAllowsChild(i.meta,e.meta)&&ClassUtils.childAllowsParent(e.meta,i.meta))},function(e){console.warn(e.message),t(n,s,!1)}),n.promise()},getInitialProperties:function(e,i,s,n){var a=$.Deferred(),r=ClassUtils.className2Path(s,!1),o=ClassUtils.className2Path(s,!1,!0)+"/designer/ClassInfo.js";return require([r,o],function(s,r){r.classExtension&&!0!==s.extended&&r.classExtension.extend(s);var o=s.static.getInitialProperties(e,i);t(a,n,o)},function(s){console.warn(s.message),t(a,n,{top:i,left:e})}),a.promise()},className2Path:function(){return ClassUtils.className2Path.apply(null,arguments)}};function t(e,t,i){Utils.isFunction(t)&&t(i),e.resolve(i)}return{extend:function(brease){brease.designer=e}}}),define("brease/core/designer/ContainerWidget/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(){"use strict";return{}}),define("brease/core/libs/Extensions",[],function(){"use strict";var Extensions={bak:{console:window.console,log:window.console.log,info:window.console.info,warn:window.console.warn,debug:window.console.debug},console:{initStorageLog:function(e){!0===e?(console.log=function(){try{throw new Error("LogError")}catch(n){var e=n.stack.split("\n"),i=e[2].substring(e[2].lastIndexOf("/")+1),s=i.split(":");t("log",Date.now(),arguments[0],s[0],s[1],arguments[1])}Extensions.bak.log.apply(Extensions.bak.console,arguments)},console.debug=function(){try{throw new Error("LogError")}catch(n){var e=n.stack.split("\n"),i=e[2].substring(e[2].lastIndexOf("/")+1),s=i.split(":");t("debug",Date.now(),arguments[0],s[0],s[1],"#0000ff")}Extensions.bak.debug.apply(Extensions.bak.console,arguments)},console.warn=function(){try{throw new Error("LogError")}catch(n){var e=n.stack.split("\n"),i=e[2].substring(e[2].lastIndexOf("/")+1),s=i.split(":");t("warn",Date.now(),arguments[0],s[0],s[1],"#000","#fffbe6")}Extensions.bak.warn.apply(Extensions.bak.console,arguments)}):Extensions.console.reset()},reset:function(){console.warn=Extensions.bak.warn,console.info=Extensions.bak.info,console.log=Extensions.bak.log,console.debug=Extensions.bak.debug},init:function(config){console.always=function(){console.log.apply(console,arguments)},console.alwaysWarn=function(){console.warn.apply(console,arguments)},console.color=function(e,t){console.log("%c"+e,"color:"+t+";")},!0===config.warn?(console.iatWarn=console.warn,console.iatInfo=console.info):(console.iatWarn=function(){},console.iatInfo=function(){}),!0===config.debug?(console.iatDebug=console.debug,console.iatDebugLog=console.log):(console.iatDebug=function(){},console.iatDebugLog=function(){})}}},e=!0;function t(){var t=localStorage.getItem("log");t=e?i.apply(null,arguments):t+"|#|"+i.apply(null,arguments),e=!1,localStorage.setItem("log",t)}function i(e,t,i,n,a,r,o){i=i||"";var l={type:e,time:t,message:0===i.indexOf("%c")?i.substring(2):i,file:n,line:a,color:r?s(r):"#000",backColor:o||"transparent"};return JSON.stringify(l)}function s(e){return e.indexOf&&-1!==e.indexOf("color:")?(e=e.substring(e.indexOf(":")+1),e.indexOf(";")===e.length-1&&(e=e.substring(0,e.length-1)),e):e}return $.fn.showByFlag=function(e){return 0!==e?this.show():this.hide()},$.containsOrEquals=function(e,t){return e===t||$.contains(e,t)},$.fn.zIndex=function(e){if(void 0!==e){var t=parseInt(e,10);if(!isNaN(t))return this.css("zIndex",t)}if(this.length)for(var i=$(this[0]),s,n;i.length&&i[0]!==document;){if(s=i.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(n=parseInt(i.css("zIndex"),10),!isNaN(n)&&0!==n))return n;i=i.parent()}return 0},Extensions}),define("brease/datatype/Node",["brease/core/Utils"],function(Utils){"use strict";var Node=function(t,i,s,n,a){e+=1,this.id=void 0!==a?a+"":"brease_node_"+e,Object.defineProperty(this,"value",{set:function(e){this._value=e,this.time=Utils.fileTimeFromDate(new Date)},get:function(){return this._value}}),this.setUnit(i),this.setValue(t),this.setMinValue(s),this.setMaxValue(n)},e=0,t=Node.prototype;return t.toJSON=function(){return{value:this.value,id:this.id,unit:this.unit?this.unit:null,minValue:this.minValue,maxValue:this.maxValue,time:this.time}},t.equals=function(e){return this.getId()===e.getId()&&this.getUnit()===e.getUnit()&&this.getMinValue()===e.getMinValue()&&this.getMaxValue()===e.getMaxValue()&&this.getValue()===e.getValue()},t.setId=function(e){void 0!==e&&(this.id=e+"")},t.getId=function(){return this.id},t.setUnit=function(e){this.unit=void 0!==e&&null!==e?e+"":null},t.getUnit=function(){return this.unit},t.setMinValue=function(e){this.minValue=Utils.isNumeric(e)&&!Array.isArray(e)?Number(e):null},t.getMinValue=function(){return this.minValue},t.setMaxValue=function(e){this.maxValue=Utils.isNumeric(e)&&!Array.isArray(e)?Number(e):null},t.getMaxValue=function(){return this.maxValue},t.setValue=function(e){this.value=Utils.isNumeric(e)&&!Array.isArray(e)?Number(e):null},t.getValue=function(){return this.value},Node.json2Node=function(e){if(Utils.isObject(e)){return new Node(e.value,e.unit,e.minValue,e.maxValue,e.id)}return null},Node}),define("brease/datatype/ArrayNode",["brease/datatype/Node","brease/core/Utils"],function(Node,Utils){"use strict";var ArrayNode=function ArrayNode(t,i,s,n,a){e+=1,this.id=void 0!==a?a:"brease_arrayNode_"+e,this.setUnit(i),this.setValue(t),this.setMinValue(s),this.setMaxValue(n)},e=0;return(ArrayNode.prototype=new Node).setValue=function(e){!0!==Array.isArray(e)?(console.iatWarn("ArrayNode: value has to be of type Array:",e),this.value=[]):this.value=e},ArrayNode.json2ArrayNode=function(e){return Utils.isObject(e)?new ArrayNode(e.value,e.unit,e.minValue,e.maxValue,e.id):null},ArrayNode}),define("brease/datatype/StructuredProperty",["brease/core/Class","brease/core/Utils"],function(e,Utils){"use strict";var StructuredProperty=e.extend(function(t,i,s,n){e.call(this),this.id=t,this.prefix=s+"_"+n+"_",this.name=t.substring(this.prefix.length),this.settings=void 0!==i&&null!==i?Utils.extendOptionsToNew(this.defaultSettings,i):Utils.deepCopy(this.defaultSettings)},null),t=StructuredProperty.prototype;return t.setId=function(e){this.id=e,this.name=e.substring(this.prefix.length)},t.getId=function(){return this.id},StructuredProperty}),define("brease/decorators/ContentActivatedDependency",["brease/core/Decorator","brease/events/ClientSystemEvent","brease/enum/Enum"],function(Decorator,ClientSystemEvent,Enum){"use strict";var ContentActivatedDependency=function(){this.initType=Decorator.TYPE_POST},e="contentActivated",t="contentActivated",i="contentActivatedHandler";ContentActivatedDependency.prototype=new Decorator,ContentActivatedDependency.prototype.constructor=ContentActivatedDependency;var s=new ContentActivatedDependency;s.methodsToAdd={init:function(r){if(void 0===this[i])throw new Error("widget »"+this.elem.id+'«: decoration with "'+s.constructor.name+'" requires method "'+i+'"');this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:n.bind(this),wake:a.bind(this),event:t},!0===r&&this.setContentActivatedDependency(r)},setContentActivatedDependency:function(e){!0===e?r.call(this,Enum.Dependency.ACTIVE):r.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,l.call(this)}};function n(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&r.call(this,Enum.Dependency.SUSPENDED)}function a(){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&r.call(this,Enum.Dependency.ACTIVE)}function r(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?(l.call(this),o.call(this)):l.call(this))}function o(){brease.appElem.addEventListener(ClientSystemEvent.CONTENT_LOADED,this._bind(d))}function l(){brease.appElem.removeEventListener(ClientSystemEvent.CONTENT_LOADED,this._bind(d))}function d(e){e.detail.contentId===this.getParentContentId()&&(l.call(this),this[i]())}return s}),define("brease/decorators/CultureDependency",["brease/core/Decorator","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,BreaseEvent,Enum){"use strict";var CultureDependency=function(){this.initType=Decorator.TYPE_PRE},e="culture",t="culture",i="cultureChangeHandler";CultureDependency.prototype=new Decorator,CultureDependency.prototype.constructor=CultureDependency;var s=new CultureDependency;s.methodsToAdd={init:function(r){if(void 0===this[i])throw new Error("widget »"+this.elem.id+'«: decoration with "'+s.constructor.name+'" requires method "'+i+'"');this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:n.bind(this),wake:a.bind(this),event:t},!0===r&&this.setCultureDependency(r)},setCultureDependency:function(e){!0===e?r.call(this,Enum.Dependency.ACTIVE):r.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,l.call(this)}};function n(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored=brease.culture.getCurrentCulture().key,r.call(this,Enum.Dependency.SUSPENDED))}function a(t){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(r.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored!==brease.culture.getCurrentCulture().key&&this[i](t))}function r(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?o.call(this):l.call(this))}function o(){document.body.addEventListener(BreaseEvent.CULTURE_CHANGED,this._bind(i))}function l(){document.body.removeEventListener(BreaseEvent.CULTURE_CHANGED,this._bind(i))}return s}),define("brease/events/Gestures",["brease/core/Utils","hammer"],function(Utils,e){"use strict";var t=new Map,i=[{name:"pan",superClass:e.Pan},{name:"pinch",superClass:e.Pinch},{name:"press",superClass:e.Press},{name:"rotate",superClass:e.Rotate},{name:"swipe",superClass:e.Swipe},{name:"tap",superClass:e.Tap}],Gestures={settings:{mngOptions:{}},add:function(i,a,r){if(Array.isArray(a)&&Array.isArray(r)){var o,l=[];return t.has(i)?(o=t.get(i),a.forEach(function(e,t){l.push(s(n(e,r[t]),o))})):(o=new e.Manager(i,Gestures.settings.mngOptions),a.forEach(function(e,t){l.push(s(n(e,r[t]),o))}),t.set(i,o)),l}},remove:function(e){var i=t.get(e);i&&i.destroy(),t.delete(e)},on:function(e,i,s){t.get(e).on(i,s)},off:function(e,i,s){var n=t.get(e);n&&n.off(i,s)},getGestures:function(){return t},getOptionsForElement:function(e){var i=t.get(e);return e?Utils.deepCopy(i.recognizers[0].options):void 0},getSrcEvent:function(e){return e.srcEvent},getScaleFactor:function(e){return Utils.getScaleFactor(e)},getAnimationFrame:function(e,t){return"function"!=typeof t?0:a()?(this.cancelAnimationFrame(e),window.requestAnimationFrame(t)):(this.cancelAnimationFrame(e),window.setTimeout(t,0))},cancelAnimationFrame:function(e){return 0===e||"number"!=typeof e?0:(a()?window.cancelAnimationFrame(e):window.clearTimeout(e),0)}},s=function(e,t){if(e&&t)return t.add(e)},n=function(e,t){var s=i.find(function(t){return t.name===e}),n;return void 0===s?console.debug("Gesture class: ",e," not defined. Available classes:",i.map(function(e){return e.name})):n=new s.superClass(t),n};function a(){return"function"==typeof window.requestAnimationFrame}return Gestures}),define("brease/decorators/libs/Draggable",[],function(){"use strict";var Draggable=function(e){e||(e={}),e.offset=e.offset?e.offset:{},this.id=e.id?e.id:"",this.contentId=e.contentId?e.contentId:"",this.scaleFactor=e.scaleFactor?e.scaleFactor:1,this.zIndex=e.zIndex?e.zIndex:"auto",this.width=e.width?e.width:"",this.height=e.height?e.height:"",this.clientX=e.clientX?e.clientX:0,this.clientY=e.clientY?e.clientY:0,this.startPosition={},this.offset={x:e.offset.x?e.offset.x:0,y:e.offset.y?e.offset.y:0},e.clone&&(this.clone=t(e.clone,this.width,this.height,this.zIndex,this.scaleFactor)),this.startPosition.x=this.clientX,this.startPosition.y=this.clientY,this.setPosition()},e=Draggable.prototype;e.setPosition=function(){this.clone&&(this.clone.style.left=this.clientX-this.offset.x+"px",this.clone.style.top=this.clientY-this.offset.y+"px")},e.updateIntersection=function(e){Number.isFinite(e.clientX)&&Number.isFinite(e.clientY)&&this.setIntersectionElement($(document.elementFromPoint(e.clientX,e.clientY)).closest(".droppableItem").get(0))},e.setIntersectionElement=function(e){var t=this.intersectionElem;e!==this.intersectionElem&&(this.intersectionElem=e,i.call(this,t),s.call(this,e))},e.dispatchDragStart=function(){brease.callWidget(this.id,"dragStartHandler",{contentId:this.contentId,id:this.id})},e.dispatchDrop=function(){this.intersectionElem&&this.intersectionElem.id&&(!0===this.intersectionElem.hasAttribute("data-widget-refid")?brease.callWidget(this.intersectionElem.getAttribute("data-widget-refid"),"dropHandler",{id:this.id,contentId:this.contentId}):brease.callWidget(this.intersectionElem.id,"dropHandler",{id:this.id,contentId:this.contentId}))},e.dispatchDragEnd=function(){brease.callWidget(this.id,"dragEndHandler",{id:this.id,contentId:this.contentId})},e.dispose=function(){this.clone&&this.clone.remove()};function t(e,t,i,s,n){return e&&(t&&(e.style.width=t+"px"),i&&(e.style.height=i+"px"),e.style["pointer-events"]="none",e.style.position="fixed",e.style.margin="auto",e.style["z-index"]=s,e.style.transform="scale("+n+","+n+")",e.style["transform-origin"]="0 0",e.style.WebkitBackfaceVisibility="hidden",e.style.backfaceVisibility="hidden"),e}function i(e){e&&e.id&&(!0===e.hasAttribute("data-widget-refid")?brease.callWidget(e.getAttribute("data-widget-refid"),"dragLeaveHandler",{id:this.id,contentId:this.contentId}):brease.callWidget(e.id,"dragLeaveHandler",{id:this.id,contentId:this.contentId}))}function s(e){e&&e.id&&(!0===e.hasAttribute("data-widget-refid")?brease.callWidget(e.getAttribute("data-widget-refid"),"dragEnterHandler",{id:this.id,contentId:this.contentId}):brease.callWidget(e.id,"dragEnterHandler",{id:this.id,contentId:this.contentId}))}return Draggable}),define("brease/decorators/libs/DragAndDropManager",["brease/core/Utils","brease/events/BreaseEvent","brease/events/Gestures","brease/decorators/libs/Draggable"],function(Utils,BreaseEvent,Gestures,Draggable){"use strict";var e=new Map;return new function(){var t=this,i=0,s=!1;t.dragOffset=window.devicePixelRatio>1?10*window.devicePixelRatio:10,t.listens=!1,t.init=function(){t.isActive()||(brease.docEl.on(BreaseEvent.MOUSE_DOWN,n),s=!0)},t.hasClones=function(){return e.size>0},t.getClone=function(){return e.get(0)},t.isActive=function(){return s},t.dispose=function(){brease.docEl.off(BreaseEvent.MOUSE_DOWN,n),s=!1};function n(i){if(!t.hasClones()){var s=$(i.target),draggable=s.closest(".draggableItem"),n=draggable.length?draggable.attr("id"):"",o=Utils.getPointerId(i),d,c,h,u,g=i.clientX?i.clientX:0,m=i.clientY?i.clientY:0,p={};!!n&&brease.callWidget(n,"isEnabled")&&draggable.length>0&&(l(i),h=draggable.get(0),u=h.cloneNode(!0),p.scaleFactor=Utils.getTransformedScaleFactor(h),p.id=n,p.contentId=n?brease.callWidget(n,"getParentContentId"):"",p.clone=u,p.clientX=g,p.clientY=m,p.zIndex=Utils.getHighestZindex(document.querySelectorAll("body > [class],body > [style],body > [id]")),c=window.getComputedStyle(h,null).getPropertyValue("transform"),"matrix(1, 0, 0, 1, 0, 0)"!==c&&"none"!==c||(d=h.getBoundingClientRect(),p.offset={x:g-d.left,y:m-d.top},p.width=d.width/p.scaleFactor,p.height=d.height/p.scaleFactor),e.set(o,new Draggable(p))),!t.listens&&t.hasClones()&&(brease.docEl.on(BreaseEvent.MOUSE_MOVE,a),brease.docEl.on(BreaseEvent.MOUSE_UP,r),t.listens=!0)}}function a(s){var n=Utils.getPointerId(s),a=e.get(n);a&&(a.clientX=s.clientX,a.clientY=s.clientY,a.pointerId===n?(l(s),i=Gestures.getAnimationFrame(i,o),a.updateIntersection(s)):(Math.abs(a.startPosition.x-s.clientX)>t.dragOffset||Math.abs(a.startPosition.y-s.clientY)>t.dragOffset)&&(l(s),a.dispatchDragStart(),a.pointerId=n,i=Gestures.getAnimationFrame(i,o),document.body.append(a.clone)))}function r(s){var n=Utils.getPointerId(s),o=e.get(n);o&&(void 0!==o.pointerId&&(l(s),o.updateIntersection(s),o.dispatchDrop(),o.dispatchDragEnd()),o.dispose(),e.delete(n)),t.listens&&!t.hasClones()&&(Gestures.cancelAnimationFrame(i),brease.docEl.off(BreaseEvent.MOUSE_MOVE,a),brease.docEl.off(BreaseEvent.MOUSE_UP,r),t.listens=!1)}function o(){e.forEach(function(draggable){draggable.setPosition()})}function l(e){e.stopPropagation(),e.preventDefault()}return t}}),define("brease/decorators/DragAndDropCapability",["brease/core/Decorator","brease/core/Utils","brease/events/BreaseEvent","brease/enum/Enum","brease/decorators/libs/DragAndDropManager"],function(Decorator,Utils,BreaseEvent,Enum,DragAndDropManager){"use strict";var DragAndDropCapability=function DragAndDropCapability(){this.initType=Decorator.TYPE_PRE},e="dragAndDrop";DragAndDropCapability.prototype=new Decorator,DragAndDropCapability.prototype.constructor=DragAndDropCapability;var t=new DragAndDropCapability;t.methodsToAdd={init:function(){this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:i.bind(this),wake:s.bind(this)},brease.config.editMode||(DragAndDropManager.isActive()||DragAndDropManager.init(),void 0!==this.settings.droppable&&!1===this.settings.droppable?this.setDroppable(!1):this.setDroppable(!0),"boolean"==typeof this.settings.draggable&&this.setDraggable(this.settings.draggable),this.dependencies[e].state=Enum.Dependency.ACTIVE)},setDraggable:function(e){e&&Utils.addClass(this.elem,"draggableItem")},setDroppable:function(e){e&&Utils.addClass(this.elem,"droppableItem")},dispose:function(){this.dependencies[e]=null},dragStartHandler:function(e){var t;return"function"==typeof this._dragStartHandler&&(t=this._dragStartHandler(e)),this.dispatchServerEvent(BreaseEvent.ONDRAG_START,{contentId:e.contentId,widgetId:Utils.getWidgetId(e.contentId,e.id)}),t},dragEndHandler:function(e){this.dispatchServerEvent(BreaseEvent.ONDRAG_END,{contentId:e.contentId,widgetId:Utils.getWidgetId(e.contentId,e.id)})},dragEnterHandler:function(e){this.dispatchServerEvent(BreaseEvent.ONDRAG_ENTER,{contentId:e.contentId,widgetId:Utils.getWidgetId(e.contentId,e.id)})},dragLeaveHandler:function(e){this.dispatchServerEvent(BreaseEvent.ONDRAG_LEAVE,{contentId:e.contentId,widgetId:Utils.getWidgetId(e.contentId,e.id)})},dropHandler:function(e){var t;return"function"==typeof this._dropHandler&&(t=this._dropHandler(e)),this.dispatchServerEvent(BreaseEvent.ONDROP,{contentId:e.contentId,widgetId:Utils.getWidgetId(e.contentId,e.id)}),t}};function i(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&n.call(this,Enum.Dependency.SUSPENDED)}function s(){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&n.call(this,Enum.Dependency.ACTIVE)}function n(t){this.dependencies[e]&&(this.dependencies[e].state=t)}return t}),define("brease/decorators/UserDependency",["brease/core/Decorator","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,BreaseEvent,Enum){"use strict";var UserDependency=function UserDependency(){this.initType=Decorator.TYPE_PRE},e="user",t="user",i="userChangeHandler";UserDependency.prototype=new Decorator,UserDependency.prototype.constructor=UserDependency;var s=new UserDependency;s.methodsToAdd={init:function(r){if(void 0===this[i])throw new Error("widget »"+this.elem.id+'«: decoration with "'+s.constructor.name+'" requires method "'+i+'"');this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:n.bind(this),wake:a.bind(this),event:t},!0===r&&this.setUserDependency(r)},setUserDependency:function(e){!0===e?r.call(this,Enum.Dependency.ACTIVE):r.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,l.call(this)}};function n(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&(this.dependencies[e].stored=brease.user.getCurrentUser().userID,r.call(this,Enum.Dependency.SUSPENDED))}function a(t){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&(r.call(this,Enum.Dependency.ACTIVE),this.dependencies[e].stored!==brease.user.getCurrentUser().userID&&this[i](t))}function r(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?o.call(this):l.call(this))}function o(){document.body.addEventListener(BreaseEvent.USER_CHANGED,this._bind(i))}function l(){document.body.removeEventListener(BreaseEvent.USER_CHANGED,this._bind(i))}return s}),define("brease/decorators/VisibilityDependency",["brease/core/Decorator","brease/core/Utils","brease/events/BreaseEvent","brease/enum/Enum"],function(Decorator,Utils,BreaseEvent,Enum){"use strict";var e="visibility",t="visibilityChangeHandler",i=100,s=Decorator.createDecorator(Decorator.TYPE_PRE),n=new s;n.methodsToAdd={init:function(t){this.dependencies[e]={state:Enum.Dependency.INACTIVE,suspend:a.bind(this),wake:r.bind(this)},!0===t&&this.setVisibilityDependency(t),this.debouncedRefresh=_.debounce(this._refreshScroller.bind(this),100)},setVisibilityDependency:function(e){!0===e?o.call(this,Enum.Dependency.ACTIVE):o.call(this,Enum.Dependency.INACTIVE)},dispose:function(){this.dependencies[e]=null,d.call(this)}},n.methodsToAdd[t]=function(e){Utils.elemContains(e.target,this.elem)&&this.debouncedRefresh()},n.addIfNotDefined={_refreshScroller:function(){this.scroller&&"function"==typeof this.scroller.refresh&&!this.isHidden&&this.scroller.refresh()}};function a(){this.dependencies[e].state===Enum.Dependency.ACTIVE&&o.call(this,Enum.Dependency.SUSPENDED)}function r(){this.dependencies[e].state===Enum.Dependency.SUSPENDED&&o.call(this,Enum.Dependency.ACTIVE)}function o(t){this.dependencies[e]&&(this.dependencies[e].state=t,t===Enum.Dependency.ACTIVE?l.call(this):d.call(this))}function l(){document.body.addEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind(t),!0)}function d(){document.body.removeEventListener(BreaseEvent.VISIBILITY_CHANGED,this._bind(t),!0)}return n}),function(e,t){var i,s,n,a,r,o,l,d,c,h,u,g,m,p,f,b,v,y,w,x,E,I,C,_;i=function(e){return new i.prototype.init(e)},void 0!==require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=i:e.Globalize=i,i.cultures={},i.prototype={constructor:i,init:function(e){return this.cultures=i.cultures,this.cultureSelector=e,this}},i.prototype.init.prototype=i.prototype,i.cultures.default={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},i.cultures.default.calendar=i.cultures.default.calendars.standard,i.cultures.en=i.cultures.default,i.cultureSelector="en",s=/^0x[a-f0-9]+$/i,n=/^[+\-]?infinity$/i,a=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,r=/^\s+|\s+$/g,o=function(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0,s=e.length;i<s;i++)if(e[i]===t)return i;return-1},l=function(e,t){return e.substr(e.length-t.length)===t},d=function(){var e,t,i,s,n,a,r=arguments[0]||{},o=1,l=arguments.length,g=!1;for("boolean"==typeof r&&(g=r,r=arguments[1]||{},o=2),"object"==typeof r||h(r)||(r={});o<l;o++)if(null!=(e=arguments[o]))for(t in e)i=r[t],s=e[t],r!==s&&(g&&s&&(u(s)||(n=c(s)))?(n?(n=!1,a=i&&c(i)?i:[]):a=i&&u(i)?i:{},r[t]=d(g,a,s)):void 0!==s&&(r[t]=s));return r},c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},h=function(e){return"[object Function]"===Object.prototype.toString.call(e)},u=function(e){return"[object Object]"===Object.prototype.toString.call(e)},g=function(e,t){return 0===e.indexOf(t)},m=function(e){return(e+"").replace(r,"")},p=function(e){return isNaN(e)?NaN:Math[e<0?"ceil":"floor"](e)},f=function(e,t,i){var s;for(s=e.length;s<t;s+=1)e=i?"0"+e:e+"0";return e},b=function(e,t){for(var i=0,s=!1,n=0,a=e.length;n<a;n++){var r=e.charAt(n);switch(r){case"'":s?t.push("'"):i++,s=!1;break;case"\\":s&&t.push("\\"),s=!s;break;default:t.push(r),s=!1;break}}return i},v=function(e,t){t=t||"F";var i,s=e.patterns,n=t.length;if(1===n){if(i=s[t],!i)throw"Invalid date format string '"+t+"'.";t=i}else 2===n&&"%"===t.charAt(0)&&(t=t.charAt(1));return t},y=function(e,t,i){var s=i.calendar,n=s.convert,a;if(!t||!t.length||"i"===t){if(i&&i.name.length)if(n)a=y(e,s.patterns.F,i);else{var r=new Date(e.getTime()),o=E(e,s.eras);r.setFullYear(I(e,s,o)),a=r.toLocaleString()}else a=e.toString();return a}var l=s.eras,d="s"===t;t=v(s,t),a=[];var c,h=["0","00","000"],u,g,m=/([^d]|^)(d|dd)([^d]|$)/g,p=0,f=x(),w;function C(e,t){var i,s=e+"";return t>1&&s.length<t?(i=h[t-2]+s,i.substr(i.length-t,t)):(i=s,i)}function _(){return u||g?u:(u=m.test(t),g=!0,u)}function S(e,t){if(w)return w[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+t}}for(!d&&n&&(w=n.fromGregorian(e));;){var T=f.lastIndex,D=f.exec(t),A=t.slice(T,D?D.index:t.length);if(p+=b(A,a),!D)break;if(p%2)a.push(D[0]);else{var L=D[0],P=L.length;switch(L){case"ddd":case"dddd":var O=3===P?s.days.namesAbbr:s.days.names;a.push(O[e.getDay()]);break;case"d":case"dd":u=!0,a.push(C(S(e,2),P));break;case"MMM":case"MMMM":var N=S(e,1);a.push(s.monthsGenitive&&_()?s.monthsGenitive[3===P?"namesAbbr":"names"][N]:s.months[3===P?"namesAbbr":"names"][N]);break;case"M":case"MM":a.push(C(S(e,1)+1,P));break;case"y":case"yy":case"yyyy":N=w?w[0]:I(e,s,E(e,l),d),P<4&&(N%=100),a.push(C(N,P));break;case"h":case"hh":c=e.getHours()%12,0===c&&(c=12),a.push(C(c,P));break;case"H":case"HH":a.push(C(e.getHours(),P));break;case"m":case"mm":a.push(C(e.getMinutes(),P));break;case"s":case"ss":a.push(C(e.getSeconds(),P));break;case"t":case"tt":N=e.getHours()<12?s.AM?s.AM[0]:" ":s.PM?s.PM[0]:" ",a.push(1===P?N.charAt(0):N);break;case"f":case"ff":case"fff":a.push(C(e.getMilliseconds(),3).substr(0,P));break;case"z":case"zz":c=e.getTimezoneOffset()/60,a.push((c<=0?"+":"-")+C(Math.floor(Math.abs(c)),P));break;case"zzz":c=e.getTimezoneOffset()/60,a.push((c<=0?"+":"-")+C(Math.floor(Math.abs(c)),2)+":"+C(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":s.eras&&a.push(s.eras[E(e,l)].name);break;case"/":a.push(s["/"]);break;default:throw"Invalid date format pattern '"+L+"'."}}}return a.join("")},function(){var e;e=function(e,t,i){var s=i.groupSizes,n=s[0],a=1,r=Math.pow(10,t),o=Math.round(e*r)/r;isFinite(o)||(o=e),e=o;var l=e+"",d="",c=l.split(/e/i),h=c.length>1?parseInt(c[1],10):0;l=c[0],c=l.split("."),l=c[0],d=c.length>1?c[1]:"",h>0?(d=f(d,h,!1),l+=d.slice(0,h),d=d.substr(h)):h<0&&(h=-h,l=f(l,h+1,!0),d=l.slice(-h,l.length)+d,l=l.slice(0,-h)),d=t>0?i["."]+(d.length>t?d.slice(0,t):f(d,t)):"";for(var u=l.length-1,g=i[","],m="";u>=0;){if(0===n||n>u)return l.slice(0,u+1)+(m.length?g+m+d:d);m=l.slice(u-n+1,u+1)+(m.length?g+m:""),u-=n,a<s.length&&(n=s[a],a++)}return l.slice(0,u+1)+g+m+d},w=function(t,i,s){if(!isFinite(t))return t===1/0?s.numberFormat.positiveInfinity:t===-1/0?s.numberFormat.negativeInfinity:s.numberFormat.NaN;if(!i||"i"===i)return s.name.length?t.toLocaleString():t.toString();i=i||"D";var n=s.numberFormat,a=Math.abs(t),r=-1,o;i.length>1&&(r=parseInt(i.slice(1),10));var l=i.charAt(0).toUpperCase(),d;switch(l){case"D":o="n",a=p(a),-1!==r&&(a=f(""+a,r,!0)),t<0&&(a="-"+a);break;case"N":d=n;case"C":d=d||n.currency;case"P":d=d||n.percent,o=t<0?d.pattern[0]:d.pattern[1]||"n",-1===r&&(r=d.decimals),a=e(a*("P"===l?100:1),r,d);break;default:throw"Bad number format specifier: "+l}for(var c=/n|\$|-|%/g,h="";;){var u=c.lastIndex,g=c.exec(o);if(h+=o.slice(u,g?g.index:o.length),!g)break;switch(g[0]){case"n":h+=a;break;case"$":h+=n.currency.symbol;break;case"-":/[1-9]/.test(a)&&(h+=n["-"]);break;case"%":h+=n.percent.symbol;break}}return h}}(),x=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},E=function(e,t){if(!t)return 0;for(var i,s=e.getTime(),n=0,a=t.length;n<a;n++)if(i=t[n].start,null===i||s>=i)return n;return 0},I=function(e,t,i,s){var n=e.getFullYear();return!s&&t.eras&&(n-=t.eras[i].offset),n},function(){var e,t,i,s,n,a,r;e=function(e,t){if(t<100){var i=new Date,s=E(i),n=I(i,e,s),a=e.twoDigitYearMax;a="string"==typeof a?(new Date).getFullYear()%100+parseInt(a,10):a,t+=n-n%100,t>a&&(t-=100)}return t},t=function(e,t,i){var s,n=e.days,l=e._upperDays;return l||(e._upperDays=l=[r(n.names),r(n.namesAbbr),r(n.namesShort)]),t=a(t),i?(s=o(l[1],t),-1===s&&(s=o(l[2],t))):s=o(l[0],t),s},i=function(e,t,i){var s=e.months,n=e.monthsGenitive||e.months,l=e._upperMonths,d=e._upperMonthsGen;l||(e._upperMonths=l=[r(s.names),r(s.namesAbbr)],e._upperMonthsGen=d=[r(n.names),r(n.namesAbbr)]),t=a(t);var c=o(i?l[1]:l[0],t);return c<0&&(c=o(i?d[1]:d[0],t)),c},s=function(e,t){var i=e._parseRegExp;if(i){var s=i[t];if(s)return s}else e._parseRegExp=i={};for(var n=v(e,t).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),a=["^"],r=[],o=0,l=0,d=x(),c;null!==(c=d.exec(n));){var h=n.slice(o,c.index);if(o=d.lastIndex,l+=b(h,a),l%2)a.push(c[0]);else{var u=c[0],g=u.length,m;switch(u){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":m="(\\D+)";break;case"tt":case"t":m="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":m="(\\d{"+g+"})";break;case"dd":case"d":
case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":m="(\\d\\d?)";break;case"zzz":m="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":m="([+-]?\\d\\d?)";break;case"/":m="(\\/)";break;default:throw"Invalid date format pattern '"+u+"'."}m&&a.push(m),r.push(c[0])}}b(n.slice(o),a),a.push("$");var p=a.join("").replace(/\s+/g,"\\s+"),f={regExp:p,groups:r};return i[t]=f},n=function(e,t,i){return e<t||e>i},a=function(e){return e.split(" ").join(" ").toUpperCase()},r=function(e){for(var t=[],i=0,s=e.length;i<s;i++)t[i]=a(e[i]);return t},C=function(a,r,o){a=m(a);var l=o.calendar,d=s(l,r),c=new RegExp(d.regExp).exec(a);if(null===c)return null;for(var h=d.groups,u=null,p=null,f=null,b=null,v=null,y=0,w,x=0,E=0,I=0,C=null,_=!1,S=0,T=h.length;S<T;S++){var D=c[S+1];if(D){var A=h[S],L=A.length,P=parseInt(D,10);switch(A){case"dd":case"d":if(b=P,n(b,1,31))return null;break;case"MMM":case"MMMM":if(f=i(l,D,3===L),n(f,0,11))return null;break;case"M":case"MM":if(f=P-1,n(f,0,11))return null;break;case"y":case"yy":case"yyyy":if(p=L<4?e(l,P):P,n(p,0,9999))return null;break;case"h":case"hh":if(y=P,12===y&&(y=0),n(y,0,11))return null;break;case"H":case"HH":if(y=P,n(y,0,23))return null;break;case"m":case"mm":if(x=P,n(x,0,59))return null;break;case"s":case"ss":if(E=P,n(E,0,59))return null;break;case"tt":case"t":if(_=l.PM&&(D===l.PM[0]||D===l.PM[1]||D===l.PM[2]),!_&&(!l.AM||D!==l.AM[0]&&D!==l.AM[1]&&D!==l.AM[2]))return null;break;case"f":case"ff":case"fff":if(I=P*Math.pow(10,3-L),n(I,0,999))return null;break;case"ddd":case"dddd":if(v=t(l,D,3===L),n(v,0,6))return null;break;case"zzz":var O=D.split(/:/);if(2!==O.length)return null;if(w=parseInt(O[0],10),n(w,-12,13))return null;var N=parseInt(O[1],10);if(n(N,0,59))return null;C=60*w+(g(D,"-")?-N:N);break;case"z":case"zz":if(w=P,n(w,-12,13))return null;C=60*w;break;case"g":case"gg":var k=D;if(!k||!l.eras)return null;k=m(k.toLowerCase());for(var R=0,B=l.eras.length;R<B;R++)if(k===l.eras[R].name.toLowerCase()){u=R;break}if(null===u)return null;break}}}var M=new Date,V,W=l.convert;if(V=W?W.fromGregorian(M)[0]:M.getFullYear(),null===p?p=V:l.eras&&(p+=l.eras[u||0].offset),null===f&&(f=0),null===b&&(b=1),W){if(M=W.toGregorian(p,f,b),null===M)return null}else{if(M.setFullYear(p,f,b),M.getDate()!==b)return null;if(null!==v&&M.getDay()!==v)return null}if(_&&y<12&&(y+=12),M.setHours(y,x,E,I),null!==C){var H=M.getMinutes()-(C+M.getTimezoneOffset());M.setHours(M.getHours()+parseInt(H/60,10),H%60)}return M}}(),_=function(e,t,i){var s=t["-"],n=t["+"],a;switch(i){case"n -":s=" "+s,n=" "+n;case"n-":l(e,s)?a=["-",e.substr(0,e.length-s.length)]:l(e,n)&&(a=["+",e.substr(0,e.length-n.length)]);break;case"- n":s+=" ",n+=" ";case"-n":g(e,s)?a=["-",e.substr(s.length)]:g(e,n)&&(a=["+",e.substr(n.length)]);break;case"(n)":g(e,"(")&&l(e,")")&&(a=["-",e.substr(1,e.length-2)]);break}return a||["",e]},i.prototype.findClosestCulture=function(e){return i.findClosestCulture.call(this,e)},i.prototype.format=function(e,t,s){return i.format.call(this,e,t,s)},i.prototype.localize=function(e,t){return i.localize.call(this,e,t)},i.prototype.parseInt=function(e,t,s){return i.parseInt.call(this,e,t,s)},i.prototype.parseFloat=function(e,t,s){return i.parseFloat.call(this,e,t,s)},i.prototype.culture=function(e){return i.culture.call(this,e)},i.addCultureInfo=function(e,t,i){var s={},n=!1;"string"!=typeof e?(i=e,e=this.culture().name,s=this.cultures[e]):"string"!=typeof t?(i=t,n=null==this.cultures[e],s=this.cultures[e]||this.cultures.default):(n=!0,s=this.cultures[t]),this.cultures[e]=d(!0,{},s,i),n&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},i.findClosestCulture=function(e){var t;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures.default;if("string"==typeof e&&(e=e.split(",")),c(e)){var i,s=this.cultures,n=e,a,r=n.length,o=[];for(a=0;a<r;a++){e=m(n[a]);var l,d=e.split(";");i=m(d[0]),1===d.length?l=1:(e=m(d[1]),0===e.indexOf("q=")?(e=e.substr(2),l=parseFloat(e),l=isNaN(l)?0:l):l=1),o.push({lang:i,pri:l})}for(o.sort(function(e,t){return e.pri<t.pri?1:e.pri>t.pri?-1:0}),a=0;a<r;a++)if(i=o[a].lang,t=s[i],t)return t;for(a=0;a<r;a++)for(i=o[a].lang;;){var h=i.lastIndexOf("-");if(-1===h)break;if(i=i.substr(0,h),t=s[i],t)return t}for(a=0;a<r;a++){i=o[a].lang;for(var u in s){var g=s[u];if(g.language===i)return g}}}else if("object"==typeof e)return e;return t||null},i.format=function(e,t,i){var s=this.findClosestCulture(i);return e instanceof Date?e=y(e,t,s):"number"==typeof e&&(e=w(e,t,s)),e},i.localize=function(e,t){return this.findClosestCulture(t).messages[e]||this.cultures.default.messages[e]},i.parseDate=function(e,t,i){i=this.findClosestCulture(i);var s,n,a;if(t){if("string"==typeof t&&(t=[t]),t.length)for(var r=0,o=t.length;r<o;r++){var l=t[r];if(l&&(s=C(e,l,i),s))break}}else{a=i.calendar.patterns;for(n in a)if(s=C(e,a[n],i),s)break}return s||null},i.parseInt=function(e,t,s){return p(i.parseFloat(e,t,s))},i.parseFloat=function(e,t,i){"number"!=typeof t&&(i=t,t=10);var r=this.findClosestCulture(i),o=NaN,l=r.numberFormat;if(e.indexOf(r.numberFormat.currency.symbol)>-1&&(e=e.replace(r.numberFormat.currency.symbol,""),e=e.replace(r.numberFormat.currency["."],r.numberFormat["."])),e.indexOf(r.numberFormat.percent.symbol)>-1&&(e=e.replace(r.numberFormat.percent.symbol,"")),e=e.replace(/ /g,""),n.test(e))o=parseFloat(e);else if(!t&&s.test(e))o=parseInt(e,16);else{var d=_(e,l,l.pattern[0]),c=d[0],h=d[1];""===c&&"(n)"!==l.pattern[0]&&(d=_(e,l,"(n)"),c=d[0],h=d[1]),""===c&&"-n"!==l.pattern[0]&&(d=_(e,l,"-n"),c=d[0],h=d[1]),c=c||"+";var u,g,m=h.indexOf("e");m<0&&(m=h.indexOf("E")),m<0?(g=h,u=null):(g=h.substr(0,m),u=h.substr(m+1));var p,f,b=l["."],v=g.indexOf(b);v<0?(p=g,f=null):(p=g.substr(0,v),f=g.substr(v+b.length));var y=l[","];p=p.split(y).join("");var w=y.replace(/\u00A0/g," ");y!==w&&(p=p.split(w).join(""));var x=c+p;if(null!==f&&(x+="."+f),null!==u){var E=_(u,l,"-n");x+="e"+(E[0]||"+")+E[1]}a.test(x)&&(o=parseFloat(x))}return o},i.culture=function(e){return void 0!==e&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures.default}}(this),define("globalize",function(){}),define("brease/helper/DateFormatter",["globalize"],function(){"use strict";var e={format:function(e,i,s,n){var a=t(i,n);s(Globalize.format(e,a.format,a.code))},formatSync:function(e,i,s){var n=t(i,s);return Globalize.format(e,n.format,n.code)},getFormat4Pattern:function(e){return brease.culture.getCurrentCulture().culture.calendar.patterns[e]},clearFormat:function(e){return-1!==e.indexOf("'")?e.split("'").filter(function(e,t){return t%2==0}).join(""):e},defaultPattern:"S"};function t(t,i){var s;if(void 0!==i){if(s=Globalize.findClosestCulture(i),null===s){var n=brease.culture.getCurrentCulture();console.iatWarn('invalid culture "'+i+'" -> take default culture "'+n.key+'"'),s=n.culture,i=n.key}}else s=brease.culture.getCurrentCulture().culture;return 1===t.length&&void 0===s.calendar.patterns[t]&&(console.iatWarn('invalid pattern "'+t+'" -> take default pattern "'+e.defaultPattern+'"'),t=e.defaultPattern),{format:t,code:i}}return e}),define("brease/helper/NumberFormatter",["brease/core/Utils"],function(Utils){"use strict";var e=function(){var e=this;return void 0===h&&(h=e),h},t=e.prototype;t.defaults={useDigitGrouping:!1,decimalPlaces:1,minimumIntegerDigits:1,maximumIntegerDigits:8,separators:{dsp:".",gsp:","}};function i(e){return e?(Utils.isString(e.dsp)||(e.dsp="."===e.gsp?",":t.defaults.separators.dsp),Utils.isString(e.gsp)||(e.gsp=","===e.dsp?".":t.defaults.separators.gsp),e):t.defaults.separators}t.parseFloat=function(e,t){return t=i(t),e=""+e,e=e.replace(d(t),""),e=e.replace(t.dsp,"."),parseFloat(e)},t.formatNumber=function(e,t,i,s){var n=Math.abs(e),a;if(a=0===n?1:e/n,n===1/0)return e.toString();var l=-1===a?"-":"";return-1!==n.toString().indexOf("e+")?o.call(this,n,l,s,t):r.call(this,n,l,s,t,i)},t.roundToSignificant=function(e,t){if(isNaN(e))throw new SyntaxError("value has to be a number");if(isNaN(t))throw new SyntaxError("precision has to be a positive integer >= 1");if(0===e)return e;t=Math.max(1,parseInt(t,10));var i=Math.abs(e),s=e/i,n=Math.floor(Math.log10(i))+1,a=Math.max(0,t-n);return s*Utils.roundTo(i,a)},t.findPossibleFormattedValue=function(e,i,s){var n=Math.abs(e),a=Math.max(1,Math.pow(10,i)),r=t.roundToFormat(e,i);return"max"===s&&r>e&&n>1/a&&(r-=1/a),"min"===s&&r<e&&n>1/a&&(r+=1/a),r},t.roundToFormat=function(e,t){if(isNaN(e))throw new SyntaxError("value has to be a number");if(isNaN(t))throw new SyntaxError("decimalPlaces has to be a positive integer >= 0");if(0===e)return e;t=Math.max(0,parseInt(t,10));var i=Math.abs(e),s=e/i,n=Math.max(1,Math.pow(10,t));return i>0&&i*n<Number.MAX_VALUE?s*Utils.roundTo(i,t):e},t.toFixed=function(e,t){return Utils.roundTo(e,t).toFixed(t)};function s(e,t){var i=this.defaults.separators[e];return t&&t[e]&&(i=t[e]),i}function n(e,t,i){var s=this.defaults[e];return t&&t[e]>=i&&(s=parseInt(t[e],10)),s}function a(e,t,i,s){var n=Math.floor(Math.log10(e)),a=e/Math.pow(10,n),r=Math.round(a*Math.pow(10,i))/Math.pow(10,i);10===r&&(r=1,n+=1);var o=r.toFixed(i).split(".");return o.length>1?t+o[0]+s+o[1]+"e+"+n:t+o[0]+"e+"+n}function r(e,i,r,o,d){var c=s.call(this,"dsp",r),h=s.call(this,"gsp",r),u=n.call(this,"decimalPlaces",o,0),g=n.call(this,"minimumIntegerDigits",o,1),m=n.call(this,"maximumIntegerDigits",o,1),p,f="";g>m&&(m=g);var b=t.toFixed(e,u).split(".");if(u>0&&(f=b[1]),b[0].length>m)return a(e,i,u,c);if(g>0&&g>b[0].length){p=(parseInt(b[0],10)/Math.pow(10,g-1)).toFixed(g-1).replace(".","")}else p=b[0];return!0===d&&(p=l(p,h)),i+p+(""!==p&&""!==f?c:"")+f}function o(e,t,i,s){var n=this.defaults.separators.dsp;i&&i.dsp&&(n=i.dsp);var a=e.toString().split("e+");return a[0]=parseFloat(a[0]).toFixed(s.decimalPlaces),a[0]=a[0].replace(".",n),t+a.join("e+")}function l(e,t){return e.split(c).join(t)}function d(e){return u.gsp!==e.gsp&&(u.gsp=e.gsp,g=new RegExp("\\"+e.gsp,"g")),g}var c=/(?=(?:\d{3})+(?:\.|$))/g,h,u={},g;return e}),define("brease/services/libs/ServerCommand",["brease/core/Utils"],function(Utils){"use strict";var e={};return Utils.defineProperty(e,"ACTION","action"),Utils.defineProperty(e,"ACTION_RESPONSE","actionResponse"),Utils.defineProperty(e,"EVENT","event"),Utils.defineProperty(e,"UPDATE","update"),Utils.defineProperty(e,"GET_UPDATE","getUpdate"),Utils.defineProperty(e,"SYSTEM","system"),Utils.defineProperty(e,"ACTIVATE_CONTENT","activatecontent"),Utils.defineProperty(e,"DEACTIVATE_CONTENT","deactivatecontent"),Utils.defineProperty(e,"SUBSCRIBE","subscribe"),Utils.defineProperty(e,"UNSUBSCRIBE","unsubscribe"),e}),define("brease/helper/Timer",["brease/events/EventDispatcher","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var Timer=function Timer(e){this.active=!1,this.interval=e,this.start()},t=Timer.prototype=new e;return t.start=function(){!1===this.active&&(this.ticker=window.setInterval(this.tickHandler.bind(this),this.interval),this.active=!0)},t.stop=function(){window.clearInterval(this.ticker),this.active=!1},t.tickHandler=function(){this.dispatchEvent(new CustomEvent(BreaseEvent.TICK,{detail:{timestamp:Date.now()}}))},t.addEventListener=function(t,i,s){e.prototype.addEventListener.call(this,t,i,s),this.start()},t.removeEventListener=function(t,i){e.prototype.removeEventListener.call(this,t,i),!1===this.hasListenersOfType("tick")&&this.stop()},t.dispose=function(){window.clearInterval(this.ticker)},Timer}),define("brease/objects/Response",[],function(){"use strict";var e={fromXHR:function(e){return""!==e?t(e):{success:!1}}};function t(e){try{var t=JSON.parse(e);return t.Error||t.error?(t.success=!1,t.error&&(t.Error={Code:-1,Text:t.error},delete t.error),t):(void 0===t.success&&(t.success=!0),t)}catch(e){return console.iatWarn("malformed data in server response!"),{success:!1,Error:{Code:-1,Text:"malformed data in server response"}}}}return e}),define("brease/helper/XHR",["brease/objects/Response","brease/core/Utils"],function(e,Utils){"use strict";var XHR=function(){try{this.xhr=new XMLHttpRequest,this.ontimeout=i.bind(this),this.onreadystatechange=t.bind(this)}catch(e){return console.log("XMLHttpRequest not supported!"),null}};XHR.prototype.open=function e(t,i){"GET"===t&&(i=Utils.addTimestamp(i)),this.xhr.open(t,i,!0),this.xhr.setRequestHeader("Content-Type","application/json; charset=utf-8"),this.xhr.setRequestHeader("Cache-Control","no-cache"),this.xhr.setRequestHeader("Accept","*/*"),this.xhr.ontimeout=this.ontimeout,this.xhr.onreadystatechange=this.onreadystatechange},XHR.prototype.send=function e(t,i){this.callback=i,this.xhr.send(t)};function t(){this.xhr.readyState===XMLHttpRequest.DONE&&(0===this.xhr.status?(console.log("%chttp status 0 for server connection!","color:#fa00f1;"),window._connectionErrorHandler()):"function"==typeof this.callback&&this.callback(e.fromXHR(this.xhr.responseText),this.callbackInfo),s.call(this))}function i(){window._connectionErrorHandler(),s.call(this)}function s(){this.xhr.ontimeout=void 0,this.xhr.onreadystatechange=void 0,this.callback=void 0,this.callbackInfo=void 0,this.active=!1}return XHR}),define("brease/helper/XHRPool",["brease/helper/XHR"],function(XHR){"use strict";var XHRPool={getXHR:function(i){var s=t();return void 0===s&&(s=new XHR,e.push(s)),s.active=!0,s.callbackInfo=i,s}},e=[];function t(){for(var t,i=0;i<e.length;i+=1)if(!0!==e[i].active){t=e[i];break}return t}return XHRPool}),define("brease/services/Configuration",["brease/services/LoadedByBootstrapper","brease/events/BreaseEvent","brease/enum/Enum"],function(e,BreaseEvent,Enum){"use strict";var Configuration={init:function(e){return t=e,this},loadConfigurations:function(r){r&&n(r);var o=$.Deferred(),l=e.get("configuration");return l?(a(l),s(o)):t.loadConfiguration(i,{deferred:o}),o.promise()}},t;function i(e,t){!0===e.success?(e.configuration&&a(e.configuration),s(t.deferred)):t.deferred.reject()}function s(e){e.resolve(),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONFIG_LOADED))}function n(e){brease.config.visu.zoom=r(e.zoom),brease.config.visu.browserZoom=o(e.browserZoom),brease.config.visu.activityCount=l(e.activityCount),brease.config.visu.bootProgressBar=d(e.bootProgressBar),brease.config.watchdog=c(e.watchdog),brease.config.gestures=h(e.gestures),brease.config.virtualKeyboards=u(e.virtualKeyboards),brease.config.visu.moveThreshold=g(e.moveThreshold),brease.config.visu.keyboardOperation=m(e.keyboardOperation),brease.config.keyboardHandling=p(e.keyboardOperation,e.keyboardHandling)}function a(e){brease.config.ContentCaching={preserveOldValues:e.ContentCaching&&"TRUE"===e.ContentCaching.preserveOldValues,cachingSlots:e.ContentCaching&&void 0!==e.ContentCaching.cachingSlots?Math.min(parseInt(e.ContentCaching.cachingSlots,10),brease.settings.cachingSlotsMax):brease.settings.cachingSlotsDefault},brease.config.WidgetData={renderingPolicy:void 0!==e.Widget&&"2"===e.Widget.renderingPolicy?Enum.RenderingPolicy.PERFORMANCE:Enum.RenderingPolicy.DEFAULT,securityPolicy:void 0!==e.Widget&&"2"===e.Widget.securityPolicy?Enum.SecurityPolicy.OFF:Enum.SecurityPolicy.ON}}function r(e){return"true"===e||!0===e}function o(e){return"true"===e||!0===e}function l(e){return"true"===e||!0===e}function d(e){return!("true"!==e&&!0!==e)}function c(e){return void 0===brease.config.watchdog&&void 0!==e?parseInt(e,10):brease.config.watchdog}function h(e){return e||void 0}function u(e){return e||void 0}function g(e){return e||void 0}function m(e){return"true"===e||!0===e}function p(e,t){return!0===e?_.defaults(t,{onStart:{action:"any"},onEnd:{action:"focus"}}):{onStart:{action:void 0},onEnd:{action:void 0}}}return Configuration}),define("brease/services/Culture",["brease/events/BreaseEvent","globalize"],function(BreaseEvent){"use strict";var Culture={init:function(e){return this.runtimeService=e,document.body.addEventListener(BreaseEvent.LANGUAGE_CHANGED,s),this},isReady:function(){var e=$.Deferred();return i(brease.language.getCurrentLanguage(),!1,e),e.promise()},getCurrentCulture:function(){return e},switchCulture:function(e){i(e,!0)},findClosestCulture:function(e){e.length>2&&(e=e.substring(0,2));var t=$.Deferred(),i=Globalize.findClosestCulture(e);if(null!==i)t.resolve(i);else{var s="libs/cultures/globalize.culture."+e;this.runtimeService.checkFileExists(requirejs.toUrl(s+".js")).then(function(){require([s],function(){t.resolve(Globalize.findClosestCulture(e))})},function(){t.resolve(Globalize.cultures.default)})}return t.promise()},defaultCulture:{key:Globalize.cultures.default.name,culture:Globalize.cultures.default}},e={};function t(t){Globalize.culture(t.name),e={key:t.name,culture:t}}function i(i,s,n){$.when(Culture.findClosestCulture(i)).then(function(i){t(i),!0===s&&document.body.dispatchEvent(new CustomEvent(BreaseEvent.CULTURE_CHANGED,{detail:{currentCulture:e.key}})),n&&n.resolve()})}function s(){i(brease.language.getCurrentLanguage(),!0)}return Culture}),define("brease/services/Language",["brease/events/BreaseEvent","brease/events/SocketEvent","brease/core/Utils","brease/config"],function(BreaseEvent,SocketEvent,Utils,config){"use strict";var Language={init:function(e){return r=e,r.addEventListener(SocketEvent.LANGUAGE_CHANGED,f),this},isReady:function(){return a=$.Deferred(),c(),a.promise()},loadAllTexts:function(){return a=$.Deferred(),r.loadTexts(t.code,b,{def:a}),a.promise()},getLanguages:function(){return Utils.deepCopy(e)},isValidLanguage:function(t){return void 0!==e.languages[t]},getCurrentLanguage:function(){return t.code},getText:function(e,t){e.startsWith("IAT/")||e.startsWith("BR/IAT/")||(e="IAT/"+e);var s=i[e];return brease.config.editMode?(void 0===s&&(s=window.iatd&&window.iatd.model&&"function"==typeof window.iatd.model.getTextByKey?window.iatd.model.getTextByKey(e):e),s!==e?s:(console.iatDebug("undefined text ID:"+e),Language.TEXTKEYPREFIX+e)):void 0!==s?s:(!0!==t&&console.iatDebug("undefined text ID:"+e),config.undefinedTextReturnValue)},getTextByKey:function(e,t){return Language.getText(e,t)},getSystemText:function(e){var t=i[e];return void 0!==t?t:(console.iatDebug("undefined text ID:"+e),config.undefinedTextReturnValue)},getSystemTextByKey:function(e){return Language.getSystemText(e)},getFormattedTextByKey:function(e,t){var s=i[e];void 0!==s?w(s)?brease.textFormatter.format(s,[]).then(function e(i){t(i)},function i(){console.iatDebug('error in textFormatter for textID "'+e+'"'),t(void 0)}):t(s):(console.iatDebug("undefined textID:"+e),t(config.undefinedTextReturnValue))},switchLanguage:function(e){return a=$.Deferred(),Language.isValidLanguage(e)?t.code===e?a.resolve({success:!0}):(t.version=0,r.switchLanguage(e,u,{code:e})):(console.iatDebug("Language »"+e+"« is not defined!"),a.resolve({success:!1})),a.promise()},reloadTexts:function(){t.version+=1,r.loadTexts(t.code,v)},getCurrentVersion:function(){return t.version},setKeyText:function(e,t){i[e]=t},addTextKey:function(e,t,s){i[e]&&!0===s?i[e]=t:i[e]&&!0!==s?console.iatDebug("textID ["+e+"] already exists!"):i[e]=t},addTextKeys:function(e,t){for(var i in e)Language.addTextKey(i,e[i],t)},isKey:function(e){return Utils.isString(e)&&e.substring(0,1)===Language.TEXTKEYPREFIX},parseKey:function(e){try{return e.substring(1)}catch(e){return}},parseProperty:function(e){return Language.isKey(e)?Language.getText(Language.parseKey(e)):e},pipeAsyncUnitSymbol:function(e,t){void 0!==e?void 0!==s[e]?void 0!==t&&t(s[e]):void 0!==n[e]?o(e,t):l(e,t):void 0!==t&&t(void 0)},unescapeText:function(e){return Utils.isString(e)?e.replace(/\\n/g,"\n"):""}},e={},t={version:0},i={},s={GRM:"g",DJ:"dag",KGM:"kg",ONZ:"oz",LBR:"lb",MMT:"mm",DMT:"dm",CMT:"cm","4H":"µm",MTR:"m",INH:"in",M7:"µin",FOT:"ft",YRD:"yd",PAL:"Pa",KPA:"kPa",BAR:"bar",HBA:"hbar",MBR:"mbar",KBA:"kbar",CEL:"°C",FAH:"°F",KEL:"K",MMQ:"mm³",CMQ:"cm³",DMQ:"dm³",INQ:"in³",FTQ:"ft³",YDQ:"yd³",AMP:"A",B22:"kA",H38:"MA","4K":"mA",B84:"µA",C39:"nA",WTT:"W",KWT:"kW",MAW:"MW",JOU:"J",KJO:"kJ",WHR:"W·h",MWH:"MW·h",KWH:"kW·h"},n={},a,r;function o(e,t){$.when(n[e].promise()).then(function(e){void 0!==t&&t(e)})}function l(e,i){n[e]=$.Deferred(),r.getUnitSymbols(t.code,[e+""],function(t){void 0!==t.unitSymbols[e]&&(s[e]=t.unitSymbols[e]),n[e].resolve(s[e]),n[e]=void 0,i(s[e])})}function d(e,t){!0===e?a.resolve(t):a.reject(t)}function c(){r.loadLanguages(h)}function h(i){!0===i.success?(e={languages:i.languages,current_language:i.current_language},$.when(m("system",e.current_language),g(e.current_language)).then(function(){t.code=e.current_language,d(!0,"languages and texts loaded successfully"),document.body.dispatchEvent(new CustomEvent(BreaseEvent.LANGUAGE_LOADED,{detail:{currentLanguage:t.code}}))},function(){console.log("fail:",arguments)})):d(!1,"languages load error")}function u(i,s){if(!0===i.success){var n=s.code;$.when(m("all",n),g(n)).then(function(){t.code=n,e.current_language=n,document.body.dispatchEvent(new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:t.code}}))},function(){console.log("fail:",arguments)}),a.resolve({success:!0})}else console.iatWarn("service switchLanguage failed!"),document.body.dispatchEvent(new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:t.code}})),a.resolve({success:!1})}function g(e){var t=$.Deferred();return r.getUnitSymbols(e,Object.keys(s),y,{requestedLang:e,def:t}),t.promise()}function m(e,t){var i=$.Deferred();return"system"===e?r.loadSystemTexts(t,b,{def:i}):r.loadTexts(t,b,{def:i}),i.promise()}function p(e){return e&&e.detail&&void 0!==e.detail.currentLanguage}function f(e){p(e)&&(!0===brease.config.editMode?(t.code=e.detail.currentLanguage,document.body.dispatchEvent(new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:t.code}}))):u({success:!0},{code:e.detail.currentLanguage}))}function b(e,t){i=brease.config.mocked?Utils.deepCopy(e):e,t.def&&t.def.resolve()}function v(e){i=brease.config.mocked?Utils.deepCopy(e):e,document.body.dispatchEvent(new CustomEvent(BreaseEvent.LANGUAGE_CHANGED,{detail:{currentLanguage:t.code}}))}function y(e,t){e.unitSymbols?(s=e.unitSymbols,t.def.resolve()):(console.iatWarn("error on fetching unit symbols!"),t.def.reject())}function w(e){return void 0!==e&&-1!==e.indexOf("{")}return Object.defineProperty(Language,"TEXTKEYPREFIX",{enumerable:!0,configurable:!0,writable:!1,value:"$"}),Language}),define("brease/services/libs/User",[],function(){"use strict";var User=function(e,t,i){this.userID=e,this.displayName=t||e,this.isAuthenticated=!0===i};return User.fromServerData=function(e){return e?new User(e.userID,e.displayName,e.isAuthenticated):new User},User}),define("brease/services/libs/UserData",["brease/core/Types"],function(Types){"use strict";var UserData=function(e,t,i,s,n,a,r,o){this.userName=e,this.fullName=i,this.roles=s,this.isAdmin=!0===a,this.userLevel=Types.parseValue(n,"Integer",{default:0}),this.isLocked=!0===r,this.lastLogin=o,this.password=t};return UserData.fromServerData=function(e){return e?new UserData(e.userName,e.password,e.fullName,e.roles,e.userLevel,e.isAdmin,e.isLocked,e.lastLogin):new UserData},UserData}),define("brease/services/libs/Userdata",["brease/core/Types"],function(Types){"use strict";var UserData=function(e,t,i,s,n,a,r,o){this.userName=e,this.fullName=i,this.roles=s,this.isAdmin=!0===a,this.userLevel=Types.parseValue(n,"Integer",{default:0}),this.isLocked=!0===r,this.lastLogin=o,this.password=t};return UserData.fromServerData=function(e){return e?new UserData(e.userName,e.password,e.fullName,e.roles,e.userLevel,e.isAdmin,e.isLocked,e.lastLogin):new UserData},UserData}),define("brease/services/libs/UserDataList",["brease/services/libs/Userdata"],function(UserData){"use strict";var UserDataList=function(e){if(this.userData=[],void 0!==e&&Array.isArray(e))for(var t=0;t<e.length;t++)this.userData[t]=new UserData(e[t].userName,e[t].password,e[t].fullName,e[t].roles,e[t].userLevel,e[t].isAdmin,e[t].isLocked,e[t].lastLogin)};return UserDataList.fromServerData=function(e){return e&&Array.isArray(e)?new UserDataList(e):new UserDataList},UserDataList}),define("brease/services/libs/Watchdog",["brease/events/SocketEvent"],function(SocketEvent){"use strict";var Watchdog=function(e){this.eventDispatcher=e,this.timeout=1e4,void 0!==brease.config.watchdog&&(0===brease.config.watchdog||brease.config.watchdog>=1e4)&&(this.timeout=brease.config.watchdog)},e=Watchdog.prototype;e.start=function(e){if(!(this.timeout<1e4)){this.socket=e,n.call(this),n.call(this,!0),i.call(this);[SocketEvent.PONG,SocketEvent.PROPERTY_VALUE_CHANGED,SocketEvent.ACTION,SocketEvent.CONTENT_ACTIVATED,SocketEvent.CONTENT_DEACTIVATED].forEach(function(e){this.eventDispatcher.addEventListener(e,t.bind(this))},this)}},e.stop=function(){window.clearTimeout(this.heartbeat),window.clearTimeout(this.timer)},e.getTimeout=function(){return this.timeout};function t(e){e.type===SocketEvent.PONG&&n.call(this,!0),i.call(this)}function i(){window.clearTimeout(this.timer),this.timer=window.setTimeout(s.bind(this),this.timeout)}function s(){this.eventDispatcher.dispatchEvent({type:SocketEvent.WATCHDOG_TIMEOUT})}function n(e){window.clearTimeout(this.heartbeat),this.socket.readyState===WebSocket.OPEN&&(!0===e?this.heartbeat=window.setTimeout(n.bind(this),this.timeout/2):this.socket.send("ping"))}return Watchdog}),define("brease/services/Logger",["brease/events/BreaseEvent","brease/enum/Enum"],function(BreaseEvent,Enum){"use strict";var Logger={logMessage:function(i,s,a,r){(void 0===s||s<=t)&&e.logEvents(i,s,a,r,n)},log:function(e,t,i,s,n,r){if(void 0===i&&(i=Enum.EventLoggerVerboseLevel.OFF),void 0!==e){var o=a(e,Enum.EventLoggerFacility.IAT,t||Enum.EventLoggerCustomer.BUR,s);this.logMessage(o,i,r||"",n||[])}},getVerboseLevel:function(){return t}},e,t,i=!1;Object.defineProperty(Logger,"init",{enumerable:!1,configurable:!1,writable:!1,value:function(n,a){return e=n,t=void 0!==a?a:Enum.EventLoggerVerboseLevel.OFF,i||(document.addEventListener(BreaseEvent.LOG_MESSAGE,s),i=!0),this}});function s(e){var t=Enum.EventLoggerVerboseLevel.OFF;if(void 0!==e.detail.verbose&&(t=e.detail.verbose),e.detail&&e.detail.code){e.detail.args=e.detail.args||[];var i=a(e.detail.code,Enum.EventLoggerFacility.IAT,e.detail.customer||Enum.EventLoggerCustomer.BUR,e.detail.severity);Logger.logMessage(i,t,e.detail.text,e.detail.args)}}function n(e){void 0!==e.verboseLvl&&(t=e.verboseLvl)}function a(e,t,i,s){var n;return void 0===s&&(s=Enum.EventLoggerSeverity.INFORMATIONAL),n=e|t<<16|i<<29|s<<30,n}return Logger}),define("brease/services/MeasurementSystem",["brease/events/BreaseEvent","brease/events/SocketEvent","brease/core/Utils"],function(BreaseEvent,SocketEvent,Utils){"use strict";var MeasurementSystem={init:function(e){return i=e,i.addEventListener(SocketEvent.MEASUREMENT_SYSTEM_CHANGED,d),document.body.addEventListener(BreaseEvent.LANGUAGE_CHANGED,s),this},isReady:function(){var e=$.Deferred();return i.loadMeasurementSystemList(a,{deferred:e}),e.promise()},getMeasurementSystems:function(){return Utils.deepCopy(e)},getCurrentMeasurementSystem:function(){return t},switchMeasurementSystem:function(s){var n=$.Deferred();return void 0===e[s]?(console.iatWarn("Measurement-System »"+s+"« is not defined!"),n.resolve({success:!1})):t===s?n.resolve({success:!0}):i.switchMeasurementSystem(s,o,{newKey:s,deferred:n}),n.promise()}},e={},t="",i;function s(){i.loadMeasurementSystemList(r)}function n(e,t,i){!0===t?e&&e.deferred&&e.deferred.resolve(i):(console.iatDebug(i),e&&e.deferred&&e.deferred.reject(i))}function a(i,s){_.isObject(i)&&!0===i.success?(e=i.measurementSystemList,t=i.current_measurementSystem,document.body.dispatchEvent(new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_LOADED,{detail:{currentMeasurementSystem:t}})),n(s,!0)):n(s,!1,"MeasurementSystems load error")}function r(i,s){_.isObject(i)&&!0===i.success?(e=i.measurementSystemList,t=i.current_measurementSystem,document.body.dispatchEvent(new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_LOADED,{detail:{currentMeasurementSystem:t}})),n(s,!0)):n(s,!1,"MeasurementSystems load error")}function o(e,i){!0===e.success?(t=i.newKey,i.deferred.resolve({success:!0})):(console.iatWarn("service switchMeasurementSystem failed!"),i.deferred.resolve({success:!1})),document.body.dispatchEvent(new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,{detail:{currentMeasurementSystem:t}}))}function l(e){return e&&e.detail&&void 0!==e.detail.currentMeasurementSystem}function d(e){l(e)&&(t=e.detail.currentMeasurementSystem,document.body.dispatchEvent(new CustomEvent(BreaseEvent.MEASUREMENT_SYSTEM_CHANGED,{detail:{currentMeasurementSystem:t}})))}return MeasurementSystem}),define("brease/services/Opcua",["brease/services/RuntimeService"],function(e){"use strict";var Opcua={readNodeHistory:function(s,n,a){var r=$.Deferred(),o=i("serverAlias",a),l={nodesReadInfo:s};return n&&(l.timeSpan=n),e.opcuaReadNodeHistory(l,o,t,{deferred:r}),r.promise()},readHistoryCount:function(s,n,a){var r=$.Deferred(),o=i("serverAlias",a);return e.opcuaReadHistoryCount({nodeId:s,timeSpan:n},o,t,{deferred:r}),r.promise()},readHistoryStart:function(s,n){var a=$.Deferred(),r=i("serverAlias",n);return e.opcuaReadHistoryStart({nodeId:s},r,t,{deferred:a}),a.promise()},readHistoryEnd:function(s,n){var a=$.Deferred(),r=i("serverAlias",n);return e.opcuaReadHistoryEnd({nodeId:s},r,t,{deferred:a}),a.promise()},browse:function(s,n){var a=$.Deferred(),r=i("serverAlias",n);return e.opcuaBrowse({nodeId:s},r,t,{deferred:a}),a.promise()},read:function(s,n){var a=$.Deferred(),r=i("serverAlias",n);return e.opcuaRead({nodesToRead:s},r,t,{deferred:a}),a.promise()},callMethod:function(s,n,a,r){var o=$.Deferred(),l=i("serverAlias",r);return e.opcuaCallMethod({objectId:s,methodId:n,arguments:a},l,t,{deferred:o}),o.promise()}};function t(e,t){t.deferred.resolve(e)}function i(e,t){var i;return void 0!==t&&(i={},i[e]=t),i}return Opcua}),define("brease/services/ServiceBridge",["brease/helper/XHRPool"],function(XHRPool){"use strict";var e=window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/services/",t=e+"client/",i=e+"server/";function s(e,t){var i={Data:e};return t&&(i.Parameter=t),JSON.stringify(i)}return{checkFileExists:function(e){return new Promise(function(t,i){var s=XHRPool.getXHR({}),n=s.onreadystatechange;s.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(this.status>=200&&this.status<400?t():i(new Error(this.status)),s.onreadystatechange=n,s.onreadystatechange())},s.open("HEAD",e),s.send(null,function(){})})},activateVisu:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("POST",t+"activateVisu"),n.send(JSON.stringify({Parameter:{visuId:e}}),i)}else console.iatWarn("undefined visuId in method activateVisu")},deactivateVisu:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"deactivateVisu?visuId="+e),n.send(null,i)}else console.iatWarn("undefined visuId in method deactivateVisu")},getSubscription:function(e,i,s,n){if(void 0!==e){var a=XHRPool.getXHR(n);a.open("GET",t+"getSubscription?contentId="+e+"&visuId="+i),a.send(null,s)}else console.iatWarn("undefined contentId in method getSubscription")},loadConfiguration:function(e,t){var s=XHRPool.getXHR(t);s.open("GET",i+"getConfiguration"),s.send(null,e)},getAutoLogOut:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"autoLogOut"),s.send(null,e)},loadVisuData:function(e,t,i){$.getJSON("/"+e+".json",function(e){t({success:!0,visuData:e},i)}).fail(function(e,s,n){console.log("error:"+JSON.stringify({status:s,errorMessage:n.toString()})),t({success:!1,status:s},i)})},createBindings:function(e,i,s,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"createBindings"),r.send(JSON.stringify({Parameter:{visuId:i,contentId:e},Data:s}),n)},deleteBindings:function(e,i,s,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"deleteBindings"),r.send(JSON.stringify({Parameter:{visuId:i,contentId:e},Data:s}),n)},getBindingSourceProperties:function(e,i,s,n,a,r,o){var l=XHRPool.getXHR(o);l.open("POST",t+"getProperties"),l.send(JSON.stringify({Parameter:{visuId:i,contentId:e},Data:[{
type:"brease",refId:s,attribute:n,property:a}]}),r)},getEventSubscription:function(e,i,s,n){if(void 0!==e){var a=XHRPool.getXHR(n);a.open("GET",t+"getEventSubscription?contentId="+e+"&visuId="+i),a.send(null,s)}else console.iatWarn("undefined contentId in method getEventSubscription")},getSessionEventSubscription:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"getSessionEventSubscription"),s.send(null,e)},loadLanguages:function(e){var i=XHRPool.getXHR();i.open("GET",t+"getLanguages"),i.send(null,e)},switchLanguage:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"switchLanguage?language="+e),n.send(null,i)}else console.iatWarn("undefined language key in method switchLanguage")},loadTexts:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"getText?language="+e),n.send(null,i)}else console.iatWarn("undefined language key in method loadTexts")},loadSystemTexts:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"getSystemTexts?language="+e),n.send(null,i)}else console.iatWarn("undefined language key in method loadSystemTexts")},getAllUnitSymbols:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"getAllUnitSymbols?language="+e),n.send(null,i)}else console.iatWarn("undefined language key in method getAllUnitSymbols")},getUnitSymbols:function(e,i,s,n){if(void 0!==e){var a=XHRPool.getXHR(n);a.open("POST",t+"getUnitSymbols"),a.send(JSON.stringify({Data:{language:e,commonCodes:i}}),s)}else console.iatWarn("undefined language key in method getUnitSymbols")},loadCultures:function(e){var i=XHRPool.getXHR();i.open("GET",t+"loadCultures"),i.send(null,e)},switchCulture:function(e,i){if(void 0!==e){var s=XHRPool.getXHR();s.open("GET",t+"switchCulture?culture="+e),s.send(null,i)}else console.iatWarn("undefined culture key in method getUnitSymbols")},loadMeasurementSystemList:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"getMeasurementSystemList"),s.send(null,e)},switchMeasurementSystem:function(e,i,s){if(void 0!==e){var n=XHRPool.getXHR(s);n.open("GET",t+"setMeasurementSystem?measurementSystem="+e),n.send(null,i)}else console.iatWarn("undefined MeasurementSystem key in method switchMeasurementSystem")},logEvents:function(e,t){var s=XHRPool.getXHR();s.open("POST",i+"sendEventLog"),s.send(JSON.stringify({Data:e}),t)},loadCurrentUser:function(e){var i=XHRPool.getXHR();i.open("GET",t+"getCurrentUser"),i.send(null,e)},setDefaultUser:function(e){var i=XHRPool.getXHR();i.open("GET",t+"setDefaultUser"),i.send(null,e)},loadUserRoles:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"getUserRoles"),s.send(null,e)},authenticateUser:function(e,i,s){var n=XHRPool.getXHR();n.open("POST",t+"authenticate"),n.send(JSON.stringify({Data:{userID:e,password:i}}),s)},setCurrentUser:function(e,i){var s=XHRPool.getXHR();s.open("POST",t+"setCurrentUser"),s.send(JSON.stringify({Data:{user:e}}),i)},userHasRoles:function(e,i){var s=XHRPool.getXHR();s.open("POST",t+"userHasRoles"),s.send(JSON.stringify({Data:{roles:e}}),i)},changePassword:function(t,i,s,n,a){var r=XHRPool.getXHR(a);r.open("POST",e+"users/"+t+"/changePassword"),r.send(JSON.stringify({Data:{old:i,new:s}}),n)},loadPasswordPolicies:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"passwordPolicy"),s.send(null,e)},loadUserList:function(t,i,s){var n=XHRPool.getXHR(s);n.open("GET",e+"users?details="+t),n.send(null,i)},loadUserData:function(t,i,s){var n=XHRPool.getXHR(s);n.open("GET",e+"users/"+t),n.send(null,i)},loadAvailableRoles:function(t,i){var s=XHRPool.getXHR(i);s.open("GET",e+"roles"),s.send(null,t)},addUserToMpUserX:function(t,i,s,n,a,r){var o=XHRPool.getXHR(r);o.open("POST",e+"users"),o.send(JSON.stringify({Data:{userName:t,fullName:s,roles:n,password:i}}),a)},deleteUserFromMpUserX:function(t,i,s){var n=XHRPool.getXHR(s);n.open("DELETE",e+"users/"+t),n.send(null,i)},modifyUserFromMpUserX:function(t,i,s,n){var a=XHRPool.getXHR(n);a.open("PATCH",e+"users/"+t),a.send(JSON.stringify({Data:i}),s)},getUserSettingsFromMpUserX:function(e,i){var s=XHRPool.getXHR(i);s.open("GET",t+"userSettings"),s.send(null,e)},formatText:function(e,i,s){var n=XHRPool.getXHR(),a={formatstring:e,args:i};n.open("POST",t+"format"),n.send(JSON.stringify({Data:a}),s)},setClientInformation:function(e,i){var s=XHRPool.getXHR();s.open("POST",t+"setClientInformation"),s.send('{"Data":'+e+"}",i)},registerClient:function(e,i){var s=XHRPool.getXHR();s.open("GET",t+"registerclient"+(void 0!==e?"?visuId="+e:"")),s.send(null,i)},opcuaReadNodeHistory:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/readHistory"),r.send(s(e,i),n)},opcuaReadHistoryCount:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/readHistoryCount"),r.send(s(e,i),n)},opcuaReadHistoryStart:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/readHistoryStart"),r.send(s(e,i),n)},opcuaReadHistoryEnd:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/readHistoryEnd"),r.send(s(e,i),n)},opcuaBrowse:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/browse"),r.send(s(e,i),n)},opcuaCallMethod:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/callMethod"),r.send(s(e,i),n)},opcuaRead:function(e,i,n,a){var r=XHRPool.getXHR(a);r.open("POST",t+"opcua/read"),r.send(s(e,i),n)}}}),define("brease/services/TextFormatter",[],function(){"use strict";var TextFormatter={init:function(e){return t=e,this},isReady:function(){return e=$.Deferred(),e.resolve(),e.promise()},format:function(e,s){var n=$.Deferred();return t.formatText(e,s,function(e){i(e,n)}),n.promise()}},e,t;function i(e,t){!0===e.success?t.resolve(e.string):t.reject(e.string)}return TextFormatter}),define("brease/services/UserService",["brease/core/Utils","brease/events/BreaseEvent","brease/events/SocketEvent","brease/events/ClientSystemEvent","brease/enum/Enum","brease/services/libs/PasswordPolicies","brease/services/libs/User","brease/services/libs/UserData","brease/services/libs/UserDataList"],function(Utils,BreaseEvent,SocketEvent,ClientSystemEvent,Enum,PasswordPolicies,User,UserData,UserDataList){"use strict";var UserService={init:function(e){return c=e,l=null,this},isReady:function(){return s=$.Deferred(),E(),s.promise()},getSeparators:function(){return{dsp:".",gsp:","}},authenticateUser:function(e,t){return n=$.Deferred(),c.authenticateUser(e,t,C),n.promise()},setCurrentUser:function(e){return a=$.Deferred(),c.setCurrentUser(e,_),a.promise()},loadCurrentUser:function(){return a=$.Deferred(),void 0!==l&&null!==l?a.resolve(l):c.loadCurrentUser(S),a.promise()},getCurrentUser:function(){return l},setDefaultUser:function(){return a=$.Deferred(),c.setDefaultUser(_),a.promise()},hasOneOfRoles:function(e){return UserService.permission(e,UserService.getUserRoles())},permission:function(e,t){var i;if(!Array.isArray(e)||0===e.length)return!1;if(!Array.isArray(t)||0===t.length)return!1;if(e.length<t.length){for(i=0;i<e.length;i+=1)if(-1!==t.indexOf(e[i]))return!0}else for(i=0;i<t.length;i+=1)if(-1!==e.indexOf(t[i]))return!0;return!1},getUserRoles:function(){return d},loadUserRoles:function(e){var t=$.Deferred();return c.loadUserRoles(h,{deferred:t,callback:e}),t.promise()},loginAction:function(t,i){return r=$.Deferred(),c.authenticateUser(t,i,e),r.promise()},changePassword:function(e,t,i){return o=$.Deferred(),c.changePassword(e,t,i,w,{userName:e}),o.promise()},loadPasswordPolicies:function(){var e=$.Deferred();return c.loadPasswordPolicies(u,{deferred:e}),e.promise()},loadUserList:function(e){var t=$.Deferred();return c.loadUserList(e,g,{deferred:t}),t.promise()},loadUserData:function(e){var t=$.Deferred();return c.loadUserData(e,m,{deferred:t}),t.promise()},addUserToMpUserX:function(e,t,i,s){var n=$.Deferred();return c.addUserToMpUserX(e,t,i,s,p,{deferred:n}),n.promise()},deleteUserFromMpUserX:function(e){var t=$.Deferred();return c.deleteUserFromMpUserX(e,f,{deferred:t}),t.promise()},modifyUserFromMpUserX:function(e,t){var i=$.Deferred();return c.modifyUserFromMpUserX(e,t,b,{deferred:i}),i.promise()},loadAvailableRoles:function(){var e=$.Deferred();return c.loadAvailableRoles(v,{deferred:e}),e.promise()},getUserSettingsFromMpUserX:function(){var e=$.Deferred();return c.getUserSettingsFromMpUserX(y,{deferred:e}),e.promise()}};function e(e){!0===e.success&&void 0!==e.user&&!0===e.user.isAuthenticated?c.setCurrentUser(e.user,i.bind(null,e.user.userID)):t(!1,e.user.userID)}function t(e,t){r.resolve({success:e});var i={event:e?ClientSystemEvent.LOGIN_SUCCESS:ClientSystemEvent.LOGIN_FAILED,source:{type:"clientSystem.Event"},eventArgs:{userName:t}};c.sendEvent(i)}function i(e,i){t(i.success,e)}var s,n,a,r,o,l,d=[],c;function h(e,t){e.success&&e.roles&&(d=e.roles.sort()),x(t.deferred,t.callback,e.roles)}function u(e,t){var i=t.deferred;!0===e.success?i.resolve(PasswordPolicies.fromServerData(e.policy)):i.reject(e.status)}function g(e,t){var i=t.deferred;!0===e.success?i.resolve(e.status,UserDataList.fromServerData(e.users)):i.reject(e.status)}function m(e,t){var i=t.deferred;!0===e.success?i.resolve(UserData.fromServerData(e.userinfo)):i.reject(e.status)}function p(e,t){var i=t.deferred;!0===e.success?i.resolve(e.status):i.reject(e.status)}function f(e,t){var i=t.deferred;!0===e.success?i.resolve(e.status):i.reject(e.status)}function b(e,t){var i=t.deferred;!0===e.success?i.resolve(e.status):i.reject(e.status)}function v(e,t){var i=t.deferred;!0===e.success?i.resolve(e.roles):i.reject(e.status)}function y(e,t){var i=t.deferred;!0===e.success?i.resolve(e.settings):i.reject(e.status)}function w(e,t){!0===e.success?o.resolve(e.status,t.userName):o.reject(e.status,t.userName)}function x(e,t,i){Utils.isFunction(t)&&t(i),e.resolve(i)}function E(){c.addEventListener(SocketEvent.USER_CHANGED,T),c.loadCurrentUser(I)}function I(e){!0===e.success?(l=User.fromServerData(e.user),document.body.dispatchEvent(new CustomEvent(BreaseEvent.USER_LOADED,{detail:l})),UserService.loadUserRoles().then(function(){s.resolve()})):s.reject()}function C(e){!0===e.success&&void 0!==e.user&&!0===e.user.isAuthenticated?(n.resolve(e.user),brease.loggerService.log(Enum.EventLoggerId.CLIENT_USER_AUTHENTICATE_OK,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.SUCCESS,[e.user.userID])):(n.reject(e.user),brease.loggerService.log(Enum.EventLoggerId.CLIENT_USER_AUTHENTICATE_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[e.user.userID]))}function _(e){!0===e.success?(a.resolve(),brease.loggerService.log(Enum.EventLoggerId.CLIENT_USER_SETUSER_OK,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.SUCCESS)):(a.reject(),brease.loggerService.log(Enum.EventLoggerId.CLIENT_USER_SETUSER_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR))}function S(e){e.success?(l=User.fromServerData(e.user),a.resolve(l)):a.reject()}function T(e){l=User.fromServerData(e.detail.user),UserService.loadUserRoles().then(function(){document.body.dispatchEvent(new CustomEvent(BreaseEvent.ROLES_CHANGED))}),document.body.dispatchEvent(new CustomEvent(BreaseEvent.USER_CHANGED,{detail:l})),brease.loggerService.log(Enum.EventLoggerId.CLIENT_USER_USERCHANGE,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.INFORMATIONAL,[l.userID])}return UserService}),define("brease/services/WebSocket",["brease/events/EventDispatcher","brease/services/libs/ServerCommand","brease/services/libs/Watchdog","brease/events/SocketEvent"],function(EventDispatcher,ServerCommand,Watchdog,SocketEvent){"use strict";var e=!1,t,i,s,n;function a(e,a){if("WebSocket"in window){var l="ws://";0===window.location.protocol.indexOf("https")&&(l="wss://");try{var u=window.setTimeout(function(){c("timedOutInitially")},void 0!==a?a:15e3);e||(e=window.WebSocket),s=new e(l+t.host+":"+t.port+"?watchdog="+n.getTimeout()),s.onmessage=r,s.onopen=function(){console.log(h.MESSAGES.success),window.clearTimeout(u),t.sockets.available=!0,i(!0)},s.onclose=function(){console.log(h.MESSAGES.socketClosed),window.clearTimeout(o),!0!==t.sockets.available?(window.clearTimeout(u),c("socketClosedBeforeSuccess")):(n.stop(),d({type:SocketEvent.CONNECTION_STATE_CHANGED,detail:{state:!1}}))},s.onerror=function(e){c("SOCKET ERROR["+e.type+"]:"+e.message)}}catch(e){c("openSocketError","\n"+e.message)}}else c("noSockets")}function r(e){if("pong"===e.data)return d({type:SocketEvent.PONG}),void 0;var t;try{t=JSON.parse(e.data)}catch(e){console.warn(h.MESSAGES.parsererror+"\n"+e.message)}if(t)if(t.Command===h.COMMAND.GET_UPDATE||t.Command===h.COMMAND.SYSTEM)d({type:t.Data.event,detail:t.Data.eventArgs});else if(t.Command===h.COMMAND.EVENT)void 0!==t.Data&&d({type:t.Data.event,detail:t.Data.eventArgs});else if(t.Command===h.COMMAND.ACTION)d({type:t.Command,detail:t.Data});else if(t.Command===h.COMMAND.ACTIVATE_CONTENT||t.Command===h.COMMAND.DEACTIVATE_CONTENT){var i=t.Data;i.status=t.status,d({type:t.Command,detail:i})}else t.Command!==h.COMMAND.SUBSCRIBE&&t.Command!==h.COMMAND.UNSUBSCRIBE||d({type:t.Command,detail:t.Data})}var o;function l(){s.readyState===WebSocket.OPEN&&(s.close(),o=window.setTimeout(function e(){s.readyState===s.CLOSING&&(console.log(h.MESSAGES.socketNotClosing),s.onclose(),s.onclose=null)},1500))}function d(e){h.dispatchEvent(e)}function c(e,t){var s=h.MESSAGES[e]+(t||"");s&&console.log(s),i(!1),d({type:SocketEvent.CONNECTION_STATE_CHANGED,detail:{state:!1}})}var h=new EventDispatcher;return h.send=function(e){e.Resource=h.RESOURCE,s.send(JSON.stringify(e))},h.start=function(s,r,o){i=s,t={sockets:{},port:window.location.port,host:window.location.hostname},n=new Watchdog(this),!0!==e&&(e=!0,a(r,o))},h.startHeartbeat=function(){n.start(s),this.addEventListener(SocketEvent.WATCHDOG_TIMEOUT,l)},h.MESSAGES={timedOutInitially:"socket connection timed out!",success:"socket connection established!",parsererror:"could not parse server message",noSockets:"WebSockets not available",openSocketError:"could not open WebSocket",socketClosed:"socket connection closed!",socketClosedBeforeSuccess:"socket connection closed before opened --\x3e failure!",socketNotClosing:"socket not closing -> force close"},h.COMMAND=ServerCommand,h.RESOURCE="services/client",h}),define("text!system/widgets/ChangePasswordDialog/ChangePasswordDialog.html",[],function(){return'<div id="breaseChangePasswordDialog" data-brease-widget="system/widgets/ChangePasswordDialog">\r\n     <header class="breaseDialogWindowHeader">\r\n         <div class="innerHeader">\r\n             <div class="textDiv"></div>\r\n         </div>\r\n         <a class="breaseWindowClose"></a>\r\n     </header>\r\n     <div class="contentBox">\r\n         <div id="chpwd_GroupBox">\r\n             <label id="brease_chpwd_userName_label" data-brease-widget="widgets/brease/Label"\r\n                    class="breaseWidget breaseLabel chpwd_userName_label"\r\n                    data-brease-options="{\'text\':\'\',\'style\':\'default\',\'textAlign\': \'right\'}"></label>\r\n             <div id="brease_chpwd_userName" data-brease-widget="widgets/brease/TextInput"\r\n                  class="breaseWidget breaseTextInput"\r\n                  data-brease-options="{\'placeholder\':\'$IAT/System/Dialog/USERNAME\',\'tabIndex\':0}"></div>\r\n \r\n             <label id="brease_chpwd_oldPassword_label" data-brease-widget="widgets/brease/Label"\r\n                    class="breaseWidget breaseLabel chpwd_oldPassword_label"\r\n                    data-brease-options="{\'text\':\'\',\'style\':\'default\',\'textAlign\': \'right\'}"></label>\r\n             <div id="brease_chpwd_oldPassword" data-brease-widget="widgets/brease/Password"\r\n                  class="breaseWidget breasePassword"\r\n                  data-brease-options="{\'placeholder\':\'$IAT/System/Dialog/OLD_PASSWORD\',\'tabIndex\':0}"></div>\r\n \r\n             <label id="brease_chpwd_newPassword_label" data-brease-widget="widgets/brease/Label"\r\n                    class="breaseWidget breaseLabel chpwd_newPassword_label"\r\n                    data-brease-options="{\'text\':\'\',\'style\':\'default\',\'textAlign\': \'right\'}"></label>\r\n             <div id="brease_chpwd_newPassword" data-brease-widget="widgets/brease/Password"\r\n                  class="breaseWidget breasePassword"\r\n                  data-brease-options="{\'placeholder\':\'$IAT/System/Dialog/NEW_PASSWORD\',\'tabIndex\':0}"></div>\r\n \r\n             <label id="brease_chpwd_confirmPassword_label" data-brease-widget="widgets/brease/Label"\r\n                    class="breaseWidget breaseLabel chpwd_confirmPassword_label"\r\n                    data-brease-options="{\'text\':\'\',\'style\':\'default\',\'textAlign\': \'right\'}"></label>\r\n             <div id="brease_chpwd_confirmPassword" data-brease-widget="widgets/brease/Password"\r\n                  class="breaseWidget breasePassword"\r\n                  data-brease-options="{\'placeholder\':\'$IAT/System/Dialog/CONFIRM_PASSWORD\',\'tabIndex\':0}"></div>\r\n \r\n             <div class="outputArea"></div>\r\n \r\n             <div id="brease_chpwd_btn_change" data-brease-widget="widgets/brease/Button" data-multitouch="true"\r\n                  class="breaseWidget breaseButton"\r\n                  data-brease-options="{\'text\':\'$IAT/System/Dialog/BTN_CHANGE_PASSWORD\',\'style\':\'default\',\'tabIndex\':0}"></div>\r\n             <div id="brease_chpwd_btn_cancel" data-brease-widget="widgets/brease/Button" data-multitouch="true"\r\n                  class="breaseWidget breaseButton" data-brease-options="{\'text\':\'$IAT/System/Dialog/BTN_CANCEL\',\'tabIndex\':0}"></div>\r\n \r\n         </div>\r\n         <div id="brease_chpwd_btn_confirm" data-brease-widget="widgets/brease/Button" data-multitouch="true"\r\n              class="breaseWidget breaseButton"\r\n              data-brease-options="{\'visible\':false, \'text\':\'$IAT/System/Dialog/BTN_CONFIRM\',\'tabIndex\':0}"></div>\r\n         <template id="passwordPolicyTemplate">\r\n             <div class="policyBox">\r\n                 <div class="policyBoxHeader"></div>\r\n \r\n                 <div class="minLength policyLine">\r\n                     <svg class="iconSuccess policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M31.8,7.8l-4.5-4.4c-0.3-0.3-0.7-0.3-1,0L11.9,17.8c-0.3,0.3-0.7,0.3-1,0l-5.4-5.4   c-0.3-0.3-0.7-0.3-1,0l-4.5,4.5c-0.3,0.3-0.3,0.7,0,1l5.4,5.4c0.3,0.3,0.7,0.7,1,1l4.5,4.5c0.3,0.3,0.7,0.3,1,0L31.8,8.8   C32.1,8.5,32.1,8.1,31.8,7.8z"></path></g>\r\n                     </svg>\r\n                     <svg class="iconFail policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M21.669,16.001L31.706,5.965c0.392-0.394,0.392-1.039,0-1.432l-4.234-4.234c-0.392-0.392-1.036-0.392-1.43,0   L16.004,10.337L5.959,0.294c-0.394-0.392-1.038-0.392-1.43,0L0.295,4.53c-0.394,0.391-0.394,1.034,0,1.432l10.043,10.042   l-10.04,10.04c-0.391,0.39-0.391,1.036,0,1.43l4.234,4.234c0.394,0.39,1.041,0.39,1.431,0l10.038-10.038l10.033,10.033   c0.392,0.392,1.039,0.392,1.432,0l4.236-4.236c0.39-0.39,0.39-1.036,0-1.431L21.669,16.001z"></path></g>\r\n                     </svg>\r\n                     <p class="textOutput"></p>\r\n                 </div>\r\n \r\n                 <div class="mixedCase policyLine">\r\n                     <svg class="iconSuccess policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M31.8,7.8l-4.5-4.4c-0.3-0.3-0.7-0.3-1,0L11.9,17.8c-0.3,0.3-0.7,0.3-1,0l-5.4-5.4   c-0.3-0.3-0.7-0.3-1,0l-4.5,4.5c-0.3,0.3-0.3,0.7,0,1l5.4,5.4c0.3,0.3,0.7,0.7,1,1l4.5,4.5c0.3,0.3,0.7,0.3,1,0L31.8,8.8   C32.1,8.5,32.1,8.1,31.8,7.8z"></path></g>\r\n                     </svg>\r\n                     <svg class="iconFail policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M21.669,16.001L31.706,5.965c0.392-0.394,0.392-1.039,0-1.432l-4.234-4.234c-0.392-0.392-1.036-0.392-1.43,0   L16.004,10.337L5.959,0.294c-0.394-0.392-1.038-0.392-1.43,0L0.295,4.53c-0.394,0.391-0.394,1.034,0,1.432l10.043,10.042   l-10.04,10.04c-0.391,0.39-0.391,1.036,0,1.43l4.234,4.234c0.394,0.39,1.041,0.39,1.431,0l10.038-10.038l10.033,10.033   c0.392,0.392,1.039,0.392,1.432,0l4.236-4.236c0.39-0.39,0.39-1.036,0-1.431L21.669,16.001z"></path></g>\r\n                     </svg>\r\n                     <p class="textOutput"></p>\r\n                 </div>\r\n                 <div class="specialChar policyLine">\r\n                     <svg class="iconSuccess policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M31.8,7.8l-4.5-4.4c-0.3-0.3-0.7-0.3-1,0L11.9,17.8c-0.3,0.3-0.7,0.3-1,0l-5.4-5.4   c-0.3-0.3-0.7-0.3-1,0l-4.5,4.5c-0.3,0.3-0.3,0.7,0,1l5.4,5.4c0.3,0.3,0.7,0.7,1,1l4.5,4.5c0.3,0.3,0.7,0.3,1,0L31.8,8.8   C32.1,8.5,32.1,8.1,31.8,7.8z"></path></g>\r\n                     </svg>\r\n                     <svg class="iconFail policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M21.669,16.001L31.706,5.965c0.392-0.394,0.392-1.039,0-1.432l-4.234-4.234c-0.392-0.392-1.036-0.392-1.43,0   L16.004,10.337L5.959,0.294c-0.394-0.392-1.038-0.392-1.43,0L0.295,4.53c-0.394,0.391-0.394,1.034,0,1.432l10.043,10.042   l-10.04,10.04c-0.391,0.39-0.391,1.036,0,1.43l4.234,4.234c0.394,0.39,1.041,0.39,1.431,0l10.038-10.038l10.033,10.033   c0.392,0.392,1.039,0.392,1.432,0l4.236-4.236c0.39-0.39,0.39-1.036,0-1.431L21.669,16.001z"></path></g>\r\n                     </svg>\r\n                     <p class="textOutput"></p>\r\n                 </div>\r\n                 <div class="alphanumeric policyLine">\r\n                     <svg class="iconSuccess policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M31.8,7.8l-4.5-4.4c-0.3-0.3-0.7-0.3-1,0L11.9,17.8c-0.3,0.3-0.7,0.3-1,0l-5.4-5.4   c-0.3-0.3-0.7-0.3-1,0l-4.5,4.5c-0.3,0.3-0.3,0.7,0,1l5.4,5.4c0.3,0.3,0.7,0.7,1,1l4.5,4.5c0.3,0.3,0.7,0.3,1,0L31.8,8.8   C32.1,8.5,32.1,8.1,31.8,7.8z"></path></g>\r\n                     </svg>\r\n                     <svg class="iconFail policyIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\r\n                          x="0px" y="0px" viewBox="0 0 32 32" width="32px" height="32px" xml:space="preserve">\r\n                     <g><path d="M21.669,16.001L31.706,5.965c0.392-0.394,0.392-1.039,0-1.432l-4.234-4.234c-0.392-0.392-1.036-0.392-1.43,0   L16.004,10.337L5.959,0.294c-0.394-0.392-1.038-0.392-1.43,0L0.295,4.53c-0.394,0.391-0.394,1.034,0,1.432l10.043,10.042   l-10.04,10.04c-0.391,0.39-0.391,1.036,0,1.43l4.234,4.234c0.394,0.39,1.041,0.39,1.431,0l10.038-10.038l10.033,10.033   c0.392,0.392,1.039,0.392,1.432,0l4.236-4.236c0.39-0.39,0.39-1.036,0-1.431L21.669,16.001z"></path></g>\r\n                     </svg>\r\n                     <p class="textOutput"></p>\r\n                 </div>\r\n             </div>\r\n         </template>\r\n     </div>\r\n </div>\r\n '}),define("widgets/brease/Window/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Window",parents:["*"],children:[],inheritance:["widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("system/widgets/ChangePasswordDialog/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"system.widgets.ChangePasswordDialog",parents:["*"],children:[],inheritance:["system.widgets.ChangePasswordDialog","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("system/widgets/ChangePasswordDialog/libs/PoliciesResult",[],function(){"use strict";return function(e,t,i,s){this.alphanumeric=e,this.mixedCase=t,this.minLength=i,this.specialChar=s}}),define("system/widgets/common/keyboards/AutoSize",["system/widgets/common/keyboards/KeyboardOptions"],function(KeyboardOptions){"use strict";var AutoSize={getOptions:function(i){if(!e[i]){var s=new KeyboardOptions,config;brease.config&&brease.config.virtualKeyboards&&(config=brease.config.virtualKeyboards[i]);for(var n in AutoSize.defaults)s[n]=t(n,config,AutoSize.defaults);s.minWidth=Math.max(0,s.minWidth),s.minHeight=Math.max(0,s.minHeight),s.minWidth>s.maxWidth&&(s.minWidth=s.maxWidth),s.minHeight>s.maxHeight&&(s.minHeight=s.maxHeight),e[i]=s}return e[i]},getLimits:function(e,t){if(!KeyboardOptions.isValid(t))return console.warn('argument "options" ('+JSON.stringify(t)+") of getLimits is not a valid KeyboardOption"),{min:1,max:1};if(!e||!e.width||e.width<=0||!e.height||e.height<=0)return console.warn('argument "dimensions" ('+JSON.stringify(e)+") of getLimits is not a valid Dimension"),{min:1,max:1};var i={min:t.minWidth>0?t.minWidth/e.width:0,max:t.maxWidth>0?t.maxWidth/e.width:Number.MAX_SAFE_INTEGER},s={min:t.minHeight>0?t.minHeight/e.height:0,max:t.maxHeight>0?t.maxHeight/e.height:Number.MAX_SAFE_INTEGER},n=Math.min(i.max,s.max),a=Math.max(i.min,s.min);return n<a&&(n=a),{min:a,max:n}},reset:function(){e={}},range:function(e,t,i){return e<t&&(e=t),e>i&&(e=i),e},defaults:new KeyboardOptions},e={};AutoSize.defaults.autoSize=!1,AutoSize.defaults.minWidth=0,AutoSize.defaults.maxWidth=Number.MAX_SAFE_INTEGER,AutoSize.defaults.minHeight=0,AutoSize.defaults.maxHeight=Number.MAX_SAFE_INTEGER;function t(e,config,t){var i=t[e];if(config){var s=config[e];if(void 0!==s)return s}return i}return AutoSize}),define("text!system/widgets/CompoundWidget/CompoundWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="system/widgets/CompoundWidget" data-instruction-loadContent="true"></div>'}),define("system/widgets/CompoundWidget/CompoundWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/controller/libs/Utils"],function(e,BreaseEvent,Enum,Utils,t){"use strict";var i={tabIndex:0,focusable:!1,addContent:brease.config.editMode},s=e.extend(function CompoundWidget(){e.apply(this,arguments)},i),n=s.prototype;s.static.delimiter="Θ",n.init=function(){this.data={},this.addInitialClass("classCompoundWidget"),!0===this.settings.addContent?(h.call(this),c.call(this)):this.contentAdded(!1),this._onWidgetsReadyHandler()},n._onWidgetsReadyHandler=function(){if(!brease.config.editMode){var e=this.selectChildren();this.childrenWidgetIds=[];for(var t=0;t<e.length;t++)2!==brease.uiController.getWidgetState(e[t].id)&&this.childrenWidgetIds.push(e[t].id);this.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind("_childWidgetReadyHandler"))}},n._childWidgetReadyHandler=function(e){if(this.childrenWidgetIds.includes(e.target.id)){var t=e.target.id,i=this.childrenWidgetIds.indexOf(t);this.childrenWidgetIds.splice(i,1)}0===this.childrenWidgetIds.length&&this._dispatchOnWidgetsReady()},n._dispatchOnWidgetsReady=function(){this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_childWidgetReadyHandler")),this.createEvent("OnWidgetsReady").dispatch()},n.contentAdded=function(t){e.prototype.init.call(this),!0===t&&this._dispatchReady(),this.setInitialValues()},n.setInitialValues=function(){},n.initMapping=function(e){this.settings.idPrefix=this.elem.id+s.static.delimiter;var t=this,i={};for(var n in e)if("all"===e[n])i[n]="all";else{var a={};for(var r in e[n])a[t.settings.idPrefix+r]=e[n][r];i[n]=a}this.propertyMapping=i},n.selectChildren=function(e){return void 0!==this.children&&0!==this.children.length||(this.directChildren=this.el.find(">[data-brease-widget]"),this.children=this.el.find("[data-brease-widget]")),"direct"===e?this.directChildren:this.children},n.disable=function(){if(e.prototype.disable.apply(this,arguments),!0!==this.initialized){var t=!this.isDisabled;!1===brease.config.editMode&&this.selectChildren("direct").each(function(){var e=this.id;brease.uiController.setWidgetPropertyIndependentOfState(e,"parentEnableState",t)})}},n._enableHandler=function(){e.prototype._enableHandler.apply(this,arguments);var t=!this.isDisabled;!1===brease.config.editMode&&this.selectChildren("direct").each(function(){var e=this.id;brease.uiController.setWidgetPropertyIndependentOfState(e,"parentEnableState",t)})},n.setChildProps=function(e,t){if(void 0!==t&&null!==t){var i=this.propertyMapping[e];i&&this.selectChildren().each(function(){var s="all"===i?e:i[this.id];if(void 0!==s)if(-1!==s.indexOf(","))for(var n=s.split(","),r=0;r<n.length;r+=1)a(this.id,n[r],t);else a(this.id,s,t)})}};function a(e,t,i){(brease.uiController.getWidgetState(e)<Enum.WidgetState.INITIALIZED||null===r(e,t,i))&&brease.uiController.addWidgetOption(e,t,i)}function r(e,t,i){var s=[e,o(t),i],n=l(t);return void 0!==n&&s.push(n),s.push({origin:"cowi",attribute:t,value:i}),brease.uiController.callWidget.apply(brease.uiController,s)}function o(e){return"permissionOperate"===e||"permissionView"===e?"_setPermission":Utils.setter(e)}function l(e){return"permissionOperate"===e?"operate":"permissionView"===e?"view":void 0}n.updateVisibility=function(){var t=this.isVisible();e.prototype.updateVisibility.apply(this,arguments),(t!==this.isVisible()||brease.config.editMode)&&(t=this.isVisible(),this.selectChildren("direct").each(function(){var e=this.id;brease.uiController.setWidgetPropertyIndependentOfState(e,"parentVisibleState",t)}))};function d(){
var e=Utils.getHighestZindex(this.selectChildren("direct"));$('<div style="position:absolute;width:100%;height:100%; background-color:rgba(255,0,0,0); z-index:'+(e+1)+';"></div>').appendTo(this.elem),this.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,this._bind(d))}function c(){var e=this;require(["text!"+e.settings.className+"/content/widgets.html"],function(i){i=i.replace(/\{COWI_ID\}/g,e.elem.id),i=i.substring(5,i.length-6),t.appendHTML(e.elem,i),e.elem.addEventListener(BreaseEvent.CONTENT_PARSED,e._bind(d)),brease.uiController.parse(e.elem,!1,e.settings.parentContentId),e.contentAdded(!0)})}function h(){this.constructor.static.contentCSS&&t.injectCSS(this.constructor.static.contentCSS.replace(/\{ID_PREFIX\}/g,this.settings.idPrefix))}return s}),define("system/widgets/CompoundWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"system.widgets.CompoundWidget",parents:["*"],children:[],inheritance:["system.widgets.CompoundWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!system/widgets/ContentLoader/ContentLoader.html",[],function(){return'<div id="WIDGETID" data-brease-widget="system/widgets/ContentLoader"></div>\r\n'}),define("system/widgets/ContentLoader/ContentLoader",["brease/core/BaseWidget","brease/enum/Enum","brease/events/BreaseEvent","brease/controller/WidgetController","brease/controller/WidgetParser","brease/controller/libs/Utils","brease/controller/objects/ContentStatus"],function(e,Enum,BreaseEvent,t,i,s,ContentStatus){"use strict";var n={loadPolicy:Enum.LoadPolicy.IMMEDIATE,cachePolicy:Enum.CachePolicy.CACHE,busyTimeout:1e3},a=e.extend(function ContentLoader(){e.apply(this,arguments)},n,!0),r=a.prototype;r.init=function e(){this.step=0,this.isLoaded=!1,this.loadQueue=[],this.settings.url&&this.settings.loadPolicy===Enum.LoadPolicy.IMMEDIATE&&this.load(this.settings.url,this.settings.contentId),this._defer("_dispatchReady")},r.load=function e(t,i,s){if(0===this.loadQueue.length||t!==this.loadQueue[0]||!0===s){o.call(this),this.contentComplete=!1,this.loadQueue.unshift(t);var n=this.settings.contentId,a=this.settings.url;this.settings.url=t,this.settings.contentId=i,this.loadFlag=!0,!0===this.isLoaded?f.call(this,n,a).then(function e(t){v.call(t)}):v.call(this),this.el.attr("data-brease-contentid",i)}};function o(){document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("suspendedListener")),document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("disposedListener")),document.body.removeEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("unloadListener"))}r.onBeforeSuspend=function(){o.call(this),t.walkWidgetsInContent(this.settings.contentId,"onBeforeSuspend")},r.suspend=function e(){this.isLoaded&&document.body.addEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("suspendedListener")),u.call(this),this.loadQueue.length=0,h.call(this),this.suspended=!0},r.suspendedListener=function e(i){i.detail.contentId===this.settings.contentId&&(o.call(this),t.suspendInContent(this.elem,this.settings.contentId),g.call(this),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_SUSPENDED,{detail:{contentId:this.settings.contentId}})))},r.disposedListener=function e(i){i.detail.contentId===this.settings.contentId&&(o.call(this),t.disposeInContent(this.elem,this.settings.contentId),g.call(this),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_DISPOSED,{detail:{contentId:this.settings.contentId}})))},r.unloadListener=function(e){e.detail.contentId===this.settings.unloadContentId&&(o.call(this),this.isLoaded=!1,t.disposeInContent(this.elem,e.detail.contentId),this.el.empty(),document.body.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_DISPOSED,{detail:{contentId:e.detail.contentId}})),this.unloadDeferred&&this.unloadDeferred.resolve(this))},r.onBeforeDispose=function(){o.call(this),t.walkWidgetsInContent(this.settings.contentId,"onBeforeDispose")},r.flush=function e(){if(this.isLoaded){var t=brease.uiController.bindingController.getContentState(this.settings.contentId);t===ContentStatus.active||t===ContentStatus.deactivatePending?(document.body.addEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("disposedListener")),t===ContentStatus.active&&u.call(this)):this.disposedListener({detail:{contentId:this.settings.contentId}})}this.isLoaded=!1,this.suspended=!1,this.loadQueue.length=0,g.call(this),m.call(this)},r.wake=function e(){var i=this;!0===this.contentComplete?(o.call(this),t.wakeInContent(this.settings.contentId),this.suspended=!1,this.step=0,$.when(brease.uiController.bindingController.activateContent(this.settings.contentId)).then(function e(t){0===i.step&&(i.step=1,l.call(i,!0),t===i.settings.contentId&&(brease.uiController.bindingController.sendInitialValues(i.settings.contentId),i.dispatchEvent(new CustomEvent(BreaseEvent.FRAGMENT_SHOW,{detail:{url:i.settings.url,contentId:i.settings.contentId},bubbles:!0}))))},function(){console.log("activateContent.fail")}),i.active=!0):this.load(this.settings.url,this.settings.contentId)},r.dispose=function i(){this.loadFlag=!1,o.call(this),!0===this.isLoaded&&(t.disposeInContent(this.elem,this.settings.contentId),u.call(this)),this.loadQueue.length=0,h.call(this),e.prototype.dispose.apply(this,arguments)},r.getContentId=function e(){return this.settings.contentId},r.getUrl=function e(){return this.settings.url};function l(e){this.el&&(this.el.css("visibility",e?"visible":"hidden"),this.elem.dispatchEvent(new CustomEvent(BreaseEvent.VISIBILITY_CHANGED,{bubbles:!1,detail:{visible:e}})))}function d(){var e=this;0===this.step&&(this.step=1,this.contentComplete=!0,l.call(this,!0),brease.uiController.bindingController.sendInitialValues(e.settings.contentId,function t(i){e.settings.contentId===i&&e.elem&&e.dispatchEvent(new CustomEvent(BreaseEvent.FRAGMENT_SHOW,{detail:{url:e.settings.url,contentId:e.settings.contentId},bubbles:!0}))}))}function c(){this.el.html(brease.language.getSystemTextByKey("BR/IAT/brease.common.pageloading"))}function h(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0)}function u(){this.active&&(this.active=!1,this.step=-1,brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_HIDE,{detail:{id:this.elem.id,contentId:this.settings.contentId}})),brease.uiController.bindingController.deactivateContent(this.settings.contentId))}function g(){this.loadFlag=!1,l.call(this,!1),b.call(this,this.settings.contentId,this.settings.url)}function m(){this.isLoaded=!1,this.settings.url=void 0}function p(e){var t=$.Deferred(),s=this,n=function i(){e.removeEventListener(BreaseEvent.CONTENT_PARSED,n),t.resolve(null)};return e.addEventListener(BreaseEvent.CONTENT_PARSED,n),i.parse(e,!1,s.settings.contentId),t.promise()}function f(e,t){return this.unloadDeferred=$.Deferred(),brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_UNLOAD,{detail:{id:this.elem.id,contentId:e}})),brease.appElem.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_HIDE,{detail:{id:this.elem.id,contentId:e}})),l.call(this,!1),b.call(this,e,t),this.settings.unloadContentId=e,o.call(this),this.isLoaded&&(brease.uiController.isContentActive(e)?(document.body.addEventListener(BreaseEvent.CONTENT_DEACTIVATED,this._bind("unloadListener")),brease.uiController.bindingController.deactivateContent(e)):this.unloadListener({detail:{contentId:e}})),this.unloadDeferred.promise()}function b(e,t){this.dispatchEvent(new CustomEvent(BreaseEvent.FRAGMENT_HIDE,{detail:{contentId:e,url:t}}))}function v(){var e=this;h.call(this),e.timer=window.setTimeout(e._bind(c),e.settings.busyTimeout),brease.uiController.bindingController.isContentActive(e.settings.contentId)?E.call(this,{message:"ContentActive"}):brease.pageController.loadHTML(e.settings.url,[e.settings.url]).done(e._bind(y)).fail(e._bind(E))}function y(e,t){var i=this;if(this.elem&&t===i.loadQueue[0]&&!0===this.loadFlag){h.call(this),i.loadQueue.length=0;try{s.appendHTML(i.elem,e)}catch(e){console.error(e),console.log('Content "'+i.settings.contentId+'": error in brease.setOptions')}i.dispatchEvent(new CustomEvent(BreaseEvent.FRAGMENT_LOADED,{detail:{url:i.settings.url,contentId:i.settings.contentId},bubbles:!0})),i.isLoaded=!0,i.step=0,$.when(brease.uiController.bindingController.activateContent(i.settings.contentId)).then(i._bind(w),i._bind(x)),this.active=!0}}function w(){var e=this;$.when(p.call(e,e.elem)).then(e._bind(d))}function x(){this.dispatchEvent(new CustomEvent(BreaseEvent.CONTENT_ACTIVATE_ERROR,{detail:{contentId:this.settings.contentId},bubbles:!0})),this.el.html('ERROR: could not activate content "'+this.settings.contentId+'", check logger').css("visibility","visible")}function E(e){var t=this;h.call(this),t.isLoaded=!1,t.elem&&!0===this.loadFlag&&(t.dispatchEvent(new CustomEvent(BreaseEvent.LOAD_ERROR,{detail:{url:t.settings.url,contentId:t.settings.contentId}})),t.el.html("ERROR: could not load content with url="+t.settings.url).css("visibility","visible")),console.iatWarn("WARNING: could not load content in ContentLoader["+(t.elem?t.elem.id:"")+"]:"+e.message)}return r.dispatchEvent=function e(t){this.elem.dispatchEvent(t)},a}),define("system/widgets/ContentLoader/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"system.widgets.ContentLoader",parents:["*"],children:[],inheritance:["system.widgets.ContentLoader","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("system/widgets/KeyBoard/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"system.widgets.KeyBoard",parents:["*"],children:[],inheritance:["system.widgets.KeyBoard","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!system/widgets/KeyBoard/KeyBoard.html",[],function(){return'<div id="WIDGETID" data-brease-widget="system/widgets/KeyBoard">\r\n    <header class="keyBoardHeader">\r\n        <div></div>\r\n    </header>\r\n</div>'}),define("system/widgets/KeyBoard/libs/Composer",["brease/enum/Enum","brease/core/Types","brease/core/Utils"],function(Enum,Types,Utils){"use strict";var e=[37,39,32,8],t=document.createElement("input");t.setAttribute("type","text");function Composer(){var e=this;this.mode=Enum.IMEMode.DISABLED,t.value="",e.onChange=function(t){if(e.isActive())if(a(t))e.onDelete(t);else if(!r(t)||e.isComposing()&&r(t)){var i=s(t.key)?t.key:"";o(i),e.eventDispatcher.dispatchEvent({type:"Composer.Change",detail:{value:e.getValue()}}),t.isComposing=e.isComposing()}},e.onInput=function(i){if(e.isActive()){var s=Utils.isString(i.detail.value)?i.detail.value:"",n=String.fromCharCode(160);(s!==n||e.isComposing()&&s===n)&&(t.setRangeText(s,t.selectionStart,t.selectionEnd,"end"),e.eventDispatcher.dispatchEvent({type:"Composer.Change",detail:{value:e.getValue()}}),i.isComposing=e.isComposing())}},e.onDelete=function(i){e.isActive()&&(i.isComposing=e.isComposing(),t.selectionEnd>0&&(t.selectionStart!==t.selectionEnd?t.setRangeText("",t.selectionStart,t.selectionEnd,"start"):t.setRangeText("",t.selectionEnd-1,t.selectionEnd,"start")),e.eventDispatcher.dispatchEvent({type:"Composer.Change",detail:{value:e.getValue()}}))},e.onCursorLeft=function(t){e.isActive()&&(t.isComposing=e.isComposing())},e.onCursorRight=function(t){e.isActive()&&(t.isComposing=e.isComposing())},e.onClear=function(t){e.isActive()&&(t.isComposing=e.isComposing(),e.setValue(""))},e.onSubmit=function(t){e.setValue("")},e.onKeyDown=function(t){var i=n(t.originalEvent);(e.isActive()&&!i||e.isComposing()&&i)&&(t.isComposing=e.isComposing(),t.originalEvent.preventDefault())},e.compose=function(t){e.isActive()&&e.eventDispatcher.dispatchEvent({type:"Composer.CompositionUpdate",detail:{values:l(e.getValue())}})},e.onCandidateInput=function(){e.setValue("")},e.onHide=function(){e.setValue("")}}var i=Composer.prototype;i.init=function(e){this.eventDispatcher=e,this.eventDispatcher.addEventListener("Validator.Change",this.onChange),this.eventDispatcher.addEventListener("Validator.Input",this.onInput),this.eventDispatcher.addEventListener("Collector.Delete",this.onDelete),this.eventDispatcher.addEventListener("Collector.CursorLeft",this.onCursorLeft),this.eventDispatcher.addEventListener("Collector.CursorRight",this.onCursorRight),this.eventDispatcher.addEventListener("Collector.Clear",this.onClear),this.eventDispatcher.addEventListener("Validator.Submit",this.onSubmit),this.eventDispatcher.addEventListener("Collector.KeyDown",this.onKeyDown),this.eventDispatcher.addEventListener("Composer.Change",this.compose),this.eventDispatcher.addEventListener("Validator.CandidateInput",this.onCandidateInput),this.eventDispatcher.addEventListener("Keyboard.Hide",this.onHide)},i.setMode=function(e){this.mode=Types.parseValue(e,"Enum",{Enum:Enum.IMEMode,default:"disabled"}),this.setValue("")},i.getMode=function(){return this.mode},i.isActive=function(){return this.getMode()!==Enum.IMEMode.DISABLED},i.isComposing=function(){return this.isActive()&&this.getValue().length>0},i.setValue=function(e){e!==this.getValue()&&(t.value=Types.parseValue(e,"String"),this.eventDispatcher.dispatchEvent({type:"Composer.Change",detail:{value:this.getValue()}}))},i.getValue=function(){return t.value},i.dispose=function(){t.value="",this.mode=Enum.IMEMode.DISABLED,this.eventDispatcher.removeEventListener("Validator.Change",this.onChange),this.eventDispatcher.removeEventListener("Validator.Input",this.onInput),this.eventDispatcher.removeEventListener("Collector.Delete",this.onDelete),this.eventDispatcher.removeEventListener("Collector.CursorLeft",this.onCursorLeft),this.eventDispatcher.removeEventListener("Collector.CursorRight",this.onCursorRight),this.eventDispatcher.removeEventListener("Collector.Clear",this.onClear),this.eventDispatcher.removeEventListener("Validator.Submit",this.onSubmit),this.eventDispatcher.removeEventListener("Collector.KeyDown",this.onKeyDown),this.eventDispatcher.removeEventListener("Composer.Change",this.compose),this.eventDispatcher.removeEventListener("Validator.CandidateInput",this.onCandidateInput),this.eventDispatcher.removeEventListener("Keyboard.Hide",this.onHide)};function s(e){return"string"==typeof e&&e.length<2}function n(t){return-1!==e.indexOf(t.which)}function a(e){return 8===e.which}function r(e){return 32===e.which}function o(e){t.setRangeText(e,t.selectionStart,t.selectionEnd,"end")}function l(e){return[e]}return Composer}),define("system/widgets/KeyBoard/libs/Converter",["brease/enum/Enum","brease/core/Types","system/widgets/KeyBoard/libs/external/dictionaries"],function(Enum,Types,e){"use strict";function Converter(){var t=this;this.mode=Enum.IMEMode.DISABLED,this.index=0,this.count=8,this.timeout=0,t.getSuggests=function(i){var s=[],n=Array.isArray(i)?i:[];if(e.has(t.getMode())){var a=n.map(function(e){return new RegExp("^"+e+"$","i")}),r=a.length,o;r>0&&(e.get(t.getMode()).filter(function(e){for(o=0;o<r;o+=1)if(!0===a[o].test(e.com))return!0;return!1}).sort(function(t,i){return Types.parseValue(t.freq,"Integer",{default:e.MAX_FREQUENCY,min:e.MIN_FREQUENCY,max:e.MAX_FREQUENCY})-Types.parseValue(i.freq,"Integer",{default:e.MAX_FREQUENCY,min:e.MIN_FREQUENCY,max:e.MAX_FREQUENCY})}).forEach(function(e){s.includes(e.can)||s.push(e.can)}),0===s.length&&(s=t.getCandidates()))}t.eventDispatcher.dispatchEvent({type:"Converter.CandidatesChange",detail:{candidates:s,query:i}})},t.updateCandidates=function(){t.eventDispatcher.dispatchEvent({type:"Converter.UpdateCandidates",detail:{candidates:t.candidates.slice(t.index,t.index+t.count),query:t.getQuery(),first:0===t.index,last:t.index+t.count>=t.candidates.length}})},t.onCompositionUpdate=function(e){var i=e.detail.values;window.clearTimeout(t.timeout),t.timeout=window.setTimeout(t.getSuggests,300,i),t.index=0},t.onCandidatesChange=function(e){var i=Array.isArray(e.detail.candidates)?e.detail.candidates:[],s=Array.isArray(e.detail.query)?e.detail.query:[];t.setQuery(s),t.setCandidates(i)},t.onPrevCandidates=function(){t.index>0&&(t.index=t.index-t.count>0?t.index-t.count:0,t.updateCandidates())},t.onNextCandidates=function(){t.index+t.count<t.candidates.length&&(t.index+=t.count,t.updateCandidates())},t.onCandidateInput=function(){t.index=0,t.setQuery([]),t.setCandidates([])}}var t=Converter.prototype;return t.init=function(e){this.eventDispatcher=e,this.eventDispatcher.addEventListener("Validator.CompositionUpdate",this.onCompositionUpdate),this.eventDispatcher.addEventListener("Validator.CandidatesChange",this.onCandidatesChange),this.eventDispatcher.addEventListener("Collector.IMEPrevCandidates",this.onPrevCandidates),this.eventDispatcher.addEventListener("Collector.IMENextCandidates",this.onNextCandidates),this.eventDispatcher.addEventListener("Validator.CandidateInput",this.onCandidateInput),this.candidates=[],this.query=[],this.index=0},t.setMode=function(t){return this.mode=Types.parseValue(t,"Enum",{Enum:Enum.IMEMode,default:"disabled"}),this.setQuery([]),this.setCandidates([]),e.load(this.mode)},t.getMode=function(){return this.mode},t.setCandidates=function(e){this.candidates=Array.isArray(e)?e:[],this.updateCandidates()},t.getCandidates=function(){return this.candidates},t.setQuery=function(e){this.query=Array.isArray(e)?e:[]},t.getQuery=function(){return this.query},t.setCount=function(e){this.count=Types.parseValue(e,"Integer",{min:1,max:12})},t.getCount=function(){return this.count},t.dispose=function(){this.eventDispatcher.removeEventListener("Validator.CompositionUpdate",this.onCompositionUpdate),this.eventDispatcher.removeEventListener("Validator.CandidatesChange",this.onCandidatesChange),this.eventDispatcher.removeEventListener("Collector.IMEPrevCandidates",this.onPrevCandidates),this.eventDispatcher.removeEventListener("Collector.IMENextCandidates",this.onNextCandidates),this.eventDispatcher.removeEventListener("Validator.CandidateInput",this.onCandidateInput),this.mode=Enum.IMEMode.DISABLED},Converter}),define("system/widgets/KeyBoard/libs/FocusManager",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";function FocusManager(){var i=this,s;i.init=function(e,t,n){s=n,i.widget=t,i.eventDispatcher=e,i.eventDispatcher.addEventListener("Keyboard.Hide",i.onHide),i.eventDispatcher.addEventListener("Keyboard.Show",i.onShow),i.eventDispatcher.addEventListener("Input.Focus",i.inputFocus),i.inputEl=t.inputEl,i.inputElem=t.inputElem},i.onShow=function(){i.inputEl.one("focusout",function(){e.call(i,s.pos)}),i.inputEl.on("click",function(){s.pos=i.inputElem.selectionStart}),t.call(i)},i.onHide=function(){i.inputBlur(),i.inputEl.off("click")},i.dispose=function(){i.eventDispatcher.removeEventListener("Keyboard.Hide",i.onHide),i.eventDispatcher.removeEventListener("Keyboard.Show",i.onShow),i.eventDispatcher.removeEventListener("Input.Focus",i.inputFocus),i.inputEl.off(),i.inputEl=null,i.inputElem=null,i.widget=null},i.inputFocus=function(){e.call(i,s.pos)},i.inputBlur=function(){i.inputEl.blur()}}function e(e){this.widget&&this.widget.data&&!0===this.widget.data.open&&this.inputElem&&this.inputElem!==document.activeElement&&(this.inputEl.focus(),this.inputElem.setSelectionRange(e,e))}function t(){var e=this,t=this.inputElem.value.length;this.inputEl.one("focusin",function(){e.inputElem.setSelectionRange(t,t)}),this.inputEl.focus()}return FocusManager}),define("system/widgets/KeyBoard/libs/InputProcessor",["brease/core/Utils"],function(Utils){"use strict";function InputProcessor(){var e=this,t;e.init=function(i,s,n){t=n||{},e.widget=s,e.eventDispatcher=i,e.eventDispatcher.addEventListener("Validator.Set",e.onSet),e.eventDispatcher.addEventListener("Validator.Change",e.onChange),e.eventDispatcher.addEventListener("Validator.Input",e.onInput),e.eventDispatcher.addEventListener("Collector.Delete",e.onDelete),e.eventDispatcher.addEventListener("Collector.CursorLeft",e.onCursorLeft),e.eventDispatcher.addEventListener("Collector.CursorRight",e.onCursorRight),e.eventDispatcher.addEventListener("Collector.Clear",e.onClear),e.eventDispatcher.addEventListener("Validator.Submit",e.onSubmit),e.eventDispatcher.addEventListener("Validator.CandidateInput",e.onCandidateInput),e.inputElem=s.inputElem},e.setOptions=function(e){void 0!==e.type&&this.inputElem.setAttribute("type",e.type),void 0!==e.maxLength?this.inputElem.setAttribute("maxlength",parseInt(e.maxLength,10)):this.inputElem.removeAttribute("maxlength")},e.onSet=function(s){var n=s.detail.value;e.inputElem.value=n,t.pos=n.length,i()};function i(){e.eventDispatcher.dispatchEvent({type:"Processor.Change",detail:{value:e.inputElem.value}}),e.eventDispatcher.dispatchEvent({type:"Input.Focus"})}e.onChange=function(s){if(!s.isComposing){var n=s.detail.value;t.pos=e.inputElem.selectionStart,void 0!==s.detail.originalValue&&s.detail.value.length!==s.detail.originalValue.length&&(t.pos-=Math.abs(s.detail.value.length-s.detail.originalValue.length)),e.inputElem.value=n,i()}},e.onInput=function(i){if(!i.isComposing){var s="";Utils.isString(i.detail.value)&&(s=i.detail.value),t.pos=e.inputElem.selectionStart+s.length,e.inputElem.setRangeText(s,e.inputElem.selectionStart,e.inputElem.selectionEnd,"end"),e.eventDispatcher.dispatchEvent({type:"Processor.Change",detail:{value:e.inputElem.value}}),e.eventDispatcher.dispatchEvent({type:"Input.Focus"})}},e.onDelete=function(i){i.isComposing||(e.inputElem.selectionEnd>0&&(e.inputElem.selectionStart!==e.inputElem.selectionEnd?(t.pos=e.inputElem.selectionStart,e.inputElem.setRangeText("",e.inputElem.selectionStart,e.inputElem.selectionEnd,"start")):(t.pos=e.inputElem.selectionEnd-1,e.inputElem.setRangeText("",e.inputElem.selectionEnd-1,e.inputElem.selectionEnd,"start"))),e.eventDispatcher.dispatchEvent({type:"Processor.Change",detail:{value:e.inputElem.value}}),e.eventDispatcher.dispatchEvent({type:"Input.Focus"}))},e.onCursorLeft=function(i){if(!i.isComposing){var s=e.inputElem.selectionStart-1;s>=0&&e.inputElem.setSelectionRange(s,s),t.pos=e.inputElem.selectionStart,e.eventDispatcher.dispatchEvent({type:"Input.Focus"})}},e.onCursorRight=function(i){if(!i.isComposing){var s=e.inputElem.selectionStart+1;e.inputElem.setSelectionRange(s,s),t.pos=e.inputElem.selectionStart,e.eventDispatcher.dispatchEvent({type:"Input.Focus"})}},e.setSelectionRange=function(i,s){e.inputElem.setSelectionRange(i,s),t.pos=e.inputElem.selectionEnd},e.onClear=function(i){i.isComposing||(e.inputElem.value="",t.pos=0,e.eventDispatcher.dispatchEvent({type:"Input.Focus"}))},e.onSubmit=function(t){e.eventDispatcher.dispatchEvent({type:"Processor.Submit",detail:{value:t.detail.value}})},e.onCandidateInput=function(i){if(!i.isComposing){var s="";Utils.isString(i.detail.value)&&(s=i.detail.value),t.pos=e.inputElem.selectionStart+s.length,e.inputElem.setRangeText(s,e.inputElem.selectionStart,e.inputElem.selectionEnd,"end"),e.eventDispatcher.dispatchEvent({type:"Processor.Change",detail:{value:e.inputElem.value}}),e.eventDispatcher.dispatchEvent({type:"Input.Focus"})}}}return InputProcessor.prototype.dispose=function(){this.eventDispatcher.removeEventListener("Validator.Set",this.onSet),this.eventDispatcher.removeEventListener("Validator.Change",this.onChange),this.eventDispatcher.removeEventListener("Validator.Input",this.onInput),this.eventDispatcher.removeEventListener("Collector.Delete",this.onDelete),this.eventDispatcher.removeEventListener("Collector.CursorLeft",this.onCursorLeft),this.eventDispatcher.removeEventListener("Collector.CursorRight",this.onCursorRight),this.eventDispatcher.removeEventListener("Collector.Clear",this.onClear),this.eventDispatcher.removeEventListener("Validator.Submit",this.onSubmit),this.eventDispatcher.removeEventListener("Validator.CandidateInput",this.onCandidateInput),this.inputElem=null},InputProcessor}),define("system/widgets/KeyBoard/libs/InputValidator",["brease/core/Utils"],function(Utils){"use strict";function InputValidator(){var e=this;e.value="",e.setValue=function(t){e.value=t.detail.value},e.getValue=function(){return e.value},e.setRestriction=function(t){e.regexp=t?new RegExp(t):void 0},e.setMaxLength=function(t){e.maxLength=t},e.inputIsAllowed=function(t){var i=e.getValue(),s=Utils.isString(i)?i.length:0,n=!0;return(!Utils.isString(t)||void 0!==e.maxLength&&s+t.length>e.maxLength)&&(n=!1),n},e.onSet=function(t){var i=e.validate(t.detail.value);e.eventDispatcher.dispatchEvent({type:"Validator.Set",detail:{value:i}})},e.onChange=function(t){var i=t.detail.value,s=e.validate(i),n={type:"Validator.Change",detail:{value:s,originalValue:i}};void 0!==t.key&&(n.key=t.key),void 0!==t.which&&(n.which=t.which),e.eventDispatcher.dispatchEvent(n)},e.onInput=function(t){var i="";e.inputIsAllowed(t.detail.value)&&(i=e.validate(t.detail.value)),e.eventDispatcher.dispatchEvent({type:"Validator.Input",detail:{value:i}})},e.onSubmit=function(){var t=e.validate(e.value);e.eventDispatcher.dispatchEvent({type:"Validator.Submit",detail:{value:t}})},e.onClear=function(){e.setValue({detail:{value:""}})},e.validate=function(t){return void 0===e.regexp?t:t.split("").filter(function(t){return e.regexp.test(t)}).join("")},e.onCompositionUpdate=function(i){var s=Array.isArray(i.detail.values)?i.detail.values:[];s=s.map(e.validate).filter(t),e.eventDispatcher.dispatchEvent({type:"Validator.CompositionUpdate",detail:{values:s}})},e.onCandidatesChange=function(i){var s=Array.isArray(i.detail.candidates)?i.detail.candidates:[],n=Array.isArray(i.detail.query)?i.detail.query:[];s=s.map(e.validate).filter(t),n=n.map(e.validate).filter(t),e.eventDispatcher.dispatchEvent({type:"Validator.CandidatesChange",detail:{candidates:s,query:n}})},e.onCandidateInput=function(t){var i="";e.inputIsAllowed(t.detail.value)&&(i=e.validate(t.detail.value)),e.eventDispatcher.dispatchEvent({type:"Validator.CandidateInput",detail:{value:i}})}}var e=InputValidator.prototype;e.init=function(e,t){this.widget=t,this.eventDispatcher=e,this.eventDispatcher.addEventListener("Collector.Set",this.onSet),this.eventDispatcher.addEventListener("Collector.Change",this.onChange),this.eventDispatcher.addEventListener("Collector.Input",this.onInput),this.eventDispatcher.addEventListener("Collector.Submit",this.onSubmit),this.eventDispatcher.addEventListener("Collector.Clear",this.onClear),this.eventDispatcher.addEventListener("Processor.Change",this.setValue),this.eventDispatcher.addEventListener("Composer.CompositionUpdate",this.onCompositionUpdate),this.eventDispatcher.addEventListener("Converter.CandidatesChange",this.onCandidatesChange),this.eventDispatcher.addEventListener("Collector.CandidateInput",this.onCandidateInput)},e.dispose=function(){this.eventDispatcher.removeEventListener("Collector.Set",this.onSet),this.eventDispatcher.removeEventListener("Collector.Change",this.onChange),this.eventDispatcher.removeEventListener("Collector.Input",this.onInput),this.eventDispatcher.removeEventListener("Collector.Submit",this.onSubmit),this.eventDispatcher.removeEventListener("Collector.Clear",this.onClear),this.eventDispatcher.removeEventListener("Processor.Change",this.setValue),this.eventDispatcher.removeEventListener("Composer.CompositionUpdate",this.onCompositionUpdate),this.eventDispatcher.removeEventListener("Converter.CandidatesChange",this.onCandidatesChange),this.eventDispatcher.removeEventListener("Collector.CandidateInput",this.onCandidateInput),this.value="",this.restriction=void 0};function t(e){return 0!==e.length}return InputValidator}),define("system/widgets/KeyBoard/libs/KeyCollector",["brease/events/BreaseEvent","brease/core/Utils"],function(BreaseEvent,Utils){"use strict";function KeyCollector(){var i=this;i.value="",i.layer=1,i.capslock=!1,i.shift=!1,i.special=!1,i.init=function(e,s){i.widget=s,i.eventDispatcher=e,i.clickEventName=t(brease.config.virtualKeyboards),i.widget.el.on("keyup",".ValueOutput",i.onKeyUp),i.widget.el.on("keydown",".ValueOutput",i.onKeyDown),i.widget.el.on(BreaseEvent.MOUSE_DOWN,".ValueButton, .ActionButton, .ActionImage",i.onButtonMouseDown),i.widget.el.on(i.clickEventName,".ValueButton",i.onValueButtonClick),i.widget.el.on(i.clickEventName,".ActionButton",i.onActionButtonClick),i.widget.el.on(i.clickEventName,".ActionImage",i.onActionButtonClick),i.widget.el.on(BreaseEvent.MOUSE_DOWN,".breaeIMECandidate",i.onIMECandidateMouseDown),i.eventDispatcher.addEventListener("Keyboard.Hide",r),i.valueButtons=i.widget.el.find(".ValueButton")},i.onButtonMouseDown=function(){i.activeButton&&Utils.removeClass(i.activeButton,"active"),i.activeButton=this,Utils.addClass(i.activeButton,"active"),brease.docEl.on(BreaseEvent.MOUSE_UP,i.onButtonMouseUp)},i.onButtonMouseUp=function(){brease.docEl.off(BreaseEvent.MOUSE_UP,i.onButtonMouseUp),Utils.removeClass(i.activeButton,"active"),i.activeButton=void 0,i.eventDispatcher.dispatchEvent({type:"Input.Focus"})},i.onValueButtonClick=function(){var t=e(this,i.layer);i.eventDispatcher.dispatchEvent({type:"Collector.Input",detail:{value:t}}),i.shift&&!i.capslock&&(i.widget.el.find('[data-action="shift"]').removeClass("selected"),i.shift=!1,i.layer=1,a())},i.onActionButtonClick=function(){var e=this.getAttribute("data-action");switch(e){case"delete":i.eventDispatcher.dispatchEvent({type:"Collector.Delete",detail:{}});break;case"enter":i.eventDispatcher.dispatchEvent({type:"Collector.Submit"});break;case"left":i.eventDispatcher.dispatchEvent({type:"Collector.CursorLeft",detail:{}});break;case"right":i.eventDispatcher.dispatchEvent({type:"Collector.CursorRight",detail:{}});break;case"shift":s(),a()
;break;case"close":i.eventDispatcher.dispatchEvent({type:"Collector.Close"});break;case"special":n(),a();break;case"clear":i.eventDispatcher.dispatchEvent({type:"Collector.Clear",detail:{}});break;case"ime-next-candidates":i.eventDispatcher.dispatchEvent({type:"Collector.IMENextCandidates"});break;case"ime-prev-candidates":i.eventDispatcher.dispatchEvent({type:"Collector.IMEPrevCandidates"});break;default:console.iatWarn('keyboard action "'+e+'" not supported!');break}},i.onKeyUp=function(e){if(13===e.which)i.eventDispatcher.dispatchEvent({type:"Collector.Submit"});else{var t={type:"Collector.Change",detail:{value:this.value}};void 0!==e.key&&(t.key=e.key),void 0!==e.which&&(t.which=e.which),i.eventDispatcher.dispatchEvent(t)}},i.onKeyDown=function(e){""===i.widget.validate(e.key,i.widget.regexp)?e.originalEvent.preventDefault():i.eventDispatcher.dispatchEvent({type:"Collector.KeyDown",originalEvent:e.originalEvent})},i.onIMECandidateMouseDown=function(){i.activeCandidate&&Utils.removeClass(i.activeCandidate,"active"),i.wasScrolling=!1,i.activeCandidate=this,i.widget.el.on(BreaseEvent.SCROLL_START,i.onIMEScroll),brease.docEl.on(BreaseEvent.MOUSE_UP,i.onIMECandidateMouseUp),Utils.addClass(i.activeCandidate,"active")},i.onIMEScroll=function(){i.wasScrolling=!0},i.onIMECandidateMouseUp=function(e){Utils.removeClass(i.activeCandidate,"active"),i.widget.el.off(BreaseEvent.SCROLL_START,i.onIMEScroll),brease.docEl.off(BreaseEvent.MOUSE_UP,i.onIMECandidateMouseUp),!i.wasScrolling&&e.target.isSameNode(i.activeCandidate)&&i.onIMECandidateClick.call(i.activeCandidate),i.activeCandidate=null,i.wasScrolling=!1},i.onIMECandidateClick=function(){var e="";e=this&&"string"==typeof this.innerText?this.innerText:"",i.eventDispatcher.dispatchEvent({type:"Collector.CandidateInput",detail:{value:e}})},i.dispose=function(){r(),brease.docEl.off(BreaseEvent.MOUSE_UP,i.onIMECandidateMouseUp),i.widget&&(i.widget.el.off("keyup",".ValueOutput",i.onKeyUp),i.widget.el.off("keydown",".ValueOutput",i.onKeyDown),i.widget.el.off(BreaseEvent.MOUSE_DOWN,".ValueButton, .ActionButton, .ActionImage",i.onButtonMouseDown),i.widget.el.off(i.clickEventName,".ValueButton",i.onValueButtonClick),i.widget.el.off(i.clickEventName,".ActionButton",i.onActionButtonClick),i.widget.el.off(i.clickEventName,".ActionImage",i.onActionButtonClick),i.widget.el.off(BreaseEvent.SCROLL_START,i.onIMEScroll),i.widget.el.off(BreaseEvent.MOUSE_DOWN,".breaeIMECandidate",i.onIMECandidateMouseDown),i.widget=null,i.valueButtons=null),i.eventDispatcher.removeEventListener("Keyboard.Hide",r),i.activeCandidate=null,i.wasScrolling=!1};function s(){!0===i.shift&&!0===i.capslock?r():!0===i.shift&&!1===i.capslock?(i.special=!1,i.capslock=!0,i.widget.el.find('[data-action="shift"]').addClass("capslocked"),i.layer=2):(i.widget.el.find('[data-action="special"]').removeClass("selected"),i.widget.el.find('[data-action="shift"]').addClass("selected"),i.special=!1,i.shift=!0,i.layer=2),i.eventDispatcher.dispatchEvent({type:"Input.Focus"})}function n(){!0===i.special?r():(i.widget.el.find('[data-action="special"]').addClass("selected"),i.widget.el.find('[data-action="shift"]').removeClass("selected").removeClass("capslocked"),i.shift=!1,i.capslock=!1,i.special=!0,i.layer=3),i.eventDispatcher.dispatchEvent({type:"Input.Focus"})}function a(){var e,t,s;switch(i.layer){case 1:e="display",t="shift-display",s="special-display";break;case 2:e="shift-display",t="",s="";break;case 3:e="special-display",t="",s="";break}i.valueButtons.each(function(i,n){var a="";s&&(a+="<sub>"+n.getAttribute("data-"+s)+"</sub>"),a+="<span>"+n.getAttribute("data-"+e)+"</span>",t&&(a+="<sup>"+n.getAttribute("data-"+t)+"</sup>"),n.innerHTML=a})}function r(){i.shift=!1,i.capslock=!1,i.special=!1,i.layer=1,i.widget&&(i.widget.el.find('[data-action="special"]').removeClass("selected"),i.widget.el.find('[data-action="shift"]').removeClass("selected").removeClass("capslocked"),a())}}function e(e,t){var i="";switch(t){case 1:i=e.getAttribute("data-value");break;case 2:i=e.getAttribute("data-shift-value");break;case 3:i=e.getAttribute("data-special-value");break}return i}function t(e){return e&&e.InputProcessing&&!0===e.InputProcessing.onKeyDown?BreaseEvent.MOUSE_DOWN:BreaseEvent.CLICK}return KeyCollector}),define("system/widgets/NumPad/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"system.widgets.NumPad",parents:["*"],children:[],inheritance:["system.widgets.NumPad","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{style:{name:"style",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!system/widgets/NumPad/NumPad.html",[],function(){return'<div id="WIDGETID" data-brease-widget="system/widgets/NumPad"></div>\r\n'}),define("text!widgets/brease/AlarmHistory/AlarmHistory.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmHistory">CONTENT</div>'}),define("widgets/brease/DataHandlerWidget/DataHandlerWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils"],function(e,BreaseEvent,Enum,Utils){"use strict";var t={childrenInitialized:!1,childrenList:[],childrenIdList:[],totalNbrofChildren:0},i=e.extend(function DataHandlerWidget(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){!0===brease.config.editMode?o(this):a(this),e.prototype.init.apply(this,arguments)},s.childrenInitializedHandler=function(){var e=this;this.settings.childrenIdList.forEach(function(t){var i=brease.callWidget(t,"widget");e.settings.childrenList.push(i),Utils.isFunction(i.setParentWidget)?i.setParentWidget(e):Utils.isFunction(i.setParentWidgetId)&&i.setParentWidgetId(e.elem.id)}),this.settings.totalNbrofChildren=this.settings.childrenIdList.length,this.createEvent("WIDGET_CHILDREN_READY").dispatch()},s.getChildrenList=function(){return this.settings.childrenList},s.getChildrenInitialized=function(){return this.settings.childrenInitialized},s.childrenParsed=function(e){e.target===this.elem&&(Array.prototype.forEach.call(d.call(this),function(e){var t=e.id;this.settings.childrenIdList.includes(t)||(this.settings.childrenList.push(brease.callWidget(t,"widget")),this.settings.childrenIdList.push(t))},this),this.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,this._bind(this.childrenParsed)),this.elem.addEventListener(BreaseEvent.WIDGET_ADDED,this._bind(this.childrenAdded)),this.elem.addEventListener(BreaseEvent.WIDGET_REMOVED,this._bind(this.childrenRemoved)))},s.childrenAdded=function(e){if(e.target===this.elem&&!this.settings.childrenIdList.includes(e.detail.widgetId)){var t=e.detail.widgetId,i=brease.callWidget(t,"widget");this.settings.childrenIdList.push(t),this.settings.childrenList.push(i);var s=n(this);this.settings.childrenList.sort(function(e,t){return s.indexOf(e.elem.id)-s.indexOf(t.elem.id)}),this.settings.childrenIdList.sort(function(e,t){return s.indexOf(e)-s.indexOf(t)}),this.settings.totalNbrofChildren+=1}};function n(e){return Array.prototype.map.call(d.call(e),function(e){return e.id})}s.childrenRemoved=function(e){if(e.target===this.elem){var t=e.detail.widgetId,i=this.settings.childrenIdList.indexOf(t);i>-1&&(this.settings.childrenList.splice(i,1),this.settings.childrenIdList.splice(i,1)),this.settings.totalNbrofChildren-=1}},s.dispose=function(){l(this),this.settings.childrenIdList=[],this.settings.childrenList=[],e.prototype.dispose.apply(this,arguments)},s.enable=function(){e.prototype.enable.call(this,arguments),(this.settings.childrenInitialized||brease.config.editMode)&&r(this)},s.disable=function(){e.prototype.disable.call(this,arguments),(this.settings.childrenInitialized||brease.config.editMode)&&r(this)};function a(e){e.itemDefs=Array.prototype.map.call(d.call(e),function(t){var i=t.id,s=$.Deferred();e.settings.childrenIdList.push(i),brease.uiController.getWidgetState(i)>=Enum.WidgetState.INITIALIZED&&brease.uiController.getWidgetState(i)!==Enum.WidgetState.SUSPENDED?s.resolve():t.addEventListener(BreaseEvent.WIDGET_INITIALIZED,n);function n(){t.removeEventListener(BreaseEvent.WIDGET_INITIALIZED,n),s.resolve()}return s}),$.when.apply($,e.itemDefs).done(function(){e.settings.childrenInitialized=!0,r(e),e.childrenInitializedHandler()})}function r(e){e.settings.childrenIdList.forEach(function(t){brease.uiController.callWidget(t,"setParentEnableState",!e.isDisabled)})}function o(e){e._cssClasses.includes("breaseTableWidget")||e.elem.classList.contains("breaseTableWidget")?e.elem.addEventListener(BreaseEvent.CONTENT_PARSED,e._bind(e.childrenParsed)):(e.elem.addEventListener(BreaseEvent.WIDGET_ADDED,e._bind(e.childrenAdded)),e.elem.addEventListener(BreaseEvent.WIDGET_REMOVED,e._bind(e.childrenRemoved)))}function l(e){!0===brease.config.editMode&&(e.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,e._bind(e.childrenParsed)),e.elem.removeEventListener(BreaseEvent.WIDGET_ADDED,e._bind(e.childrenAdded)),e.elem.removeEventListener(BreaseEvent.WIDGET_REMOVED,e._bind(e.childrenRemoved)))}function d(){return this.elem.querySelectorAll("[data-brease-widget]")}return i}),define("widgets/brease/TableWidget/libs/DataTable",["widgets/brease/common/libs/external/jquery.dataTables","widgets/brease/common/libs/external/dataTables.select","widgets/brease/common/libs/external/dataTables.scroller"],function(){"use strict";function e(){}var t=e.prototype;return t.exists=function(){return!!this.datatable},t._noExist=function(){return!this.datatable},t.addTableNode=function(e){return this.$table=$('<table cellspacing="0"></table>'),e.prepend(this.$table),this.$table},t.initializeDataTable=function(e){$.fn.dataTable.ext.sErrMode=console.warn,this.datatable=this.$table.DataTable(e)},t.info=function(){return this._noExist()?{page:0,pages:0,length:0,start:0,end:0}:this.datatable.page.info()},t.addRows=function(e){!this._noExist()&&e&&this.datatable.rows.add(e)},t.order=function(e){this._noExist()||this.datatable.order(e)},t.search=function(e){this._noExist()||this.datatable.search(e)},t.resetFilter=function(e){this._noExist()||(this.datatable.column([0]).search(""),this.datatable.column([1]).search(""),e&&this.datatable.column([3]).search(""))},t.goToPage=function(e){this._noExist()||this.datatable.page(e)},t.show=function(e){this.datatable.row().show(e)},t.find=function(e){if(!this._noExist()){var t=this,i=!1,s=Object.keys(e);return this.datatable.rows({filter:"applied"})[0].forEach(function(n){t.datatable.data()[n][s]===e[s]&&(i=!0)}),i}},t.draw=function(e){this._noExist()||this.datatable.draw(e)},t.deselect=function(e){this.datatable.rows(e).deselect()},t.select=function(e){this.datatable.row(e,{page:"current"}).select()},t.index=function(e){return this.datatable.row(e,{page:"current"}).index()},t.getCurrentRow=function(){return this.datatable.rows({selected:!0}).data()[0]},t.getRowIndex=function(){return this.datatable.row({selected:!0}).index()},t.getRowIndices=function(){return this.datatable.rows({selected:!0})[0]},t.getFilteredPage=function(){return this.datatable.rows({filter:"applied"}).page()},t.getFilteredOffset=function(e){return this.datatable.rows({filter:"applied"})[0][e]},t.clear=function(){this._noExist()||this.datatable.clear()},t.addRowSelectionFromPlugin=function(){$.fn.dataTable.Api.register("row().show()",function(e){this.table().rows({page:"current"}).deselect();for(var t=this.table().page.info(),i=this.table().rows({filter:"applied"}).data(),s=0,n=Object.getOwnPropertyNames(e),a=0;a<i.length;a+=1)if(i[a][n]===e[n]){s=a;break}var r=Math.floor(s/t.length);return-1!==t.length&&r!==this.index()&&(this.table().page(r).draw(!1),s%=t.length),this.table().row(":eq("+s+")",{page:"current"}).select(),this})},t.destroy=function(){void 0!==this.datatable&&this.datatable.destroy(!0),void 0!==this.$table&&this.$table.remove()},e});define("widgets/brease/common/libs/NativeScroller",["brease/core/Class"],function(e){"use strict";var t=e.extend(function NativeScroller(t){e.call(this),this.widget=t},{}),i=t.prototype;i.init=function(e){this.internal={starttime:void 0,enabled:!0,elem:e,momentum:!0,stopped:!1,distance:0,timer:[],bounceTime:600,useTransition:!1,directionLockThreshold:5,eventType:{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3},ease:{circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return Math.sqrt(1- --e*e)}}}},e.addEventListener("mousedown",this._bind("_start")),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this.hasHorizontalScroll=!0,this.hasVerticalScroll=!0},i.dispose=function(){window.cancelAnimationFrame(this.internal.animationFrame),this.internal.elem.removeEventListener("mousedown",this._bind("_start")),document.removeEventListener("mousemove",this._bind("_move")),document.removeEventListener("mouseup",this._bind("_stop"))},i._start=function(e){if(1!==this.internal.eventType[e.type]){var t;if(t=e.which?e.button:e.button<2?0:4===e.button?1:2,0!==t)return}if(this.internal.enabled&&(!this.initiated||this.internal.eventType[e.type]===this.initiated)){var i=e.touches?e.touches[0]:e;this.initiated=this.internal.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this.startTime=this._getTime(),this.internal.useTransition&&this.isInTransition?(this.isInTransition=!1,this._execEvent("scrollEnd")):!this.internal.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=i.pageX,this.pointY=i.pageY,this._execEvent("beforeScrollStart"),document.addEventListener("mousemove",this._bind("_move")),document.addEventListener("mouseup",this._bind("_stop"))}},i._move=function(e){if(this.internal.enabled&&this.internal.eventType[e.type]===this.initiated){var t=this._getTime(),i=s(e),a=i.pageX-this.pointX,r=i.pageY-this.pointY,o,l;this.pointX=i.pageX,this.pointY=i.pageY,this.distX+=a,this.distY+=r,o=Math.abs(this.distX),l=Math.abs(this.distY),this._movedLessThanTreshold(o,l)||(this._lockDirection(o,l),"h"===this.directionLocked?r=0:"v"===this.directionLocked&&(a=0),a=this.hasHorizontalScroll?a:0,r=this.hasVerticalScroll?r:0,this.directionX=n(a),this.directionY=n(r),this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(a,r),t-this.startTime>300&&(this.startTime=t,this.startX=this.x,this.startY=this.y))}};function s(e){return e.touches?e.touches[0]:e}function n(e){return e>0?-1:e<0?1:0}return i._movedLessThanTreshold=function(e,t){return this._getTime()-this.endTime>300&&e<10&&t<10},i._lockDirection=function(e,t){this.directionLocked||this.internal.freeScroll||(e>t+this.internal.directionLockThreshold?this.directionLocked="h":t>=e+this.internal.directionLockThreshold?this.directionLocked="v":this.directionLocked="n")},i._stop=function(e){if(document.removeEventListener("mousemove",this._bind("_move")),document.removeEventListener("mouseup",this._bind("_stop")),this.internal.enabled&&this.internal.eventType[e.type]===this.initiated){var t,i,s=this._getTime()-this.startTime,n=Math.round(this.x),a=Math.round(this.y),r=0,o="";if(this.isInTransition=0,this.initiated=0,this.endTime=this._getTime(),!this._resetPosition(this.internal.bounceTime)){if(this._scrollTo(n,a),!this.moved)return this._execEvent("scrollCancel"),void 0;if(this.internal.momentum&&s<300&&(t=this.hasHorizontalScroll?this._momentum(this.x,this.startX,s,this.maxScrollX,this.internal.bounce?this.wrapperWidth:0,this.internal.deceleration):{destination:n,duration:0},i=this.hasVerticalScroll?this._momentum(this.y,this.startY,s,this.maxScrollY,this.internal.bounce?this.wrapperHeight:0,this.internal.deceleration):{destination:a,duration:0},n=t.destination,a=i.destination,r=Math.max(t.duration,i.duration),this.isInTransition=1),n!==this.x||a!==this.y)return(n>0||n<this.maxScrollX||a>0||a<this.maxScrollY)&&(o=this.internal.ease.quadratic),this._scrollTo(n,a,r,o),void 0;this._execEvent("scrollEnd")}}},i._momentum=function(e,t,i,s,n,a){var r=e-t,o=Math.abs(r)/i,l,d;return a=void 0===a?6e-4:a,l=e+o*o/(2*a)*(r<0?-1:1),d=o/a,l<s?(l=n?s-n/2.5*(o/8):s,r=Math.abs(l-e),d=r/o):l>0&&(l=n?n/2.5*(o/8):0,r=Math.abs(e)+l,d=r/o),{destination:Math.round(l),duration:d}},i._scrollTo=function(e,t,i,s){s=s||this.internal.ease.circular,this.isInTransition=this.internal.useTransition&&i>0;var n=this.internal.useTransition&&s.style;!i||n?this._translate(e,t):this._animate(e,t,i,s.fn)},i.scrollToElement=function(e,t,i,s,n){!0===s&&(s=Math.round(e.offsetHeight/2-this.internal.elem.offsetHeight/2)),this.internal.elem.scrollTop=e.offsetTop-this.internal.elem.offsetTop+s},i._getTime=function(){return Date.now()||function e(){return(new Date).getTime()}},i._animate=function(e,t,i,s){var n=this,a=this.x,r=this.y,o=this._getTime(),l=o+i;function d(){var c=n._getTime(),h,u,g;if(c>=l)return n.isAnimating=!1,n._translate(e,t),n._resetPosition(n.internal.bounceTime)||n._execEvent("scrollEnd"),void 0;c=(c-o)/i,g=s(c),h=(e-a)*g+a,u=(t-r)*g+r,n._translate(h,u),n.isAnimating&&(n.internal.animationFrame=window.requestAnimationFrame(d))}this.isAnimating=!0,d()},i._preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},i._execEvent=function(e){},i._translate=function(e,t){e=Math.round(e),t=Math.round(t),this.internal.elem.scrollLeft-=e,this.internal.elem.scrollTop-=t,this.x=e,this.y=t},i._resetPosition=function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(t!==this.x||i!==this.y)&&(this._scrollTo(t,i,e,this.internal.ease.circular),!0)},t}),define("widgets/brease/TableWidget/libs/Renderer",["brease/core/Class","brease/helper/Scroller","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/TableWidget/libs/DataTable","widgets/brease/common/libs/NativeScroller"],function(e,Scroller,Utils,BreaseEvent,t,NativeScroller){"use strict";var i=e.extend(function Renderer(i){e.call(this),this.widget=i,this.dt=new t,this.internal={searchInProgress:!1,filterSet:!1,filterPos:-1,scrollerOptions:{header:{mouseWheel:!0,scrollY:!1,scrollX:!0,scrollbars:!1,probeType:3},body:{mouseWheel:!0,scrollY:!0,scrollX:!0,probeType:3}}}},null),s=i.prototype;return s.initialize=function(){!0!==this.widget.settings.omitClass&&(this.widget.el.addClass("breaseTableWidget"),this.widget.el.addClass("container")),brease.config.editMode||this._addRowSelectionFromPlugin(),this.widget.settings.itemsPerPage=this.widget.settings.itemsPerPage<=0?1:this.widget.settings.itemsPerPage,this.searchBoxId=Utils.uniqueID(this.widget.elem.id+"_searchbox"),this.searchBoxWidth="30%",this.searchBoxPadding=3,this.topBarWrapperHeight=30+2*this.searchBoxPadding,this.tableWrapperHeight=0,this.pagingWrapperHeight=34,this.heightToReduce=0,this.initialized=!1,this.throttledRedraw=_.throttle(this._redraw,this.getRedrawWaitTime(),{leading:!1,trailing:!0}),this.debouncedRefreshScrollerBody=_.debounce(this._bind("_refreshScrollerBody"),20,{leading:!1,trailing:!0}),this.tableEl=this.dt.addTableNode(this.widget.el),this.setFilter()},s.getRedrawWaitTime=function(){return 300},s.start=function(){this._initializeDataTable()},s.rebuildView=function(){this.initialized=!1,this._destroy(),this._removeScroller(),this._removeResizeObserver(),this._removeSearchBox(),this.widget._showBusyIndicator(),this.widget.model.updateModel(),this._initializeDataTable()},s.redraw=function(){this.throttledRedraw()},s._redraw=function(){this._destroy(),this._removeScroller(),this._removeResizeObserver(),this._removeSearchBox(),this.widget._showBusyIndicator(),this._initializeDataTable()},s._removeSearchBox=function(){brease.uiController.disposeWidget(this.searchBoxId),this.searchBox&&this._nullifySearchBox(),this.widget.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_onAggregatedWidgetsReady"))},s._nullifySearchBox=function(){this.searchBox=null},s.refreshScroller=function(){this._refreshScrollerHead(),this.tableBodyResizeObserver||this._refreshScrollerBody()},s.setColumnWidth=function(e,t){this._setColumnWidth(this.tableEl,e,t)},s.setTableWidth=function(e){this._setTableWidth(this.tableEl,e)},s.deselect=function(e){this.dt.deselect(e)},s.select=function(e){this.dt.select(e)},s.index=function(e){return this.dt.index(e)},s.getCurrentRow=function(){return this.dt.getCurrentRow()},s.getRowIndex=function(){return this.dt.getRowIndex()},s.getRowIndices=function(){return this.dt.getRowIndices()},s.setSearchBox=function(e){!0===e&&(this.topBarWrapperHeight=30+2*this.searchBoxPadding),this.updateLayout()},s.setPaging=function(e){!0===e&&(this.pagingWrapperHeight=30),this.rebuildView()},s.setItemsPerPage=function(){this.rebuildView()},s.setHeaderHeight=function(){this.tw_header_el&&this.updateLayout()},s.addRows=function(e){e||(e=this._getPreparedData()),this.dt.addRows(e),this.draw()},s.setSearch=function(e){this.internal.searchInProgress=e.length>0,this.searchBox.setValue(e),this.dt.search(e),this.draw()},s.draw=function(e){void 0===e&&(e=!0),this.dt.draw(!1);var t=this._getDataTablePageInfo(),i=t.page>t.pages?t.pages-1:t.page;this.dt.goToPage(i),this.dt.draw(e)},s.setFilter=function(){var e=this;this.internal.filterSet||($.fn.dataTable.ext.search.push(function(t,i,s,n){var a=$(t.nTable).closest(".breaseTableWidget")[0];if(!a||a.id!==e.widget.elem.id||0===e.widget.model.getPreparedData().length)return!0;for(var r=0===e.widget.settings.config.filter.length,o=!0,l=0;l<e.widget.settings.config.filter.length;l+=1){var d=e.widget.settings.config.filter[l],c,h;"tim"===d.data?(c=e._fixTimestamp(d.comp.split("Z")[0]).getTime(),h=e._fixTimestamp(e.widget.model.currentData[s].tim).getTime()):(c=d.comp,h=e.widget.model.currentData[s][d.data]);var u=e._getFilterStatement(h,d.opVal,c);1===d.logVal||""===d.logical?(r=r||o&&u,o=!0):0===d.logVal&&(o=o&&u)}return r}),this.internal.filterSet=!0,this.internal.filterPos=$.fn.dataTable.ext.search.length-1)},s._fixTimestamp=function(e){var t=new Date(e),i=this.widget.getFormat();return-1!==i.indexOf("f")?t=t:-1!==i.indexOf("s")||-1!==i.indexOf("T")?t.setMilliseconds(0):-1!==i.indexOf("m")||-1!==i.indexOf("t")&&1===i.length?(t.setMilliseconds(0),t.setSeconds(0)):-1!==i.indexOf("H")||-1!==i.indexOf("h")?(t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0)):-1!==i.indexOf("d")||-1!==i.indexOf("D")||-1!==i.indexOf("M")&&1===i.length?(t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(0)):-1!==i.indexOf("M")||-1!==i.indexOf("Y")?(t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(0),t.setDate(0)):-1!==i.indexOf("y")&&(t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setHours(0),t.setDate(0),t.setMonth(0)),t},s._getFilterStatement=function(e,t,i){var s;switch(e instanceof Date&&(e=e.getTime(),i=i.getTime()),"number"==typeof e&&(i=parseInt(i)),t){case 0:s=e!==i;break;case 1:s=e===i;break;case 2:s=e<i;break;case 3:s=e<=i;break;case 4:s=e>i;break;case 5:s=e>=i;break;case 6:s="string"==typeof e&&-1!==e.indexOf(i);break;case 7:s="string"==typeof e&&-1===e.indexOf(i);break;default:s=!0}return s},s._rowEligibility=function(){},s._colorMeBlue=function(){},s._centerImages=function(){},s._resetFilter=function(e){this.dt.resetFilter(e),this.draw()},s.updateData=function(){this.dt.exists()&&(this.widget.settings.optimize?this.widget.model.dataPrepended()?this.addRows(this._getPrependedData()):this.rebuildView():(this.dt.clear(),this.dt.addRows(this._getPreparedData()),this.draw(!1)))},s.updateNextData=function(e){this.dt.addRows(e),this.draw(!1)},s.repositionTopBar=function(){this.widget.el.find(".top-bar-table").prepend(this.searchBox.el),this.searchBox.el.css("float","right")},s.updateColumnWidths=function(){for(var e=0;e<this.widget.settings.childrenIdList.length;e+=1)this._setColumnWidth(this.tableEl,e,this.widget.model.columnWidths[e])},s.updateText=function(){this.widget.el.find(".previous").text(this.widget.settings.previousText),this.widget.el.find(".next").text(this.widget.settings.nextText)},s.updateTableWidth=function(){this._setTableWidth(this.tableEl,this.widget.model.maxWidth)},s.updateTableElHeight=function(){var e=this._getTableElHeight();return this._setTableElHeight(e),e},s._getTableElHeight=function(){return this.widget.el.height()-this.widget.settings.headerHeight-this.heightToReduce},s._setTableElHeight=function(e){this.tw_table_el&&this.tw_table_el.height(e)},s.updateOrder=function(e){for(var t=0;t<this.widget.settings.childrenIdList.length;t+=1)this.widget.settings.childrenIdList[t]===e.id?(void 0===e.order?this.dt.order([this.widget.settings.childrenIdList.length,"desc"]):this.dt.order([t,e.order]),this.draw()):brease.callWidget(this.widget.settings.childrenIdList[t],"resetOrdering")},s.updateLayout=function(){this.initialized&&(this._setLayoutSize(),this.refreshScroller())},s.enable=function(){if(this.searchBox&&!this.widget.isDisabled&&this.searchBox.setEnable(!0),!this.widget.isDisabled){void 0!==this.selectedAtDisable&&this._getDataTablePageInfo().page===this.selectedPageAtDisable&&this.disabledEdge&&(this.widget.el.find("tr:eq("+this.selectedAtDisable+")").addClass("selected"),this.disabledEdge=!1);for(var e=1;e<=this.nbrOfRows;e+=1)this.widget.el.find("tr:eq("+e+")").removeClass("disabled");for(var t=1;t<=this.nbrOfColumns;t+=1)this.widget.el.find(".breaseTableColumnWidget > svg").css("display","block")}},s.disable=function(){if(this.searchBox&&this.widget.isDisabled&&this.searchBox.setEnable(!1),this.widget.isDisabled){for(var e=1;e<=this.nbrOfRows;e+=1)this.widget.el.find("tr:eq("+e+")").addClass("disabled"),this.widget.el.find("tr:eq("+e+")").hasClass("selected")&&(this.widget.el.find("tr:eq("+e+")").removeClass("selected"),this.disabledEdge=!0,this.selectedPageAtDisable=this._getDataTablePageInfo().page,this.selectedAtDisable=e);for(var t=1;t<=this.nbrOfColumns;t+=1)this.widget.el.find(".breaseTableColumnWidget > svg").css("display","none")}},s._getLayoutElements=function(){this.tw_top_bar_el=this.widget.el.find(".tw_top_bar"),this.tw_header_el=this.widget.el.find(".tw_header"),this.tw_table_el=this.widget.el.find(".tw_table"),this.tw_paging_el=this.widget.el.find(".tw_paging")},s._setLayoutSize=function(){this.tw_header_el.height(this.widget.settings.headerHeight),this.heightToReduce=0,this.widget.settings.searchBox?(this.tw_top_bar_el.removeClass("remove"),this.tw_top_bar_el.height(this.topBarWrapperHeight),this.heightToReduce+=this.topBarWrapperHeight):(this.topBarWrapperHeight=0,this.tw_top_bar_el.addClass("remove")),this.widget.settings.paging&&this.widget.settings.showPagingButtons?(this.tw_paging_el.removeClass("remove"),this.tw_paging_el.height(this.pagingWrapperHeight),this.heightToReduce+=this.pagingWrapperHeight):(this.pagingWrapperHeight=0,this.tw_paging_el.addClass("remove"));var e=this.updateTableElHeight();this.widget.settings.optimize&&this.scrollerBody.height(e)},s._initCompleteCallback=function(){this.initialized=!0;var e=new CustomEvent("RendererInitialized",{bubbles:!0,cancelable:!0});if(this.widget.dispatchEvent(e),this.widget.model.updateModel(),this._getLayoutElements(),this._rearrangeColumnWidgets(),this._addAggregatedWidgets(),this._addColumnDefs(this.tableEl,this.widget.settings.childrenIdList.length),this._createScroller(),this.widget.controller.addEventListenerOnItems(),this.updateLayout(),this.updateColumnWidths(),this.updateTableWidth(),this.widget.settings.showPagingButtons&&this.widget.settings.paging&&this._setButtons(this),this.widget.settings.paging&&this._pageChange(),"function"==typeof this.afterComplete&&void 0===this.afterCompleteTimeoutId){var t=this;this.afterCompleteTimeoutId=window.setTimeout(function(){t.afterComplete(),t.afterComplete=void 0,t.afterCompleteTimeoutId=void 0},0)}},s._pageChange=function(){if(this.dt.exists()){var e=this._getDataTablePageInfo().page+1,t=this._getDataTablePageInfo().pages;this.widget.controller._pageChange(e,t)}},s.goToPage=function(e,t){var i=this._getDataTablePageInfo().page,s=this._getDataTablePageInfo().pages;switch(t){case"first":i=i>0?0:-1;break;case"last":i=i<s-1?s-1:-1;break;case"next":i=i+1<s?i+1:-1;break;case"prev":i=i-1>=0?i-1:-1;break;case"number":i="number"!=typeof e||isNaN(e)?-1:e-1<0?-1:e-1>s-1?-1:e-1;break;default:i=-1}return-1!==i&&(this.dt.goToPage(i),this.draw(!1),!0)},s._drawCallback=function(){this.initialized?(this.widget._hideBusyIndicator(),this.updateTableWidth(),this.updateTableElHeight(),this.refreshScroller(),this.widget.setTexts(),this.dt.exists()&&(this.nbrOfRows=this._getDataTablePageInfo().end-this._getDataTablePageInfo().start,this.nbrOfColumns=this.widget.settings.config.columns.length),this._colorMeBlue(),this._centerImages(),this.widget.settings.showPagingButtons&&this.widget.settings.paging&&(this._updateLastbutton(),this._setButtons(this)),this.widget.settings.paging&&this._pageChange(),this.widget.isDisabled?this.disable():this.enable(),this.widget.settings.optimize&&!this.ns&&(this.ns=new NativeScroller,this.ns.init(this.widget.elem.getElementsByClassName("dataTables_scrollBody")[0])),this.widget.eventDispatcher.dispatchEvent({type:"draw"})):this.afterComplete=this._drawCallback},s._onAggregatedWidgetsReady=function(e){e.target.id===this.searchBoxId&&(this.searchBox=brease.callWidget(this.searchBoxId,"widget"),this.searchBox.el.css("margin",this.searchBoxPadding+"px"),this.searchBox&&(this.widget.isDisabled&&this.disable(),brease.config.editMode?this._rearrangeSearchBox(this):(this._rearrangeSearchBox(this),this.widget.controller.aggregatedReadyHandler())))},s.wake=function(){},s.suspend=function(){},s.dispose=function(){window.clearTimeout(this.afterCompleteTimeoutId),$.fn.dataTable.ext.search.splice(this.internal.filterPos,1,function(){return!0}),this.internal.filterPos=-1,this._removeScroller(),this._removeResizeObserver(),this._destroy(),this._removeEventListener(),this.throttledRedraw.cancel(),this.debouncedRefreshScrollerBody.cancel()},s._addTableNode=function(e){var t=$('<table cellspacing="0"></table>');return e.prepend(t),t},s._rearrangeColumnWidgets=function(){var e=this;$.each(this.widget.model.childrenList,function(t,i){i.el.detach(),e.tw_header_el.children().append(i.el)})},s._rearrangeSearchBox=function(){var e={float:"right",width:this.searchBoxWidth};this.tw_top_bar_el.append(this.searchBox.el),this.searchBox.el.css(e)},s._addAggregatedWidgets=function(){var e={position:"relative",visibility:"hidden","z-index":1e3,height:"50px",width:"50px",top:"-"+parseInt(this.widget.el.height(),10)/2+"px","padding-left":parseInt(this.widget.el.width(),10)/2-15+"px",left:"0px"};this.widget.busyIndicatorHandler.createBusyIndicator(e),this.widget.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind("_onAggregatedWidgetsReady")),brease.uiController.createWidgets(this.widget.elem,[{className:"widgets.brease.TextInput",id:this.searchBoxId,options:{droppable:!1,omitDisabledClick:!0,tabIndex:this.widget.getTabIndex()}}],!0,this.widget.settings.parentContentId)},s._initializeDataTable=function(){if(0===this.widget.settings.config.columns.length)return!1;this.options=this._fetchDataTableOptions(),
this.dt.initializeDataTable(this.options),this._addResizeObserver(this.dt.$table.find("tbody").get(0)),this.widget.settings.optimize||this.addRows()},s._fetchDataTableOptions=function(){var e={};if(e={createdRow:function(e,t){e.setAttribute("data-recordindex",t.RecordIndex)},initComplete:_.bind(this._initCompleteCallback,this),drawCallback:_.bind(this._drawCallback,this),api:!0,autoWidth:!1,rowId:this.widget.settings.rowId,language:{search:"",paginate:{next:"Next",previous:"Previous"}},pageLength:3,paging:!0,pagingType:"simple_numbers",info:!1,dom:"<'tw_top_bar'><'tw_header' <'header-flex-container'>><'tw_table' t><'tw_paging' p>",columns:[],order:0===this.widget.settings.config.sort.length?[[this.widget.settings.childrenIdList.length,"desc"]]:this.widget.settings.config.sort,columnDefs:[{targets:-1,searchable:!1,visible:!1,orderable:!0},{targets:"_all",searchable:!0,orderable:!0}]},this.widget.settings.optimize){var t=this.widget.elem.clientHeight;this.widget.settings.searchBox&&(t-=this.topBarWrapperHeight),t-=this.widget.settings.headerHeight,e.data=this._getPreparedData(),e.scroller={rowHeight:0!==this.widget.settings.rowHeight?this.widget.settings.rowHeight:62,boundaryScale:.5},e.scrollY=t,e.deferRender=!0}else e.paging=this.widget.settings.paging,e.pageLength=this.widget.settings.itemsPerPage;return 0!==this.widget.settings.rowHeight&&(e.dom="<'tw_top_bar'><'tw_header' <'header-flex-container'>><'tw_table fixed-row-height' t><'tw_paging' p>"),e.columns=this.widget.settings.config.columns,e.language.paginate.previous=this.widget.settings.previousText,e.language.paginate.next=this.widget.settings.nextText,e},s._getDataTablePageInfo=function(){return this.dt.info()},s._addColumnDefs=function(e,t){var i=e.find("colgroup"),s=$("<col />");if(0!==i.length){$(i).empty();for(var n=0;n<t;n+=1)$(i).append(s);e.prepend(i)}else{for(var a=$("<colgroup />"),r=0;r<t;r+=1)a.append(s.clone());e.prepend(a)}},s._setColumnWidth=function(e,t,i){var s=e.find("col");$(s[t]).width(i);var n=this.widget.settings.childrenList[t];n&&Utils.isPercentageValue(n.getWidth())&&$("#"+this.widget.settings.childrenIdList[t]).css("width",i)},s._setButtons=function(){if(void 0!==this.tw_paging_el){var e=this.tw_paging_el.find(".paginate_button"),t=this.tw_paging_el.find(".ellipsis");e.addClass("widgets_brease_ToggleButton_style_default"),e.addClass("breaseButton"),e.each(function(){var e=$(this),t=e.text();e.text(""),e.append("<span>"+t+"</span>"),e.hasClass("next")||e.hasClass("previous")||e.css("width","auto").css("min-width",44),e.height(30),e.hasClass("current")&&e.addClass("active")}),void 0!==t&&this._wrapEllipsisSpan(t,e.not(".previous").not(".next").css("height"),e.not(".previous").not(".next").css("width"))}},s._updateLastbutton=function(){},s._setTableWidth=function(e,t){e.css("width",t+"px")},s._createScroller=function(){brease.config.editMode&&(this.internal.scrollerOptions.header.disableMouse=!0,this.internal.scrollerOptions.header.disableTouch=!0),this.scrollerHead=Scroller.addScrollbars(this.tw_header_el[0],this.internal.scrollerOptions.header),this.widget.settings.optimize?(this.scrollerBody=this.widget.el.find(".dataTables_scrollBody"),this.scrollerBody.on("mousewheel",this._bind("_onScrollerMouseWheel"))):this.scrollerBody=Scroller.addScrollbars(this.widget.el.find(".tw_table")[0],this.internal.scrollerOptions.body),this._addScrollListener()},s._onScrollerMouseWheel=function(e){this._hasScrollBar()&&e.stopPropagation()},s._hasScrollBar=function(){return this.scrollerBody.get(0).scrollHeight>this.scrollerBody.height()},s._addScrollListener=function(){this.scrollerBody.on("scroll",_.bind(this._scrollLinkHead,this)),this.scrollerHead.on("scroll",_.bind(this._scrollLinkBody,this)),this.widget.settings.optimize||this.widget.settings.paging||this.scrollerBody.on("scrollEnd",_.bind(this._howFarScrolledDefault,this))},s._howFarScrolledDefault=function(){Math.abs(this.scrollerBody.maxScrollY)-Math.abs(this.scrollerBody.y)<500&&this.widget.controller.howFarScrolledDefault()},s._scrollLinkHead=function(){this.widget.settings.optimize?this.scrollerHead.scrollTo(-1*this.dt.datatable.settings()[0].nScrollBody.scrollLeft,0,0):this.scrollerHead.scrollTo(this.scrollerBody.x,0,0)},s._scrollLinkBody=function(){this.widget.settings.optimize?this.dt.datatable.settings()[0].nScrollBody.scrollLeft=-1*this.scrollerHead.x:this.scrollerBody.scrollTo(this.scrollerHead.x,0,0)},s._refreshScroller=function(){this._refreshScrollerHead(),this._refreshScrollerBody()},s._refreshScrollerHead=function(){this.scrollerHead&&this.scrollerHead.refresh()},s._refreshScrollerBody=function(){this.scrollerBody&&!this.widget.settings.optimize&&this.scrollerBody.refresh()},s._removeEventListener=function(){this.widget.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_onAggregatedWidgetsReady"))},s._addResizeObserver=function(e){if("function"==typeof ResizeObserver){var renderer=this;renderer.tableBodyResizeObserver=new ResizeObserver(function(){renderer.debouncedRefreshScrollerBody()}),renderer.tableBodyResizeObserver.observe(e)}},s._removeResizeObserver=function(){this.tableBodyResizeObserver&&(this.tableBodyResizeObserver.disconnect(),this.tableBodyResizeObserver=void 0)},s._removeScroller=function(){this.scrollerBody&&(this.scrollerBody.off("mousewheel",this._bind("_onScrollerMouseWheel")),this.scrollerBody.off("scroll",_.bind(this._scrollLinkHead,this)),this.scrollerBody.off("scrollEnd",_.bind(this._howFarScrolledDefault,this)),this.widget.settings.optimize||this.scrollerBody.destroy(),this._nullifyScrollBody()),this.scrollerHead&&(this.scrollerHead.off("scroll",_.bind(this._scrollLinkBody,this)),this.scrollerHead.destroy(),this._nullifyScrollHead()),this.ns&&(this.ns.dispose(),this.ns=null)},s._nullifyScrollBody=function(){this.scrollerBody=null},s._nullifyScrollHead=function(){this.scrollerHead=null},s.displayRowInTable=function(e){this._findRow(e)&&(this.dt.show(e),this._scrollToSelectedRow())},s._findRow=function(e){return this.dt.find(e)},s._addRowSelectionFromPlugin=function(){this.dt.addRowSelectionFromPlugin()},s._scrollToSelectedRow=function(){this.widget.settings.optimize||this.scrollerBody.scrollToElement(".selected")},s._destroy=function(){this.widget.eventDispatcher.dispatchEvent({type:"before_destroy"}),this.dt.destroy(),this.tableEl=this.dt.addTableNode(this.widget.el)},s._wrapEllipsisSpan=function(e,t,i){var s=$("<a class = ellipsisSpanWrap ></a>");s.addClass("widgets_brease_ToggleButton_style_default"),s.addClass("breaseButton"),s.height(t),s.width(i),e.css("position","absolute"),e.wrap(s)},s._clickHandler=function(e){!this.widget.isEnabled()&&Utils.getOriginalEvent(e)instanceof TouchEvent&&this.tw_paging_el&&this.tw_paging_el.get(0).contains(e.target)&&e.originalEvent&&(e.originalEvent.defaultPrevented=!0)},s._getPrependedData=function(){return this.widget.model.getPrependedData()},s._getPreparedData=function(){return this.widget.model.getPreparedData()},i}),define("widgets/brease/common/ErrorHandling/libs/CommissioningErrorHandler",["brease/core/Class"],function(e){"use strict";var t=e.extend(function t(i){this.widget=i,this.init(),e.apply(this,arguments)},null),i=t.prototype;i.init=function(){this.contentId=this.widget.settings.parentContentId,this.widgetId=this.widget.elem.id,this.$overlay=null,this.numberOfReportedErrors=0},i.dispose=function(){this.$overlay&&(this.$overlay.remove(),this.$overlay=null)},i.requiredBindingMissing=function(e,t){var i=s(this.widgetId,this.contentId),n=e;void 0!==t&&(i=s(t,this.contentId)),a(this,i,"Binding for property "+n+" missing!")},i.requiredBindingsMissing=function(e){var t=s(this.widgetId,this.contentId);void 0!==e&&(t=s(e,this.contentId)),a(this,t,"Binding for properties missing!")},i.requiredBindingNodesMissing=function(){a(this,s(this.widgetId,this.contentId),"Node(s) binding for graph(s) missing!")},i.invalidPropertyValue=function(e,t){var i=s(this.widgetId,this.contentId),n=e;void 0!==t&&(i=s(t,this.contentId)),a(this,i,'Property "'+n+'" has invalid or conflicting value!')},i.requiredAncestorWidgetMissing=function(e,t){var i=s(this.widgetId,this.contentId),n;n="string"==typeof e?e:e.join(", "),void 0!==t&&(i=s(t,this.contentId)),a(this,i,"Missing an ancestor of type "+n+"!")},i.requiredParentWidgetMissing=function(e,t){var i=s(this.widgetId,this.contentId),n;n="string"==typeof e?e:e.join(", "),void 0!==t&&(i=s(t,this.contentId)),a(this,i,"Missing a parent of type "+n+"!")},i.requiredChildWidgetMissing=function(e,t){var i=s(this.widgetId,this.contentId),n;n="string"==typeof e?e:e.join(", "),void 0!==t&&(i=s(t,this.contentId)),a(this,i,"Missing a child of type "+n+"!")},i.childrenConflict=function(e,t){var i=s(this.widgetId,this.contentId),n=s(e,this.contentId);void 0!==t&&(i=s(t,this.contentId)),a(this,i,"Child "+n+" is invalid or conflicts with other children!")};function s(e,t){return e.replace(t+"_","")}function n(e){var t=$("<div />"),i={"background-color":"white",width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px",color:"red","z-index":"999"};return t.css(i),e.el.append(t),t}function a(e,t,i){if(brease.config.editMode)return!1;r(e,"ERROR: "+i+" { WidgetId: "+t+", ContentId: "+e.contentId+" }"),e._numberOfReportedErrors+=1}function r(e,t){null===e.$overlay&&(e.$overlay=n(e.widget)),e.$overlay.text().indexOf(t)<0&&e.$overlay.append("<p>"+t+"</p>"),console.error(t)}return t}),define("widgets/brease/GenericDialog/libs/config",["brease/enum/Enum"],function(Enum){"use strict";function Config(){this.id="",this.html="",this.width=void 0,this.height=void 0,this.contentHeight=void 0,this.contentWidth=void 0,this.arrow={position:"",show:!1,width:12},this.position={vertical:"middle",horizontal:"center"},this.header={text:"",textKey:""},this.widgets=[],this.forceInteraction=!1,this.pointOfOrigin=Enum.PointOfOrigin.APP,this.modal=!0,this.showCloseButton=!0,this.buttons={yes:!1,no:!1,ok:!0,cancel:!1},this.dialogResult="",this.stylePrefix="widgets_brease_GenericDialog",this.style="default"}return Config.prototype.getWidgetModelByName=function(e){for(var t=0;t<this.widgets.length;t+=1)if(this.widgets[t].name===e)return this.widgets[t];return null},Config}),define("widgets/brease/GenericDialog/libs/constants",[],function(){"use strict";function e(){return{DIALOG_ID:"GenericDialog",DIALOG_WIDGET_ID_PREFIX:"dialog_",DIALOG_INITIAL_CLASS:"breaseGenericDialog",DIALOG_WINDOW_TYPE:"GenericDialog",DIALOG_WIDGET_CLASS:"generic-dialog",DIALOG_FOOTER_CLASS:"generic-dialog-footer",DIALOG_HEADER_CLASS:"generic-dialog-header",DIALOG_FOOTER_BUTTON_CLASS:"generic-dialog-footer-button",DIALOG_CONTENT_FOOTER_CONTAINER_CLASS:"generic-dialog-content-footer-container"}}return new e}),define("widgets/brease/GenericDialog/libs/renderer",["widgets/brease/GenericDialog/libs/constants"],function(e){"use strict";function Renderer(){}var t=Renderer.prototype;t.createDialog=function(e){return $("<div/>").attr("id",e).attr("data-brease-widget","widgets/brease/GenericDialog").get(0)},t.createHeader=function(){return $("<header/>").addClass(e.DIALOG_HEADER_CLASS).get(0)},t.createHeaderContent=function(){return $("<div/>").get(0)},t.createFooter=function(){return $("<footer/>").addClass(e.DIALOG_FOOTER_CLASS).get(0)},t.createFooterContent=function(){return $("<div/>").get(0)},t.createContentFooterContainer=function(){return $("<div/>").addClass(e.DIALOG_CONTENT_FOOTER_CONTAINER_CLASS).get(0)},t.createContentContainer=function(){return $("<div/>").addClass("contentBox").get(0)},t.createContent=function(e){var t=$("<div/>").addClass("content");return e.contentWidth?t.css("width",e.contentWidth+"px"):t.css("width","auto"),e.contentHeight?t.css("height",e.contentHeight+"px"):t.css("height","auto"),t.get(0)},t.updateElementSize=function(e,t,i,s){s?($(e).css("width","auto"),$(e).css("height","auto")):($(e).css("width",t+"px"),$(e).css("height",i+"px"))},t.createWidgetElem=function(t,i){if(t&&t.type){var s=$("<div/>").addClass(e.DIALOG_WIDGET_CLASS).attr("id",t.id).attr("data-brease-widget",t.type).css("width",t.width).css("height",t.height).css("left",t.x).css("top",t.y).css("z-index",t.zIndex);i&&(t.options.className=t.type,brease.setOptions(t.id,t.options));var n=s.get(0);if(void 0!==t.content&&null!==t.content)for(var a=0;a<t.content.length;a+=1){t.content[a].id=t.id.split("_")[0]+"_"+t.content[a].name;var r=this.createWidgetElem(t.content[a],!0);null!==r&&n.appendChild(r)}return n}return null},t.createFooterButtonElement=function(t){var s=this.createWidgetElem(t,!0);return i(s,e.DIALOG_FOOTER_BUTTON_CLASS),s};function i(e,t){e.classList?e.classList.add(t):$(e).addClass(t)}return Renderer}),define("widgets/brease/GenericDialog/libs/models/dialogWidgetModel",[],function(){"use strict";function e(){this.name="widget",this.id="",this.type="",this.width="auto",this.height="auto",this.x=0,this.y=0,this.options={},this.zIndex=1}return e.fromObject=function(t){var i=new e;for(var s in t)i[s]=t[s];return i},e}),define("widgets/brease/GenericDialog/libs/enum/dialogResultEnum",[],function(){"use strict";return{NONE:"none",OK:"ok",CANCEL:"cancel",YES:"yes",NO:"no",CLOSE:"close"}}),define("widgets/brease/GenericDialog/GenericDialog",["widgets/brease/Window/Window","brease/events/BreaseEvent","brease/controller/libs/KeyActions","brease/enum/Enum","brease/core/Utils","widgets/brease/GenericDialog/libs/config","widgets/brease/GenericDialog/libs/constants","widgets/brease/GenericDialog/libs/renderer","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/GenericDialog/libs/enum/dialogResultEnum"],function(e,BreaseEvent,KeyActions,Enum,Utils,Config,t,Renderer,i,s){"use strict";var n=new Config,a=e.extend(function GenericDialog(t){this.renderer=new Renderer,this.widgetElement=t,this.elem=null,this.el=null,this.headerElem=null,this.footerElem=null,this.contentElem=null,this.data={},this.error=!1,this.closingDeferred=$.Deferred(),e.call(this,null,null,!0,!0)},n),r=a.prototype;r.init=function(i){!0!==this.settings.omitClass&&this.addInitialClass(t.DIALOG_INITIAL_CLASS),this.settings.windowType=t.DIALOG_WINDOW_TYPE,this.settings.focusEvent={start:BreaseEvent.WIDGET_READY,end:BreaseEvent.CLOSED},u(this),g(this),this._initHeader(),this._initContent(),this._initFooter(),document.body.appendChild(this.elem),e.prototype.init.call(this,i);var s=this;this.onContentParsed=function(e){o(s,e)},this.elem.addEventListener(BreaseEvent.CONTENT_PARSED,this.onContentParsed),brease.uiController.parse(this.elem)},r.show=function(config,t){config=f(config),this.settings=Utils.extendDeepToNew(this.settings,config),this.init(!1),config.zoomFactor=this._setZoom(this.el,brease.config.visuId),e.prototype.show.call(this,config,t),brease.config.visu.keyboardOperation&&(this.elem.addEventListener("keydown",this._bind("_keydownHandler")),this.elem.addEventListener("focusin",this._bind("_scrollIntoView")))},r.hide=function(){this.dispatchEvent(new CustomEvent("window_closing",{detail:{id:this.elem.id},bubbles:!0})),this.closingDeferred&&this.closingDeferred.resolve(),e.prototype.hide.call(this),this.dispose()},r.close=function(){var e=this;this.isReady().then(function(){e.settings.dialogResult=s.CLOSE,e.debouncedHide()})},r.isOpen=function(){return!(!this.closingDeferred||"pending"!==this.closingDeferred.state())},r.onClosing=function(){return this.closingDeferred.promise()},r.getDialogResult=function(){return this.settings.dialogResult},r.getWidgetByName=function(e){var t=this.settings.getWidgetModelByName(e);if(t){return brease.callWidget(t.id,"widget")}return null},r.getWidgetIdByName=function(e){return this._createWidgetId(e)},r.addWidget=function(e){if(this.getWidgetByName(e.name))return console.iatWarn("Widget already exists in Dialog!"),void 0;e.id=this._createWidgetId(e.name);var t=this.renderer.createWidgetElem(e);t&&(this.settings.widgets.push(e),this.contentElem.appendChild(t),brease.uiController.parse(t,!0),brease.uiController.setOptions(e.id,e.options))},r.removeWidget=function(e){var t=this.getWidgetByName(e.name);if(t){var i=this.settings.widgets.indexOf(e);i>-1&&this.settings.widgets.splice(i,1),brease.uiController.dispose(t.elem,!0)}},r.updateContentSize=function(e,t){this.renderer.updateElementSize(this.contentElem,e,t)},r.dispose=function(){this.elem&&(this.elem.removeEventListener("focusin",this._bind("_scrollIntoView")),this.elem.removeEventListener("keydown",this._bind("_keydownHandler")),this.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,this.onContentParsed),brease.uiController.dispose(this.elem),e.prototype.dispose.apply(this,arguments)),this.closingDeferred&&"pending"===this.closingDeferred.state()&&this.closingDeferred.reject(),this.closingDeferred=null},r._setContent=function(){},r._createRootElem=function(e){return this.renderer.createDialog(e)},r._initHeader=function(){this.headerElem&&this.settings.header&&(brease.language.isKey(this.settings.header.text)&&(this.settings.header.textkey=brease.language.parseKey(this.settings.header.text)),this.settings.header.textkey&&(this.settings.header.text=brease.language.getTextByKey(this.settings.header.textkey)),this.headerElem.textContent=this.settings.header.text)},r._initContent=function(){this._initWidgets()},r._initFooter=function(){m(this)},r._closeButtonClickhandler=function(){this.settings.dialogResult=s.CLOSE,e.prototype._closeButtonClickhandler.apply(this,arguments)},r._keydownHandler=function(e){-1!==KeyActions.getActionsForKey(e.key).indexOf(Enum.KeyAction.Close)&&this.debouncedHide()},r._scrollIntoView=function(e){e.target.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})};function o(e){e.elem.removeEventListener(BreaseEvent.CONTENT_PARSED,e.onContentParsed),e.readyHandler()}function l(e,t){t.target.classList.contains("disabled")||(e.settings.dialogResult=s.OK,e.debouncedHide())}function d(e){e.settings.dialogResult=s.CANCEL,e.debouncedHide()}function c(e){e.settings.dialogResult=s.YES,e.debouncedHide()}function h(e){e.settings.dialogResult=s.NO,e.debouncedHide()}function u(e){var i=e.settings.id||Utils.uniqueID(t.DIALOG_ID);e.elem=e._createRootElem(i),e.el=$(e.elem);var s=e.renderer.createHeader(),n=e.renderer.createHeaderContent(),a=e.renderer.createContentContainer(),r=e.renderer.createContent(e.settings),o=e.renderer.createFooter(),l=e.renderer.createFooterContent(),d=e.renderer.createContentFooterContainer();s.appendChild(n),o.appendChild(l),a.appendChild(r),e.headerElem=n,e.footerElem=l,e.contentElem=r,d.appendChild(a),d.appendChild(o),e.elem.appendChild(s),e.elem.appendChild(d)}function g(e){e.btnOkClickHandler=function(t){l(e,t)},e.btnCancelClickHandler=function(t){d(e,t)},e.btnYesClickHandler=function(t){c(e,t)},e.btnNoClickHandler=function(t){h(e,t)}}r._initWidgets=function(){var config=this.settings;if(config.widgets.length>0)for(var e=0;e<config.widgets.length;e+=1){var t=config.widgets[e];t.id=this._createWidgetId(t.name),t.options.style=config.style;var i=this.renderer.createWidgetElem(t,!0);i&&this.contentElem.appendChild(i)}},r._createWidgetId=function(e){return this.elem.id+"_"+e};function m(e){var t=null;if(e.settings.buttons.ok){t=p(e,"okButton",brease.language.getSystemTextByKey("BR/IAT/brease.common.ok"));var i=e.renderer.createFooterButtonElement(t);e.footerElem.appendChild(i),$(i).on(BreaseEvent.CLICK,e.btnOkClickHandler)}if(e.settings.buttons.cancel){t=p(e,"cancelButton",brease.language.getSystemTextByKey("BR/IAT/brease.common.cancel"));var s=e.renderer.createFooterButtonElement(t);e.footerElem.appendChild(s),$(s).on(BreaseEvent.CLICK,e.btnCancelClickHandler)}if(e.settings.buttons.yes){t=p(e,"yesButton",brease.language.getSystemTextByKey("BR/IAT/brease.common.yes"));var n=e.renderer.createFooterButtonElement(t);e.footerElem.appendChild(n),$(n).on(BreaseEvent.CLICK,e.btnYesClickHandler)}if(e.settings.buttons.no){t=p(e,"noButton",brease.language.getSystemTextByKey("BR/IAT/brease.common.no"));var a=e.renderer.createFooterButtonElement(t);e.footerElem.appendChild(a),$(a).on(BreaseEvent.CLICK,e.btnNoClickHandler)}}function p(e,t,s){var n=new i;return n.name=t,n.id=e._createWidgetId(n.name),n.type="widgets/brease/Button",n.width="100px",n.height="30px",n.options={text:s},n}r._setZoom=function(e,t){var i=brease.pageController.getVisuById(t),s=1;if(i&&i.containerId&&this.widgetElement&&(s=Utils.getScaleFactor(this.widgetElement),0===s)){var n=$(this.widgetElement).closest("[data-brease-layoutid]");n.length>0&&(s=Utils.getScaleFactor(n.get(0))),s=0===s?1:s}return e.css({transform:"scale("+s+","+s+")","transform-origin":"0 0"}),s};function f(config){if(config.position){var e=config.position;switch(e.horizontal){case"left"===e.horizontal:config.position.vertical="middle",config.arrow.position="right",config.arrow.show=!0;break;case"right"===e.horizontal:config.position.vertical="middle",config.arrow.position="left",config.arrow.show=!0;break;case"top"===e.vertical:config.position.horizontal="center",config.arrow.position="bottom",config.arrow.show=!0;break;case"bottom"===e.vertical:config.position.horizontal="center",config.arrow.position="top",config.arrow.show=!0;break;default:config.position.vertical="middle",config.position.horizontal="center",config.arrow.show=!1;break}}return config}return a}),define("widgets/brease/TableWidget/libs/Dialogue",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/GenericDialog","widgets/brease/GenericDialog/libs/config"],function(e,BreaseEvent,t,i){"use strict";var s=e.extend(function Dialogue(i){this.dialog=new t(i.elem),e.apply(this),this.widget=i},null),n=s.prototype;n.initialize=function(){},n.open=function(e){this.actualLang=this._getLanguage(),this.lang="de"!==this.actualLang?"en":"de";var t=new $.Deferred;this.setUpTexts(t,this.actualLang,this.lang,e);var i=this;$.when(t.promise()).then(function t(){var s=i.initialize(e);i.dialog.show(s,i.widget.elem),i.dialog.isReady().then(function(){$("#"+i.dialog.elem.id).on(BreaseEvent.WIDGET_READY,{type:e},i._bind("_widgetAdded")),$("#"+i.dialog.elem.id).on("window_closing",{type:e},i._bind("_collectDataBeforeClosing"))})})},n._initializeEmptyDialogConfig=function(e,t,s){this.config=new i,this.config.forceInteraction=!0,this.config.contentWidth=s||600,this.config.contentHeight=t||480,this.config.header.text=e,this.config.buttons.ok=!0,this.config.buttons.cancel=!0},n._widgetAdded=function(e){var t=e.data.type;$("#"+this.dialog.elem.id).off(BreaseEvent.WIDGET_READY,this._bind("_widgetAdded")).addClass("system_brease_TableConfigurationDialog_style_default"),this[t].initialize()},n._collectDataBeforeClosing=function(e){if(brease.uiController.parentWidgetId(e.target)===this.dialog.elem.id){var t=e.data.type;this[t].removeEventListeners(),"ok"===this.dialog.getDialogResult()&&(this.widget.settings.config[t]=this[t]._widgetCollectStateBeforeClosing(),this.widget.controller&&this.widget.controller.draw(),this.widget.sendConfiguration(t))}},n._addRowHandler=function(e){this.filter._addRowHandler(e)},n._getLanguage=function(){return brease.language.getCurrentLanguage()},n.setUpTexts=function(){};function a(e){e.filter._reColourFirstLineSeparator()}return n.dispose=function(){this.dialog.dispose(),e.prototype.dispose.call(this)},s}),define("widgets/brease/TableWidget/libs/PageEventDispatcher",["brease/core/Types"],function(Types){"use strict";var PageEventDispatcher=function(){this.currentPage=0,this.lastPage=0,this.maxPageNumber=1},e=["FirstPageNumber","PreviousPageNumber","CurrentPageNumber","NextPageNumber","LastPageNumber"],t=PageEventDispatcher.prototype;t.init=function(e){"function"==typeof e&&(this.callback=e)},t.hasCallback=function(){return"function"==typeof this.callback},t.setCurrentPage=function(e){this.currentPage=Types.parseValue(e,"Integer",{min:0,default:0})},t.getCurrentPage=function(){return this.currentPage},t.setLastPage=function(e){this.lastPage=Types.parseValue(e,"Integer",{min:0,default:0}),this.maxPageNumber=Types.parseValue(this.lastPage,"Integer",{min:1,default:1})},t.getLastPage=function(){return this.lastPage},t.getMaxPageNumber=function(){return this.maxPageNumber},t.dispatchEvent=function(e){var t=this.createPageEvent(e);this.hasCallback()&&null!==t&&this.callback(e,t)},t.createPageEvent=function(e){return i.call(this,e)},t.getEventTypes=function(){return e},t.dispose=function(){this.callback=null};function i(e){var t={pageNumber:1,pageText:"",show:!1,select:0};switch(e){case"FirstPageNumber":t.pageNumber=Types.parseValue(1,"Integer",{min:1,max:this.maxPageNumber,default:1}),t.show=1!==this.currentPage,t.select=1===this.currentPage|0;break;case"PreviousPageNumber":t.pageNumber=Types.parseValue(this.currentPage-1,"Integer",{min:1,max:Math.max(this.maxPageNumber-1,1),default:1}),t.show=this.lastPage>0,t.select=1===this.currentPage|0;break;case"CurrentPageNumber":t.pageNumber=Types.parseValue(this.currentPage,"Integer",{min:1,max:this.maxPageNumber,default:1}),t.show=this.lastPage>1,t.select=0|(1!==this.currentPage&&this.currentPage!==this.lastPage||1!==this.currentPage&&this.lastPage<3),t.pageAlternativeNumber=this.currentPage===this.lastPage&&this.lastPage>2?this.lastPage-1:1===this.currentPage?2:2===this.currentPage?2:this.currentPage,t.pageAlternativeText=t.pageAlternativeNumber.toString();break;case"NextPageNumber":t.pageNumber=Types.parseValue(this.currentPage+1,"Integer",{min:1,max:this.maxPageNumber,default:1}),t.show=this.lastPage>2,t.select=this.currentPage===this.lastPage|0;break;case"LastPageNumber":t.pageNumber=this.maxPageNumber,t.show=this.currentPage!==this.lastPage&&this.lastPage>1,t.select=this.currentPage===this.lastPage|0;break;default:return null}return 0===this.lastPage&&(t.pageNumber=0),t.pageText=t.pageNumber.toString(),t}return PageEventDispatcher}),define("widgets/brease/TableWidget/libs/Controller",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/common/ErrorHandling/libs/CommissioningErrorHandler","widgets/brease/TableWidget/libs/Dialogue","widgets/brease/TableWidget/libs/PageEventDispatcher"],function(e,BreaseEvent,t,i,PageEventDispatcher){"use strict";var s=e.extend(function Controller(t){e.call(this),this.pageEventDispatcher=new PageEventDispatcher,this.widget=t},null),n=s.prototype;n.initialize=function(){l(this),this._addClassSpecificEventListeners(this),this.errorHandler=new t(this.widget),this.internal={timer:[],firstItr:!0};var e=this;this.widgetReady=new $.Deferred,this.childrenReady=new $.Deferred,$.when(this.widgetReady.promise(),this.childrenReady.promise()).done(e._bind("_allReadyHandler")),this.selectedItem=void 0},n._addClassSpecificEventListeners=function(){},n.languageChanged=function(){},n.getEventItem=function(e){},n.setSelectedItem=function(e){this.selectedItem=e},n.draw=function(){this.widget.renderer.redraw()},n.filterDraw=function(){this.widget.renderer.draw()},n.dispatchItemClickEvent=function(e,t){void 0!==e&&this.widget._itemClickHandler(this.getEventItem(e),t)},n.dispatchDoubleItemClickEvent=function(e,t){void 0!==e&&this.widget._itemDoubleClickHandler(this.getEventItem(e),t)},n.getSelectedItem=function(){return!this.widget.isDisabled&&this.selectedItem},n.aggregatedReadyHandler=function(){this.widget.elem.addEventListener("ValueChanged",this._bind("_submitSearchValueHandler"))},n.childrenInitializedHandler=function(){this.childrenReady.resolve()},n.openConf=function(e){this.configDialogue=new i(this.widget),this.configDialogue.open(e)},n.filterData=function(e){this.widget.renderer.setFilter(e)},n._allReadyHandler=function(){this.widget.model.start(),this.widget.renderer.start(),this.widget.setTexts()},n._submitSearchValueHandler=function(e){e.srcElement.id===this.widget.renderer.searchBoxId&&this.widget.model.setSearch(e.detail.value)},n._itemDoubleSelectHandler=function(e,t,i,s,n){if(this.widget.isDisabled)return!1;var a=$(e.target).closest("tr");this.dispatchDoubleItemClickEvent(this.widget.renderer.index(a),e)},n._mouseDownHandler=function(e){if(this.widget.isDisabled)return!1;this.movingSelection=$(e.target).closest("tr"),this.movingSelection.addClass("mousedown"),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler"))},n._mouseUpHandler=function(e){this.movingSelection.removeClass("mousedown"),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler"))},n._itemSelectHandler=function(e,t,i,s,n){if(this.widget.isDisabled)return!1;var a=$(e.target).closest("tbody").find("tr.selected"),r=$(e.target).closest("tr");a[0]!==r[0]&&(this.widget.renderer.deselect(),this.widget.renderer.select(r),this.setSelectedItem(this._getRowIndex())),this.dispatchItemClickEvent(this.widget.renderer.index(r),e)},n._widgetReadyHandler=function(e){brease.uiController.parentWidgetId(e.target)===this.widget.elem.id&&(this.widget.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),this.widgetReady.resolve())},n._pageChange=function(e,t){var i=this.widget;this.pageEventDispatcher.setCurrentPage(e),this.pageEventDispatcher.setLastPage(t);for(var s=this.pageEventDispatcher.getEventTypes(),n,a=0;a<s.length;a++)n=this.pageEventDispatcher.createPageEvent(s[a]),null!==n&&i._pageChangeHandler(s[a],n)},n.goToPage=function(e,t){return this.widget.renderer.goToPage(e,t)},n._setMissingBindingErrorMsg=function(){this.errorHandler.requiredBindingMissing("mpLink")},n.addEventListenerOnItems=function(){for(var e=0;e<this.widget.settings.childrenList.length;e+=1)brease.callWidget(this.widget.settings.childrenIdList[e],"appendEventListeners")},n.disable=function(){this.widget.renderer.disable();for(var e=0;e<this.widget.settings.childrenList.length;e+=1)brease.callWidget(this.widget.settings.childrenIdList[e],"disable")},n.enable=function(){this.widget.renderer.enable();for(var e=0;e<this.widget.settings.childrenList.length;e+=1)brease.callWidget(this.widget.settings.childrenIdList[e],"enable")},n.dispose=function(){this.pageEventDispatcher.dispose(),this.widget.elem.removeEventListener("ColumnWidthChanged",_.bind(a,this)),this.widget.elem.removeEventListener("ColumnTypeChanged",_.bind(r,this)),this.widget.elem.removeEventListener("ColumnOrderChanged",_.bind(o,this)),this.widget.elem.removeEventListener("RendererInitialized",this._bind("_rendererInitialized")),this.widget.elem.removeEventListener("ValueChanged",this._bind("_submitSearchValueHandler")),this.widget.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),this.widget.renderer.tableEl.off(BreaseEvent.CLICK,this._bind("_itemSelectHandler")),this.widget.renderer.tableEl.off(BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler")),this.widget.renderer.tableEl.off(BreaseEvent.DBL_CLICK,this._bind("_itemDoubleSelectHandler"))},n._getCurrentDataRow=function(){return this.widget.renderer.getCurrentRow()},n._getRowIndex=function(){return this.widget.renderer.getRowIndex()},n._getRowIndices=function(){return this.widget.renderer.getRowIndices()};function a(e){this.widget.renderer.refreshScroller(),this.widget.model.updateModel();var t=this.widget.model.childrenIdList.indexOf(e.detail.id);this.widget.renderer.setColumnWidth(t,this.widget.model.columnWidths[t]),this.widget.renderer.setTableWidth(this.widget.model.maxWidth)}function r(){this.widget.renderer.rebuildView()}function o(e){for(var t=0;t<this.widget.settings.childrenIdList.length;t+=1)this.widget.settings.childrenIdList[t]!==e.detail.id&&brease.callWidget(this.widget.settings.childrenIdList[t],"resetOrdering");this.widget.renderer.updateOrder(e.detail)}n._rendererInitialized=function(e){this.widget.renderer.tableEl.on(BreaseEvent.CLICK,this._bind("_itemSelectHandler")),this.widget.renderer.tableEl.on(BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler")),this.widget.renderer.tableEl.on(BreaseEvent.DBL_CLICK,this._bind("_itemDoubleSelectHandler"));var t=this.widget.elem.querySelector(".dataTables_scrollBody");null!==t&&t.addEventListener("scroll",this._bind("_howFarScrolled")),this.widget.el.on("page.dt",this._bind("_howFarPaged"))},n._howFarScrolled=function(e){var t=this.widget.elem.querySelector(".dataTables_scrollBody")
;t.offsetHeight+t.scrollTop>=t.scrollHeight-500&&this._scrolledToBottom(e)},n.howFarScrolledDefault=function(e){this._scrolledToBottom(e)},n._scrolledToBottom=function(e){},n._howFarPaged=function(e){var t=this.widget.renderer._getDataTablePageInfo();t.pages-1===t.page&&this._scrolledToBottom()};function l(e){e.widget.elem.addEventListener(BreaseEvent.WIDGET_READY,e._bind("_widgetReadyHandler")),e.widget.elem.addEventListener("ColumnWidthChanged",_.bind(a,e)),e.widget.elem.addEventListener("ColumnTypeChanged",_.bind(r,e)),e.widget.elem.addEventListener("ColumnOrderChanged",_.bind(o,e)),e.widget.elem.addEventListener("RendererInitialized",e._bind("_rendererInitialized"))}return s}),define("widgets/brease/TableWidget/libs/Model",["brease/core/Class","brease/core/Utils","brease/helper/DateFormatter"],function(e,Utils,DateFormatter){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t,this.settings=t.settings},t),s=i.prototype;return s.initialize=function(){this.childrenList=this.widget.settings.childrenList,this.childrenIdList=this.widget.settings.childrenIdList,this.internal={dataPrepended:!1},this.columnWidths=this.widget.settings.childrenColumnWidths,this.errorMode=!1,this.maxWidth=0,this.columns=[],this.data=[]},s.start=function(){this.updateModel()},s.updateModel=function(){this.getColumns(),this.getColumnWidths(),this.getMaxWidth(),brease.config.editMode?this.setMockData():this.updateTable(),this.widget.controller.setSelectedItem(void 0)},s.getRowFromCurrentData=function(e){return this.currentData[e]},s.getCurrentData=function(){return this.currentData},s.getPreparedData=function(){return this.data},s.getPreparedDataToPrepend=function(){return this.prependData},s.setSearch=function(e){this.widget.renderer.setSearch(e)},s.getColumns=function(){for(var e=[],t=0;t<this.settings.childrenIdList.length;t+=1)e.push(brease.callWidget(this.settings.childrenIdList[t],"getShortColumnType"));e.push($.extend(!0,{},this.settings.config.hidden)),this.settings.config.columns=e},s.getColumnWidths=function(){for(var e=[],t=0;t<this.settings.childrenIdList.length;t+=1){var i=brease.callWidget(this.settings.childrenIdList[t],"getWidth");i=Utils.isPercentageValue(i)?Utils.getPercentageWidth(i,this.widget.elem):parseInt(i,10),e.push(i)}this.columnWidths=e},s.updateTable=function(){for(var e={},t=0;t<this.settings.childrenIdList.length;t+=1)e[this.settings.config.columns[t].data]="This is col "+t+"!";if(this.data=[],brease.config.editMode)for(var i=0;i<5;i+=1)this.data.push(e);else for(var s=0;s<12;s+=1)this.data.push(e)},s.setMockData=function(){this.updateTable()},s._fixTimestamp=function(e){if(!e)return{display:"",value:0};var t,i=new Date(e.substring(0,23));return DateFormatter.format(i,this.widget.settings.format,function(e){t=e}),{display:t,value:i.getTime()}},s.getMaxWidth=function(){for(var e=0,t=0;t<this.settings.childrenIdList.length;t+=1)e+=this.columnWidths[t];this.maxWidth=e},s.dataPrepended=function(){return this.internal.dataPrepended},s.getPrependedData=function(){return this.telegram},s.suspend=function(){},s.dispose=function(){},i}),define("widgets/brease/TableWidget/libs/FocusHandler",["brease/controller/libs/FocusElem","brease/events/BreaseEvent","brease/enum/Enum","brease/controller/libs/KeyActions","brease/core/Utils","brease/events/VirtualEvents"],function(FocusElem,BreaseEvent,Enum,KeyActions,Utils,VirtualEvents){"use strict";var FocusHandler=function(e){this.widget=e,this.focusElems=[],this.focusPosition=0,this.scrollTime=100,this.rows=[],this.headerCells=[],this.dimensions={},this.zoomFactor=1,W(e.getTabIndex())&&(this._onDrawBinded=this.onDraw.bind(this),this._onBeforeDestroyBinded=this.onBeforeDestroy.bind(this),this.widget.eventDispatcher.addEventListener("draw",this._onDrawBinded),this.widget.eventDispatcher.addEventListener("before_destroy",this._onBeforeDestroyBinded),this.widget.el.on(BreaseEvent.BEFORE_ENABLE_CHANGE,y.bind(this)),this.widget.el.on(BreaseEvent.BEFORE_VISIBLE_CHANGE,w.bind(this)),this._boundUpdateZoomFactor=C.bind(this),document.body.addEventListener(BreaseEvent.APP_RESIZE,this._boundUpdateZoomFactor))},e=FocusHandler.prototype,t="elementFocus";e.focus=function(){if(brease.config.visu.keyboardOperation){if(!(this.focusElems.length>0))return null;this.focusElems[0].elem.focus({preventScroll:!0})}},e.dispose=function(){this.widget.eventDispatcher.removeEventListener("draw",this._onDrawBinded),this.widget.eventDispatcher.removeEventListener("before_destroy",this._onBeforeDestroyBinded),this.widget.el.off(BreaseEvent.BEFORE_ENABLE_CHANGE),this.widget.el.off(BreaseEvent.BEFORE_VISIBLE_CHANGE),document.body.removeEventListener(BreaseEvent.APP_RESIZE,this._boundUpdateZoomFactor)},e.onBeforeDestroy=function(){v.call(this,this.rows),this.focusElems.forEach(function(e){e.dispose()}),this.focusElems=[]},e.onDraw=function(){this.onBeforeDestroy(),i.call(this),n.call(this),r.call(this)};function i(){var e=this;this.headerEl=this.widget.el.find(".tw_header");var t=new FocusElem(this.headerEl.get(0),s.call(this));this.focusElems.push(t),this.headerEl.off("focus").on("focus",o.bind(this)),this.headerEl.off("blur").on("blur",l.bind(this)),this.headerEl.off(BreaseEvent.CLICK).on(BreaseEvent.CLICK,function(t){m.call(e,t,e.headerCells)}),this.headerCells=this.widget.settings.childrenList.map(function(e){return e.elem})}function s(){return{tabIndex:this.widget.settings.tabIndex,parentContentId:this.widget.getParentContentId(),enable:this.widget.isEnabled(),omitFocusStyle:!0}}function n(){if(this.rows=Array.from(this.widget.elem.querySelectorAll("tbody>tr")).filter(function(e){return!e.children[0].classList.contains("dataTables_empty")}),this.tableEl=this.widget.el.find(".tw_table"),this.rows.length>0){var e=this,t=new FocusElem(this.tableEl.get(0),s.call(this));this.focusElems.push(t),this.tableEl.off("focus").on("focus",f.bind(this)),this.tableEl.off("blur").on("blur",b.bind(this)),this.tableEl.off(BreaseEvent.CLICK).on(BreaseEvent.CLICK,function(t){m.call(e,t,e.rows)}),C.call(this),a.call(this)}else this.tableEl.get(0).removeAttribute("tabIndex")}function a(){document.activeElement===this.tableEl.get(0)&&(void 0===this.rows[this.focusPosition]&&(this.focusPosition=this.rows.length-1),p.call(this,this.rows,this.focusPosition))}function r(){for(var e=this.widget.el.find(".paginate_button"),t=0;t<e.length;++t){var i=e[t],n=s.call(this);n.omitFocusStyle=!1,n.enable=!i.classList.contains("disabled");var a=new FocusElem(i,n);this.focusElems.push(a)}x.call(this,e),E.call(this,e)}function o(e){var i=this;this.headerCells[this.focusPosition].classList.add(t),$(e.target).on("keydown",function(e){d.call(i,e,i.headerCells)})}function l(e){$(e.target).off("keydown"),v.call(this,this.headerCells),this.focusPosition=0}function d(e,t){var i=KeyActions.getActionForKey(e.key);i===Enum.KeyAction.Accept?F(t[this.focusPosition],e):e.currentTarget===this.tableEl.get(0)?c.call(this,e,i):h.call(this,e,i)}function c(e,t){t===Enum.KeyAction.ScrollDown?(H(e),u.call(this,this.rows)):t===Enum.KeyAction.ScrollUp?(H(e),g.call(this,this.rows)):t===Enum.KeyAction.ScrollDownFast?(H(e),N.call(this)):t===Enum.KeyAction.ScrollUpFast&&(H(e),R.call(this))}function h(e,t){t===Enum.KeyAction.ScrollRight?(H(e),u.call(this,this.headerCells)):t===Enum.KeyAction.ScrollLeft&&(H(e),g.call(this,this.headerCells))}function u(e){e[this.focusPosition].classList.remove(t),this.focusPosition++,this.focusPosition>=e.length&&(this.focusPosition=0),e[this.focusPosition].classList.add(t),T.call(this,e[this.focusPosition])}function g(e){e[this.focusPosition].classList.remove(t),this.focusPosition--,this.focusPosition<0&&(this.focusPosition=e.length-1),e[this.focusPosition].classList.add(t),T.call(this,e[this.focusPosition])}function m(e,t){if(this.widget.isEnabled()){var i=t.findIndex(function(t){return t.contains(e.target)});i>=0&&i!==this.focusPosition&&(e.currentTarget.focus(),p.call(this,t,i))}}function p(e,i){e[this.focusPosition].classList.remove(t),this.focusPosition=i,e[this.focusPosition].classList.add(t)}function f(e){var i=this;this.rows[this.focusPosition].classList.add(t),T.call(this,this.rows[this.focusPosition]),$(e.target).on("keydown",function(e){d.call(i,e,i.rows)})}function b(e){$(e.target).off("keydown"),v.call(this,this.rows),this.focusPosition=0}function v(e){e.forEach(function(e){e.classList.remove(t)})}function y(e){if(e.target===this.widget.elem){e.detail.value?this.focusElems.forEach(function(e){e.elem.classList.contains("paginate_button")||e.enable()}):(v(this.rows),v(this.headerCells),this.focusElems.forEach(function(e){e.elem.classList.contains("paginate_button")||e.disable()}))}}function w(e){if(e.target===this.widget.elem){var t=e.detail.value,i=this.widget.elem.querySelectorAll(".tw_top_bar .breaseTextInput")[0];i&&i.dispatchEvent(new CustomEvent(BreaseEvent.BEFORE_VISIBLE_CHANGE,{detail:{value:t},bubbles:!0})),t?this.focusElems.forEach(function(e){e.show()}):(v(this.rows),v(this.headerCells),this.focusElems.forEach(function(e){e.hide()}))}}function x(e){var t=this;e.off(BreaseEvent.MOUSE_UP).on(BreaseEvent.MOUSE_UP,function(e){t.prevFocusedButtonIdx=parseInt(e.target.dataset.dtIdx,10),e.target.classList.contains("current")&&window.setTimeout(function(){e.target.focus()},1)}),void 0!==this.prevFocusedButtonIdx&&I.call(this,e,this.prevFocusedButtonIdx),t.prevFocusedButtonIdx=void 0}function E(e){var t=this;e.off("keydown").on("keydown",function(e){KeyActions.getActionForKey(e.key)===Enum.KeyAction.Accept&&(t.prevKeyFocusedButtonIdx=parseInt(e.target.dataset.dtIdx,10))}),void 0!==this.prevKeyFocusedButtonIdx&&document.activeElement.isSameNode(document.body)&&I.call(this,e,this.prevKeyFocusedButtonIdx),t.prevKeyFocusedButtonIdx=void 0}function I(e,t){e[t].classList.contains("disabled")?e[t].classList.contains("previous")?e[t+1].focus():(e[t-1].focus(),brease.focusManager.focusNext()):e[t].focus()}function C(){this.tableEl&&(this.zoomFactor=Utils.getScaleFactor(this.tableEl.get(0)),delete this.dimensions.rowHeight,delete this.dimensions.height)}function _(){return this.dimensions.rowHeight||(this.dimensions.rowHeight=this.rows[0].getBoundingClientRect().height),this.dimensions.rowHeight}function S(){if(!this.dimensions.height){var e=this.tableEl.get(0),t=e.getBoundingClientRect();this.dimensions.height=t.height}return this.dimensions.height}function T(e){var t;this.rows.includes(e)?(t=this.widget.getScroller(),t&&e&&!D.call(this,e)&&t.scrollToElement(e,this.scrollTime,0,!0)):(t=this.widget.getHeaderScroller(),t&&e&&!A.call(this,e)&&t.scrollToElement(e,this.scrollTime,!0,0))}function D(e){var t=L.call(this),i=O.call(this,e),s=_.call(this),n=S.call(this),a=i*s-t;return a>=0&&a+s<=n}function A(e){var t=P.call(this),i=e.offsetLeft-t,s=e.offsetWidth;return i>=0&&i+s<=this.headerEl.get(0).offsetWidth}function L(){var e=this.widget.getScroller();return e?"function"==typeof e.scrollBy?Math.abs(e.y)*this.zoomFactor:this.tableEl.get(0).getElementsByClassName("dataTables_scrollBody")[0].scrollTop*this.zoomFactor:0}function P(){var e=this.widget.getHeaderScroller();return e?Math.abs(e.x):0}function O(e){return Array.prototype.indexOf.call(this.rows,e)}function N(){var e=B.call(this),t=O.call(this,this.rows[this.focusPosition]);if(e===t){var i=_.call(this),s=S.call(this),n=Math.max(1,k(s,i)-1),a=this.rows.length-1,r=Math.min(t+n,a);if(r>t){p.call(this,this.rows,r);var o=this.rows[this.focusPosition];V.call(this,o,-Math.trunc(s-i)/this.zoomFactor)}}else p.call(this,this.rows,e)}function k(e,t){return Math.ceil(e/t)-1}function R(){var e=M.call(this),t=O.call(this,this.rows[this.focusPosition]);if(e===t){var i=_.call(this),s=S.call(this),n=Math.max(1,k(s,i)-1),a=Math.max(t-n,0);if(a<t){p.call(this,this.rows,a);var r=this.rows[this.focusPosition];V.call(this,r,0)}}else p.call(this,this.rows,e)}function B(){var e=_.call(this),t=L.call(this),i=S.call(this),s=(i+t)/e,n=Utils.roundTo(s,2),a=Math.floor(n)-1,r=this.rows.length-1;return Math.min(a,r)}function M(){var e=_.call(this),t=L.call(this),i=t/e,s=Utils.roundTo(i,2),n=Math.ceil(s);return Math.max(n,0)}function V(e,t){var i=this.widget.getScroller();i&&e&&i.scrollToElement(e,this.scrollTime,0,t)}function W(e){return brease.config.isKeyboardOperationEnabled()&&e>-1&&!brease.config.editMode}function H(e){e.stopPropagation(),e.preventDefault()}function F(e,t){var i=BreaseEvent.CLICK,s=e.getBoundingClientRect(),n=new MouseEvent(i.substring(1),{bubbles:!0,cancelable:!0,clientX:s.left,clientY:s.top,view:window});n.originalEvent=t,VirtualEvents.triggerVirtualEvent(e,i,n,{pointerId:0})}return FocusHandler}),define("widgets/brease/TableWidget/libs/ConfigBuilder",[],function(){"use strict";function ConfigBuilder(){}var e=ConfigBuilder.prototype;return e.parse=function(e,t,i){var s;switch(e){case"filter":case"Filter":s=this._parseFilter(t,i);break;case"sort":case"Sort":s=this._parseSort(t,i);break;case"style":case"Style":s=this._parseStyle(t,i);break;default:s={};break}return s},e.serialize=function(e,t){var i="";switch(e){case"filter":case"Filter":i=this._serializeFilter(t);break;case"sort":case"Sort":i=this._serializeSort(t);break;case"style":case"Style":i=this._serializeStyle(t);break}return i},e._parseFilter=function(e,t){if(void 0===e||""===e||null===e)return[];var i=this._parseJSON(e,"filter",t);if(void 0===i||void 0===i.length||0===i.length)return[];var s={},n=[],a;for(a=0;a<i.length;a+=1)s.opVal=this._convertOp(i[a].conditionType),s.data=i[a].columnType,s.comp=i[a].value,s.logVal=this._convertLogVal(i[a].logicalOperator),s.logical=i[a].logicalOperator,void 0!==i[a].useAlarmState&&(s.ext="true"===i[a].useAlarmState||!0===i[a].useAlarmState,s.extCompVal=i[a].alarmState),n.push($.extend(!0,{},s));return n[a-1].logical="",n},e._serializeFilter=function(e){if(void 0===e||""===e)return[];for(var t={},i=[],s=0;s<e.length;s+=1)t.logicalOperator=this._deconvertLogVal(e[s].logVal),t.value=e[s].comp,t.conditionType=this._deconvertOp(e[s].opVal),t.columnType=e[s].data,void 0!==e[s].ext&&(t.useAlarmState=e[s].ext,t.alarmState=e[s].extCompVal),i.push($.extend(!0,{},t));return JSON.stringify(i)},e._parseSort=function(e,t){if(void 0===e||""===e||null===e)return[];var i=this._parseJSON(e,"sort",t);return void 0===i||void 0===i.length||0===i.length?[]:i},e._serializeSort=function(e){return void 0===e||""===e?[]:JSON.stringify(e)},e._parseStyle=function(e,t){if(void 0===e||""===e||null===e)return[];var i=this._parseJSON(e,"style",t);if(void 0===i||void 0===i.length||0===i.length)return[];for(var s={},n=[],a=0;a<i.length;a+=1)void 0!==i[a].alarmState?(s.namePos=i[a].styleNbr,s.statePos=i[a].alarmState,s.sevTwoOp=this._convertLogVal(i[a].logicalOperator),s.sevOneUse=i[a].severity[0].useState,s.sevOne=i[a].severity[0].value,s.sevOnePos=this._convertOp(i[a].severity[0].conditionType),s.sevTwoUse=i[a].severity[1].useState,s.sevTwo=i[a].severity[1].value,s.sevTwoPos=this._convertOp(i[a].severity[1].conditionType)):(s.namePos=i[a].styleNbr,s.statePos=i[a].type),n.push($.extend(!0,{},s));return n},e._serializeStyle=function(e){if(void 0===e||""===e)return[];for(var t={},i=[],s={},n={},a=0;a<e.length;a+=1)void 0!==e[a].sevOneUse?(t.styleNbr=e[a].namePos,t.alarmState=e[a].statePos,t.logicalOperator=this._deconvertLogVal(e[a].sevTwoOp),t.severity=[],s.useState=e[a].sevOneUse,s.value=e[a].sevOne,s.conditionType=this._deconvertOp(e[a].sevOnePos),t.severity.push(s),n.useState=e[a].sevTwoUse,n.value=e[a].sevTwo,n.conditionType=this._deconvertOp(e[a].sevTwoPos),t.severity.push(n)):(t.styleNbr=e[a].namePos,t.type=e[a].statePos),i.push($.extend(!0,{},t));return JSON.stringify(i)},e._parseJSON=function(e,t,i){try{return JSON.parse(e)}catch(e){console.warn("The json for the",t,"configuration in the",i,"is invalid")}},e._convertLogVal=function(e){var t;switch(e){case"and":t=0;break;case"or":t=1;break}return t},e._deconvertLogVal=function(e){var t;switch(e){case 0:t="and";break;case 1:t="or";break}return t},e._convertOp=function(e){var t;switch(e){case"<>":t=0;break;case"==":t=1;break;case"<":t=2;break;case"<=":t=3;break;case">":t=4;break;case">=":t=5;break;case"Contains":t=6;break;case"Does not contain":t=7;break}return t},e._deconvertOp=function(e){var t;switch(e){case 0:t="<>";break;case 1:t="==";break;case 2:t="<";break;case 3:t="<=";break;case 4:t=">";break;case 5:t=">=";break;case 6:t="Contains";break;case 7:t="Does not contain";break}return t},ConfigBuilder}),define("widgets/brease/common/BusyIndicatorHandler/libs/BusyIndicatorHandler",["brease/core/Class","brease/core/Utils"],function(e,Utils){"use strict";var BusyIndicatorHandler=e.extend(function BusyIndicatorHandler(t){e.apply(this,arguments),this.widget=t},null),t=BusyIndicatorHandler.prototype;return t.dispose=function(){var e=this.widget;this._resetTimeout(),this.widget.busyWrapper&&brease.uiController.dispose(e.busyWrapper,!1,function(){e.busyWrapper.remove(),e.busyWrapper=null,e.busyId=null,e.busyIndicator=null})},t._resetTimeout=function(){this.busyIndicatorTimout&&(window.clearTimeout(this.busyIndicatorTimout),this.busyIndicatorTimout=null)},t._setTimeout=function(e,t){this._resetTimeout(),this.busyIndicatorTimout=window.setTimeout(function(){e.busyWrapper.css("visibility","visible")},t)},t.showBusyIndicator=function(){if(!(brease.config.editMode||this.widget.settings.busyIndicatorDelay<0)&&this.widget.busyWrapper){var e=0;this.widget.settings.busyIndicatorDelay&&(e=this.widget.settings.busyIndicatorDelay),0===e?this.widget.busyWrapper.css("visibility","visible"):this._setTimeout(this.widget,e)}},t.hideBusyIndicator=function(){this.widget.busyWrapper&&(this.widget.busyWrapper.css("visibility","hidden"),this._resetTimeout())},t.createBusyIndicator=function(e){var t=this.widget,i={"z-Index":"9999",position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%","background-color":"#fff",opacity:.5,display:"inline-flex","align-items":"center","justify-content":"center",visibility:"hidden"};e&&(i=e),t.busyWrapper||(t.busyId=Utils.uniqueID(t.elem.id+"_busyIndicator"),t.busyWrapper=$('<div class="busyWrapper"/>'),t.busyWrapper.css(i),t.el.append(t.busyWrapper),brease.uiController.createWidgets(t.busyWrapper[0],[{className:"widgets.brease.BusyIndicator",id:t.busyId,options:{}}],!0,t.settings.parentContentId))},BusyIndicatorHandler}),define("widgets/brease/common/libs/BreaseResizeObserver",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var BreaseResizeObserver=function(e,t){this.initialized=!1,this.active=!1,e instanceof Element?this.elem=e:(this.elem=null,console.warn("BreaseResizeObserver parameter elem is not an instance of Element")),this.callback="function"==typeof t?t:function(){},this.boundOnResize=this.onResize.bind(this)},e=BreaseResizeObserver.prototype;e.init=function(){t.call(this),this.initialized=!0,this.active=!0,this.callback()},e.wake=function(){t.call(this),this.active=!0,this.callback()},e.suspend=function(){this.active=!1,t.call(this,!0)},e.dispose=function(){this.initialized=!1,this.active=!1,t.call(this,!0),this.elem=null,this.callback=null},e.onResize=function(e){e.target.contains(this.elem)&&this.callback()};function t(e){var t=!0===e?"off":"on",i=!0===e?"removeEventListener":"addEventListener";this.active||($(this.elem instanceof Element?this.elem.closest(".breaseFlexBoxItem"):null)[t]("FlexSizeChanged",this.callback),brease.config.editMode&&(document.body[i](BreaseEvent.WIDGET_PROPERTIES_CHANGED,this.boundOnResize),document.body[i](BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this.boundOnResize),document.body[i](BreaseEvent.WIDGET_RESIZE,this.boundOnResize)))}return BreaseResizeObserver}),define("widgets/brease/TableWidget/TableWidget",["widgets/brease/DataHandlerWidget/DataHandlerWidget","brease/events/EventDispatcher","brease/events/BreaseEvent","brease/enum/Enum","widgets/brease/TableWidget/libs/Renderer","widgets/brease/TableWidget/libs/Controller","widgets/brease/TableWidget/libs/Model","widgets/brease/TableWidget/libs/FocusHandler","brease/decorators/CultureDependency","brease/decorators/MeasurementSystemDependency","brease/decorators/VisibilityDependency","widgets/brease/TableWidget/libs/ConfigBuilder","widgets/brease/common/BusyIndicatorHandler/libs/BusyIndicatorHandler","widgets/brease/common/libs/BreaseResizeObserver","brease/decorators/ContentActivatedDependency"],function(e,EventDispatcher,BreaseEvent,Enum,Renderer,Controller,Model,FocusHandler,CultureDependency,MeasurementSystemDependency,VisibilityDependency,ConfigBuilder,BusyIndicatorHandler,BreaseResizeObserver,t){"use strict";var i={childrenInitialized:!1,childrenList:[],childrenIdList:[],childrenColumnWidths:[],counter:0,headerHeight:40,itemsPerPage:3,searchBox:!0,optimize:brease.config.WidgetData.renderingPolicy===Enum.RenderingPolicy.PERFORMANCE,paging:!0,showPagingButtons:brease.config.WidgetData.renderingPolicy===Enum.RenderingPolicy.DEFAULT,nextText:"Next",previousText:"Previous",nextTextKey:null,previousTextKey:null,rowHeight:0,format:"F",formatKey:"",filterConfiguration:"",sortConfiguration:"",styleConfiguration:"",config:{hidden:{data:""}},busyIndicatorDelay:0,focusable:!1},s=e.extend(function TableWidget(){e.apply(this,arguments)},i),n=s.prototype;return n.init=function(){this.eventDispatcher=new EventDispatcher,this.focusHandler=new FocusHandler(this),this.busyIndicatorHandler=new BusyIndicatorHandler(this),this.initRenderer(),this.observer=new BreaseResizeObserver(this.elem,this._bind("redraw")),this.initController(),this.initModel(),e.prototype.init.call(this),brease.config.editMode||(this.updateConfigurations(),this.setFormat(this.settings.format))},n._initEditor=function(){var e=this;this.elem.classList.add("iatd-outline"),require(["widgets/brease/TableWidget/libs/EditorBehavior"],function(EditorBehavior){e.editorBehavior=new EditorBehavior(e),e.el.addClass("iatd-outline"),e.el.addClass("iat-container-widget"),e.editorBehavior.initialize(),e.el.append($('<div id="fakeRowHeight"/>')),e.settings.rowHeight=e.el.find("#fakeRowHeight").height(),e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0})),e.observer.init()})},n.initController=function(){this.controller=new Controller(this),this.controller.initialize()},n.initRenderer=function(){this.renderer=new Renderer(this),this.renderer.initialize()},n.initModel=function(){this.model=new Model(this),this.model.initialize()},n.redraw=function(){this.isVisible()&&this.renderer.redraw()},n.setTabIndex=function(t){this.renderer&&brease.callWidget(this.renderer.searchBoxId,"setTabIndex",t),e.prototype.setTabIndex.call(this,t)},n.focus=function(){return this.getSearchBox()?brease.callWidget(this.renderer.searchBoxId,"focus"):this.focusHandler.focus()},n.getScroller=function(){return this.settings.optimize?this.renderer.ns:this.renderer.scrollerBody},n.getHeaderScroller=function(){return this.renderer.scrollerHead},n.setItemsPerPage=function(e){this.settings.itemsPerPage=e<=0?1:e,this.renderer.setItemsPerPage()},n.getItemsPerPage=function(){return this.settings.itemsPerPage},n.setPaging=function(e){this.settings.paging=e&&!this.settings.optimize,this.renderer.setPaging(this.settings.paging)},n.getPaging=function(){return this.settings.paging},n.setShowPagingButtons=function(e){this.settings.showPagingButtons=e,this.renderer.setPaging(this.settings.paging)},n.getShowPagingButtons=function(){return this.settings.showPagingButtons},n.setSearchBox=function(e){this.settings.searchBox=e,this.renderer.setSearchBox(e)},n.getSearchBox=function(){return this.settings.searchBox},n.setPreviousText=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.updatePreviousText(e),this.previousTextKey=null):this.setPreviousTextKey(brease.language.parseKey(e)))},n.getPreviousText=function(){return this.settings.previousText},n.setPreviousTextKey=function(e){void 0!==e&&(this.settings.previousTextKey=e,this.updatePreviousText(brease.language.getTextByKey(this.settings.previousTextKey)))},n.getPreviousTextKey=function(){return this.settings.previousTextKey},n.updatePreviousText=function(e){this.settings.previousText=e,this._updateTexts()},n.setNextText=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.updateNextText(e),this.nextTextKey=null):this.setNextTextKey(brease.language.parseKey(e)))},n.getNextText=function(){return this.settings.nextText},n.setNextTextKey=function(e){void 0!==e&&(this.settings.nextTextKey=e,this.updateNextText(brease.language.getTextByKey(this.settings.nextTextKey)))},n.getNextTextKey=function(){return this.settings.nextTextKey},n.updateNextText=function(e){this.settings.nextText=e,this._updateTexts()},n.setHeaderHeight=function(e){this.settings.headerHeight=e,this.renderer.setHeaderHeight()},n.getHeaderHeight=function(){return this.settings.headerHeight},n.setTexts=function(){this.setNextText(this.settings.nextText),this.setPreviousText(this.settings.previousText)},n.setRowHeight=function(e){this.settings.rowHeight=e},n.getRowHeight=function(){return this.settings.rowHeight},n.setFormat=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.format=e,this.settings.formatKey=void 0):this.setFormatKey(brease.language.parseKey(e)),brease.config.editMode?this.controller.updateData():this.controller.languageChanged())},n.getFormat=function(){return this.settings.format},n.setFormatKey=function(e){if(void 0!==e){this.settings.formatKey=e,this.setCultureDependency(!0);var t=brease.language.getTextByKey(this.settings.formatKey);"undefined key"!==t?this.settings.format=t:console.iatWarn(this.elem.id+": Format textKey not found: "+e)}else this.settings.formatKey=void 0,console.iatInfo(this.elem.id+": The text key is not valid : "+e)},n.setFilterConfiguration=function(e){this.settings.filterConfiguration=e,brease.config.editMode||this.updateConfigurations()},n.getFilterConfiguration=function(){return this.settings.filterConfiguration},n.setSortConfiguration=function(e){this.settings.sortConfiguration=e,brease.config.editMode||this.updateConfigurations()},n.getSortConfiguration=function(){return this.settings.sortConfiguration},n.setStyleConfiguration=function(e){this.settings.styleConfiguration=e,brease.config.editMode||this.updateConfigurations()},n.getStyleConfiguration=function(){return this.settings.styleConfiguration},n.setBusyIndicatorDelay=function(e){this.settings.busyIndicatorDelay=e},n.getBusyIndicatorDelay=function(){return this.settings.busyIndicatorDelay},n._onErrorHandler=function(e){if(!brease.config.editMode){this._hideBusyIndicator();this.createEvent("OnError",{result:e}).dispatch()}},n._itemClickHandler=function(e,t){if(!this.isDisabled){this.createMouseEvent("ItemClick",e,t).dispatch()}},n._itemDoubleClickHandler=function(e,t){if(!this.isDisabled){this.createMouseEvent("ItemDoubleClick",e,t).dispatch()}},n._clickHandler=function(t){this.renderer._clickHandler(t),e.prototype._clickHandler.call(this,t,{origin:this.elem.id})},n._visibleHandler=function(){e.prototype._visibleHandler.apply(this,arguments),this.isVisible()&&this.renderer.redraw()},n._pageChangeHandler=function(e,t){if(!this.isDisabled){this.createEvent(e,t).dispatch()}},n.openConfiguration=function(e){this.isDisabled||("Filtering"===e?this.controller.openConf("filter"):"Sorting"===e?this.controller.openConf("sort"):"Styling"===e?this.controller.openConf("style"):console.iatWarn("Unsupported configuration type!"))},n.goToPage=function(e){return this.controller.goToPage(e,"number")},n.goToFirstPage=function(){return this.controller.goToPage(void 0,"first")},n.goToLastPage=function(){return this.controller.goToPage(void 0,"last")},n.goToNextPage=function(){return this.controller.goToPage(void 0,"next")},n.goToPreviousPage=function(){return this.controller.goToPage(void 0,"prev")},n.cultureChangeHandler=function(e){void 0===e&&void 0===e.detail||(this.settings.nextTextKey&&this.setNextText(brease.language.getTextByKey(this.settings.nextTextKey)),this.settings.previousTextKey&&this.setPreviousText(brease.language.getTextByKey(this.settings.previousTextKey)),this.settings.formatKey&&this.setFormatKey(this.settings.formatKey)),this.controller.languageChanged()},n.measurementSystemChangeHandler=function(){this.controller.languageChanged()},n.contentActivatedHandler=function(){this.observer.initialized?this.observer.wake():this.observer.init()},n.childrenInitializedHandler=function(){e.prototype.childrenInitializedHandler.call(this),this.controller.childrenInitializedHandler()},n.childrenParsed=function(t){var i=this;e.prototype.childrenParsed.call(this,t),0===this.el.find("[data-brease-widget]").length&&(this.editorBehavior?this.editorBehavior.childrenAdded():this.el.one(BreaseEvent.WIDGET_EDITOR_IF_READY,function(){i.editorBehavior.childrenAdded()}))},n.childrenAdded=function(t){var i=this;e.prototype.childrenAdded.call(this,t),this.editorBehavior?this.editorBehavior.childrenAdded():this.el.one(BreaseEvent.WIDGET_EDITOR_IF_READY,function(){i.editorBehavior.childrenAdded()}),this.isDisabled&&this.controller.disable()},n.childrenRemoved=function(e){this.editorBehavior.childrenRemoved(e)},n.updateConfigurations=function(){if(!brease.config.editMode){var e=new ConfigBuilder;this.settings.config.filter=e.parse("filter",this.settings.filterConfiguration,this.elem.id),this.settings.config.sort=e.parse("sort",this.settings.sortConfiguration,this.elem.id),this.settings.config.style=e.parse("style",this.settings.styleConfiguration,this.elem.id),this.renderer.redraw()}},n.sendConfiguration=function(e){var t=new ConfigBuilder,i=e+"Configuration";this.settings[i]=t.serialize(e,this.settings.config[e]);var s={};s[i]=this.settings[i],this.sendValueChange(s)},n.dispose=function(){this.observer.dispose(),this.focusHandler.dispose(),this.controller.dispose(),this.renderer.dispose(),this.model.dispose(),this.settings.initial=!1,this.busyIndicatorHandler.dispose(),e.prototype.dispose.apply(this,arguments)},n._updateTexts=function(){this.renderer.updateText()},n.wake=function(){this.observer.wake(),this.renderer.wake(),e.prototype.wake.apply(this,arguments)},n.suspend=function(){this.observer.suspend(),this.renderer.suspend(),this.model.suspend(),this.settings.initial=!1,e.prototype.suspend.apply(this,arguments)},n.disable=function(){e.prototype.disable.apply(this,arguments),this.isDisabled&&this.controller.disable()},n.enable=function(){e.prototype.enable.apply(this,arguments),this.isDisabled||this.controller.enable()},n._refreshScroller=function(){this.renderer._refreshScroller()},n._showBusyIndicator=function(){this.busyIndicatorHandler.showBusyIndicator()},n._hideBusyIndicator=function(){this.busyIndicatorHandler.hideBusyIndicator()},t.decorate(VisibilityDependency.decorate(MeasurementSystemDependency.decorate(CultureDependency.decorate(s,!0),!0),!0),!0)}),define("widgets/brease/AlarmHistory/libs/Model",["widgets/brease/TableWidget/libs/Model","brease/enum/Enum"],function(e,Enum){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t,this.categories=[],this.currentData=[],this.firstConnection=!0,this.sendDataThrottle=_.throttle(this._sendData,this.settings.fetchInterval)},t),s=i.prototype;s.updateNextData=function(e){if(this.prevTelegram&&this.prevTelegram.parameter.ToRecordIndex>=e.parameter.FromRecordIndex||void 0===this.prevTelegram){this.updateTable(e.data);for(var t=0;t<e.data.length;t+=1)e.data[t]=this._fixItem(e.data[t]);this.prevTelegram=e,this.updateFixedData(e.data),this.widget.renderer.updateNextData(e.data)}},s.updateTable=function(e){this.currentData=this.currentData.concat($.extend(!0,[],e)),this.currentData=this._discardData(this.currentData)},s.updateFixedData=function(e){this.data=this.data.concat($.extend(!0,[],e))},s.prepareData=function(e){for(var t=0;t<e.length;t+=1)this.data.push(this._fixItem(e[t]));this.data=this._discardData(this.data),brease.config.editMode||this.widget.renderer.updateData()},s._discardData=function(e){if(e.length>0){e=_.uniqBy(e,"RecordIndex");var t=this.widget.settings.firstItem;this.getLowestRowIndex(e)<t&&(e=_.remove(e,function(e){return e.RecordIndex>=t}))}return e
},s.prepareTelegram=function(e){this.telegram=$.extend(!0,{},e);for(var t=0;t<this.telegram.length;t+=1)this.telegram[t]=this._fixItem(this.telegram[t])},s.setMockData=function(){if(!brease.config.editMode)return!1;this.fetchData(n())},s.getInstanceId=function(e){return this.currentData[e].ins},s.setData=function(e){switch(e.methodID){case"GetCategoryList":this.setCategories(e);break;default:this.fetchData(e);break}},s.setCategories=function(e){this.categories=$.extend(!0,[],_.uniq(e.data))},s.resetTable=function(){this.data=[],this.currentData=[],this.categories=[],this.widget.renderer.updateData()},s.fetchData=function(e){if(null!==e){var t=$.extend(!0,{},e);"GetUpdateCount"===t.methodID?(this.widget._showBusyIndicator(),0===this.widget.settings.counter?this.startFetch(t):0===t.data.ActualId?this.resetFetch():t.data.ActualId<this.widget.settings.counter?(this._updateCounters(e.data),this.reFetchData()):this.continueFetch(t)):"GetAlarmHistory"===t.methodID&&(t.parameter.NextData?this.updateNextData(t):this.getData(t))}},s.startFetch=function(e){this._updateCounters(e.data),this.getFrom=e.data.ActualId,this.getTo=e.data.ActualId-this.settings.rowsPerFetch,this.sendData(this.getFrom,this.getTo)},s.continueFetch=function(e){this.getFrom=e.data.ActualId,this.getTo=this.getHighestRowIndex(),this._updateCounters(e.data),this.currentData.length>this.data.length&&this.prepareData($.extend(!0,[],this.currentData)),this.sendDataThrottle()},s.reFetchData=function(){this._resetData(),this.resetTable(),this.widget.settings.counter>0&&(this.widget._showBusyIndicator(),this.getFrom=this.widget.settings.counter,this.getTo=this.widget.settings.counter-this.widget.settings.rowsPerFetch,this.sendData(this.getFrom,this.getTo))},s.resetFetch=function(){this._resetData(),this.widget.settings.counter=0,this.resetTable()},s.fetchNextData=function(e){this.getFrom=this._getFromData(),this.getTo=this._getToData(),this.sendData(this.getFrom,this.getTo,!0,e)},s._resetData=function(){this.currentIteration=0,this.prevTelegram=void 0,this.getFrom=this.settings.rowsPerFetch,this.getTo=0,this.data=[],this.currentData=[]},s.getData=function(e){this.widget.settings.langChanged=!1,this.updateTable(e.data),this.prepareData(e.data)},s.getLowestRowIndex=function(e){var t=0;return e.length>0&&(t=_.minBy(e,"RecordIndex").RecordIndex),t},s.getHighestRowIndex=function(){var e=0;return this.currentData.length>0&&(e=_.maxBy(this.currentData,"RecordIndex").RecordIndex),e},s._getFromData=function(){return this.currentData.length>0?_.minBy(this.currentData,"RecordIndex").RecordIndex-1:this.settings.rowsPerFetch},s._getToData=function(){return this.currentData.length>0?Math.max(_.minBy(this.currentData,"RecordIndex").RecordIndex-this.settings.rowsPerFetch-1,0):0},s.getDataForItem=function(e){return this.currentData[e]},s._sendData=function(){this.sendData(this.getFrom,this.getTo)},s.sendData=function(e,t,i,s){t=Math.max(t,this.settings.firstItem);var n={FromRecordIndex:e,ToRecordIndex:t};if(i&&(n.NextData=!0),s||e>=this.settings.firstItem){if(brease.config.preLoadingState)return;this.widget.linkHandler.sendRequestAndProvideCallback("GetAlarmHistory",this.widget._updateData,void 0,n)}else this.widget._hideBusyIndicator()},s.getCategories=function(){brease.config.preLoadingState||this.widget.linkHandler.sendRequestAndProvideCallback("GetCategoryList",this.widget._updateData)},s.sendAckData=function(e,t){this.ackAllFlag=void 0!==t&&t,this.widget.submitMpLinkData(e)},s._fixItem=function(e){return e.stn=this._addSVGToRow(e.stn),e.sto=this._addSVGToRow(e.sto),e.cat=this._fixCategory(e.cat),e.tim=this._fixTimestamp(e.tim),e.mes=_.escape(e.mes),e},s._updateCounters=function(e){this.widget.settings.counter=e.ActualId,this._updateOldestId(e.OldestId),this.setTotalNumberOfPages()},s._updateOldestId=function(e){void 0!==e&&(this.widget.settings.firstItem=e)},s.setTotalNumberOfPages=function(){var e=Math.abs(this.widget.settings.counter-this.widget.settings.firstItem+1);this.internal.totalPages=Math.ceil(e/this.settings.itemsPerPage)},s.getTotalNumberOfPages=function(){return this.internal.totalPages},s._addSVGToRow=function(e){isNaN(e)&&(e=parseInt(e.match(/>[0-9]</)[0].match(/[0-9]/)[0]));var t="";return 1===e?t=""===this.widget.settings.imageActive?"widgets/brease/AlarmHistory/assets/act.svg":this.widget.settings.imageActive:2===e?t=""===this.widget.settings.imageInactive?"widgets/brease/AlarmHistory/assets/inact.svg":this.widget.settings.imageInactive:3===e?t=""===this.widget.settings.imageAcknowledged?"widgets/brease/AlarmHistory/assets/ack.svg":this.widget.settings.imageAcknowledged:4===e&&(t=""===this.widget.settings.imageUnacknowledged?"widgets/brease/AlarmHistory/assets/unack.svg":this.widget.settings.imageUnacknowledged),"<img src='"+t+"' /><div class='stateIdent'>"+e+"</div>"},s._fixCategory=function(e){var t="";return brease.config.editMode?t='<img src="widgets/brease/AlarmHistory/assets/'+e+'.svg" /><div class="catIdent">'+e+"</div>":e.length>0&&this.widget.settings.imagePrefix.length>0?t='<img src="'+this.widget.settings.imagePrefix+e+this.widget.settings.imageSuffix+'" /><div class="catIdent">'+e+"</div>":e.length>0&&(t='<img src="" /><div class="catIdent">'+e+"</div>"),t},s.suspend=function(){this.sendDataThrottle.cancel()},s.dispose=function(){this.sendDataThrottle.cancel()};function n(){return{data:[{RecordIndex:0,ins:0,ad1:"",ad2:"",cat:"cat0",cod:10,mes:"All these alarms are mocked and are in no way real",nam:"Mocked Alarm",sco:"",sev:1,stn:2,sto:1,tim:"1970-01-01T00:00:00.000Z"},{RecordIndex:1,ins:1,ad1:"",ad2:"",cat:"cat1",cod:2e3,mes:"Mocked:  Temperature level is critical ",nam:"Mocked:  TemperatureCritical",sco:"",sev:1,stn:4,sto:3,tim:"1970-01-01T11:33:15.141Z"},{RecordIndex:2,ins:2,ad1:"",ad2:"",cat:"cat1",cod:2001,mes:"Mocked:  Temperature level is high",nam:"Mocked:  TemperatureHigh",sco:"",sev:2,stn:2,sto:1,tim:"1970-01-01T11:33:15.141Z"},{RecordIndex:3,ins:3,ad1:"",ad2:"",cat:"cat2",cod:0,mes:"Mocked:  Initialization failed,  temperatureerror",nam:"Mocked:  InitializationError",sco:"gAxisBasic",sev:2,stn:3,sto:2,tim:"1970-01-01T11:31:56.541Z"},{RecordIndex:4,ins:4,ad1:"",ad2:"",cat:"cat2",cod:0,mes:"Mocked:  General axis error",nam:"Mocked:  GeneralDriveError",sco:"gAxisBasic",sev:1,stn:4,sto:3,tim:"1970-01-01T11:31:56.341Z"},{RecordIndex:5,ins:5,ad1:"",ad2:"",cat:"cat0",cod:0,mes:"Mocked:  Sequence import failed",nam:"Mocked:  ImportFailed",sco:"gSequencer",sev:1,stn:4,sto:3,tim:"1970-01-01T11:31:55.741Z"},{RecordIndex:6,ins:6,ad1:"",ad2:"",cat:"cat0",cod:0,mes:"Mocked:  Sequence import failed",nam:"Mocked:  ImportFailed",sco:"gSequencer",sev:1,stn:3,sto:2,tim:"1970-01-01T11:31:55.865Z"}],parameter:{},methodID:"GetAlarmHistory",response:"OK"}}return i}),define("widgets/brease/TableWidget/libs/DialogStyles",[],function(){return{DIALOG_WIDGETS_STYLE:"tableConfigurationDialogStyle",DIALOG_HEADERWIDGETS_STYLE:"tableConfigurationDialogHeaderStyle"}}),define("widgets/brease/TableWidget/libs/FilterSettings",["brease/core/Class","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/TableWidget/libs/DialogStyles","brease/services/RuntimeService"],function(e,Utils,BreaseEvent,t,DialogStyles,i){"use strict";var s=e.extend(function FilterSettings(t,i,s,n,a){this.texts=a,this.lang=s,this.dialog=t,this.categories=n,this.tableConfig=i.settings.config,this.childrenList=i.settings.childrenList,this.widget=i,this.currRow=0,e.call(this)},null),n=s.prototype;n.initialize=function(){if(this.config={},this.config.rows=[],this.config.cats=[],this.textSystemReady=new $.Deferred,this.config.children={delete_this_row:0,column_picker:1,operator:2,add_next_row:3,logic_op_next_row:4,rect_separator:5,comp_value:6,left:{delete_this_row:50,column_picker:100,operator:270,add_next_row:10,logic_op_next_row:5,rect_separator:70,comp_value:375}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:12,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:100},this.config.loc.rowHeight=this.config.loc.widgetHeight+3*this.config.loc.widgetOffset,this._getCategoryNames(),this._initializeEmptyDialogConfig(),0!==this.widget.settings.config.filter.length){var e=this;$.when(this.textSystemReady.promise()).then(function t(){e._initializeStoredDialogConfig()})}return this.config},n._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},n._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+(e-1)*this.config.loc.rowHeight+this.config.loc.offset},n._getCurrTop=function(e){return 60+e*this.config.loc.rowHeight+this.config.loc.offset},n._getOneRowOffset=function(e){return e+this.config.loc.rowHeight},n._addRow=function(){for(var e=this._createRow(this.currRow),t=0;t<e.length;t+=1)t===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(e[t]);$("#"+e[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+e[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+e[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.push({widgets:e}),this.currRow+=1,a.call(this)},n._insertRow=function(e){var t=this._createRow(e);0===e&&(""===this.config.rows[e].widgets[this.config.children.logic_op_next_row].id&&(this.config.rows[e].widgets[this.config.children.logic_op_next_row].id=this._generateLogicalOperatorWidgetId()),this.dialog.addWidget(this.config.rows[e].widgets[this.config.children.logic_op_next_row])),this._moveRow(e,!1);for(var i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===e||this.dialog.addWidget(t[i]);$("#"+t[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+t[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+t[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.splice(e,0,{widgets:t}),this.currRow+=1,a.call(this)},n._generateLogicalOperatorWidgetId=function(){return"Dropdown_Logical_Filter_"+Utils.uniqueID()},n._updateRowHandler=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.column_picker);void 0!==t&&(this._reColourNewObject(t),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).on("SelectedIndexChanged",this._bind("_updateRow")))},n._updateRow=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.column_picker);if(void 0!==t){var i=this._getCurrTop(t);this.config.rows[t].widgets[this.config.children.comp_value]&&(this.dialog.removeWidget(this.config.rows[t].widgets[this.config.children.comp_value]),this.config.rows[t].widgets.pop());var s=[];s.push(this._getValueColumn(e.detail.selectedValue,this.config.children.left.comp_value,i,220));for(var n=0;n<s.length;n+=1)this.dialog.addWidget(s[n]);this.config.rows[t].widgets=this.config.rows[t].widgets.concat(s),a.call(this)}},n._addRowHandler=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.add_next_row);t===this.currRow?this._addRow():this._insertRow(t)},n._removeRow=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.delete_this_row);if(this.config.rows[t].widgets[this.config.children.delete_this_row].id===brease.uiController.parentWidgetId(e.target)){e.stopPropagation(),$("#"+this.config.rows[t].widgets[this.config.children.delete_this_row].id).off(BreaseEvent.CLICK,this._bind("_removeRow")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off("SelectedIndexChanged",this._bind("_updateRow")),$("#"+this.config.rows[t].widgets[this.config.children.add_next_row].id).off(BreaseEvent.CLICK,this._bind("_addRowHandler"));for(var i=0;i<this.config.rows[t].widgets.length-1;i+=1)this.dialog.removeWidget(this.config.rows[t].widgets[i+1]);var s=this;setTimeout(function(){s.dialog.removeWidget(s.config.rows[t].widgets[s.config.children.delete_this_row]),s.config.rows.splice(t,1),s.currRow-=1,l.call(s,t),a.call(s)},0),0===t&&void 0!==this.config.rows[t+1]&&(this.dialog.removeWidget(this.config.rows[t+1].widgets[this.config.children.logic_op_next_row]),this.config.rows[t+1].widgets[this.config.children.logic_op_next_row].id=""),this._moveRow(t,!0,!0)}},n._moveRow=function(e,t,i){for(var s=e+(void 0!==i||!0===i?1:0),n=s;n<this.config.rows.length;n+=1)for(var a=0;a<this.config.rows[n].widgets.length;a+=1)t?this.config.rows[n].widgets[a].y-=this.config.loc.rowHeight:this.config.rows[n].widgets[a].y+=this.config.loc.rowHeight,$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt(this.config.rows[n].widgets[a].y))},n._widgetCollectStateBeforeClosing=function(e){for(var t=[],i=0;i<this.currRow;i+=1){var s={logical:"",logVal:2,data:"",op:"",opVal:0,comp:""};if(i<this.currRow-1){var n=this._getSelectedItemFromDataProvider(this.config.rows[i+1].widgets[this.config.children.logic_op_next_row].id);s.logical=n.text,s.logVal=n.value}s.data=brease.callWidget(this.config.rows[i].widgets[this.config.children.column_picker].id,"getSelectedValue");var a=this._getSelectedItemFromDataProvider(this.config.rows[i].widgets[this.config.children.operator].id);s.op=a.text,s.opVal=a.value;var r=0;6===this.config.rows[i].widgets.length&&(r=1),"sto"===s.data||"stn"===s.data||"cat"===s.data||"IsAdmin"===s.data||"IsLocked"===s.data?s.comp=brease.callWidget(this.config.rows[i].widgets[this.config.children.comp_value-r].id,"getSelectedValue"):s.comp=brease.callWidget(this.config.rows[i].widgets[this.config.children.comp_value-r].id,"getValue"),t.push(s)}return void 0===this.config?this.widget.settings.config.filter:t},n.removeEventListeners=function(){this.dialog.el.off(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady"))},n._getSelectedItemFromDataProvider=function(e){var t,i=brease.callWidget(e,"getDataProvider"),s=brease.callWidget(e,"getSelectedIndex");return i&&s>-1&&(t=i[s]),t},n._reColourFirstLineSeparator=function(){$("#"+this.config.startWidgets[0].id).css("border-width","0px 0px 2px 0px")},n._reColourNewObject=function(e){$("#"+this.config.rows[e].widgets[this.config.children.rect_separator].id).css("border-width","0px 0px 2px 0px")},n._getCurrentRow=function(e,t){if(e.includes("button_add_0"))return 0;for(var i=0;i<this.config.rows.length;i+=1)if(e===this.config.rows[i].widgets[t].id)return this.config.children.add_next_row===t?i+1:i},n._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrFilterLogicalTop(e),s=this._getCurrTop(e),n=[],a=Utils.uniqueID(),r={};this.widget.settings.config.filter.length>0&&void 0!==this.widget.settings.config.filter[e]&&(r=this.widget.settings.config.filter[e]),n.push(this._getImage("Button_Delete_"+a,"widgets/brease/TableWidget/assets/Delete.svg",this.config.children.left.delete_this_row,s)),n.push(this._getDropDownColumn("Dropdown_ColumnPicker_"+a,this.config.children.left.column_picker,s,150,r.data)),n.push(this._getDropDownOperator("Dropdown_Operator_"+a,this.config.children.left.operator,s,85,r.opVal));var o=s+this.config.loc.rowHeight;n.push(this._getImage("Button_Add_"+a,"widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,o));var l;l=0===e||_.isEmpty(r)?0:this.widget.settings.config.filter[e-1].logVal,n.push(this._getDropDown("Dropdown_Logical_Filter_"+a,[{value:0,text:this.texts.and},{value:1,text:this.texts.or}],this.config.children.left.logic_op_next_row,i,60,this.config.loc.logicalOperatorHeight,l,"right")),n.push(this._getRect("Rect_Separator_"+a,this.config.children.left.rect_separator,t,600));var d;return d=void 0!==r.data?r.data:this.tableConfig.columns[0].data,n.push(this._getValueColumn(d,this.config.children.left.comp_value,s,220,r.comp)),n},n._initializeStoredDialogConfig=function(){for(var e=0;e<this.widget.settings.config.filter.length;e+=1){for(var t=this._createRow(e),i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(t[i]);this.config.rows.push({widgets:t}),this.currRow+=1,$("#"+this.config.rows[e].widgets[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow"))}a.call(this)},n._initializeEmptyDialogConfig=function(){this.config.startWidgets=[],this.dialog.el.on(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady")),this.config.startWidgets.push(this._getRect("filter_rect_header",0,50+this.config.loc.offset,600)),this.config.startWidgets.push(this._getLabel("filter_label_column",this.texts.col,100,20+this.config.loc.offset,100,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getLabel("filter_label_operator",this.texts.op,270,20+this.config.loc.offset,100,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getLabel("filter_label_value",this.texts.val,375,20+this.config.loc.offset,100,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getImage("filter_button_add_0","widgets/brease/TableWidget/assets/Add.svg",10,60+this.config.loc.offset));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);var t=this.config.startWidgets[4].id;brease.config.isKeyboardOperationEnabled()&&brease.uiController.setWidgetPropertyIndependentOfState(t,"tabIndex",1),$("#"+t).on(BreaseEvent.CLICK,this._bind("_addRowHandler"))},n._handleChildWidgetReady=function(e){this._initFocus(e),brease.callWidget(e.target.id,"setAdditionalStyle","default")},n._initFocus=function(e){e.target.id.includes("filter_button_add_0")&&e.target.focus()},n._getValueColumn=function(e,t,i,s,n){var a,r=Utils.uniqueID("Value_"+this.currRow);if("date"===this.tableConfig.columnTypes[e])a=this._getDateTimeInput("DateTimeInput_"+r,t,i,s,n);else if("str"===this.tableConfig.columnTypes[e])a=this._getTextInput("TextInput_"+r,t,i,s,n);else if("bool"===this.tableConfig.columnTypes[e]){var o=[{value:!1,text:this.texts.false},{value:!0,text:this.texts.true}];a=this._getDropDown("DropDownStatus_"+r,o,t,i,s,30,void 0!==n?parseInt(n)-1:n,"left")}else if("int"===this.tableConfig.columnTypes[e]){var l;if("sta"===e)l=[{value:"1",text:this.texts.act},{value:"2",text:this.texts.actack},{value:"3",text:this.texts.inact}],a=this._getDropDown("DropDownStatus_"+r,l,t,i,s,30,void 0!==n?parseInt(n)-1:n,"left");else if("cat"===e){l=[];for(var d=0;d<this.categories.length;d+=1)l.push({value:d.toString(),text:this.config.cats[d]});a=this._getDropDown("DropDownStatus_"+r,l,t,i,s,30,n,"left")}else"stn"===e||"sto"===e?(l=[{value:"1",text:this.texts.act},{value:"2",text:this.texts.actack},{value:"3",text:this.texts.inact},{value:"4",text:this.texts.inactack}],a=this._getDropDown("DropDownStatus_"+r,l,t,i,s,30,void 0!==n?parseInt(n)-1:n,"left")):a=this._getNumericInput("NumericInput_"+r,t,i,s,e,n)}return a},n._getCategoryNames=function(){if(void 0===this.categories)return this.textSystemReady.resolve(),null;var e=this;function t(t){for(var i=0;i<e.categories.length;i+=1){var s=t["IAT/Widgets/"+e.widget.settings.type+"/"+e.categories[i]];void 0===s&&(s=e.categories[i]),e.config.cats.push(s)}e.textSystemReady.resolve()}i.loadTexts(this.lang,t)},n._getDropDownColumn=function(e,i,s,n,a,r){if(r=r||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===a)a=0;else for(var o=0;o<this.tableConfig.columns.length-1;o+=1)a===this.tableConfig.columns[o].data&&(a=o);var l=new t;l.name=e,l.type="widgets/brease/DropDownBox",l.x=i,l.y=s,l.width=n,l.height=30,l.options={dataProvider:[],selectedIndex:parseInt(a),listPosition:"right",fitHeight2Items:!1,listWidth:190,cropToParent:!0,ellipsis:!0},l.options.style=r;for(var d=0;d<this.tableConfig.columns.length-1;d+=1)l.options.dataProvider.push({value:this.tableConfig.columns[d].data,text:this.childrenList[d].settings.text});return l.result={method:"getSelectedValue"},l},n._getDropDownOperator=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===a&&(a=0);var o=new t;return o.name=e,o.type="widgets/brease/DropDownBox",o.x=i,o.y=s,o.width=n,o.height=30,o.options={dataProvider:[{value:0,text:"<>"},{value:1,text:"=="},{value:2,text:"<"},{value:3,text:"<="},{value:4,text:">"},{value:5,text:">="},{value:6,text:"Contains"},{value:7,text:"Does not contain"}],selectedIndex:parseInt(a),listPosition:"right",fitHeight2Items:!1,cropToParent:!0,ellipsis:!0},o.options.style=r,o.result={method:"getSelectedValue"},o},n._getDropDown=function(e,i,s,n,a,r,o,l,d){d=d||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===r&&(r=30),void 0===o&&(o=0),void 0===l&&(l="right");var c=new t;return c.name=e,c.type="widgets/brease/DropDownBox",c.x=s,c.y=n,c.width=a,c.height=r,c.options={dataProvider:i,selectedIndex:parseInt(o),listPosition:l,fitHeight2Items:!1,listWidth:220,cropToParent:!0,ellipsis:!0},c.options.style=d,c.result={method:"getSelectedValue"},c},n._getDateTimeInput=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;if(o.name=e,o.type="widgets/brease/DateTimeInput",o.x=i,o.y=s,o.width=n,o.height="30px",o.options={format:"yyyy-MM-dd HH:mm:ss"},o.options.style=r,void 0!==a)o.options.value=new Date(a).toISOString();else{var l=new Date,d=l.getFullYear().toString(),c=l.getMonth(),h=l.getDate().toString(),u=l.getHours(),g=l.getMinutes(),m=l.getSeconds();c=(c<9?"0":"")+(c+1).toString(),h=(h<10?"0":"")+h.toString(),u=(u<10?"0":"")+u.toString(),g=(g<10?"0":"")+g.toString(),m=(m<10?"0":"")+m.toString(),o.options.value=d+"-"+c+"-"+h+"T"+u+":"+g+":"+m+".000Z"}return o},n._getLabel=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/Label",o.x=s,o.y=n,o.width=a,o.height="30px",o.options={text:i},o.options.style=r,o},n._getTextInput=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/TextInput",o.x=i,o.y=s,o.width=n,o.height="30px",void 0!==a&&(o.options.value=a),o.options.style=r,o},n._getNumericInput=function(e,i,s,n,a,r,o){o=o||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===r&&(r=0);var l=4294967295,d,c={metric:{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11},imperial:{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11},"imperial-us":{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11}},h=!1;"sta"===a?(l=2,d="noSubmit"):"idx"===a?d="submitAll":(h=!0,d="noSubmit");var u=new t;return u.name=e,u.type="widgets/brease/NumericInput",u.x=i,u.y=s,u.width=n,u.height="30px",u.options={value:r,useDigitGrouping:h,numpadPosition:"left",format:c,showUnits:!1,maxValue:l,limitViolationPolicy:d},u.options.style=o,u},n._getImage=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Image",r.x=s,r.y=n,r.width="30px",r.height="30px",r.options={image:i,tabIndex:0},r.options.style=a,r},n._getRect=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Rectangle",r.x=i,r.y=s,r.width=n,r.height="2px",r.options={borderWidth:"0px 0px 1px 0px"},r.options.style=a,r};function a(){if(brease.config.isKeyboardOperationEnabled()){var e=o.call(this),t=2;this.config.rows.forEach(function(i){i.widgets.forEach(function(s){if(r(s)&&(s.name.includes("Button_Add_")&&e.length>0&&brease.uiController.setWidgetPropertyIndependentOfState(e.shift(),"tabIndex",t++),brease.uiController.setWidgetPropertyIndependentOfState(s.id,"tabIndex",t++),s.name.includes("Dropdown_Operator")&&i.widgets[this.config.children.comp_value])){var n=i.widgets[this.config.children.comp_value].id;brease.uiController.setWidgetPropertyIndependentOfState(n,"tabIndex",t++)}},this)},this),this.dialog.elem.dispatchEvent(new CustomEvent(BreaseEvent.TABINDEX_CHANGED,{bubbles:!0,detail:{contentId:brease.settings.globalContent}}))}}function r(e){return""!==e.id&&!e.name.includes("Rect")&&!e.name.includes("Dropdown_Logical")&&!e.name.includes("Value_")&&"widgets/brease/Label"!==e.type}function o(){var e=[];return this.config.rows.forEach(function(t){var i=t.widgets[this.config.children.logic_op_next_row];""!==i.id&&e.push(i.id)},this),e}function l(e){if(brease.config.isKeyboardOperationEnabled()){var t;if(0===e){var i=this.config.startWidgets[4].id;t=document.getElementById(i)}else t=document.getElementById(this.config.rows[e-1].widgets[this.config.children.add_next_row].id);t&&t.focus()}}return s}),define("widgets/brease/TableWidget/libs/SortingSettings",["brease/core/Class","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/TableWidget/libs/DialogStyles","widgets/brease/GenericDialog/libs/models/dialogWidgetModel"],function(e,Utils,BreaseEvent,DialogStyles,t){"use strict";var i=e.extend(function SortingSettings(t,i,s,n){this.texts=n,this.lang=s,this.dialog=t,this.tableConfig=i.settings.config,this.childrenList=i.settings.childrenList,this.widget=i,this.currRow=0,this.init=!1,e.call(this)},null),s=i.prototype;s.initialize=function(){return this.config={},this.config.rows=[],this.config.startWidgets=[],this._initializeEmptyDialogConfig(),this.widget.settings.config.sort.length>0&&this._initializeStoredDialogConfig(),this.config},s._initializeEmptyDialogConfig=function(){this.config.children={delete_this_row:0,label:1,column_picker:2,rect_separator:3,add_next_row:4,sort_value:5,left:{left_banner_label:75,center_banner_label:150,right_banner_label:360,add_next_row:10,delete_this_row:50,label:90,column_picker:150,sort_value:360,rect_separator:0}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:12,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:100},this.config.loc.rowHeight=this.config.loc.widgetHeight+3*this.config.loc.widgetOffset,this.config.rows=[],this.dialog.el.on(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady")),this.config.startWidgets.push(this._getRect("sort_rect_header",0,50+this.config.loc.offset,600)),this.config.startWidgets.push(this._getLabel("sort_label_sort",this.texts.sort,this.config.children.left.left_banner_label,20+this.config.loc.offset,75,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getLabel("sort_label_columns",this.texts.col,this.config.children.left.center_banner_label,20+this.config.loc.offset,150,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getLabel("sort_label_by",this.texts.by,this.config.children.left.right_banner_label,20+this.config.loc.offset,150,DialogStyles.DIALOG_HEADERWIDGETS_STYLE)),this.config.startWidgets.push(this._getImage("sort_button_add_0","widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,60+this.config.loc.offset));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);var t=this.config.startWidgets[4].id;brease.config.isKeyboardOperationEnabled()&&brease.uiController.setWidgetPropertyIndependentOfState(t,"tabIndex",1),$("#"+t).on(BreaseEvent.CLICK,this._bind("_addRowHandler"))},s._handleChildWidgetReady=function(e){this._initFocus(e),brease.callWidget(e.target.id,"setAdditionalStyle","default")},s._initFocus=function(e){e.target.id.includes("sort_button_add_0")&&e.target.focus()},s.removeEventListeners=function(){this.dialog.el.off(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady"))},s._reColourFirstLineSeparator=function(){$("#"+this.config.startWidgets[0].id).css("border-width","0px 0px 2px 0px")},s._addRowHandler=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.add_next_row);t===this.currRow?this._addRow():this._insertRow(t)},s._addRow=function(){for(var e=this._createRow(this.currRow),t=0;t<e.length;t+=1)t===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(e[t]);$("#"+e[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+e[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+e[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.push({widgets:e}),this.currRow+=1,r.call(this)},s._initializeStoredDialogConfig=function(){for(var e=0;e<this.widget.settings.config.sort.length;e+=1){for(var t=this._createRow(e),i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(t[i]);this.config.rows.push({widgets:t}),this.currRow+=1,$("#"+this.config.rows[e].widgets[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this._reColourNewObject(e)}r.call(this)},s._updateRowHandler=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.column_picker);void 0!==t&&(this._reColourNewObject(t),this._checkMaxColumnsReached(),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).on("SelectedIndexChanged",this._bind("_updateRow")))},s._updateRow=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.column_picker);if(void 0!==t){var i=this._getCurrTop(t);this.config.rows[t].widgets[this.config.children.sort_value]&&(this.dialog.removeWidget(this.config.rows[t].widgets[this.config.children.sort_value]),this.config.rows[t].widgets.pop());var s=[];s.push(this._getValueColumn(e.detail.selectedValue,this.config.children.left.sort_value,i,220));for(var n=0;n<s.length;n+=1)this.dialog.addWidget(s[n]);this.config.rows[t].widgets=this.config.rows[t].widgets.concat(s),r.call(this)}},s._insertRow=function(e){0===e&&brease.callWidget(this.config.rows[e].widgets[this.config.children.label].id,"setText",this.texts.then);var t=this._createRow(e);this._moveRow(e,!1);for(var i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===e||this.dialog.addWidget(t[i]);$("#"+t[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+t[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+t[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.splice(e,0,{widgets:t}),this.currRow+=1,r.call(this)},s._getCurrentRow=function(e,t){if(e.includes("button_add_0"))return 0;for(var i=0;i<this.config.rows.length;i+=1)if(e===this.config.rows[i].widgets[t].id)return this.config.children.add_next_row===t?i+1:i},s._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrTop(e),s=[],n,a=Utils.uniqueID();s.push(this._getImage("sort_button_delete_"+a,"widgets/brease/TableWidget/assets/Delete.svg",this.config.children.left.delete_this_row,i)),n=0===this.currRow||0===e?this.texts.first:this.texts.then;var r=this.tableConfig.columns[0].data,o;this.widget.settings.config.sort.length>0&&void 0!==this.widget.settings.config.sort[e]&&(r=this.widget.settings.config.columns[this.widget.settings.config.sort[e][0]].data,o="asc"===this.widget.settings.config.sort[e][1]?0:1),
s.push(this._getLabel("sort_label_"+a,n,this.config.children.left.label,i,150)),s.push(this._getDropDownColumn("sort_dropdown_columnpicker_"+a,this.config.children.left.column_picker,i,150,r)),s.push(this._getRect("sort_rect_separator_"+a,this.config.children.left.rect_separator,t,600));var l=this._getOneRowOffset(i);return s.push(this._getImage("sort_button_add_"+a,"widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,l)),s.push(this._getValueColumn(r,this.config.children.left.sort_value,i,220,o)),s},s._removeRow=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.delete_this_row);if(this.config.rows[t].widgets[this.config.children.delete_this_row].id===brease.uiController.parentWidgetId(e.target)){e.stopPropagation(),$("#"+this.config.rows[t].widgets[this.config.children.delete_this_row].id).off(BreaseEvent.CLICK,this._bind("_removeRow")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off("SelectedIndexChanged",this._bind("_updateRow")),$("#"+this.config.rows[t].widgets[this.config.children.add_next_row].id).off(BreaseEvent.CLICK,this._bind("_addRowHandler"));for(var i=0;i<this.config.rows[t].widgets.length-1;i+=1)this.dialog.removeWidget(this.config.rows[t].widgets[i+1]);var s=this;window.setTimeout(function(){s.dialog.removeWidget(s.config.rows[t].widgets[s.config.children.delete_this_row]),s.config.rows.splice(t,1),s.currRow-=1,0===t&&void 0!==s.config.rows[t]&&brease.callWidget(s.config.rows[t].widgets[s.config.children.label].id,"setText",s.texts.first),s.config.rows.length===a.call(s)-1&&s._belowMaxColumn(),o.call(s,t),r.call(s)},0),this._moveRow(t,!0,!0)}},s._moveRow=function(e,t,i){for(var s=e+(void 0!==i||!0===i?1:0),n=s;n<this.config.rows.length;n+=1)for(var a=0;a<this.config.rows[n].widgets.length;a+=1)t?$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))-this.config.loc.rowHeight):$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))+this.config.loc.rowHeight)},s._getValueColumn=function(e,t,i,s,n){var a,r,o=Utils.uniqueID(),l="dropdown_sort_"+o;return"int"===this.tableConfig.columnTypes[e]?r=[{value:"0",text:this.texts.inc},{value:"1",text:this.texts.dec}]:"str"===this.tableConfig.columnTypes[e]?r=[{value:"0",text:this.texts.az},{value:"1",text:this.texts.za}]:"date"===this.tableConfig.columnTypes[e]?r=[{value:"0",text:this.texts.old},{value:"1",text:this.texts.new}]:"bool"===this.tableConfig.columnTypes[e]&&(r=[{value:"0",text:this.texts.false},{value:"1",text:this.texts.true}]),a=this._getDropDown(l,r,t,i,s,n),a},s._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){for(var i=[],s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.column_picker].id),n=0;n<this.widget.settings.config.columns.length-1;n+=1)if(this.widget.settings.config.columns[n].data===s.value){i.push(n);break}0===parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.sort_value].id,"getSelectedValue"))?i.push("asc"):i.push("desc"),e.push(i)}return void 0===this.config?this.widget.settings.config.sort:e},s._getSelectedItemFromDataProvider=function(e){var t,i=brease.callWidget(e,"getDataProvider"),s=brease.callWidget(e,"getSelectedIndex");return i&&s>-1&&(t=i[s]),t},s._checkMaxColumnsReached=function(){this.config.rows.length>=a.call(this)&&n.call(this,!1)},s._belowMaxColumn=function(){n.call(this,!0)};function n(e){for(var t=0;t<this.config.rows.length;t+=1)brease.callWidget(this.config.rows[t].widgets[this.config.children.add_next_row].id,"setVisible",e);brease.callWidget(this.config.startWidgets[this.config.children.add_next_row].id,"setVisible",e)}s._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+(e-1)*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrTop=function(e){return 60+e*this.config.loc.rowHeight+this.config.loc.offset},s._getOneRowOffset=function(e){return e+this.config.loc.rowHeight},s._reColourNewObject=function(e){$("#"+this.config.rows[e].widgets[this.config.children.rect_separator].id).css("border-width","0px 0px 2px 0px")},s._getDropDown=function(e,i,s,n,r,o,l){if(l=l||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===o)o=0;else for(var d=0;d<a.call(this);d+=1)o===this.tableConfig.columns[d].data&&(o=d);var c=new t;return c.name=e,c.type="widgets/brease/DropDownBox",c.x=s,c.y=n,c.width=r,c.height=30,c.options={dataProvider:i,selectedIndex:parseInt(o),listPosition:"left",fitHeight2Items:!1,cropToParent:!0,listWidth:220,ellipsis:!0},c.options.style=l,c.result={method:"getSelectedValue"},c},s._getDropDownColumn=function(e,i,s,n,r,o){if(o=o||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===r)r=0;else for(var l=0;l<a.call(this);l+=1)r===this.tableConfig.columns[l].data&&(r=l);var d=new t;d.name=e,d.type="widgets/brease/DropDownBox",d.x=i,d.y=s,d.width=n,d.height=30,d.options={dataProvider:[],selectedIndex:parseInt(r),listPosition:"right",fitHeight2Items:!1,cropToParent:!0,listWidth:220,ellipsis:!0},d.options.style=o;for(var c=0;c<a.call(this);c+=1)d.options.dataProvider.push({value:this.tableConfig.columns[c].data,text:this.childrenList[c].settings.text});return d.result={method:"getSelectedValue"},d},s._getImage=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Image",r.x=s,r.y=n,r.width="30px",r.height="30px",r.options={image:i,tabIndex:0},r.options.style=a,r},s._getLabel=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/Label",o.x=s,o.y=n,o.width=a,o.height="30px",o.options={text:i},o.options.style=r,o},s._getRect=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Rectangle",r.x=i,r.y=s,r.width=n,r.height="2px",r.options={borderWidth:"0px 0px 1px 0px"},r.options.style=a,r};function a(){return this.tableConfig.columns.length-1}function r(){if(brease.config.isKeyboardOperationEnabled()){var e=2;this.config.rows.forEach(function(t){t.widgets.forEach(function(i){if(""!==i.id&&!i.name.includes("sort_rect")&&!i.name.includes("sort_label")&&!i.name.includes("dropdown_sort_")&&(brease.uiController.setWidgetPropertyIndependentOfState(i.id,"tabIndex",e++),i.name.includes("sort_dropdown_columnpicker")&&t.widgets[this.config.children.sort_value])){var s=t.widgets[this.config.children.sort_value].id;brease.uiController.setWidgetPropertyIndependentOfState(s,"tabIndex",e++)}},this)},this),this.dialog.elem.dispatchEvent(new CustomEvent(BreaseEvent.TABINDEX_CHANGED,{bubbles:!0,detail:{contentId:brease.settings.globalContent}}))}}function o(e){if(brease.config.isKeyboardOperationEnabled()){var t;if(0===e){var i=this.config.startWidgets[this.config.children.add_next_row].id;t=document.getElementById(i)}else t=document.getElementById(this.config.rows[e-1].widgets[this.config.children.add_next_row].id);t&&t.focus()}}return i}),define("widgets/brease/TableWidget/libs/StylingSettings",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/TableWidget/libs/DialogStyles","brease/services/RuntimeService"],function(e,BreaseEvent,t,DialogStyles,i){"use strict";var s=e.extend(function FilterSettings(t,i,s,n){this.texts=n,this.lang=s,this.dialog=t,this.tableConfig=i.settings.config,this.childrenList=i.settings.childrenList,this.widget=i,this.currRow=0,this.init=!1,e.call(this)},null),n=s.prototype;return n.initialize=function(){},n._getCurrSeparatorTop=function(e){},n._getCurrFilterLogicalTop=function(e){},n._getCurrTop=function(e){},n._getOneRowOffset=function(e){},n._createRow=function(e){},n._widgetCollectStateBeforeClosing=function(){},n._getSelectedItemFromDataProvider=function(e){var t,i=brease.callWidget(e,"getDataProvider"),s=brease.callWidget(e,"getSelectedIndex");return i&&s>-1&&(t=i[s]),t},n._initializeEmptyDialogConfig=function(){this.config.startWidgets=[],this.dialog.el.on(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady")),this.config.startWidgets.push(this._getImage("style_button_add_0","widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,this._getCurrTop(0)));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);var t=this.config.startWidgets[0].id;brease.config.isKeyboardOperationEnabled()&&brease.uiController.setWidgetPropertyIndependentOfState(t,"tabIndex",1),$("#"+t).on(BreaseEvent.CLICK,this._bind("_addRowHandler"))},n._handleChildWidgetReady=function(e){this._initFocus(e),brease.callWidget(e.target.id,"setAdditionalStyle","default")},n._initFocus=function(e){e.target.id.includes("style_button_add_0")&&e.target.focus()},n._initializeStoredDialogConfig=function(){for(var e=0;e<this.widget.settings.config.style.length;e+=1){for(var t=this._createRow(e),i=0;i<t.length;i+=1)this.dialog.addWidget(t[i]);this.config.rows.push({widgets:t}),this.currRow+=1,$("#"+this.config.rows[e].widgets[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this._reColourNewObject(e)}a.call(this)},n._addRowHandler=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.add_next_row);t===this.currRow?this._addRow():this._insertRow(t),this._reColourNewObject(t)},n._addRow=function(){for(var e=this._createRow(this.currRow),t=0;t<e.length;t+=1)this.dialog.addWidget(e[t]);$("#"+e[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+e[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.push({widgets:e}),this.currRow+=1,a.call(this)},n._insertRow=function(e){var t=this._createRow(e);this._moveRow(e,!1);for(var i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===e||this.dialog.addWidget(t[i]);$("#"+t[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+t[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.splice(e,0,{widgets:t}),this.currRow+=1,a.call(this)},n._removeRow=function(e){var t=this._getCurrentRow(brease.uiController.parentWidgetId(e.target),this.config.children.delete_this_row);if(this.config.rows[t].widgets[this.config.children.delete_this_row].id===brease.uiController.parentWidgetId(e.target)){e.stopPropagation(),$("#"+this.config.rows[t].widgets[this.config.children.delete_this_row].id).off(BreaseEvent.CLICK,this._bind("_removeRow")),$("#"+this.config.rows[t].widgets[this.config.children.add_next_row].id).off(BreaseEvent.CLICK,this._bind("_addRowHandler"));for(var i=0;i<this.config.rows[t].widgets.length-1;i+=1)this.dialog.removeWidget(this.config.rows[t].widgets[i+1]);var s=this;setTimeout(function(){s.dialog.removeWidget(s.config.rows[t].widgets[s.config.children.delete_this_row]),s.config.rows.splice(t,1),s.currRow-=1,a.call(s),r.call(s,t)},0),this._moveRow(t,!0,!0)}},n._moveRow=function(e,t,i){for(var s=e+(void 0!==i||!0===i?1:0),n=s;n<this.config.rows.length;n+=1)for(var a=0;a<this.config.rows[n].widgets.length;a+=1)t?$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))-this.config.loc.rowHeight):$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))+this.config.loc.rowHeight)},n._getCurrentRow=function(e,t){if(e.includes("button_add_0"))return 0;for(var i=0;i<this.config.rows.length;i+=1)if(e===this.config.rows[i].widgets[t].id)return this.config.children.add_next_row===t?i+1:i},n._reColourNewObject=function(e){$("#"+this.config.rows[e].widgets[this.config.children.rect_separator].id).css("border-width","0px 0px 2px 0px")},n.removeEventListeners=function(){this.dialog.el.off(BreaseEvent.WIDGET_READY,this._bind("_handleChildWidgetReady"))},n._getStyleNames=function(){var e=this;function t(t){for(var i=1;i<=8;i+=1){var s=t["IAT/Widgets/"+e.widget.settings.type+"/style"+i];void 0===s&&(s="style"+i),e.config.names.push(s)}e.textSystemReady.resolve()}i.loadTexts(this.lang,t)},n._getDropDown=function(e,i,s,n,a,r,o,l){l=l||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===o?o="0":"number"==typeof o&&(o=o.toString());for(var d,c=0;c<i.length;c+=1)if(i[c].value===o){d=c;break}var h=new t;return h.name=e,h.type="widgets/brease/DropDownBox",h.x=s,h.y=n,h.width=a,h.height="30px",h.options={dataProvider:i,selectedValue:o,selectedIndex:d,listPosition:r,fitHeight2Items:!1,cropToParent:!0,ellipsis:!0},h.options.style=l,e.includes("state")&&(h.options.listWidth=220),h.result={method:"getSelectedValue"},h},n._getLabel=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/Label",o.x=s,o.y=n,o.width=a,o.height="30px",o.options={text:i},o.options.style=r,o},n._getTextInput=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/TextInput",o.x=i,o.y=s,o.width=n,o.height="30px",void 0!==a&&(o.options.value=a),o.options.style=r,o},n._getNumericInput=function(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE,void 0===a&&(a=0);var o={metric:{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11},imperial:{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11},"imperial-us":{decimalPlaces:0,minimumIntegerDigits:1,maximumIntegerDigits:11}},l=!0,d=new t;return d.name=e,d.type="widgets/brease/NumericInput",d.x=i,d.y=s,d.width=n,d.height="30px",d.options={value:a,useDigitGrouping:!0,numpadPosition:"left",format:o,showUnits:!1,maxValue:4294967295,limitViolationPolicy:"noSubmit"},d.options.style=r,d},n._getImage=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Image",r.x=s,r.y=n,r.width="30px",r.height="30px",r.options={image:i,tabIndex:0},r.options.style=a,r},n._getRect=function(e,i,s,n,a){a=a||DialogStyles.DIALOG_WIDGETS_STYLE;var r=new t;return r.name=e,r.type="widgets/brease/Rectangle",r.x=i,r.y=s,r.width=n,r.height="2px",r.options={borderWidth:"0px 0px 1px 0px"},r.options.style=a,r},n._getCheckExtOptions=function(e,i,s,n,a,r,o){o=o||DialogStyles.DIALOG_WIDGETS_STYLE;var l=new t;return l.name=e,l.type="widgets/brease/CheckBox",l.x=s,l.y=n,l.width=a,l.height="30px",l.options={text:i},void 0!==r&&(l.options.value=r),l.options.style=o,l},s;function a(){if(brease.config.isKeyboardOperationEnabled()){var e=2;this.config.rows.forEach(function(t){t.widgets.forEach(function(t){""===t.id||t.id.includes("label")||t.id.includes("rect_separator")||brease.uiController.setWidgetPropertyIndependentOfState(t.id,"tabIndex",e++)},this)},this),this.dialog.elem.dispatchEvent(new CustomEvent(BreaseEvent.TABINDEX_CHANGED,{bubbles:!0,detail:{contentId:brease.settings.globalContent}}))}}function r(e){if(brease.config.isKeyboardOperationEnabled()){var t;if(0===e){var i=this.config.startWidgets[0].id;t=document.getElementById(i)}else t=document.getElementById(this.config.rows[e-1].widgets[this.config.children.add_next_row].id);t&&t.focus()}}}),define("widgets/brease/AlarmHistory/libs/StylingSettings",["widgets/brease/TableWidget/libs/StylingSettings","brease/core/Utils"],function(e,Utils){"use strict";var t=e.extend(function FilterSettings(t,i,s,n){this.texts=n,e.apply(this,arguments)},null),i=t.prototype;return i.initialize=function(){if(this.config={},this.config.rows=[],this.textSystemReady=new $.Deferred,this.setUpConfiguration(),this._getStyleNames(),this._initializeEmptyDialogConfig(),this.widget.settings.config.style.length>0){var e=this;$.when(this.textSystemReady.promise()).then(function t(){e._initializeStoredDialogConfig()})}return this.config},i.setUpConfiguration=function(){this.config.names=[],this.config.children={delete_this_row:0,label_style:1,input_style:2,label_state:3,dd_state:4,check_cond_first:5,dd_cond_first:6,input_cond_first:7,check_cond_sec:8,dd_cond_sec_cond:9,dd_cond_sec:10,input_cond_sec:11,rect_separator:12,add_next_row:13,left:{delete_this_row:50,label_style:75,input_style:185,label_state:330,dd_state:450,check_cond_first:30,dd_cond_first:230,input_cond_first:286,check_cond_sec:365,dd_cond_sec_cond:398,dd_cond_sec:468,input_cond_sec:528,rect_separator:0,add_next_row:10}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:10,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:125},this.config.loc.rowHeight=2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},i._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+3*(e-1)*this.config.loc.widgetHeight+this.config.loc.offset},i._getCurrTop=function(e){return 30+2*e*this.config.loc.widgetHeight+3*e*this.config.loc.widgetOffset+this.config.loc.offset},i._getOneRowOffset=function(e){return e+2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrTop(e),s=40+i,n=[],a=Utils.uniqueID();n.push(this._getImage("style_button_delete_"+a,"widgets/brease/TableWidget/assets/Delete.svg",this.config.children.left.delete_this_row,i)),n.push(this._getLabel("style_label_"+a,this.texts.style,this.config.children.left.label_style,i,150));var r=[{value:"1",text:this.config.names[0]},{value:"2",text:this.config.names[1]},{value:"3",text:this.config.names[2]},{value:"4",text:this.config.names[3]},{value:"5",text:this.config.names[4]},{value:"6",text:this.config.names[5]},{value:"7",text:this.config.names[6]},{value:"8",text:this.config.names[7]}],o={};this.widget.settings.config.style.length>0&&void 0!==this.widget.settings.config.style[e]?o=this.widget.settings.config.style[e]:(o.sevOnePos=4,o.sevTwoPos=2),n.push(this._getDropDown("style_input_"+a,r,this.config.children.left.input_style,i,140,"right",o.namePos)),n.push(this._getLabel("style_label_state_"+a,this.texts.state,this.config.children.left.label_state,i,150));var l=[{value:"1",text:this.texts.act},{value:"3",text:this.texts.actack},{value:"2",text:this.texts.inact},{value:"3",text:this.texts.inactack},{value:"5",text:this.texts.any}];n.push(this._getDropDown("style_dropdown_state_"+a,l,this.config.children.left.dd_state,i,150,"left",o.statePos)),n.push(this._getCheckExtOptions("style_check_cond_first_"+a,this.texts.sev,this.config.children.left.check_cond_first,s,200,o.sevOneUse));var d=[{value:"0",text:"<>"},{value:"1",text:"=="},{value:"2",text:"<"},{value:"3",text:"<="},{value:"4",text:">"},{value:"5",text:">="}];n.push(this._getDropDown("style_dd_cond_first_"+a,d,this.config.children.left.dd_cond_first,s,50,"right",o.sevOnePos)),n.push(this._getNumericInput("style_input_cond_first_"+a,this.config.children.left.input_cond_first,s,70,o.sevOne)),n.push(this._getCheckExtOptions("style_check_cond_sec_"+a,"",this.config.children.left.check_cond_sec,s,30,o.sevTwoUse)),n.push(this._getDropDown("style_dd_cond_sec_cond"+a,[{value:"0",text:this.texts.and},{value:"1",text:this.texts.or}],this.config.children.left.dd_cond_sec_cond,s,60,"left",o.sevTwoOp)),n.push(this._getDropDown("style_dd_cond_sec"+a,d,this.config.children.left.dd_cond_sec,s,50,"left",o.sevTwoPos)),n.push(this._getNumericInput("style_input_cond_sec"+a,this.config.children.left.input_cond_sec,s,70,o.sevTwo)),n.push(this._getRect("style_rect_separator_"+a,this.config.children.left.rect_separator,t,600));var c=this._getOneRowOffset(i);return n.push(this._getImage("style_button_add_"+a,"widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,c)),n},i._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){var i={name:"",namePos:"",state:"",statePos:0,sevOneUse:!1,sevOnePos:4,sevOne:0,sevTwoUse:!1,sevTwoOp:0,sevTwoPos:2,sevTwo:0},s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.input_style].id);i.name=s.text,i.namePos=parseInt(s.value),s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.dd_state].id),i.state=s.text,i.statePos=parseInt(s.value),i.sevOneUse=brease.callWidget(this.config.rows[t].widgets[this.config.children.check_cond_first].id,"getValue"),i.sevOneUse&&(i.sevOne=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.input_cond_first].id,"getValue")),i.sevOnePos=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_first].id,"getSelectedValue"))),i.sevTwoUse=brease.callWidget(this.config.rows[t].widgets[this.config.children.check_cond_sec].id,"getValue"),i.sevTwoUse&&(i.sevTwo=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.input_cond_sec].id,"getValue")),i.sevTwoOp=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_sec_cond].id,"getSelectedValue")),i.sevTwoPos=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_sec].id,"getSelectedValue"))),e.push(i)}return void 0===this.config?this.widget.settings.config.style:e},t}),define("widgets/brease/AlarmHistory/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{filter:{title:"Configuration dialog to filter the alarm history",col:"Column",op:"Operator",val:"Value",and:"and",or:"or",act:"active",inact:"inactive",actack:"active acknowledged",inactack:"inactive acknowledged"},sort:{title:"Configuration dialog to sort the alarm history",col:"Column",sort:"Sort",by:"By",first:"First",inc:"increasing",dec:"decreasing",then:"then",az:"A - Z",za:"Z - A",old:"oldest first",new:"newest first"},style:{title:"Configuration dialog to style the alarm history",style:"Set style",state:"if alarm is",act:"active",actack:"active acknowledged",inact:"inactive",inactack:"inactive acknowledged",any:"any",sev:"and severity condition",and:"and",or:"or"}},de:{filter:{title:"Konfigurationsdialog zum Filtern der Alarmhistorie",col:"Spalte",op:"Operator",val:"Wert",and:"und",or:"oder",act:"aktiv",inact:"inaktiv",actack:"aktiv bestätigt",inactack:"inaktiv bestätigt"},sort:{title:"Konfigurationsdialog zum Sortieren der Alarmhistorie",col:"Spalte",sort:"Sortieren",by:"Nach",first:"Zuerst",inc:"aufsteigend",dec:"absteigend",then:"dann",az:"A - Z",za:"Z - A",old:"älteste",new:"neueste"},style:{title:"Konfigurationsdialog zum Stylen der Alarmhistorie",act:"aktiv",inact:"inaktiv",actack:"aktiv bestätigt",inactack:"inaktiv bestätigt",any:"alle",sev:"und Schweregrad ist",and:"und",or:"oder",style:"Style festlegen",state:"wenn Alarm ist"}}}}return new DialogueTexts}),define("widgets/brease/TableWidget/libs/TextRetriever",["brease/services/RuntimeService"],function(e){"use strict";return{getTexts:function(t,i,s,n,a,r){function o(e){for(var t in i[n])if(i[n].hasOwnProperty(t)){var a=e["IAT/Widgets/"+s+"/"+n+"."+t];void 0!==a&&(i[n][t]=a)}r.resolve()}e.loadTexts(t,o)}}}),define("widgets/brease/AlarmHistory/libs/Dialogue",["widgets/brease/TableWidget/libs/Dialogue","brease/enum/Enum","widgets/brease/TableWidget/libs/FilterSettings","widgets/brease/TableWidget/libs/SortingSettings","widgets/brease/AlarmHistory/libs/StylingSettings","widgets/brease/AlarmHistory/libs/DialogueTexts","widgets/brease/TableWidget/libs/TextRetriever"],function(e,Enum,t,i,s,Texts,TextRetriever){"use strict";var n=e.extend(function Dialogue(){e.apply(this,arguments)},null),a=n.prototype;return a.initialize=function(e){switch(e){case Enum.MappTableConfigurationType.Filtering:this.filter=new t(this.dialog,this.widget,this.actualLang,this.widget.model.categories,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Sorting:this.sort=new i(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Styling:this.style=new s(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break}return this._initializeEmptyDialogConfig(Texts[this.lang][e].title),this.config},a.setUpTexts=function(e,t,i,s){this.texts=TextRetriever.getTexts(t,Texts[i],"AlarmHistory",s,this,e)},n}),define("widgets/brease/AlarmHistory/libs/Controller",["widgets/brease/TableWidget/libs/Controller","brease/events/BreaseEvent","widgets/brease/AlarmHistory/libs/Dialogue"],function(e,BreaseEvent,t){"use strict";var i=e.extend(function Controller(t){e.call(this),this.widget=t},null),s=i.prototype;return s._addClassSpecificEventListeners=function(e){document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,e._bind("_contentActivatedHandler"))},s._contentActivatedHandler=function(e){e.detail.contentId===this.widget.settings.parentContentId&&this&&(document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),void 0!==this.widget.bindings&&void 0!==this.widget.bindings.mpLink||brease.config.preLoadingState||this._setMissingBindingErrorMsg(),this.widget.linkHandler.subscribeWithCallback("GetUpdateCount",this.widget._updateData),this.widget.model.getCategories())},s._contentDeactivatedHandler=function(){this.widget.linkHandler.unSubscribe("GetUpdateCount")},s.languageChanged=function(){this.widget.model.reFetchData()},s.getEventItem=function(e){var t=this.widget.model.getRowFromCurrentData(e);return{additionalInfo1:t.ad1,additionalInfo2:t.ad2,category:t.cat,code:t.cod,instanceID:t.ins,message:t.mes,name:t.nam,scope:t.sco,severity:t.sev,oldState:t.sto,newState:t.stn,timestamp:t.tim.substring(0,23)+"Z"}},s.updateData=function(){this.widget.model.setMockData(),this.widget.renderer.updateData()},s.getTotalNumberOfPages=function(){return this.widget.model.getTotalNumberOfPages()},s.openConf=function(e){this.configDialogue=new t(this.widget),this.configDialogue.open(e)},s._scrolledToBottom=function(){this.internal.firstItr&&!this.widget.settings.paging?(this.widget.renderer.draw(),this.internal.firstItr=!1):this.widget.model.fetchNextData()},s.dispose=function(){document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),e.prototype.dispose.apply(this,arguments)},i}),define("widgets/brease/AlarmHistory/libs/Config",[],function(){"use strict";return{rowsPerFetch:1e3,fetchInterval:1e3,imagePrefix:"",imageSuffix:".png",imageActive:"",imageAcknowledged:"",imageInactive:"",imageUnacknowledged:"",mpLink:"",type:"AlarmHistory",config:{columns:[],columnWidths:[],columnTypes:{ad1:"str",ad2:"str",cat:"int",cod:"int",ins:"int",mes:"str",nam:"str",sco:"str",sev:"int",stn:"int",sto:"int",tim:"date"},style:[],order:[],hidden:{data:"RecordIndex"},filter:[],sort:[],original:{order:[]}}}}),define("widgets/brease/AlarmHistory/libs/Renderer",["widgets/brease/TableWidget/libs/Renderer","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var t=e.extend(function Renderer(t){e.call(this),this.widget=t},null),i=t.prototype;return i.setFilter=function(){var e=this;this.internal.filterSet||($.fn.dataTable.ext.search.push(function(t,i,s,n){var a=$(t.nTable).closest('[data-brease-widget="widgets/brease/AlarmHistory"]')[0];if(!a||a.id!==e.widget.elem.id||0===e.widget.model.getPreparedData().length)return!0;for(var r=0===e.widget.settings.config.filter.length,o=!0,l=0;l<e.widget.settings.config.filter.length;l+=1){var d=e.widget.settings.config.filter[l],c,h,u=e._getComparativeAndOriginalValue(d,e.widget.model.currentData[s]);h=u[1],c=u[0];var g=e._getFilterStatement(h,d.opVal,c);1===d.logVal||""===d.logical?(r=r||o&&g,o=!0):0===d.logVal&&(o=o&&g)}return r}),this.internal.filterSet=!0,this.internal.filterPos=$.fn.dataTable.ext.search.length-1)},i._getComparativeAndOriginalValue=function(e,t){var i,s;return"tim"===e.data?(i=this._fixTimestamp(e.comp.split("Z")[0]).getTime(),s=this._fixTimestamp(t.tim).getTime()):"cat"===e.data?(i=this.widget.model.categories[e.comp],s=t[e.data]):(i=e.comp,s=t[e.data]),[i,s]},i._colorMeBlue=function(){this.widget.settings.optimize?this._setStyleRowOptimized():this._setStyleRowNotOptimized()},i._setStyleRowOptimized=function(){if(void 0!==this.widget.model.currentData&&this.dt.exists()&&0!==this.widget.model.currentData.length)for(var e=0;e<this.widget.el.find("tbody").children().length;e+=1)for(var t=0;t<this.widget.settings.config.style.length;t+=1){var i=this.widget.el.find("tbody").children("tr:eq("+e+")").data("recordindex"),s=this.widget.model.currentData,n=Object.keys(s).find(function(e){if(s[e].RecordIndex===i)return e});if(void 0!==n){var a=this.widget.model.currentData[n].sev,r=this.widget.model.currentData[n].stn,o=this._rowEligibility(r,a,this.widget.settings.config.style[t]),l=i;o&&this.widget.el.find("tbody").find("[data-recordindex="+l+"]").addClass("widgets_brease_AlarmHistoryStyle_style_style"+this.widget.settings.config.style[t].namePos)}}},i._setStyleRowNotOptimized=function(){if(void 0!==this.widget.model.currentData&&this.dt.exists()&&0!==this.widget.model.currentData.length)for(var e=0;e<this.widget.el.find("tbody").children().length;e+=1)for(var t=0;t<this.widget.settings.config.style.length;t+=1){var i=this.dt.getFilteredPage()*this.widget.settings.itemsPerPage+e,s=this.dt.getFilteredOffset(i);if(void 0!==s){var n=this.widget.model.currentData[s].sev,a=this.widget.model.currentData[s].stn,r=this._rowEligibility(a,n,this.widget.settings.config.style[t]);r&&this.widget.el.find("tbody").children("tr:eq("+e+")").addClass("widgets_brease_AlarmHistoryStyle_style_style"+this.widget.settings.config.style[t].namePos)}}},i._rowEligibility=function(e,t,i){return(e===i.statePos||5===i.statePos)&&(i.sevOneUse&&i.sevTwoUse&&0===i.sevTwoOp?this._getFilterStatement(t,i.sevOnePos,i.sevOne)&&this._getFilterStatement(t,i.sevTwoPos,i.sevTwo):i.sevOneUse&&i.sevTwoUse&&1===i.sevTwoOp?this._getFilterStatement(t,i.sevOnePos,i.sevOne)||this._getFilterStatement(t,i.sevTwoPos,i.sevTwo):!(i.sevOneUse&&!i.sevTwoUse)||this._getFilterStatement(t,i.sevOnePos,i.sevOne))},i._pageChange=function(){if(this.dt.exists()){var e,t=this._getDataTablePageInfo().page+1;e=this.internal.searchInProgress||this.widget.settings.filterConfiguration.length>0?this._getDataTablePageInfo().pages:this.widget.controller.getTotalNumberOfPages(),this.widget.controller._pageChange(t,e)}},i._updateLastbutton=function(){if(!(this.internal.searchInProgress||this.widget.settings.filterConfiguration.length>0)){var e=this.widget.controller.getTotalNumberOfPages();this.widget.el.find(".paginate_button").length>2&&(0===this.widget.el.find(".ellipsis").length&&this._getDataTablePageInfo().pages<e?this._addEllipsis(e):this.widget.el.find(".paginate_button:eq(-2)").text(e))}},i._addEllipsis=function(e){$('<span class="ellipsis">...</span><a class="paginate_button widgets_brease_ToggleButton_style_default breaseButton"><span>'+e+"</span></a>").one(BreaseEvent.CLICK,this._bind(this.widget.controller._scrolledToBottom)).insertBefore(this.widget.el.find(".paginate_button:last"))},t}),define("widgets/brease/common/MpLinkHandler/libs/MpLinkHandler",["brease/core/Class"],function(e){"use strict";var t=e.extend(function MpLinkHandler(t){e.call(this),this.widget=t,this.init()},null),i=t.prototype;return i.init=function(){this.reset()},i.reset=function(){this.componentActive=!1,this.callbackQueue=[],this.queueUntilComponentIsActive=[]},i.dispose=function(){this.callbackQueue.length>0&&console.iatDebug("Open requests...")},i.incomingMessage=function(e){if(!(null===e||""===e||this.componentActive&&void 0===e.parameter))return this.componentActive?(e.parameter.widgetId===this.widget.elem.id&&(e.error&&this.widget._onErrorHandler(e.error.code),e.response?this._handleCallbackItem(e):console.iatDebug("Unexpected telegram recieved",this.widget.elem.id,e)),
void 0):(this._updateComponentActiveState(e),void 0)},i._handleCallbackItem=function(e){var t,i=this._getIndexInQueue(e.methodID);if(i>-1)switch(t=this.callbackQueue[i],t.type){case"REQUEST":t.callback.call(this.widget,e.response,e),this.callbackQueue.splice(i,1);break;case"SUBSCRIPTION":t.callback.call(this.widget,e.response,e);break;case"UNSUBSCRIPTION":this.callbackQueue.splice(i,1);break}else console.iatDebug("Response without callback to handle it",e)},i.sendMessage=function(e){return this.componentActive?void 0===e?(this.widget.sendValueChange({mpLink:{}}),void 0):(void 0===e.parameter||null===e.parameter?e.parameter={widgetId:this.widget.elem.id}:e.parameter.widgetId=this.widget.elem.id,this.widget.sendValueChange({mpLink:e}),void 0):(this._handleInactiveComponent(e),void 0)},i.sendRequestAndProvideCallback=function(e,t,i,s){var n={request:"Get",methodID:e};void 0!==i&&(n.data=i),void 0!==s&&(n.parameter=s),this.callbackQueue.push({method:e,callback:t,type:"REQUEST"}),this.sendMessage(n)},i.sendDataAndProvideCallback=function(e,t,i,s){var n={request:"Set",methodID:e};void 0!==i&&(n.data=i),void 0!==s&&(n.parameter=s),this.callbackQueue.push({method:e,callback:t,type:"REQUEST"}),this.sendMessage(n)},i.subscribeWithCallback=function(e,t,i,s){var n={request:"Subscribe",methodID:e};void 0!==i&&(n.data=i),void 0!==s&&(n.parameter=s),this.callbackQueue.push({method:e,callback:t,type:"SUBSCRIPTION"}),this.sendMessage(n)},i.unSubscribe=function(e,t){var i={request:"Unsubscribe",methodID:e},s=this._getIndexInQueue(e);void 0!==t&&(i.parameter=t),s>-1&&(this.callbackQueue[s].type="UNSUBSCRIPTION"),this.sendMessage(i)},i._getIndexInQueue=function(e){return _.findIndex(this.callbackQueue,function(t){return t.method===e})},i._handleInactiveComponent=function(e){this.queueUntilComponentIsActive.push(e)},i._handleComponentSwitchedToActive=function(){var e=this;$.each(this.queueUntilComponentIsActive,function(){e.sendMessage(this)}),this.queueUntilComponentIsActive=[]},i._handleComponentNotYetActive=function(e){this.widget._onErrorHandler(e.error.code)},i._updateComponentActiveState=function(e){"GetActiveState"===e.methodID&&("OK"===e.response?(this.componentActive=!0,this._handleComponentSwitchedToActive()):this._handleComponentNotYetActive(e))},t}),define("widgets/brease/AlarmHistory/AlarmHistory",["widgets/brease/TableWidget/TableWidget","widgets/brease/AlarmHistory/libs/Model","widgets/brease/AlarmHistory/libs/Controller","widgets/brease/AlarmHistory/libs/Config","widgets/brease/AlarmHistory/libs/Renderer","widgets/brease/common/MpLinkHandler/libs/MpLinkHandler"],function(e,Model,Controller,t,Renderer,MpLinkHandler){"use strict";var i=t,s=e.extend(function AlarmHistory(){e.apply(this,arguments)},i),n=s.prototype;return n.initModel=function(){this.linkHandler=new MpLinkHandler(this),this.model=new Model(this),this.model.initialize()},n.initController=function(){this.controller=new Controller(this),this.controller.initialize()},n.initRenderer=function(){this.renderer=new Renderer(this),this.renderer.initialize()},n.setImagePrefix=function(e){this.settings.imagePrefix=e,brease.config.editMode&&this.controller.updateData()},n.getImagePrefix=function(){return this.settings.imagePrefix},n.setImageSuffix=function(e){this.settings.imageSuffix=e,brease.config.editMode&&this.controller.updateData()},n.getImageSuffix=function(){return this.settings.imageSuffix},n.setImageActive=function(e){this.settings.imageActive=e,brease.config.editMode&&this.controller.updateData()},n.getImageActive=function(){return this.settings.imageActive},n.setImageInactive=function(e){this.settings.imageInactive=e,brease.config.editMode&&this.controller.updateData()},n.getImageInactive=function(){return this.settings.imageInactive},n.setImageAcknowledged=function(e){this.settings.imageAcknowledged=e,brease.config.editMode&&this.controller.updateData()},n.getImageAcknowledged=function(){return this.settings.imageAcknowledged},n.setImageUnacknowledged=function(e){this.settings.imageUnacknowledged=e,brease.config.editMode&&this.controller.updateData()},n.getImageUnacknowledged=function(){return this.settings.imageUnacknowledged},n.setMpLink=function(e){brease.config.preLoadingState||this.linkHandler.incomingMessage(e)},n.getMpLink=function(){return this.settings.mpLink},n._updateData=function(e,t){e.includes("Error")||this.model.setData(t)},n.onBeforeDispose=function(){this.controller._contentDeactivatedHandler(),e.prototype.onBeforeDispose.apply(this,arguments)},n.wake=function(){this.controller._addClassSpecificEventListeners(this.controller),e.prototype.wake.apply(this,arguments)},n.onBeforeSuspend=function(){this.controller._contentDeactivatedHandler(),this.linkHandler.reset(),e.prototype.onBeforeSuspend.apply(this,arguments)},s}),define("widgets/brease/DataHandlerWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DataHandlerWidget",parents:["*"],children:[],inheritance:["widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/TableWidget/designer/ClassInfo",["widgets/brease/DataHandlerWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableWidget",parents:["*"],children:["widgets.brease.TableColumnWidget"],inheritance:["widgets.brease.TableWidget","widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GoToFirstPage:{method:"goToFirstPage"},GoToLastPage:{method:"goToLastPage"},GoToNextPage:{method:"goToNextPage"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"Integer"}}},GoToPreviousPage:{method:"goToPreviousPage"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"MappTableConfigurationType"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setHeaderHeight:{method:"setHeaderHeight",parameter:{headerHeaderHeight:{name:"headerHeaderHeight",index:0,type:"PixelVal"}}},setItemsPerPage:{method:"setItemsPerPage",parameter:{itemsPerPage:{name:"itemsPerPage",index:0,type:"Integer"}}},setNextText:{method:"setNextText",parameter:{nextText:{name:"nextText",index:0,type:"String"}}},setNextTextKey:{method:"setNextTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setPaging:{method:"setPaging",parameter:{paging:{name:"paging",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPreviousText:{method:"setPreviousText",parameter:{previousText:{name:"previousText",index:0,type:"String"}}},setPreviousTextKey:{method:"setPreviousTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"String"}}},setSearchBox:{method:"setSearchBox",parameter:{searchBox:{name:"searchBox",index:0,type:"Boolean"}}},setShowPagingButtons:{method:"setShowPagingButtons",parameter:{showPagingButtons:{name:"showPagingButtons",index:0,type:"Boolean"}}},setSortConfiguration:{method:"setSortConfiguration",parameter:{sortConfiguration:{name:"sortConfiguration",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setStyleConfiguration:{method:"setStyleConfiguration",parameter:{styleConfiguration:{name:"styleConfiguration",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/AlarmHistory/designer/ClassInfo",["widgets/brease/TableWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmHistory",parents:["*"],children:["widgets.brease.AlarmHistoryItem"],inheritance:["widgets.brease.AlarmHistory","widgets.brease.TableWidget","widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GoToFirstPage:{method:"goToFirstPage"},GoToLastPage:{method:"goToLastPage"},GoToNextPage:{method:"goToNextPage"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"Integer"}}},GoToPreviousPage:{method:"goToPreviousPage"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"MappTableConfigurationType"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setHeaderHeight:{method:"setHeaderHeight",parameter:{headerHeaderHeight:{name:"headerHeaderHeight",index:0,type:"PixelVal"}}},setImageAcknowledged:{method:"setImageAcknowledged",parameter:{imageAcknowledged:{name:"imageAcknowledged",index:0,type:"ImagePath"}}},setImageActive:{method:"setImageActive",parameter:{imageActive:{name:"imageActive",index:0,type:"ImagePath"}}},setImageInactive:{method:"setImageInactive",parameter:{imageInactive:{name:"imageInactive",index:0,type:"ImagePath"}}},setImagePrefix:{method:"setImagePrefix",parameter:{imagePrefix:{name:"imagePrefix",index:0,type:"DirectoryPath"}}},setImageSuffix:{method:"setImageSuffix",parameter:{imageSuffix:{name:"imageSuffix",index:0,type:"ImageType"}}},setImageUnacknowledged:{method:"setImageUnacknowledged",parameter:{imageUnacknowledged:{name:"imageUnacknowledged",index:0,type:"ImagePath"}}},setItemsPerPage:{method:"setItemsPerPage",parameter:{itemsPerPage:{name:"itemsPerPage",index:0,type:"Integer"}}},setMpLink:{method:"setMpLink",parameter:{telegram:{name:"telegram",index:0,type:"MpComIdentType"}}},setNextText:{method:"setNextText",parameter:{nextText:{name:"nextText",index:0,type:"String"}}},setNextTextKey:{method:"setNextTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setPaging:{method:"setPaging",parameter:{paging:{name:"paging",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPreviousText:{method:"setPreviousText",parameter:{previousText:{name:"previousText",index:0,type:"String"}}},setPreviousTextKey:{method:"setPreviousTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"String"}}},setSearchBox:{method:"setSearchBox",parameter:{searchBox:{name:"searchBox",index:0,type:"Boolean"}}},setShowPagingButtons:{method:"setShowPagingButtons",parameter:{showPagingButtons:{name:"showPagingButtons",index:0,type:"Boolean"}}},setSortConfiguration:{method:"setSortConfiguration",parameter:{sortConfiguration:{name:"sortConfiguration",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setStyleConfiguration:{method:"setStyleConfiguration",parameter:{styleConfiguration:{name:"styleConfiguration",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AlarmHistoryItem/AlarmHistoryItem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmHistoryItem">CONTENT</div>'}),define("widgets/brease/common/libs/wfUtils/SVGCache",[],function(){"use strict";var SVGCache={contains:function(t){return void 0!==e[t]},add:function(t){e[t]={deferred:$.Deferred(),resolve:function(e){this.deferred.resolve(e)}}},resolve:function(t,i){e[t].resolve(i)},done:function(t,i){return e[t].deferred.done(i)}},e={};return SVGCache}),define("widgets/brease/common/libs/wfUtils/UtilsImage",["libs/d3/d3","widgets/brease/common/libs/wfUtils/SVGCache","brease/controller/libs/LogCode","brease/enum/Enum","brease/core/Utils"],function(e,SVGCache,LogCode,Enum,Utils){"use strict";var UtilsImage={};UtilsImage.getInlineSvg=function(a,r,o,l){var d=$.Deferred();return r=!0===r,l=!0===l,Utils.hasSameOrigin(a)?(SVGCache.contains(a)?SVGCache.done(a,function(e){e?n(e,a,o,d):d.reject()}):(l&&SVGCache.add(a),e.xml(a).mimeType("image/svg+xml").get(i.bind(null,a,d,o,r,l))),d):(s(a,r,l,d),t(a),d)};function t(e){var t=LogCode.getConfig(LogCode.CROSS_ORIGIN_REQUEST_BLOCKED);brease.loggerService.log(t.code,Enum.EventLoggerCustomer.BUR,t.verboseLevel,t.severity,[e])}function i(e,t,i,a,r,o,l){o||null===l?s(e,a,r,t):(r&&SVGCache.resolve(e,l.documentElement.outerHTML),n(l.documentElement,e,i,t))}function s(e,t,i,s){if(!0===t)i&&SVGCache.resolve(e),s.reject();else{var n=UtilsImage.getBrokenSvg();i&&SVGCache.resolve(e,n.outerHTML),s.resolve($(n))}}function n(e,t,i,s){void 0===i||i[i.length-1]===t?s.resolve($(e)):i.shift()}return UtilsImage.isStylable=function(e){var t;return t=""!==e&&void 0!==e&&null!==e&&"svg"===e.split(".").pop(),t},UtilsImage.getBrokenSvg=function(){var t=document.createElementNS(e.ns.prefix.svg,"svg"),i=e.select(t).attr("style","width: 20px; height:23px");return i.append("line").attr("x1",3.75).attr("y1",-.069449).attr("x2",.75).attr("y2",23).attr("stroke","#b2b2b2").attr("stroke-width",1.5),i.append("line").attr("x1",23).attr("y1",22.25).attr("x2",0).attr("y2",22.25).attr("stroke","#666666").attr("stroke-width",1.5),i.append("line").attr("x1",22.521265).attr("y1",3.787241).attr("x2",22.521265).attr("y2",16.808505).attr("stroke","#666666").attr("stroke-width",1.5),i.append("line").attr("x1",19.25).attr("y1",5.202132).attr("x2",19.25).attr("y2",23).attr("stroke","#666666").attr("stroke-width",1.5),i.append("rect").attr("height",3.339856).attr("width",15.40424).attr("x",2.297881).attr("y",17.436729).attr("stroke","#00bf00").attr("stroke-width",1.5).attr("fill","#00bf00"),i.append("rect").attr("height",7.914511).attr("width",14.553177).attr("x",2.808519).attr("y",8.01064).attr("stroke","#97c9fc").attr("stroke-width",2.5).attr("fill","#97c9fc"),i.append("rect").attr("height",3.489358).attr("width",8.51063).attr("x",2.808518).attr("y",2.563837).attr("stroke","#97c9fc").attr("stroke-width",2.5).attr("fill","#97c9fc"),i.append("ellipse").attr("rx",1.548673).attr("ry",.309735).attr("cx",5.840707).attr("cy",5.615045).attr("stroke","#ffffff").attr("stroke-width",1.5),i.append("ellipse").attr("rx",7.743362).attr("ry",2.964602).attr("cx",10.088495).attr("cy",16.676991).attr("stroke","#00bf00").attr("stroke-width",1.5).attr("fill","#00bf00"),i.append("line").attr("x1",21.814158).attr("y1",12.207965).attr("x2",7.743362).attr("y2",25.039822).attr("stroke","#ffffff").attr("stroke-width",3.5),i.append("line").attr("x1",12.964601).attr("y1",.349558).attr("x2",19.690264).attr("y2",6.013275).attr("stroke","#666666").attr("stroke-width",1.5),i.append("line").attr("x1",0).attr("y1",.615045).attr("x2",13.672565).attr("y2",.792036).attr("stroke","#b2b2b2").attr("stroke-width",1.5),i.append("line").attr("x1",12.964601).attr("y1",-.09292).attr("x2",13.053096).attr("y2",6.89823).attr("stroke","#666666").attr("stroke-width",1.5),i.append("line").attr("x1",19.867255).attr("y1",6.190266).attr("x2",12.610619).attr("y2",6.278761).attr("stroke","#666666").attr("stroke-width",1.5),t},UtilsImage}),define("widgets/brease/TableColumnWidget/TableColumnWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/core/Types","brease/decorators/LanguageDependency","widgets/brease/common/libs/wfUtils/UtilsImage"],function(e,BreaseEvent,Types,LanguageDependency,UtilsImage){"use strict";var t={text:"",columnType:"",textKey:""},i=e.extend(function TableColumnWidget(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){e.prototype.init.call(this),this.el.addClass("breaseTableColumnWidget"),this.nameEl=$('<div class="headerText"></div>'),this.imgEl=$("<svg></svg>");var t=this;UtilsImage.getInlineSvg("widgets/brease/TableColumnWidget/assets/sort_arrow.svg").then(function(e){t.imgEl.replaceWith(e),t.imgEl=e,t.imgEl.addClass("ordering")}),this.el.append(this.nameEl),this.el.append(this.imgEl),this.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),this.appendEventListeners(),this.el.off(BreaseEvent.CLICK,this._bind("_clickHandler")),this.setText(this.settings.text)},s.appendEventListeners=function(){this.el.off(BreaseEvent.CLICK,this._bind("_widgetOrderHandler")).on(BreaseEvent.CLICK,this._bind("_widgetOrderHandler"))},s.setText=function(e){void 0!==e&&(!1===brease.language.isKey(e)?this.updateText(e):this.setTextKey(brease.language.parseKey(e)))},s.getText=function(){return this.settings.text},s.setTextKey=function(e){void 0!==e&&(this.settings.textkey=e,this.updateText(brease.language.getTextByKey(this.settings.textkey)),this.setLangDependency(!0))},s.getTextKey=function(){return this.settings.textkey},s.updateText=function(e){null!==e&&(this.settings.text=Types.parseValue(e,"String"),this.el.find(".headerText").text(this.settings.text))},s.removeTextKey=function(){this.settings.textkey=null,this.setLangDependency(!1)},s.setColumnType=function(e){this.settings.columnType=e},s.getColumnType=function(){return this.settings.columnType},s.getShortColumnType=function(){return{data:this.settings.columnType}},s.getKey=function(e,t){for(var i in e)if(e[i]===t)return i},s.getWidth=function(){return this.settings.width},s.updateImage=function(e){this.el.find(".ordering").attr("src",e)},s._widgetReadyHandler=function(e){e.target.id===this.elem.id&&this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler"))},s._editorStyleChanged=function(e){this.widthUpdate(this.getWidth())},s.resetOrdering=function(e){this.order=void 0,this.el.find("svg > g > path:eq(0)").removeClass("selected").removeClass("unselected").addClass("unselected"),this.el.find("svg > g > path:eq(1)").removeClass("selected").removeClass("unselected").addClass("unselected")},s._widgetOrderHandler=function(e){if(!this.isDisabled){var t,i;void 0===this.order?(this.order="desc",t="unselected",i="selected"):"desc"===this.order?(this.order="asc",t="selected",i="unselected"):"asc"===this.order&&(this.order=void 0,t="unselected",i="unselected"),this.el.find("svg > g > path:eq(0)").removeClass("selected").removeClass("unselected").addClass(t),this.el.find("svg > g > path:eq(1)").removeClass("selected").removeClass("unselected").addClass(i);var s=new CustomEvent("ColumnOrderChanged",{detail:{id:this.elem.id,order:this.order},bubbles:!0,cancelable:!0});this.dispatchEvent(s)}},s.widthUpdate=function(e){var t=new CustomEvent("ColumnWidthChanged",{detail:{id:this.elem.id,newWidth:e},bubbles:!0,cancelable:!0});this.dispatchEvent(t)},s.dispose=function(){this.el.off(BreaseEvent.CLICK,this._bind("_widgetOrderHandler")),e.prototype.dispose.apply(this,arguments)},s.langChangeHandler=function(e){void 0===e&&void 0===e.detail||this.setText(brease.language.getTextByKey(this.settings.textkey))},s._initEditor=function(){var e=this;this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_editorStyleChanged")),e.designer.options={isRelocatable:!1},require(["widgets/brease/TableColumnWidget/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()}})},LanguageDependency.decorate(i,!1)}),define("widgets/brease/AlarmHistoryItem/AlarmHistoryItem",["widgets/brease/TableColumnWidget/TableColumnWidget","brease/events/BreaseEvent","brease/core/Types","brease/enum/Enum"],function(e,BreaseEvent,Types,Enum){"use strict";var t={text:"",columnType:Enum.AlarmHistoryItemType.mes},i=e.extend(function AlarmHistoryItem(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){e.prototype.init.call(this),this.el.addClass("breaseItem")},s.setColumnType=function(e){this.settings.columnType=e;var t=new CustomEvent("ColumnTypeChanged",{detail:{columnType:Enum.AlarmHistoryItemType.getKeyForValue(e)},bubbles:!0,cancelable:!0});this.dispatchEvent(t)},s.getColumnType=function(){return this.settings.columnType},s.getShortColumnType=function(){return this.settings.columnType!==Enum.AlarmHistoryItemType.tim?{data:Enum.AlarmHistoryItemType.getKeyForValue(this.settings.columnType)}:{data:Enum.AlarmHistoryItemType.getKeyForValue(this.settings.columnType),type:"num",render:{_:"display",sort:"value"}}},s.setData=function(e){this.telegram=e},i}),define("widgets/brease/TableColumnWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableColumnWidget",parents:["widgets.brease.TableWidget"],children:[],inheritance:["widgets.brease.TableColumnWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setColumnType:{method:"setColumnType",parameter:{columnType:{name:"columnType",index:0,type:"String"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/AlarmHistoryItem/designer/ClassInfo",["widgets/brease/TableColumnWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmHistoryItem",parents:["widgets.brease.AlarmHistory"],children:[],inheritance:["widgets.brease.AlarmHistoryItem","widgets.brease.TableColumnWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setColumnType:{method:"setColumnType",parameter:{columnType:{name:"columnType",index:0,type:"brease.enum.AlarmHistoryItemType"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AlarmHistoryStyle/AlarmHistoryStyle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmHistoryStyle">CONTENT</div>\r\n'}),define("widgets/brease/TableWidgetStyle/TableWidgetStyle",["brease/core/BaseWidget"],function(e){"use strict";return e.extend(function TableWidgetStyle(){e.apply(this,arguments)},!1)}),define("widgets/brease/AlarmHistoryStyle/AlarmHistoryStyle",["widgets/brease/TableWidgetStyle/TableWidgetStyle"],function(e){"use strict";return e.extend(function AlarmHistoryStyle(){e.apply(this,arguments)},!1)}),define("widgets/brease/TableWidgetStyle/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableWidgetStyle",parents:["*"],children:[],inheritance:["widgets.brease.TableWidgetStyle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/AlarmHistoryStyle/designer/ClassInfo",["widgets/brease/TableWidgetStyle/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmHistoryStyle",parents:["*"],children:[],inheritance:["widgets.brease.AlarmHistoryStyle","widgets.brease.TableWidgetStyle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AlarmList/AlarmList.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmList">CONTENT</div>'}),define("widgets/brease/AlarmList/libs/Model",["widgets/brease/TableWidget/libs/Model"],function(e){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t,this.categories=[],this.firstConnection=!0},t),s=i.prototype;s.initialize=function(){this.errorMode=!1,e.prototype.initialize.call(this)},s.updateTable=function(e){if(void 0!==e){this.currentData=$.extend(!0,{},e),this.data=e;for(var t=0;t<e.length;t+=1)e[t].sta=this._addSVGToRow(e[t].sta),e[t].cat=this._fixCategory(e[t].cat),e[t].tim=this._fixTimestamp(e[t].tim),e[t].mes=_.escape(e[t].mes);this.widget.renderer.updateData(e)}},s.setMockData=function(){if(!brease.config.editMode)return!1;this.fetchData(n())},s.getInstanceId=function(e){return this.currentData[e].ins},s.setData=function(e){switch(e.methodID){case"GetCategoryList":this.setCategories(e);break;default:this.fetchData(e);break}},s.setCategories=function(e){this.categories=$.extend(!0,[],_.uniq(e.data))},s.fetchData=function(e){if(null!==e){var t=!1;this.telegram=$.extend(!0,{},e),"GetUpdateCount"===this.telegram.methodID?(this.widget._showBusyIndicator(),this.widget.settings.counter!==this.telegram.data&&(t=!0,this.widget.settings.counter=this.telegram.data),this.widget.langChanged&&(this.widget.langChanged=!1,this.widget.settings.counter=0,t=!0)):"GetAlarmList"===this.telegram.methodID?(this.isGetAlarmListPending=!1,this.updateTable(this.telegram.data)):"SetAcknowledge"===this.telegram.methodID&&"OK"===this.telegram.response&&(t=!0),t?this.sendData():this.widget._hideBusyIndicator()}},s.getCategories=function(){this.widget.linkHandler.sendRequestAndProvideCallback("GetCategoryList",this.widget._updateData)},s.sendAckData=function(e,t){this.ackAllFlag=void 0!==t&&t,this.widget.linkHandler.sendDataAndProvideCallback(e.methodID,this.widget._updateData,e.data,e.parameter)},s.sendData=function(){this.isGetAlarmListPending=!0,this.widget.linkHandler.sendRequestAndProvideCallback("GetAlarmList",this.widget._updateData)},s.wake=function(){this.isGetAlarmListPending&&this.sendData()},s._addSVGToRow=function(e){isNaN(e)&&(e=parseInt(e.match(/>[0-9]</)[0].match(/[0-9]/)[0]));var t="";return 1===e?t=""===this.widget.settings.imageActive?"widgets/brease/AlarmList/assets/act_nack.svg":this.widget.settings.imageActive:2===e?t=""===this.widget.settings.imageActiveAcknowledged?"widgets/brease/AlarmList/assets/act_ack.svg":this.widget.settings.imageActiveAcknowledged:3===e&&(t=""===this.widget.settings.imageInactive?"widgets/brease/AlarmList/assets/nact_nack.svg":this.widget.settings.imageInactive),'<img src="'+t+'" /><div class="stateIdent">'+e+"</div>"},s._fixCategory=function(e){var t="";return brease.config.editMode?t='<img src="widgets/brease/AlarmList/assets/'+e+'.svg" /><div class="catIdent">'+e+"</div>":e.length>0&&this.widget.settings.imagePrefix.length>0?t='<img src="'+this.widget.settings.imagePrefix+e+this.widget.settings.imageSuffix+'" /><div class="catIdent">'+e+"</div>":e.length>0&&(t='<img src="" /><div class="catIdent">'+e+"</div>"),t};function n(){return{data:[{ad1:"",ad2:"",cat:"cat0",cod:10,ins:0,mes:"All these alarms are mocked and are in no way real",nam:"Mocked Alarm",sco:"",sev:1,sta:1,tim:"1970-01-01T00:00:01.000+00:00"},{ad1:"",ad2:"",cat:"cat1",cod:2e3,ins:5,mes:"Mocked:  Temperature level is critical ",nam:"Mocked:  TemperatureCritical",sco:"",sev:1,sta:3,tim:"1970-01-01T11:33:15.141+00:00"},{ad1:"",ad2:"",cat:"cat1",cod:2001,ins:4,mes:"Mocked:  Temperature level is high",nam:"Mocked:  TemperatureHigh",sco:"",sev:2,sta:1,tim:"1970-01-01T11:33:15.141+00:00"},{ad1:"",ad2:"",cat:"cat2",cod:0,ins:3,mes:"Mocked:  Initialization failed,  temperature error",nam:"Mocked:  InitializationError",sco:"gAxisBasic",sev:2,sta:2,tim:"1970-01-01T11:31:56.541+00:00"},{ad1:"",ad2:"",cat:"cat2",cod:0,ins:2,
mes:"Mocked:  General axis error",nam:"Mocked:  GeneralDriveError",sco:"gAxisBasic",sev:1,sta:3,tim:"1970-01-01T11:31:56.341+00:00"},{ad1:"",ad2:"",cat:"cat0",cod:0,ins:1,mes:"Mocked:  Sequence import failed",nam:"Mocked:  ImportFailed",sco:"gSequencer",sev:1,sta:3,tim:"1970-01-01T11:31:55.741+00:00"},{ad1:"",ad2:"",cat:"cat0",cod:0,ins:6,mes:"Mocked:  Sequence import failed",nam:"Mocked:  ImportFailed",sco:"gSequencer",sev:1,sta:2,tim:"1970-01-01T11:31:55.865+00:00"}],methodID:"GetAlarmList",response:"OK"}}return i}),define("widgets/brease/AlarmList/libs/FilterSettings",["widgets/brease/TableWidget/libs/FilterSettings","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/TableWidget/libs/DialogStyles"],function(e,t,DialogStyles){var i=e.extend(function FilterSettings(t,i,s,n,a){this.texts=a,e.apply(this,arguments)},null),s=i.prototype;s.initialize=function(){if(this.config={},this.config.rows=[],this.config.cats=[],this.textSystemReady=new $.Deferred,this.config.children={delete_this_row:0,column_picker:1,operator:2,check_ext_options:3,label_ext_options:4,ext_options_state:5,add_next_row:6,logic_op_next_row:7,rect_separator:8,comp_value:9,left:{delete_this_row:50,column_picker:100,operator:270,check_ext_options:270,label_ext_options:300,ext_options_state:485,add_next_row:10,logic_op_next_row:5,rect_separator:70,comp_value:375}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:10,logicalOperatorHeight:20,currSeparatorTopOffset:135,filterlogicalTopOffset:125},this.config.loc.rowHeight=2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset,this._getCategoryNames(),this._initializeEmptyDialogConfig(),0!==this.widget.settings.config.filter.length){var e=this;$.when(this.textSystemReady.promise()).then(function t(){e._initializeStoredDialogConfig()})}return this.config},s._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+2*e*(this.config.loc.widgetHeight+this.config.loc.widgetOffset+5)+this.config.loc.offset},s._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+3*(e-1)*this.config.loc.widgetHeight+this.config.loc.offset},s._getCurrTop=function(e){return 60+2*e*this.config.loc.widgetHeight+3*e*this.config.loc.widgetOffset+this.config.loc.offset},s._getOneRowOffset=function(e){return e+2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},s._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){var i={logical:"",logVal:2,data:"",op:"",opVal:0,comp:"",ext:0,extCompVal:0};if(t<this.currRow-1){var s=this._getSelectedItemFromDataProvider(this.config.rows[t+1].widgets[this.config.children.logic_op_next_row].id);i.logical=s.text,i.logVal=s.value}i.data=brease.callWidget(this.config.rows[t].widgets[this.config.children.column_picker].id,"getSelectedValue");var n=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.operator].id);i.op=n.text,i.opVal=n.value;var a=0;9===this.config.rows[t].widgets.length&&(a=1),"sta"===i.data||"cat"===i.data?i.comp=brease.callWidget(this.config.rows[t].widgets[this.config.children.comp_value-a].id,"getSelectedValue"):i.comp=brease.callWidget(this.config.rows[t].widgets[this.config.children.comp_value-a].id,"getValue"),i.ext=brease.callWidget(this.config.rows[t].widgets[this.config.children.check_ext_options].id,"getValue"),i.ext&&(i.extCompVal=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.ext_options_state].id).value),e.push(i)}return void 0===this.config?this.widget.settings.config.filter:e},s._createRow=function(t){var i=e.prototype._createRow.apply(this,arguments),s=this._getCurrTop(t),a=40+s,r=[],o=30,l=i[0].name.slice(14),d={};return this.widget.settings.config.filter.length>0&&void 0!==this.widget.settings.config.filter[t]&&(d=this.widget.settings.config.filter[t]),r.push(n("Check_Ext_Options_"+l,this.config.children.left.check_ext_options,a,30,d.ext)),r.push(this._getLabel("Label_Ext_Options_State_"+l,this.texts.state,this.config.children.left.label_ext_options,a,180)),r.push(this._getDropDown("Dropdown_Ext_Options_State_"+l,[{value:0,text:this.texts.act},{value:1,text:this.texts.inact}],this.config.children.left.ext_options_state,a,110,30,d.extCompVal,"left")),i.splice.apply(i,[this.config.children.check_ext_options,0].concat(r)),i};function n(e,i,s,n,a,r){r=r||DialogStyles.DIALOG_WIDGETS_STYLE;var o=new t;return o.name=e,o.type="widgets/brease/CheckBox",o.x=i,o.y=s,o.width=n,o.height="30px",void 0!==a&&(o.options.value=a),o.options.style=r,o}return i}),define("widgets/brease/AlarmList/libs/StylingSettings",["widgets/brease/TableWidget/libs/StylingSettings","brease/core/Utils"],function(e,Utils){"use strict";var t=e.extend(function FilterSettings(t,i,s,n){this.texts=n,e.apply(this,arguments)},null),i=t.prototype;return i.initialize=function(){if(this.config={},this.config.rows=[],this.textSystemReady=new $.Deferred,this.setUpConfiguration(),this._getStyleNames(),this._initializeEmptyDialogConfig(),this.widget.settings.config.style.length>0){var e=this;$.when(this.textSystemReady.promise()).then(function t(){e._initializeStoredDialogConfig()})}return this.config},i.setUpConfiguration=function(){this.config.names=[],this.config.children={delete_this_row:0,label_style:1,input_style:2,label_state:3,dd_state:4,check_cond_first:5,dd_cond_first:6,input_cond_first:7,check_cond_sec:8,dd_cond_sec_cond:9,dd_cond_sec:10,input_cond_sec:11,rect_separator:12,add_next_row:13,left:{delete_this_row:50,label_style:75,input_style:185,label_state:330,dd_state:450,check_cond_first:30,dd_cond_first:230,input_cond_first:286,check_cond_sec:365,dd_cond_sec_cond:398,dd_cond_sec:468,input_cond_sec:528,rect_separator:0,add_next_row:10}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:10,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:125},this.config.loc.rowHeight=2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},i._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+3*(e-1)*this.config.loc.widgetHeight+this.config.loc.offset},i._getCurrTop=function(e){return 30+2*e*this.config.loc.widgetHeight+3*e*this.config.loc.widgetOffset+this.config.loc.offset},i._getOneRowOffset=function(e){return e+2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrTop(e),s=40+i,n=[],a=Utils.uniqueID();n.push(this._getImage("style_button_delete_"+a,"widgets/brease/TableWidget/assets/Delete.svg",this.config.children.left.delete_this_row,i)),n.push(this._getLabel("style_label_"+a,this.texts.style,this.config.children.left.label_style,i,150));var r=[{value:"1",text:this.config.names[0]},{value:"2",text:this.config.names[1]},{value:"3",text:this.config.names[2]},{value:"4",text:this.config.names[3]},{value:"5",text:this.config.names[4]},{value:"6",text:this.config.names[5]},{value:"7",text:this.config.names[6]},{value:"8",text:this.config.names[7]}],o={};this.widget.settings.config.style.length>0&&void 0!==this.widget.settings.config.style[e]?o=this.widget.settings.config.style[e]:(o.sevOnePos=4,o.sevTwoPos=2),n.push(this._getDropDown("style_input_"+a,r,this.config.children.left.input_style,i,140,"right",o.namePos)),n.push(this._getLabel("style_label_state_"+a,this.texts.state,this.config.children.left.label_state,i,150));var l=[{value:"1",text:this.texts.act},{value:"2",text:this.texts.actack},{value:"3",text:this.texts.inact},{value:"5",text:this.texts.any}];n.push(this._getDropDown("style_dropdown_state_"+a,l,this.config.children.left.dd_state,i,150,"left",o.statePos)),n.push(this._getCheckExtOptions("style_check_cond_first_"+a,this.texts.sev,this.config.children.left.check_cond_first,s,200,o.sevOneUse));var d=[{value:"0",text:"<>"},{value:"1",text:"=="},{value:"2",text:"<"},{value:"3",text:"<="},{value:"4",text:">"},{value:"5",text:">="}];n.push(this._getDropDown("style_dd_cond_first_"+a,d,this.config.children.left.dd_cond_first,s,50,"right",o.sevOnePos)),n.push(this._getNumericInput("style_input_cond_first_"+a,this.config.children.left.input_cond_first,s,70,o.sevOne)),n.push(this._getCheckExtOptions("style_check_cond_sec_"+a,"",this.config.children.left.check_cond_sec,s,30,o.sevTwoUse)),n.push(this._getDropDown("style_dd_cond_sec_cond"+a,[{value:"0",text:this.texts.and},{value:"1",text:this.texts.or}],this.config.children.left.dd_cond_sec_cond,s,60,"left",o.sevTwoOp)),n.push(this._getDropDown("style_dd_cond_sec"+a,d,this.config.children.left.dd_cond_sec,s,50,"left",o.sevTwoPos)),n.push(this._getNumericInput("style_input_cond_sec"+a,this.config.children.left.input_cond_sec,s,70,o.sevTwo)),n.push(this._getRect("style_rect_separator_"+a,this.config.children.left.rect_separator,t,600));var c=this._getOneRowOffset(i);return n.push(this._getImage("style_button_add_"+a,"widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,c)),n},i._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){var i={name:"",namePos:"",state:"",statePos:0,sevOneUse:!1,sevOne:0,sevOnePos:2,sevTwoUse:!1,sevTwo:0,sevTwoPos:4},s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.input_style].id);i.name=s.text,i.namePos=parseInt(s.value),s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.dd_state].id),i.state=s.text,i.statePos=parseInt(s.value),i.sevOneUse=brease.callWidget(this.config.rows[t].widgets[this.config.children.check_cond_first].id,"getValue"),i.sevOneUse&&(i.sevOne=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.input_cond_first].id,"getValue")),i.sevOnePos=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_first].id,"getSelectedValue"))),i.sevTwoUse=brease.callWidget(this.config.rows[t].widgets[this.config.children.check_cond_sec].id,"getValue"),i.sevTwoUse&&(i.sevTwo=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.input_cond_sec].id,"getValue")),i.sevTwoOp=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_sec_cond].id,"getSelectedValue")),i.sevTwoPos=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.dd_cond_sec].id,"getSelectedValue"))),e.push(i)}return void 0===this.config?this.widget.settings.config.style:e},t}),define("widgets/brease/AlarmList/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{filter:{title:"Configuration dialog to filter alarms",col:"Column",op:"Operator",val:"Value",state:"and state is",act:"active",inact:"inactive",actack:"active acknowledged",and:"and",or:"or"},sort:{title:"Configuration dialog to sort alarms",col:"Column",sort:"Sort",by:"By",first:"First",then:"then",inc:"increasing",dec:"decreasing",az:"A - Z",za:"Z - A",old:"oldest first",new:"newest first"},style:{title:"Configuration dialogue to style alarms",style:"Set style",state:"if alarm is",act:"active",inact:"inactive",actack:"active acknowledge",any:"any",sev:"and severity condition",and:"and",or:"or"}},de:{filter:{title:"Konfigurationsdialog zum Filtern von Alarmen",col:"Spalte",op:"Operator",val:"Wert",state:"und Status ist",and:"und",or:"oder",act:"aktiv",inact:"inaktiv",actack:"aktiv bestätigt"},sort:{title:"Konfigurationsdialog zum Sortieren von Alarmen",col:"Spalte",sort:"Sortieren",by:"Nach",first:"Zuerst",inc:"aufsteigend",dec:"absteigend",then:"dann",az:"A - Z",za:"Z - A",old:"älteste",new:"neueste"},style:{title:"Konfigurationsdialog zum Stylen von Alarmen",style:"Style festlegen",state:"wenn Alarm ist",act:"aktiv",inact:"inaktiv",actack:"aktiv bestätigt",any:"alle",sev:"und Schweregrad ist",and:"und",or:"oder"}}}}return new DialogueTexts}),define("widgets/brease/AlarmList/libs/Dialogue",["widgets/brease/TableWidget/libs/Dialogue","brease/enum/Enum","widgets/brease/AlarmList/libs/FilterSettings","widgets/brease/TableWidget/libs/SortingSettings","widgets/brease/AlarmList/libs/StylingSettings","widgets/brease/AlarmList/libs/DialogueTexts","widgets/brease/TableWidget/libs/TextRetriever"],function(e,Enum,t,i,s,Texts,TextRetriever){"use strict";var n=e.extend(function Dialogue(t){e.apply(this,arguments)},null),a=n.prototype;return a.initialize=function(e){switch(e){case Enum.MappTableConfigurationType.Filtering:this.filter=new t(this.dialog,this.widget,this.actualLang,this.widget.model.categories,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Sorting:this.sort=new i(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Styling:this.style=new s(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break}return this._initializeEmptyDialogConfig(Texts[this.lang][e].title),this.config},a.setUpTexts=function(e,t,i,s){this.texts=TextRetriever.getTexts(t,Texts[i],"AlarmList",s,this,e)},n}),define("widgets/brease/AlarmList/libs/Controller",["widgets/brease/TableWidget/libs/Controller","brease/events/BreaseEvent","widgets/brease/AlarmList/libs/Dialogue"],function(e,BreaseEvent,t){"use strict";var i=e.extend(function Controller(t){e.call(this),this.widget=t},null),s=i.prototype;return s._addClassSpecificEventListeners=function(e){document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,e._bind("_contentActivatedHandler"))},s.acknowledge=function(){if(this.widget.isDisabled)return!1;if(void 0!==this._getCurrentDataRow()){var e={request:"Set",methodID:"SetAcknowledge",parameter:{ins:this._getCurrentDataRow().ins,name:this.widget.elem.id}};this.selectedItem=void 0,this.widget.model.sendAckData(e)}},s.acknowledgeAll=function(){if(this.widget.isDisabled)return!1;var e={request:"Set",methodID:"SetAcknowledgeAll"};this.widget.model.sendAckData(e,!0)},s._contentActivatedHandler=function(e){e.detail.contentId===this.widget.settings.parentContentId&&this&&(document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),void 0!==this.widget.bindings&&void 0!==this.widget.bindings.mpLink||brease.config.preLoadingState||this._setMissingBindingErrorMsg(),this.widget.linkHandler.subscribeWithCallback("GetUpdateCount",this.widget._updateData),this.widget.model.getCategories())},s._contentDeactivatedHandler=function(){this.widget.linkHandler.unSubscribe("GetUpdateCount")},s.languageChanged=function(){this.widget.model.sendData(),this.widget.langChanged=!0},s.getEventItem=function(e){var t=this.widget.model.getRowFromCurrentData(e);return{additionalInfo1:t.ad1,additionalInfo2:t.ad2,category:t.cat,code:t.cod,instanceID:t.ins,message:t.mes,name:t.nam,scope:t.sco,severity:t.sev,state:t.sta,timestamp:t.tim.substring(0,23)+"Z"}},s.updateData=function(){this.widget.model.setMockData(),this.widget.renderer.updateData()},s.openConf=function(e){this.configDialogue=new t(this.widget),this.configDialogue.open(e)},s.dispose=function(){document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),e.prototype.dispose.apply(this,arguments)},i}),define("widgets/brease/AlarmList/libs/Config",[],function(){"use strict";return{imagePrefix:"",imageSuffix:".png",imageActive:"",imageActiveAcknowledged:"",imageInactive:"",mpLink:"",type:"AlarmList",config:{columns:[],allColumns:["ad1","ad2","cat","cod","ins","mes","nam","sco","sev","sta","tim"],columnWidths:[],columnTypes:{ad1:"str",ad2:"str",cat:"int",cod:"int",ins:"int",mes:"str",nam:"str",sco:"str",sev:"int",sta:"int",tim:"date"},style:[],order:[],hidden:{data:"ins"},filter:[],sort:[],original:{order:[]}}}}),define("widgets/brease/AlarmList/libs/Renderer",["widgets/brease/TableWidget/libs/Renderer"],function(e){"use strict";var t=e.extend(function Renderer(t){e.call(this),this.widget=t},null),i=t.prototype;return i.setFilter=function(){var e=this;this.internal.filterSet||($.fn.dataTable.ext.search.push(function(t,i,s,n){var a=$(t.nTable).closest('[data-brease-widget="widgets/brease/AlarmList"]')[0];if(!a||a.id!==e.widget.elem.id||0===e.widget.model.getPreparedData().length)return!0;for(var r=0===e.widget.settings.config.filter.length,o=!0,l=0;l<e.widget.settings.config.filter.length;l+=1){var d=e.widget.settings.config.filter[l],c=e._getComparativeAndOriginalValue(d,e.widget.model.currentData[s]),h=c[1],u=c[0],g=e._getFilterStatement(h,d.opVal,u);d.ext&&(g&=e._getNestedFilterStatement(d.extCompVal,h,e._getStatus(n.sta))),1===d.logVal||""===d.logical?(r=r||o&&g,o=!0):0===d.logVal&&(o=o&&g)}return r}),this.internal.filterSet=!0,this.internal.filterPos=$.fn.dataTable.ext.search.length-1)},i._getComparativeAndOriginalValue=function(e,t){var i,s;return"tim"===e.data?(i=this._fixTimestamp(e.comp.split("Z")[0]).getTime(),s=this._fixTimestamp(t.tim).getTime()):"sta"===e.data?(i=e.comp,s=this._getStatus(t[e.data])):"cat"===e.data?(i=this.widget.model&&this.widget.model.categories?this.widget.model.categories[e.comp]:void 0,s=t[e.data]):(i=e.comp,s=t[e.data]),[i,s]},i._getStatus=function(e){if("string"==typeof e){var t=e.match(/>\d</);return parseInt(e[t.index+1],10)}return e},i._getNestedFilterStatement=function(e,t,i){return 0===e&&(1===i||2===i)||1===e&&(3===i||4===i)},i._rowEligibility=function(e,t,i){return(e===i.statePos||5===i.statePos)&&(i.sevOneUse&&i.sevTwoUse&&0===i.sevTwoOp?this._getFilterStatement(t,i.sevOnePos,i.sevOne)&&this._getFilterStatement(t,i.sevTwoPos,i.sevTwo):i.sevOneUse&&i.sevTwoUse&&1===i.sevTwoOp?this._getFilterStatement(t,i.sevOnePos,i.sevOne)||this._getFilterStatement(t,i.sevTwoPos,i.sevTwo):!(i.sevOneUse&&!i.sevTwoUse)||this._getFilterStatement(t,i.sevOnePos,i.sevOne))},i._centerImages=function(){if(this.widget.el){var e="calc(50% - "+parseInt(this.widget.el.find("td > img").width()).toString()+")";this.widget.el.find("td > img").css("margin-left",e)}},i._colorMeBlue=function(){if(void 0!==this.widget.model.currentData&&0!==this.widget.model.currentData.length)for(var e=0;e<this.widget.el.find("tbody").children().length;e+=1)for(var t=0;t<this.widget.settings.config.style.length;t+=1){var i=this._colorMeBlueHelp(e);if(void 0!==i){var s=this.widget.model.currentData[i],n;s&&(n=this._rowEligibility(s.sta,s.sev,this.widget.settings.config.style[t])),n&&this.widget.el.find("tbody").children("tr:eq("+e+")").addClass("widgets_brease_AlarmListStyle_style_style"+this.widget.settings.config.style[t].namePos)}}},i._colorMeBlueHelp=function(e){if(this.dt.exists()){var t=this.dt.getFilteredPage()*this.widget.settings.itemsPerPage+e;return this.dt.getFilteredOffset(t)}},t}),define("widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents",[],function(){"use strict";return{}}),define("widgets/brease/AlarmList/AlarmList",["widgets/brease/TableWidget/TableWidget","widgets/brease/AlarmList/libs/Model","widgets/brease/AlarmList/libs/Controller","widgets/brease/AlarmList/libs/Config","widgets/brease/AlarmList/libs/Renderer","widgets/brease/common/MpLinkHandler/libs/MpLinkHandler","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,Model,Controller,t,Renderer,MpLinkHandler,i){"use strict";var s=t,n=e.extend(function AlarmList(){e.apply(this,arguments)},s),a=n.prototype;return a.initModel=function(){this.model=new Model(this),this.model.initialize()},a.initController=function(){this.linkHandler=new MpLinkHandler(this),this.controller=new Controller(this),this.controller.initialize()},a.initRenderer=function(){this.renderer=new Renderer(this),this.renderer.initialize()},a.setImagePrefix=function(e){this.settings.imagePrefix=e,brease.config.editMode&&this.controller.updateData()},a.getImagePrefix=function(){return this.settings.imagePrefix},a.setImageSuffix=function(e){this.settings.imageSuffix=e,brease.config.editMode&&this.controller.updateData()},a.getImageSuffix=function(){return this.settings.imageSuffix},a.setImageActive=function(e){this.settings.imageActive=e,brease.config.editMode&&this.controller.updateData()},a.getImageActive=function(){return this.settings.imageActive},a.setImageActiveAcknowledged=function(e){this.settings.imageActiveAcknowledged=e,brease.config.editMode&&this.controller.updateData()},a.getImageActiveAcknowledged=function(){return this.settings.imageActiveAcknowledged},a.setImageInactive=function(e){this.settings.imageInactive=e,brease.config.editMode&&this.controller.updateData()},a.getImageInactive=function(){return this.settings.imageInactive},a.setHeaderSorting=function(e){this.settings.headerSorting=e},a.getHeaderSorting=function(){return this.settings.headerSorting},a.setMpLink=function(e){brease.config.preLoadingState||this.linkHandler.incomingMessage(e)},a.getMpLink=function(){return this.settings.mpLink},a._updateData=function(e,t){e.includes("Error")||this.model.setData(t)},a.acknowledge=function(){this.isDisabled||this.controller.acknowledge()},a.acknowledgeAll=function(){this.isDisabled||this.controller.acknowledgeAll()},a.selectAlarmById=function(e){this.renderer.displayRowInTable({ins:e})},a.onBeforeDispose=function(){this.controller._contentDeactivatedHandler(),e.prototype.onBeforeDispose.apply(this,arguments)},a.wake=function(){this.controller._addClassSpecificEventListeners(this.controller),this.model.wake(),e.prototype.wake.apply(this,arguments)},a.onBeforeSuspend=function(){this.controller._contentDeactivatedHandler(),this.linkHandler.reset(),e.prototype.onBeforeSuspend.apply(this,arguments)},i.decorate(n,!1)}),define("widgets/brease/AlarmList/designer/ClassInfo",["widgets/brease/TableWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmList",parents:["*"],children:["widgets.brease.AlarmListItem"],inheritance:["widgets.brease.AlarmList","widgets.brease.TableWidget","widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Acknowledge:{method:"acknowledge"},AcknowledgeAll:{method:"acknowledgeAll"},Focus:{method:"focus"},GoToFirstPage:{method:"goToFirstPage"},GoToLastPage:{method:"goToLastPage"},GoToNextPage:{method:"goToNextPage"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"Integer"}}},GoToPreviousPage:{method:"goToPreviousPage"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"MappTableConfigurationType"}}},SelectAlarmById:{method:"selectAlarmById",parameter:{instanceID:{name:"instanceID",index:0,type:"UInteger"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setHeaderHeight:{method:"setHeaderHeight",parameter:{headerHeaderHeight:{name:"headerHeaderHeight",index:0,type:"PixelVal"}}},setHeaderSorting:{method:"setHeaderSorting",parameter:{headerSorting:{name:"headerSorting",index:0,type:"Boolean"}}},setImageActive:{method:"setImageActive",parameter:{imageActive:{name:"imageActive",index:0,type:"ImagePath"}}},setImageActiveAcknowledged:{method:"setImageActiveAcknowledged",parameter:{imageActiveAcknowledged:{name:"imageActiveAcknowledged",index:0,type:"ImagePath"}}},setImageInactive:{method:"setImageInactive",parameter:{imageInactive:{name:"imageInactive",index:0,type:"ImagePath"}}},setImagePrefix:{method:"setImagePrefix",parameter:{imagePrefix:{name:"imagePrefix",index:0,type:"DirectoryPath"}}},setImageSuffix:{method:"setImageSuffix",parameter:{imageSuffix:{name:"imageSuffix",index:0,type:"ImageType"}}},setItemsPerPage:{method:"setItemsPerPage",parameter:{itemsPerPage:{name:"itemsPerPage",index:0,type:"Integer"}}},setMpLink:{method:"setMpLink",parameter:{telegram:{name:"telegram",index:0,type:"MpComIdentType"}}},setNextText:{method:"setNextText",parameter:{nextText:{name:"nextText",index:0,type:"String"}}},setNextTextKey:{method:"setNextTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setPaging:{method:"setPaging",parameter:{paging:{name:"paging",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPreviousText:{method:"setPreviousText",parameter:{previousText:{name:"previousText",index:0,type:"String"}}},setPreviousTextKey:{method:"setPreviousTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"String"}}},setSearchBox:{method:"setSearchBox",parameter:{searchBox:{name:"searchBox",index:0,type:"Boolean"}}},setShowPagingButtons:{method:"setShowPagingButtons",parameter:{showPagingButtons:{name:"showPagingButtons",index:0,type:"Boolean"}}},setSortConfiguration:{method:"setSortConfiguration",parameter:{sortConfiguration:{name:"sortConfiguration",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setStyleConfiguration:{method:"setStyleConfiguration",parameter:{styleConfiguration:{name:"styleConfiguration",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AlarmListItem/AlarmListItem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmListItem">CONTENT</div>'}),define("widgets/brease/AlarmListItem/AlarmListItem",["widgets/brease/TableColumnWidget/TableColumnWidget","brease/events/BreaseEvent","brease/core/Types","brease/enum/Enum"],function(e,BreaseEvent,Types,Enum){"use strict";var t={text:"",columnType:Enum.AlarmListItemType.mes},i=e.extend(function AlarmListItem(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){e.prototype.init.call(this),this.el.addClass("breaseAlarmListItem")},s.setColumnType=function(e){this.settings.columnType=e;var t=new CustomEvent("ColumnTypeChanged",{detail:{columnType:Enum.AlarmListItemType.getKeyForValue(e)},bubbles:!0,cancelable:!0});this.dispatchEvent(t)},s.getColumnType=function(){return this.settings.columnType},s.getShortColumnType=function(){return this.settings.columnType!==Enum.AlarmListItemType.tim?{data:Enum.AlarmListItemType.getKeyForValue(this.settings.columnType)}:{data:Enum.AlarmListItemType.getKeyForValue(this.settings.columnType),type:"num",render:{_:"display",sort:"value"}}},s.setData=function(e){this.telegram=e},i}),define("widgets/brease/AlarmListItem/designer/ClassInfo",["widgets/brease/TableColumnWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmListItem",parents:["widgets.brease.AlarmList"],children:[],inheritance:["widgets.brease.AlarmListItem","widgets.brease.TableColumnWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setColumnType:{method:"setColumnType",parameter:{columnType:{name:"columnType",index:0,type:"brease.enum.AlarmListItemType"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AlarmListStyle/AlarmListStyle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AlarmListStyle">CONTENT</div>\r\n'}),define("widgets/brease/AlarmListStyle/AlarmListStyle",["widgets/brease/TableWidgetStyle/TableWidgetStyle"],function(e){"use strict";return e.extend(function AlarmListStyle(){e.apply(this,arguments)},!1)}),define("widgets/brease/AlarmListStyle/designer/ClassInfo",["widgets/brease/TableWidgetStyle/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AlarmListStyle",parents:["*"],children:[],inheritance:["widgets.brease.AlarmListStyle","widgets.brease.TableWidgetStyle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AuditList/AuditList.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AuditList">CONTENT</div>'}),define("widgets/brease/AuditList/libs/Model",["widgets/brease/TableWidget/libs/Model"],function(e){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t,this.settings=t.settings,this.settings.firstItem=0,this.firstConnection=!0,this.currentData=[],this.sendDataThrottle=_.throttle(this._sendData,this.settings.fetchInterval)},t),s=i.prototype;s.updateNextData=function(e){if(this.prevTelegram&&this.prevTelegram.parameter.ToRecordIndex>=e.parameter.FromRecordIndex||void 0===this.prevTelegram){this.updateTable(e.data.List);for(var t=0;t<e.data.List.length;t+=1)e.data.List[t].tim=this._fixTimestamp(e.data.List[t].tim);this.prevTelegram=e,this.updateFixedData(e.data.List),this.widget.renderer.updateNextData(e.data.List)}},s.updateTable=function(e){this.currentData=this.currentData.concat($.extend(!0,[],e)),this.currentData=this._discardData(this.currentData)},s.updateFixedData=function(e){this.data=this.data.concat($.extend(!0,[],e)),this.data=this._discardData(this.data)},s.prepareData=function(e){for(var t=0;t<e.length;t+=1)e[t].tim=this._fixTimestamp(e[t].tim),e[t].tex=_.escape(e[t].tex),this.data.push(e[t]);this.data=this._discardData(this.data),brease.config.editMode||this.widget.renderer.updateData()},s.prepareTelegram=function(e){this.telegram=$.extend(!0,{},e);for(var t=0;t<this.telegram.length;t+=1)this.telegram[t].tim=this._fixTimestamp(this.telegram[t].tim)},s.resetTable=function(){this.currentData=[],this.data=[],this.widget.renderer.updateData()},s.setMockData=function(){if(!brease.config.editMode)return!1;this.fetchData(n())},s.setData=function(e){this.fetchData(e)},s.fetchData=function(e){if(null!==e){var t=$.extend(!0,{},e);"GetRecordIndex"===t.methodID?(this.widget._showBusyIndicator(),
0===this.widget.settings.counter?this.startFetch(t):0===t.data.ActualId?this.resetFetch():t.data.ActualId<this.widget.settings.counter?(this._updateCounters(e.data),this.reFetchData()):this.continueFetch(t)):"GetList"===t.methodID&&(t.parameter.NextData?this.updateNextData(t):this.getData(t))}},s.startFetch=function(e){this.getFrom=e.data.ActualId,this.getTo=e.data.ActualId-this.settings.rowsPerFetch,this._updateCounters(e.data),this.sendData(this.getFrom,this.getTo)},s.continueFetch=function(e){this.getFrom=e.data.ActualId,this.getTo=this.getHighestRowIndex(),this._updateCounters(e.data),this.currentData.length>this.data.length&&this.prepareData($.extend(!0,[],this.currentData)),this.sendDataThrottle()},s.reFetchData=function(){this._resetData(),this.resetTable(),this.widget.settings.counter>0&&(this.widget._showBusyIndicator(),this.getFrom=this.widget.settings.counter,this.getTo=this.widget.settings.counter-this.widget.settings.rowsPerFetch,this.sendData(this.getFrom,this.getTo))},s.resetFetch=function(){this._resetData(),this.widget.settings.counter=0,this.widget.settings.firstItem=0,this.resetTable()},s.fetchNextData=function(e){this.getFrom=this._getFromData(),this.getTo=this._getToData(),this.sendData(this.getFrom,this.getTo,!0,e)},s._resetData=function(){this.currentIteration=0,this.prevTelegram=void 0,this.getFrom=this.settings.rowsPerFetch,this.getTo=0,this.data=[],this.currentData=[]},s.getData=function(e){this.widget.settings.langChanged=!1,this.updateTable(e.data.List),this.prepareData(e.data.List)},s._updateCounters=function(e){this.widget.settings.counter=e.ActualId,this._updateOldestId(e.OldestId),this.setTotalNumberOfPages()},s._updateOldestId=function(e){void 0!==e&&(this.widget.settings.firstItem=e)},s.setTotalNumberOfPages=function(){var e=Math.abs(this.widget.settings.counter-this.widget.settings.firstItem+1);this.internal.totalPages=Math.ceil(e/this.settings.itemsPerPage)},s.getTotalNumberOfPages=function(){return this.internal.totalPages},s.getLowestRowIndex=function(e){var t=0;return e.length>0&&(t=_.minBy(e,"idx").idx),t},s.getHighestRowIndex=function(){var e=0;return this.currentData.length>0&&(e=_.maxBy(this.currentData,"idx").idx),e},s._getFromData=function(){return this.currentData.length>0?_.minBy(this.currentData,"idx").idx-1:this.settings.rowsPerFetch},s._getToData=function(){return this.currentData.length>0?Math.max(_.minBy(this.currentData,"idx").idx-this.settings.rowsPerFetch-1,this.settings.firstItem):this.settings.firstItem},s._discardData=function(e){if(e.length>0){e=_.uniqBy(e,"idx");var t=this.widget.settings.firstItem;this.getLowestRowIndex(e)<t&&(e=_.remove(e,function(e){return e.idx>=t}))}return e},s._sendData=function(){this.sendData(this.getFrom,this.getTo)},s.sendData=function(e,t,i,s){var n=[],a;if(n=this._getOptionalParams(),t=Math.max(t,this.settings.firstItem),a=Object.assign({FromRecordIndex:e,ToRecordIndex:t},n),i&&(a.NextData=!0),s||e>=this.settings.firstItem){if(brease.config.preLoadingState)return;this.widget.linkHandler.sendRequestAndProvideCallback("GetList",this.widget._updateData,void 0,a)}else this.widget._hideBusyIndicator()},s._getOptionalParams=function(){var e=1,t=[];return void 0!==this.settings.config&&void 0!==this.settings.config.columns&&this.settings.config.columns.forEach(function(i){var s={};"new"!==i.data&&"old"!==i.data||(s["Parameter"+e]=i.data+"={&"+i.data+"}{&"+i.data+"[UNIT= %s]}",t.push(s),e++)}),t},s.suspend=function(){this.sendDataThrottle.cancel()},s.dispose=function(){this.sendDataThrottle.cancel()},s.export=function(){this.widget.linkHandler.sendDataAndProvideCallback("Export",this.widget._updateData,void 0,{})};function n(){return{data:{List:[{idx:"0",opn:"Mocked Audit Trace",tex:"This audit list is a mocked list and will not reflect the real audit list, it still needs to be configured in the MpAuditTrail",tim:"1970-01-01T00:00:00.000+00:00",typ:"0",new:"10",old:"5"},{idx:"1",opn:"Mocked: Audit Item 1",tex:" User 1 has logged in",tim:"1970-01-01T11:33:15.141+00:00",typ:"1",new:"10",old:"5"},{idx:"2",opn:"Mocked: Audit Item 2",tex:"User 1 changed motor speed",tim:"1970-01-01T11:33:15.141+00:00",typ:"2",new:"10",old:"5"},{idx:"3",opn:"Mocked: Audit Item 3",tex:"User 2 logged in",tim:"1970-01-01T11:31:56.541+00:00",typ:"3",new:"10",old:"5"},{idx:"4",opn:"Mocked: Audit Item 4",tex:"User 2 changed location to Great Britain.",tim:"1970-01-01T11:31:56.341+00:00",typ:"0",new:"10",old:"5"},{idx:"5",opn:"Mocked: Audit Item 5",tex:"User 1 logged off",tim:"1970-01-01T11:31:55.741+00:00",typ:"1",new:"10",old:"5"},{idx:"6",opn:"Mocked: Audit Item 6",tex:"User 2 logged off",tim:"1970-01-01T11:31:55.865+00:00",typ:"2",new:"10",old:"5"}],RecordIndex:6},parameter:{},methodID:"GetList",response:"OK"}}return i}),define("widgets/brease/AuditList/libs/StylingSettings",["widgets/brease/TableWidget/libs/StylingSettings","brease/core/Utils"],function(e,Utils){"use strict";var t=e.extend(function FilterSettings(t,i,s,n){this.lang=s,this.texts=n,e.apply(this,arguments)},null),i=t.prototype;return i.initialize=function(){if(this.config={},this.config.rows=[],this.textSystemReady=new $.Deferred,this.setUpConfiguration(),this._getStyleNames(),this._initializeEmptyDialogConfig(),this.widget.settings.config.style.length>0){var e=this;$.when(this.textSystemReady.promise()).then(function t(){e._initializeStoredDialogConfig()})}return this.config},i.setUpConfiguration=function(){this.config.names=[],this.config.children={delete_this_row:0,label_style:1,input_style:2,label_state:3,dd_state:4,rect_separator:5,add_next_row:6,left:{delete_this_row:50,label_style:90,input_style:200,label_state:350,dd_state:300,rect_separator:0,add_next_row:10}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:10,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:125},this.config.loc.rowHeight=2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},i._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+3*(e-1)*this.config.loc.widgetHeight+this.config.loc.offset},i._getCurrTop=function(e){return 30+2*e*this.config.loc.widgetHeight+3*e*this.config.loc.widgetOffset+this.config.loc.offset},i._getOneRowOffset=function(e){return e+2*this.config.loc.widgetHeight+3*this.config.loc.widgetOffset},i._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrTop(e),s=40+i,n=[],a=Utils.uniqueID();n.push(this._getImage("style_button_delete_"+a,"widgets/brease/TableWidget/assets/Delete.svg",this.config.children.left.delete_this_row,i)),n.push(this._getLabel("style_label_"+a,this.texts.style,this.config.children.left.label_style,i,150));var r={};this.widget.settings.config.style.length>0&&void 0!==this.widget.settings.config.style[e]&&(r=this.widget.settings.config.style[e]);var o=[{value:"1",text:this.config.names[0]},{value:"2",text:this.config.names[1]},{value:"3",text:this.config.names[2]},{value:"4",text:this.config.names[3]},{value:"5",text:this.config.names[4]},{value:"6",text:this.config.names[5]},{value:"7",text:this.config.names[6]},{value:"8",text:this.config.names[7]}];n.push(this._getDropDown("style_input_"+a,o,this.config.children.left.input_style,i,140,"right",r.namePos)),n.push(this._getLabel("style_label_state_"+a,this.texts.state,this.config.children.left.label_state,i,200));var l=[{value:"1",text:this.texts.au1},{value:"2",text:this.texts.au2},{value:"3",text:this.texts.au3},{value:"16",text:this.texts.au16},{value:"17",text:this.texts.au17},{value:"18",text:this.texts.au18},{value:"19",text:this.texts.au19},{value:"20",text:this.texts.au20},{value:"32",text:this.texts.au32},{value:"33",text:this.texts.au33},{value:"48",text:this.texts.au48},{value:"64",text:this.texts.au64},{value:"65",text:this.texts.au65},{value:"80",text:this.texts.au80},{value:"96",text:this.texts.au96},{value:"112",text:this.texts.au112},{value:"2457",text:this.texts.au2457}];n.push(this._getDropDown("style_dropdown_state_"+a,l,this.config.children.left.dd_state,s,300,"left",r.statePos)),n.push(this._getRect("style_rect_separator_"+a,this.config.children.left.rect_separator,t,600));var d=this._getOneRowOffset(i);return n.push(this._getImage("style_button_add_"+a,"widgets/brease/TableWidget/assets/Add.svg",this.config.children.left.add_next_row,d)),n},i._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){var i={name:"",namePos:"",state:"",statePos:0},s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.input_style].id);i.name=s.text,i.namePos=parseInt(s.value),s=this._getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.dd_state].id),i.state=s.text,i.statePos=parseInt(s.value),e.push(i)}return void 0===this.config?this.widget.settings.config.style:e},t}),define("widgets/brease/AuditList/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{filter:{title:"Configuration dialogue to filter the audits",col:"Column",op:"Operator",val:"Value",and:"and",or:"or"},sort:{title:"Configuration dialog to sort the audits",col:"Column",sort:"Sort",by:"By",first:"First",then:"then",inc:"increasing",dec:"decreasing",az:"A - Z",za:"Z - A",old:"oldest first",new:"newest first"},style:{title:"Configuration dialogue to style the audits",and:"and",or:"or",style:"Set style",state:"if audit is",au1:"diagnostics",au2:"user management",au3:"electronic signature",au16:"value change",au17:"value change VC4",au18:"audit custom",au19:"value change OPC",au20:"batch start",au32:"AlarmX state change",au33:"AlarmX audit",au48:"recipe audit",au64:"PackML mode change",au65:"PackML state change",au80:"tweet message service",au96:"hardware import",au112:"codeBox program",au2457:"audit cleared"}},de:{filter:{title:"Konfigurationsdialog für das Filtern der Auditliste",col:"Spalte",op:"Operator",val:"Wert",and:"und",or:"oder"},sort:{title:"Konfigurationsdialog zum Sortieren der Auditliste",col:"Spalte",sort:"Sortieren",by:"Nach",first:"Zuerst",then:"dann",inc:"aufsteigend",dec:"absteigend",az:"A - Z",za:"Z - A",old:"älteste",new:"neueste"},style:{title:"Konfigurationsdialog zum Stylen der Auditliste",and:"und",or:"oder",style:"Set style",state:"if event is of type",au1:"Diagnose",au2:"Benutzerverwaltung",au3:"elektronische Unterschrift",au16:"Wertänderung",au17:"Wertänderung VC4",au18:"benutzerdefiniertes Audit",au19:"Wertänderung OPC",au20:"Batchstart",au32:"AlarmX-Statusänderung",au33:"AlarmX-Audit",au48:"Recipe Audit",au64:"PackML-Modusänderung",au65:"PackML-Statusänderung",au80:"Tweet-Nachrichtendienst",au96:"Hardware importieren",au112:"CodeBox Programm",au999:"Audit gelöscht"}}}}return new DialogueTexts}),define("widgets/brease/AuditList/libs/Dialogue",["widgets/brease/TableWidget/libs/Dialogue","brease/enum/Enum","widgets/brease/TableWidget/libs/FilterSettings","widgets/brease/TableWidget/libs/SortingSettings","widgets/brease/AuditList/libs/StylingSettings","widgets/brease/AuditList/libs/DialogueTexts","widgets/brease/TableWidget/libs/TextRetriever"],function(e,Enum,t,i,s,Texts,TextRetriever){"use strict";var n=e.extend(function Dialogue(){e.apply(this,arguments)},null),a=n.prototype;return a.initialize=function(e){switch(e){case Enum.MappTableConfigurationType.Filtering:this.filter=new t(this.dialog,this.widget,this.actualLang,this.widget.model.categories,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Sorting:this.sort=new i(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break;case Enum.MappTableConfigurationType.Styling:this.style=new s(this.dialog,this.widget,this.actualLang,Texts[this.lang][e]);break}return this._initializeEmptyDialogConfig(Texts[this.lang][e].title),this.config},a.setUpTexts=function(e,t,i,s){this.texts=TextRetriever.getTexts(t,Texts[i],"AuditList",s,this,e)},n}),define("widgets/brease/AuditList/libs/Controller",["widgets/brease/TableWidget/libs/Controller","brease/events/BreaseEvent","widgets/brease/AuditList/libs/Dialogue"],function(e,BreaseEvent,t){"use strict";var i=e.extend(function Controller(t){e.call(this),this.widget=t},null),s=i.prototype;return s._addClassSpecificEventListeners=function(e){document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,e._bind("_contentActivatedHandler"))},s._contentActivatedHandler=function(e){e.detail.contentId===this.widget.settings.parentContentId&&this&&(document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),void 0!==this.widget.bindings&&void 0!==this.widget.bindings.mpLink||brease.config.preLoadingState||this._setMissingBindingErrorMsg(),this.widget.linkHandler.subscribeWithCallback("GetRecordIndex",this.widget._updateData))},s._contentDeactivatedHandler=function(){this.widget.linkHandler.unSubscribe("GetRecordIndex")},s.languageChanged=function(){this.widget.model.reFetchData()},s.openConf=function(e){this.configDialogue=new t(this.widget),this.configDialogue.open(e)},s.export=function(){this.widget.model.export()},s.getEventItem=function(e){var t=this.widget.model.getRowFromCurrentData(e);return{id:t.idx,operatorName:t.opn,text:t.tex,timestamp:t.tim,type:t.typ}},s.getTotalNumberOfPages=function(){return this.widget.model.getTotalNumberOfPages()},s.updateData=function(){this.widget.model.setMockData(),this.widget.renderer.updateData()},s._scrolledToBottom=function(){this.widget.model.fetchNextData()},s.dispose=function(){document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),e.prototype.dispose.apply(this,arguments)},i}),define("widgets/brease/AuditList/libs/Renderer",["widgets/brease/TableWidget/libs/Renderer","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var t=e.extend(function Renderer(t){e.call(this),this.widget=t},null),i=t.prototype;return i._colorMeBlue=function(){if(void 0!==this.widget.model.currentData&&this.dt.exists()&&0!==this.widget.model.currentData.length)for(var e=0;e<this.widget.el.find("tbody").children().length;e+=1)for(var t=0;t<this.widget.settings.config.style.length;t+=1){var i=this.dt.getFilteredPage()*this.widget.settings.itemsPerPage+e,s=this.dt.getFilteredOffset(i);if(void 0!==s){var n=this.widget.model.currentData[s].typ,a=this._rowEligibility(n,this.widget.settings.config.style[t]);a&&this.widget.el.find("tbody").children("tr:eq("+e+")").addClass("widgets_brease_AuditListStyle_style_style"+this.widget.settings.config.style[t].namePos)}}},i._rowEligibility=function(e,t){return e===t.statePos},i._pageChange=function(){if(this.dt.exists()){var e,t=this._getDataTablePageInfo().page+1;e=this.internal.searchInProgress||this.widget.settings.filterConfiguration.length>0?this._getDataTablePageInfo().pages:this.widget.controller.getTotalNumberOfPages(),this.widget.controller._pageChange(t,e)}},i._updateLastbutton=function(){if(!(this.internal.searchInProgress||this.widget.settings.filterConfiguration.length>0)){var e=this.widget.controller.getTotalNumberOfPages();this.widget.el.find(".paginate_button").length>2&&(0===this.widget.el.find(".ellipsis").length&&this._getDataTablePageInfo().pages<e?this._addEllipsis(e):this.widget.el.find(".paginate_button:eq(-2)").text(e))}},i._addEllipsis=function(e){$('<span class="ellipsis">...</span><a class="paginate_button widgets_brease_ToggleButton_style_default breaseButton"><span>'+e+"</span></a>").on(BreaseEvent.CLICK,this._bind(this.widget.controller._scrolledToBottom)).insertBefore(this.widget.el.find(".paginate_button:last"))},t}),define("widgets/brease/AuditList/libs/Config",[],function(){"use strict";return{rowsPerFetch:1e3,fetchInterval:1e3,mpLink:"",type:"AuditList",config:{columns:[],columnWidths:[],columnTypes:{idx:"int",opn:"str",tex:"str",tim:"date",typ:"int",old:"str",new:"str"},style:[],order:[[0,"asc"]],filter:[],hidden:{data:"idx"},sort:[],original:{order:[]}}}}),define("widgets/brease/AuditList/AuditList",["widgets/brease/TableWidget/TableWidget","widgets/brease/AuditList/libs/Model","widgets/brease/AuditList/libs/Controller","widgets/brease/AuditList/libs/Renderer","widgets/brease/AuditList/libs/Config","widgets/brease/common/MpLinkHandler/libs/MpLinkHandler"],function(e,Model,Controller,Renderer,t,MpLinkHandler){"use strict";var i=t,s=e.extend(function AuditList(){e.apply(this,arguments)},i),n=s.prototype;return n.initModel=function(){this.linkHandler=new MpLinkHandler(this),this.model=new Model(this),this.model.initialize()},n.initController=function(){this.controller=new Controller(this),this.controller.initialize()},n.initRenderer=function(){this.renderer=new Renderer(this),this.renderer.initialize()},n.setMpLink=function(e){brease.config.preLoadingState||this.linkHandler.incomingMessage(e)},n.getMpLink=function(){return this.settings.mpLink},n._updateData=function(e,t){e.includes("Error")||this.model.setData(t)},n.export=function(){this.isDisabled||this.controller.export()},n.onBeforeDispose=function(){this.controller._contentDeactivatedHandler(),e.prototype.onBeforeDispose.apply(this,arguments)},n.wake=function(){this.controller._addClassSpecificEventListeners(this.controller),e.prototype.wake.apply(this,arguments)},n.onBeforeSuspend=function(){this.controller._contentDeactivatedHandler(),this.linkHandler.reset(),e.prototype.onBeforeSuspend.apply(this,arguments)},s}),define("widgets/brease/AuditList/designer/ClassInfo",["widgets/brease/TableWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AuditList",parents:["*"],children:["widgets.brease.AuditListItem"],inheritance:["widgets.brease.AuditList","widgets.brease.TableWidget","widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Export:{method:"export"},Focus:{method:"focus"},GoToFirstPage:{method:"goToFirstPage"},GoToLastPage:{method:"goToLastPage"},GoToNextPage:{method:"goToNextPage"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"Integer"}}},GoToPreviousPage:{method:"goToPreviousPage"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"MappTableConfigurationType"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setHeaderHeight:{method:"setHeaderHeight",parameter:{headerHeaderHeight:{name:"headerHeaderHeight",index:0,type:"PixelVal"}}},setItemsPerPage:{method:"setItemsPerPage",parameter:{itemsPerPage:{name:"itemsPerPage",index:0,type:"Integer"}}},setMpLink:{method:"setMpLink",parameter:{telegram:{name:"telegram",index:0,type:"MpComIdentType"}}},setNextText:{method:"setNextText",parameter:{nextText:{name:"nextText",index:0,type:"String"}}},setNextTextKey:{method:"setNextTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setPaging:{method:"setPaging",parameter:{paging:{name:"paging",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPreviousText:{method:"setPreviousText",parameter:{previousText:{name:"previousText",index:0,type:"String"}}},setPreviousTextKey:{method:"setPreviousTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"String"}}},setSearchBox:{method:"setSearchBox",parameter:{searchBox:{name:"searchBox",index:0,type:"Boolean"}}},setShowPagingButtons:{method:"setShowPagingButtons",parameter:{showPagingButtons:{name:"showPagingButtons",index:0,type:"Boolean"}}},setSortConfiguration:{method:"setSortConfiguration",parameter:{sortConfiguration:{name:"sortConfiguration",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setStyleConfiguration:{method:"setStyleConfiguration",parameter:{styleConfiguration:{name:"styleConfiguration",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AuditListItem/AuditListItem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AuditListItem">CONTENT</div>'}),define("widgets/brease/AuditListItem/AuditListItem",["widgets/brease/TableColumnWidget/TableColumnWidget","brease/events/BreaseEvent","brease/core/Types","brease/enum/Enum"],function(e,BreaseEvent,Types,Enum){"use strict";var t={text:"",columnType:Enum.AuditListItemType.tex},i=e.extend(function AuditListItem(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){e.prototype.init.call(this),this.el.addClass("breaseAuditListItem")},s.setColumnType=function(e){this.settings.columnType=e;var t=new CustomEvent("ColumnTypeChanged",{detail:{columnType:Enum.AuditListItemType.getKeyForValue(e)},bubbles:!0,cancelable:!0});this.dispatchEvent(t)},s.getColumnType=function(){return this.settings.columnType},s.getShortColumnType=function(){return this.settings.columnType!==Enum.AuditListItemType.tim?{data:Enum.AuditListItemType.getKeyForValue(this.settings.columnType)}:{data:Enum.AuditListItemType.getKeyForValue(this.settings.columnType),type:"num",render:{_:"display",sort:"value"}}},s.setData=function(e){this.telegram=e},i}),define("widgets/brease/AuditListItem/designer/ClassInfo",["widgets/brease/TableColumnWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AuditListItem",parents:["widgets.brease.AuditList"],children:[],inheritance:["widgets.brease.AuditListItem","widgets.brease.TableColumnWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setColumnType:{method:"setColumnType",parameter:{columnType:{name:"columnType",index:0,type:"brease.enum.AuditListItemType"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/AuditListStyle/AuditListStyle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/AuditListStyle">CONTENT</div>\r\n'}),define("widgets/brease/AuditListStyle/AuditListStyle",["widgets/brease/TableWidgetStyle/TableWidgetStyle"],function(e){"use strict";return e.extend(function AuditListStyle(){e.apply(this,arguments)},!1)}),define("widgets/brease/AuditListStyle/designer/ClassInfo",["widgets/brease/TableWidgetStyle/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.AuditListStyle",parents:["*"],children:[],inheritance:["widgets.brease.AuditListStyle","widgets.brease.TableWidgetStyle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/BasicSlider/BasicSlider.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/BasicSlider"></div>\r\n'}),define("widgets/brease/common/libs/redux/utils/UtilsSize",["brease/core/Utils"],function(Utils){"use strict";var UtilsSize={};function e(e,t,i){return Utils.isPercentageValue(t)||Utils.isPercentageValue(i)||(t=parseInt(t,10),i=parseInt(i,10),t>=e?e=t:e>=i&&(e=i)),e}return UtilsSize.getWidth=function(t,i){var s=0,n=window.getComputedStyle(i,null),a=n.getPropertyValue("min-width"),r=n.getPropertyValue("max-width");if(!1===isNaN(t)?s=parseInt(t,10):($(i).css("width",t),s=i.offsetWidth),s=e(s,a,r),void 0===s){var o=Utils.getScaleFactor(i)||1;s=i.getBoundingClientRect().width/o}return s},UtilsSize.setAndGetWidth=function(e,t){var i,s;return t.setAttribute("width",e),s=window.getComputedStyle(t,null),i=t.clientWidth-(parseInt(s.paddingLeft,10)+parseInt(s.paddingRight,10)),Math.max(i,0)},UtilsSize.getHeight=function(t,i){var s=0,n=window.getComputedStyle(i,null),a=n.getPropertyValue("min-height"),r=n.getPropertyValue("max-height");if(!1===isNaN(t)?s=parseInt(t,10):($(i).css("height",t),s=i.offsetHeight),s=e(s,a,r),void 0===s){var o=Utils.getScaleFactor(i)||1;s=i.getBoundingClientRect().height/o}return s},UtilsSize.setAndGetHeight=function(e,t){var i,s;return t.setAttribute("width",e),s=window.getComputedStyle(t,null),i=t.clientHeight-(parseInt(s.paddingTop,10)+parseInt(s.paddingBottom,10)),Math.max(i,0)},UtilsSize}),define("widgets/brease/BasicSlider/libs/Renderer",["brease/core/Class","brease/events/BreaseEvent","libs/d3/d3","brease/core/Types","brease/enum/Enum","brease/core/Utils","widgets/brease/common/libs/redux/utils/UtilsSize"],function(e,BreaseEvent,t,Types,Enum,Utils,UtilsSize){"use strict";var Renderer=e.extend(function Renderer(t){e.call(this),this.widget=t,this.settings=t.settings,this.initialize()},null),i=Renderer.prototype;i.initialize=function(){this.reinitialize()},i.reinitialize=function(){this.settings.axisSizeFactor=10,this.settings.thumbRadius=parseInt(this.settings.thumbSize,10)/2,this._setSize(),this.scaleDomain(this.widget.data.node),d(this),this.initDraw(),this.valueDisplayDraw(),this.valueDisplayHandling(),this.updateThumbPositionByValue(Types.parseValue(this.widget.data.node.value,"Number",{min:this.widget.data.node.minValue,max:this.widget.data.node.maxValue})),this.tickNumbersHandling(),c(this),this.enableClassHandling()},i._setSize=function(){this.widgetWidth=UtilsSize.setAndGetWidth(this.settings.width,this.widget.elem),this.widgetHeight=UtilsSize.setAndGetHeight(this.settings.height,this.widget.elem)},i.redraw=function(){this.widget.el.children().remove(),this.reinitialize()},i.initDraw=function(){this.containerId=Utils.uniqueID(this.widget.elem.id+"_container"),this.axisId=Utils.uniqueID(this.widget.elem.id+"_axis"),this.containerElement=$("<div class='borderElement' id="+this.containerId+">"),this.widget.el.append(this.containerElement),this.containerElement.height(this.widgetHeight).width(this.widgetWidth),this.axisElement=t.select("#"+this.containerId).append("svg").attr("id",this.axisId).attr("class","axisElement"),this.backgroundId=Utils.uniqueID(this.widget.elem.id+"_container"),this.backgroundElement=$("<div class='backgroundElement' id="+this.backgroundId+">"),this.containerElement.append(this.backgroundElement),this.sliderElement=t.select("#"+this.containerId).append("svg").attr("class","sliderElement").attr("width",this.widgetWidth).attr("height",this.widgetHeight),this.drawElements(),this.drawFillElement()},i.createThumbBackGround=function(e,t,i,s,n){var a=0,r=0;switch(e){case Enum.Orientation.LTR:case Enum.Orientation.RTL:a=i/2-t/2,r=n-t/2;break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:a=n-t/2,r=s/2-t/2;break}return $("<div>").css("height",t).css("width",t).css("top",a).css("left",r).attr("class","thumbBackground")},i.createSliderThumb=function(e,t,i,s,n,a){var r=e.append("rect").attr("height",s).attr("width",s).attr("class","sliderThumb").call(n);switch(a){case Enum.Orientation.LTR:case Enum.Orientation.RTL:r.attr("y",t/2-s/2);break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:r.attr("x",i/2-s/2);break}return r},i.createSliderRectangle=function(e,t,i,s,n){var a=0,r=0,o=0,l=0,d=0,c=0,h;switch(n){case Enum.Orientation.LTR:case Enum.Orientation.RTL:a=0,r=t/2-s/2,o=s,l=i,d=s/2,c=0;break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:a=i/2-s/2,r=0,o=t,l=s,d=0,c=s/2;break}return h=e.append("rect").attr("x",a).attr("y",r).attr("height",o).attr("width",l).attr("rx",d).attr("ry",c).attr("class","sliderRectangle"),h},i.createRectangleBackground=function(e,t,i,s){var n=0,a=0,r=0,o=0,l;switch(e){case Enum.Orientation.LTR:case Enum.Orientation.RTL:n=0,a=t/2-s/2,o=i,r=s;break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:n=i/2-s/2,a=0,o=s,r=t;break}return l=$("<div>").css("height",r).css("width",o).css("top",a).css("left",n).attr("class","rectangleBackground"),l},i.drawElements=function(){switch(this.sliderRectangle=this.createSliderRectangle(this.sliderElement,parseInt(this.widgetHeight,10),parseInt(this.widgetWidth,10),parseInt(this.settings.trackSize,10),this.settings.orientation),this.createDragBehavior(),this.sliderThumb=this.createSliderThumb(this.sliderElement,parseInt(this.widgetHeight,10),parseInt(this.widgetWidth,10),parseInt(this.settings.thumbSize,10),this.dragBehavior,this.settings.orientation),this.thumbBackground=this.createThumbBackGround(this.settings.orientation,this.settings.thumbSize,parseInt(this.widgetHeight,10),parseInt(this.widgetWidth,10),this.thumbScale(this.widget.data.node.value)),this.rectangleBackground=this.createRectangleBackground(this.settings.orientation,parseInt(this.widgetHeight,10),parseInt(this.widgetWidth,10),parseInt(this.settings.trackSize,10)),this.backgroundElement.append(this.rectangleBackground).append(this.thumbBackground),this.settings.orientation){case Enum.Orientation.LTR:case Enum.Orientation.RTL:this.drawHorizontalAxis();break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:this.drawVerticalAxis();break}},i.createDragBehavior=function(){this.dragBehavior=t.behavior.drag(),!1===brease.config.editMode&&(this.widget.el.find(".sliderRectangle").on(BreaseEvent.CLICK,this._bind("_rectangleTrackHandler")),this.dragBehavior.on("dragstart",this._bind(this.dragStart)),this.dragBehavior.on("drag",this._bind(this.updateThumbPositionByEvent)),this.dragBehavior.on("dragend",this._bind(this.dragEnd)))},i.drawFillElement=function(){switch(this.fillElement=$("<div>"),this.fillElement.addClass("fillElement"),this.fillElement.addClass(this.settings.orientation),this.settings.orientation){case Enum.Orientation.LTR:this.fillElement.css("height",this.settings.trackSize),this.fillElement.css("width",this.settings.thumbRadius),this.fillElement.css("top",parseFloat(this.widgetHeight,10)/2-this.settings.trackSize/2),this.fillElement.css("left",0);break;case Enum.Orientation.RTL:this.fillElement.css("height",this.settings.trackSize),this.fillElement.css("width",this.thumbScale(this.settings.value-this.settings.minValue)),
this.fillElement.css("top",parseFloat(this.widgetHeight,10)/2-this.settings.trackSize/2),this.fillElement.css("left",this.thumbScale(this.settings.value));break;case Enum.Orientation.BTT:this.fillElement.css("height",this.settings.thumbPosition),this.fillElement.css("top",parseFloat(this.widgetHeight,10)-this.settings.thumbRadius),this.fillElement.css("left",parseFloat(this.widgetWidth,10)/2-this.settings.trackSize/2),this.fillElement.css("width",this.settings.trackSize);break;case Enum.Orientation.TTB:this.fillElement.css("height",this.thumbScale(this.settings.value)),this.fillElement.css("top",this.thumbScale(this.settings.value)),this.fillElement.css("left",parseFloat(this.widgetWidth,10)/2-this.settings.trackSize/2),this.fillElement.css("width",this.settings.trackSize);break}this.rectangleBackground.after(this.fillElement)},i.updateFillElement=function(){switch(this.settings.orientation){case Enum.Orientation.LTR:this.fillElement.css("width",this.settings.thumbPosition),this.fillElement.css("left",0);break;case Enum.Orientation.RTL:this.fillElement.css("width",this.thumbScale(this.settings.minValue)-this.settings.thumbPosition+this.settings.thumbRadius),this.fillElement.css("left",this.settings.thumbPosition);break;case Enum.Orientation.BTT:this.fillElement.css("height",this.thumbScale(this.settings.minValue)-this.settings.thumbPosition+this.settings.thumbRadius),this.fillElement.css("top",this.settings.thumbPosition);break;case Enum.Orientation.TTB:this.fillElement.css("height",this.settings.thumbPosition),this.fillElement.css("top",0);break}},i.dragStart=function(){this.updateThumbPositionByEvent()},i.dragEnd=function(){this.updateThumbPositionByEvent()},i.updateThumbPositionByEvent=function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation(),o(this,t.event),this.updateFillElement()},i.updateThumbPositionByValue=function(e){this.settings.thumbPosition=this.thumbScale(e),this.updateThumb(),this.updateFillElement()},i.getCurrentValue=function(){this.widget.data.node.value=this.thumbScale.invert(this.settings.thumbPosition)},i.scaleDomain=function(e){switch(void 0!==e&&(this.settings.value=e.value,this.settings.minValue=e.minValue,this.settings.maxValue=e.maxValue),this.settings.orientation){case Enum.Orientation.TTB:this.thumbScale=t.scale.linear().domain([this.settings.minValue,this.settings.maxValue]).range([this.settings.thumbRadius,parseFloat(this.widgetHeight,10)-this.settings.thumbRadius]);break;case Enum.Orientation.BTT:this.thumbScale=t.scale.linear().domain([this.settings.maxValue,this.settings.minValue]).range([this.settings.thumbRadius,parseFloat(this.widgetHeight,10)-this.settings.thumbRadius]);break;case Enum.Orientation.RTL:this.thumbScale=t.scale.linear().domain([this.settings.maxValue,this.settings.minValue]).range([this.settings.thumbRadius,parseFloat(this.widgetWidth,10)-this.settings.thumbRadius]);break;case Enum.Orientation.LTR:this.thumbScale=t.scale.linear().domain([this.settings.minValue,this.settings.maxValue]).range([this.settings.thumbRadius,parseFloat(this.widgetWidth,10)-this.settings.thumbRadius]);break}},i.drawHorizontalAxis=function(){var e=this.widgetHeight/this.settings.axisSizeFactor;"top"===this.settings.tickPosition&&a(this,e),"bottom"===this.settings.tickPosition&&r(this,e),"topbottom"===this.settings.tickPosition&&(a(this,e),r(this,e))},i.drawVerticalAxis=function(){var e=this.widgetWidth/this.settings.axisSizeFactor;"top"===this.settings.tickPosition&&s(this,e),"bottom"===this.settings.tickPosition&&n(this,e),"topbottom"===this.settings.tickPosition&&(s(this,e),n(this,e))},i._rectangleTrackHandler=function(e){if(!this.widget.isDisabled){var t=Types.parseValue(this.settings.largeChange,"Number",{min:0,max:100})/100,i=this.widget.data.node.value,s=this.settings.maxValue-this.settings.minValue,n,a=Utils.getScaleFactor(this.widget.elem);switch(void 0!==e.offsetX&&void 0!==e.offsetY||(e.offsetX=(e.pageX-this.widget.elem.getBoundingClientRect().left)/a,e.offsetY=(e.pageY-this.widget.elem.getBoundingClientRect().top)/a),this.settings.orientation){case Enum.Orientation.TTB:e.offsetY<this.settings.thumbPosition?n=Types.parseValue(i-s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}):e.offsetY>this.settings.thumbPosition&&(n=Types.parseValue(i+s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}));break;case Enum.Orientation.BTT:e.offsetY<this.settings.thumbPosition?n=Types.parseValue(i+s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}):e.offsetY>this.settings.thumbPosition&&(n=Types.parseValue(i-s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}));break;case Enum.Orientation.RTL:e.offsetX<this.settings.thumbPosition?n=Types.parseValue(i+s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}):e.offsetX>this.settings.thumbPosition&&(n=Types.parseValue(i-s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}));break;case Enum.Orientation.LTR:e.offsetX<this.settings.thumbPosition?n=Types.parseValue(i-s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}):e.offsetX>this.settings.thumbPosition&&(n=Types.parseValue(i+s*t,"Number",{min:this.settings.minValue,max:this.settings.maxValue}));break}void 0!==n&&(this.widget.data.node.value=n,this.updateThumbPositionByValue(n),this.widget.submitChange(),this.widget.writeValue())}},i.updateAxis=function(){this.settings=this.widget.settings,d(this);var e;this.settings.orientation===Enum.Orientation.LTR||this.settings.orientation===Enum.Orientation.RTL?e=this.widgetHeight/this.settings.axisSizeFactor:this.settings.orientation!==Enum.Orientation.TTB&&this.settings.orientation!==Enum.Orientation.BTT||(e=this.widgetWidth/this.settings.axisSizeFactor),void 0===this.axisAfter&&void 0===this.axisBefore||("top"===this.settings.tickPosition&&(this.axisBefore.scale(this.thumbScale).tickValues(this.tickValues).tickFormat(t.format("."+this.settings.numberFormat.decimalPlaces+"f")).innerTickSize(e),t.select("#"+this.axisId).select(".axis-before").call(this.axisBefore)),"bottom"===this.settings.tickPosition&&(this.axisAfter.scale(this.thumbScale).tickValues(this.tickValues).tickFormat(t.format("."+this.settings.numberFormat.decimalPlaces+"f")).innerTickSize(e),t.select("#"+this.axisId).select(".axis-after").call(this.axisAfter)),"topbottom"===this.settings.tickPosition&&(this.axisBefore.scale(this.thumbScale).tickValues(this.tickValues).tickFormat(t.format("."+this.settings.numberFormat.decimalPlaces+"f")).innerTickSize(e),t.select("#"+this.axisId).select(".axis-before").call(this.axisBefore),this.axisAfter.scale(this.thumbScale).tickValues(this.tickValues).tickFormat(t.format("."+this.settings.numberFormat.decimalPlaces+"f")).innerTickSize(e),t.select("#"+this.axisId).select(".axis-after").call(this.axisAfter)),this.tickNumbersHandling())},i.valueDisplayHandling=function(){this.settings.showValueDisplay?this.output.css("display",""):this.output.css("display","none"),!0===brease.config.editMode&&(this.outputVal.text(this.settings.displayedValue),this.settings.showUnit&&this.outputUnit.text("unit"))},i.tickNumbersHandling=function(){!0===this.settings.showTickNumbers?this.widget.el.find("text").css("display","block"):this.widget.el.find("text").css("display","none")},i.tickPositionHandling=function(){void 0!==this.axisAfter&&t.select("#"+this.axisId).selectAll(".axis-after").remove(),void 0!==this.axisBefore&&t.select("#"+this.axisId).selectAll(".axis-before").remove(),this.settings.orientation===Enum.Orientation.LTR||this.settings.orientation===Enum.Orientation.RTL?this.drawHorizontalAxis():this.settings.orientation!==Enum.Orientation.TTB&&this.settings.orientation!==Enum.Orientation.BTT||this.drawVerticalAxis(),this.tickNumbersHandling()},i.updateImg=function(e,t){t?c(this):this.widget.el.find("img").attr("src",e)},i.thumbCornerHandling=function(e){e?this.sliderThumb.attr("rx",0):this.sliderThumb.attr("rx",this.settings.thumbSize/2)},i.valueDisplayDraw=function(){var e=8,t="auto";this.output=$("<output/>").attr("class","valueDisplay"),this.outputVal=$("<span/>").attr("class","valueOutput"),this.outputUnit=$("<span/>").attr("class","unitOutput"),this.outputArrow=$("<span/>").attr("class","arrowOutput"),this.output.append([this.outputVal,this.outputUnit,this.outputArrow]),this.containerElement.append(this.output),!0===this.settings.ellipsis?(t=this.settings.valueDisplaySize,this.output.addClass("ellipsis")):(t="auto",this.output.removeClass("ellipsis")),this.settings.orientation===Enum.Orientation.LTR||this.settings.orientation===Enum.Orientation.RTL?(this.output.addClass("horizontal"),this.output.removeClass("vertical"),this.output.css("height",this.settings.valueDisplaySize).css("top",this.widgetHeight/2-this.settings.valueDisplaySize-this.settings.thumbRadius-8+parseInt(this.widget.el.css("padding-top"),10)).css("width",t)):this.settings.orientation!==Enum.Orientation.TTB&&this.settings.orientation!==Enum.Orientation.BTT||(this.output.addClass("vertical"),this.output.removeClass("horizontal"),this.output.css("width",t).css("right",this.widgetWidth/2+this.settings.thumbRadius+8+parseInt(this.widget.el.css("padding-left"),10)).css("height",this.settings.valueDisplaySize))},i.dispose=function(){this.dragBehavior.on("drag",null),this.widget.el.find(".sliderRectangle").off(BreaseEvent.CLICK,this._bind("_rectangleTrackHandler")),e.prototype.dispose.call(this)},i.updateThumb=function(){this.settings.orientation===Enum.Orientation.LTR||this.settings.orientation===Enum.Orientation.RTL?(this.sliderThumb.attr("x",this.settings.thumbPosition-this.settings.thumbRadius),this.thumbBackground.css("left",this.settings.thumbPosition-this.settings.thumbRadius),this.output.css("left",this.settings.thumbPosition+parseInt(this.widget.el.css("padding-left"),10))):this.settings.orientation!==Enum.Orientation.TTB&&this.settings.orientation!==Enum.Orientation.BTT||(this.sliderThumb.attr("y",this.settings.thumbPosition-this.settings.thumbRadius),this.thumbBackground.css("top",this.settings.thumbPosition-this.settings.thumbRadius),this.output.css("top",this.settings.thumbPosition+parseInt(this.widget.el.css("padding-top"),10)))},i.enableClassHandling=function(){this.widget.isDisabled?(this.rectangleBackground.addClass("disabled"),this.thumbBackground.addClass("disabled")):(this.rectangleBackground.removeClass("disabled"),this.thumbBackground.removeClass("disabled"))};function s(renderer,e){renderer.axisBefore=t.svg.axis().scale(renderer.thumbScale).tickValues(renderer.tickValues).innerTickSize(e).tickFormat(t.format("."+renderer.settings.numberFormat.decimalPlaces+"f")).orient("left"),renderer.axisElement.append("g").call(renderer.axisBefore).attr("class","axis-before").attr("transform","translate("+(renderer.widgetWidth/2-renderer.settings.scaleOffset)+",0)")}function n(renderer,e){renderer.axisAfter=t.svg.axis().scale(renderer.thumbScale).tickValues(renderer.tickValues).innerTickSize(e).tickFormat(t.format("."+renderer.settings.numberFormat.decimalPlaces+"f")).orient("right"),renderer.axisElement.append("g").call(renderer.axisAfter).attr("class","axis-after").attr("transform","translate("+(renderer.widgetWidth/2+renderer.settings.scaleOffset)+",0)")}function a(renderer,e){renderer.axisBefore=t.svg.axis().scale(renderer.thumbScale).tickValues(renderer.tickValues).innerTickSize(e).tickFormat(t.format("."+renderer.settings.numberFormat.decimalPlaces+"f")).orient("top"),renderer.axisElement.append("g").call(renderer.axisBefore).attr("class","axis-before").attr("transform","translate(0,"+(renderer.widgetHeight/2-renderer.settings.scaleOffset)+")")}function r(renderer,e){renderer.axisAfter=t.svg.axis().scale(renderer.thumbScale).tickValues(renderer.tickValues).innerTickSize(e).tickFormat(t.format("."+renderer.settings.numberFormat.decimalPlaces+"f")).orient("bottom"),renderer.axisElement.append("g").call(renderer.axisAfter).attr("class","axis-after").attr("transform","translate(0,"+(renderer.widgetHeight/2+renderer.settings.scaleOffset)+")")}function o(renderer,e){if(!renderer.widget.isDisabled){var t=Types.parseValue(renderer.settings.smallChange,"Number",{min:0,max:100})/100,i=(renderer.thumbScale(renderer.settings.maxValue)-renderer.thumbScale(renderer.settings.minValue))*t,s;switch(renderer.scaleFactor||(renderer.scaleFactor=Utils.getChromeScale(renderer.widget.elem)),renderer.settings.orientation){case Enum.Orientation.LTR:e.x/renderer.scaleFactor>=renderer.settings.thumbPosition+i&&(s=renderer.widget.data.node.value+(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.minValue),max:renderer.thumbScale(renderer.settings.maxValue)})),e.x/renderer.scaleFactor<=renderer.settings.thumbPosition-i&&(s=renderer.widget.data.node.value-(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.minValue),max:renderer.thumbScale(renderer.settings.maxValue)}));break;case Enum.Orientation.RTL:e.x/renderer.scaleFactor<=renderer.settings.thumbPosition+i&&(s=renderer.widget.data.node.value-(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.maxValue),max:renderer.thumbScale(renderer.settings.minValue)})),e.x/renderer.scaleFactor>=renderer.settings.thumbPosition-i&&(s=renderer.widget.data.node.value+(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.maxValue),max:renderer.thumbScale(renderer.settings.minValue)}));break;case Enum.Orientation.TTB:e.y/renderer.scaleFactor>=renderer.settings.thumbPosition+i&&(s=renderer.widget.data.node.value+(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.minValue),max:renderer.thumbScale(renderer.settings.maxValue)})),e.y/renderer.scaleFactor<=renderer.settings.thumbPosition-i&&(s=renderer.widget.data.node.value-(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.minValue),max:renderer.thumbScale(renderer.settings.maxValue)}));break;case Enum.Orientation.BTT:e.y/renderer.scaleFactor<=renderer.settings.thumbPosition+i&&(s=renderer.widget.data.node.value-(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.maxValue),max:renderer.thumbScale(renderer.settings.minValue)})),e.y/renderer.scaleFactor>=renderer.settings.thumbPosition-i&&(s=renderer.widget.data.node.value+(renderer.settings.maxValue-renderer.settings.minValue)*t*l(renderer,e,i),renderer.settings.thumbPosition=Types.parseValue(renderer.thumbScale(s),"Number",{min:renderer.thumbScale(renderer.settings.maxValue),max:renderer.thumbScale(renderer.settings.minValue)}));break}renderer.updateThumb()}}function l(renderer,e,t){var i;return renderer.settings.orientation===Enum.Orientation.LTR||renderer.settings.orientation===Enum.Orientation.RTL?i=Math.floor(Math.abs(renderer.settings.thumbPosition-e.x/renderer.scaleFactor)/t):renderer.settings.orientation!==Enum.Orientation.TTB&&renderer.settings.orientation!==Enum.Orientation.BTT||(i=Math.floor(Math.abs(renderer.settings.thumbPosition-e.y/renderer.scaleFactor)/t)),i}function d(renderer){var e=(renderer.settings.maxValue-renderer.settings.minValue)/(renderer.settings.majorTicks+1);renderer.tickValues=[];for(var t=0;t<renderer.settings.majorTicks+2;t+=1)renderer.tickValues[t]=parseFloat(brease.formatter.formatNumber(renderer.settings.minValue+t*e,renderer.settings.numberFormat,renderer.settings.useDigitGrouping,renderer.settings.separators))}function c(renderer){if(void 0!==renderer.settings.image&&""!==renderer.settings.image){var e="<img src="+renderer.settings.image+"></img>";renderer.thumbBackground.append(e),renderer.thumbCornerHandling(!0)}else renderer.thumbCornerHandling(!1)}return Renderer}),define("widgets/brease/BasicSlider/libs/Config",["brease/enum/Enum"],function(Enum){"use strict";return{changeOnMove:!0,largeChange:10,majorTicks:5,maxValue:100,minValue:0,orientation:Enum.Orientation.LTR,smallChange:1,showTickNumbers:!1,showValueDisplay:!1,tickPosition:Enum.TickStyle.NONE,value:0,thumbSize:"25px",scaleOffset:"15px",valueDisplaySize:"35px",trackSize:"7px",image:"",ellipsis:!1,showUnit:!1}}),define("widgets/brease/common/libs/wfUtils/UtilsEditableBinding",[],function(){"use strict";var UtilsEditableBinding={};UtilsEditableBinding.handleEditable=function(i,s,n,a){if(void 0!==s&&void 0!==s.refAttribute){var r=s.refAttribute;a.indexOf(r)>-1&&(e.call(n,r,i),n.settings.editable=t.call(n),n._internalEnable())}};function e(e,t){i.call(this)||s.call(this),this.internal.editables[e]=t}function t(){var e=!0,t=this.internal.editables;for(var i in t)if(e=e&&t[i],!e)return e;return e}function i(){return this.internal&&this.internal.editables}function s(){this.internal||(this.internal={}),this.internal.editables||(this.internal.editables={})}return UtilsEditableBinding}),define("widgets/brease/BasicSlider/BasicSlider",["brease/core/BaseWidget","brease/events/BreaseEvent","widgets/brease/BasicSlider/libs/Renderer","brease/enum/Enum","brease/core/Types","brease/core/Utils","brease/decorators/MeasurementSystemDependency","brease/datatype/Node","brease/config/NumberFormat","brease/decorators/LanguageDependency","widgets/brease/BasicSlider/libs/Config","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/libs/BreaseResizeObserver","brease/decorators/ContentActivatedDependency","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,Renderer,Enum,Types,Utils,t,Node,NumberFormat,i,Config,UtilsEditableBinding,s,BreaseResizeObserver,n){"use strict";var a=Config,r=e.extend(function BasicSlider(){e.apply(this,arguments)},a),o=r.prototype;r.static.multitouch=!0,o.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseBasicSlider"),this.triggerValueChangedEventThrottled=_.throttle(this.triggerValueChangedEvent,100),this.data={node:new Node(this.settings.value,null,this.settings.minValue,this.settings.maxValue)},this.initSettings(),this.observer=new BreaseResizeObserver(this.elem,this._bind(this.redraw)),e.prototype.init.apply(this,arguments),this.renderer=new Renderer(this),this.onMove=!1,this._addSliderThumpEvents(),this.settings.minValue>0&&(this.settings.value=this.settings.minValue,this.submitChange()),this.writeUnit(this.settings.unitSymbol),this.writeValue(),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind(g))},o._addSliderThumpEvents=function(){this.sliderThumb=this.el.find(".sliderThumb"),this.sliderThumb.on("mousedown pointerdown touchstart",this._bind(u)),this.sliderThumb.on(BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler"))},o._enableHandler=function(){this.renderer&&this.renderer.enableClassHandling()},o.setStyle=function(t){e.prototype.setStyle.call(this,t),this.redrawView(),this.writeValue()},o.setFormat=function(e){this.settings.format=e,this.updateFormat(),this.renderer.updateAxis(),this.writeValue()},o.getFormat=function(){return this.settings.format},o.setLargeChange=function(e){this.settings.largeChange=e},o.getLargeChange=function(){return this.settings.largeChange},o.setMajorTicks=function(e){this.settings.majorTicks=e,this.renderer.redraw()},o.getMajorTicks=function(){return this.settings.majorTicks},o.setMaxValue=function(e){Utils.isNumeric(e)&&(this.data.node.setMaxValue(e),this.renderer.settings.maxValue=e,this.renderer.scaleDomain(this.data.node),this.renderer.updateAxis(),this.setValue(this.data.node.value))},o.getMaxValue=function(){return this.data.node.maxValue},o.setMinValue=function(e){Utils.isNumeric(e)&&(this.data.node.setMinValue(e),this.renderer.settings.minValue=e,this.renderer.scaleDomain(this.data.node),this.renderer.updateAxis(),this.setValue(this.data.node.value))},o.getMinValue=function(){return this.data.node.minValue},o.setNode=function(e){void 0!==e.minValue&&this.data.node.minValue!==e.minValue&&(this.data.node.setMinValue(e.minValue),this.renderer.scaleDomain(e),this.renderer.updateAxis()),void 0!==e.maxValue&&this.data.node.maxValue!==e.maxValue&&(this.data.node.setMaxValue(e.maxValue),this.renderer.scaleDomain(e),this.renderer.updateAxis()),void 0!==this.valueChange&&"resolved"!==this.valueChange.state()?this.valueChange.resolve():(this.data.node.setId(e.id),this.setValue(e.value))},o.getNode=function(){return this.data.node},o.setOrientation=function(e){this.settings.orientation=e,this.setOrientationClasses(),this.renderer.redraw()},o.getOrientation=function(){return this.settings.orientation},o.setShowTickNumbers=function(e){this.settings.showTickNumbers=e,this.renderer.tickNumbersHandling()},o.getShowTickNumbers=function(){return this.settings.showTickNumbers},o.setShowValueDisplay=function(e){this.settings.showValueDisplay=e,this.renderer.valueDisplayHandling()},o.getShowValueDisplay=function(){return this.settings.showValueDisplay},o.setSmallChange=function(e){this.settings.smallChange=e},o.getSmallChange=function(){return this.settings.smallChange},o.setTickPosition=function(e){this.settings.tickPosition=e,this.renderer.tickPositionHandling()},o.getTickPosition=function(){return this.settings.tickPosition},o.setShowUnit=function(e){this.settings.showUnit=e,this.showUnit()},o.getShowUnit=function(){return this.settings.showUnit},o.setUnit=function(e){if(Utils.isObject(e))this.settings.unitTextKey=void 0,this.settings.unit=e;else if(brease.language.isKey(e))try{this.setLangDependency(!0),this.settings.unitTextKey=brease.language.parseKey(e),this.settings.unit=JSON.parse(brease.language.getTextByKey(this.settings.unitTextKey).replace(/'/g,'"'))}catch(t){console.iatWarn(this.elem.id+':Unit String "'+e+'" is invalid!')}else{this.settings.unitTextKey=void 0;try{this.settings.unit=JSON.parse(e.replace(/'/g,'"'))}catch(t){console.iatWarn(this.elem.id+':Unit String "'+e+'" is invalid!')}}void 0===e&&(this.settings.unit=void 0),this.processMeasurementSystemUpdate()},o.getUnit=function(){return this.settings.unit},o.setValue=function(e){!1===this.onMove&&(void 0!==e&&this.data.node.setValue(Types.parseValue(e,"Number",{min:this.data.node.minValue,max:this.data.node.maxValue})),void 0!==this.valueChange&&"resolved"!==this.valueChange.state()?this.valueChange.resolve():(this.renderer.updateThumbPositionByValue(this.data.node.value),this.writeValue()))},o.getValue=function(){return this.data.node.value},o.setScaleOffset=function(e){this.settings.scaleOffset=parseInt(e,10),this.renderer.redraw()},o.getScaleOffset=function(){return parseInt(this.settings.scaleOffset,10)+"px"},o.setThumbSize=function(e){this.settings.thumbSize=parseInt(e,10),this.renderer.redraw()},o.getThumbSize=function(){return parseInt(this.settings.thumbSize,10)+"px"},o.setValueDisplaySize=function(e){this.settings.valueDisplaySize=parseInt(e,10),this.renderer.redraw()},o.getValueDisplaySize=function(){return parseInt(this.settings.valueDisplaySize,10)+"px"},o.setEllipsis=function(e){this.settings.ellipsis=e,this.renderer.redraw()},o.getEllipsis=function(){return this.settings.ellipsis},o.setTrackSize=function(e){this.settings.trackSize=parseInt(e,10),this.renderer.redraw()},o.getTrackSize=function(){return parseInt(this.settings.trackSize,10)+"px"},o.setImage=function(e){this.settings.image=e;var t=this.el.find("img");void 0!==e&&""!==e?t.length>0?this.renderer.updateImg(e,!1):this.renderer.updateImg(e,!0):(t.remove(),this.renderer.thumbCornerHandling(!1))},o.getImage=function(){return this.settings.image},o.setChangeOnMove=function(e){this.settings.changeOnMove=e},o.getChangeOnMove=function(){return this.settings.changeOnMove},o.setEditable=function(e,t){var i=["value","node"];UtilsEditableBinding.handleEditable(e,t,this,i)},o.langChangeHandler=function(e){null!==this.data.node.unit&&!0===this.settings.showUnit&&this.showUnit()},o.showUnit=function(){brease.language.pipeAsyncUnitSymbol(this.data.node.unit,this._bind("writeUnit"))},o.writeUnit=function(e){this.settings.unitSymbol=e,!0===this.settings.showUnit||"true"===this.settings.showUnit?this.renderer&&(this.renderer.outputUnit.text(e),!0===brease.config.editMode&&this.renderer.outputUnit.text("unit")):this.renderer&&this.renderer.outputUnit.text("")},o.processMeasurementSystemUpdate=function(){var e=this;this.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.updateFormat(),this.valueChange=$.Deferred(),this.unitChange=$.Deferred(),$.when(this.valueChange.promise(),this.unitChange.promise()).then(function t(){c(e)});var t=this.data.node.unit;void 0!==this.settings.unit&&this.data.node.setUnit(this.settings.unit[this.settings.mms]),this.data.node.unit!==t?brease.language.pipeAsyncUnitSymbol(this.data.node.unit,this._bind(d)):this.unitChange.resolve();var i=brease.uiController.getSubscriptionsForElement(this.elem.id);void 0!==i&&void 0!==i.node&&this.data.node.unit!==t?this.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:this.data.node.unit}):this.valueChange.resolve()},o.measurementSystemChangeHandler=function(){this.processMeasurementSystemUpdate()},o.contentActivatedHandler=function(){this.observer.initialized?this.observer.wake():this.observer.init()},o.writeValue=function(){this.settings.displayedValue=brease.formatter.formatNumber(this.data.node.value,this.settings.numberFormat,this.settings.useDigitGrouping,this.settings.separators),this.renderer.outputVal.text(this.settings.displayedValue)},o._mouseDownHandler=function(e){if(!this.isDisabled&&!this.onMove){this.onMove=!0,this.pointerId=Utils.getPointerId(e),this._handleEvent(e),$(document).on(BreaseEvent.MOUSE_MOVE,this._bind("_mouseMoveHandler")),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler"));this.createMouseEvent("MouseDown",{},e).dispatch()}},o._mouseMoveHandler=function(e){this._handleEvent(e),this.renderer.getCurrentValue(),this.writeValue(),!0===this.settings.changeOnMove&&this.submitChange()},o._mouseUpHandler=function(e){if(!this.isDisabled&&!brease.config.editMode&&Utils.getPointerId(e)===this.pointerId){this._handleEvent(e),$(document).off(BreaseEvent.MOUSE_MOVE,this._bind("_mouseMoveHandler")),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler")),this.renderer.getCurrentValue(),this.writeValue(),this.submitChange(),this.onMove=!1;this.createMouseEvent("MouseUp",{},e).dispatch()}},o._visibleHandler=function(){e.prototype._visibleHandler.apply(this,arguments),this.isVisible()&&this.renderer&&this.redraw()},o.submitChange=function(){this.sendValueChange({value:this.getValue(),node:this.getNode()}),this.triggerValueChangedEventThrottled()},o.triggerValueChangedEvent=function(){this.createEvent("ValueChanged",{value:this.getValue()}).dispatch()},o.wake=function(){this._addRedrawListener(),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind(g)),e.prototype.wake.apply(this,arguments)},o.suspend=function(){document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind(g)),this.observer.suspend(),this._removeRedrawListener(),e.prototype.suspend.apply(this,arguments)},o.dispose=function(){document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind(g)),this.observer.dispose(),this.observer=void 0,this.sliderThumb.off(),this.renderer.dispose(),this.triggerValueChangedEventThrottled.cancel(),this._removeRedrawListener(),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler")),$(document).off(BreaseEvent.MOUSE_MOVE,this._bind("_mouseMoveHandler")),e.prototype.dispose.apply(this,arguments)};function l(e){e.detail.contentId===this.getParentContentId()&&this.redrawView()}o._addRedrawListener=function(){(isNaN(this.settings.height)||isNaN(this.settings.width))&&brease.bodyEl.on(BreaseEvent.FRAGMENT_SHOW,this._bind(l))},o._removeRedrawListener=function(){brease.bodyEl.off(BreaseEvent.FRAGMENT_SHOW,this._bind(l))},o.setOrientationClasses=function(){switch(this.settings.orientation){case Enum.Orientation.LTR:case Enum.Orientation.RTL:this.el.addClass("horizontal").removeClass("vertical");break;case Enum.Orientation.TTB:case Enum.Orientation.BTT:this.el.addClass("vertical").removeClass("horizontal");break}},o.redrawView=function(){this.isVisible()&&this.renderer&&(this.renderer.redraw(),this._addSliderThumpEvents())},o.redraw=function(){this.isVisible()&&(this.redrawView(),this.writeValue(),this.writeUnit(this.settings.unitSymbol))},o.updateFormat=function(){if(void 0!==this.settings.format){var e;if(Utils.isObject(this.settings.format))this.settings.numberFormat=NumberFormat.getFormat(this.settings.format,this.settings.mms);else if("string"==typeof format)if(brease.language.isKey(this.settings.format))try{this.setLangDependency(!0);var t=brease.language.parseKey(this.settings.format);e=JSON.parse(brease.language.getTextByKey(t).replace(/'/g,'"')),this.settings.numberFormat=NumberFormat.getFormat(e,this.settings.mms)}catch(e){console.iatWarn(this.elem.id+': Format String "'+this.settings.format+'" is invalid!'),this.settings.numberFormat=NumberFormat.getFormat({},this.settings.mms)}else try{e=JSON.parse(this.settings.format.replace(/'/g,'"')),this.settings.numberFormat=NumberFormat.getFormat(e,this.settings.mms)}catch(e){console.iatWarn(this.elem.id+': Format String "'+this.settings.format+'" is invalid!'),this.settings.numberFormat=NumberFormat.getFormat({},this.settings.mms)}}else this.settings.numberFormat=NumberFormat.getFormat({},this.settings.mms);this.settings.separators=brease.user.getSeparators()};function d(e){this.settings.unitSymbol=e,this.unitChange.resolve()}function c(e){e.writeUnit(e.settings.unitSymbol),e.renderer.updateAxis(),e.renderer.getCurrentValue(),e.writeValue()}function h(e){e.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),Utils.isObject(e.settings.unit)&&(e.data.node.unit=e.settings.unit[brease.measurementSystem.getCurrentMeasurementSystem()],e.showUnit(),e.setLangDependency(!0))}o.initSettings=function(){this.initParse(),this.setOrientationClasses(),this.settings.separators=brease.user.getSeparators(),this.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.updateFormat(),h(this)},o.initParse=function(){this.settings.thumbSize=parseInt(this.settings.thumbSize,10),this.settings.valueDisplaySize=parseInt(this.settings.valueDisplaySize,10),this.settings.scaleOffset=parseInt(this.settings.scaleOffset,10),this.settings.trackSize=parseInt(this.settings.trackSize,10)},o._initEditor=function(){var e=this;require(["widgets/brease/BasicSlider/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0})),e.observer.init()})};function u(e){!brease.config.editMode&&this.isEnabled()&&e.stopPropagation()}function g(){this.redraw(this)}return n.decorate(s.decorate(t.decorate(i.decorate(r,!1),!0),!1),!0)}),define("widgets/brease/BasicSlider/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.BasicSlider",parents:["*"],children:[],inheritance:["widgets.brease.BasicSlider","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{
method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setChangeOnMove:{method:"setChangeOnMove",parameter:{changeOnMove:{name:"changeOnMove",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setLargeChange:{method:"setLargeChange",parameter:{largeChange:{name:"largeChange",index:0,type:"UNumber"}}},setMajorTicks:{method:"setMajorTicks",parameter:{majorTicks:{name:"majorTicks",index:0,type:"UInteger"}}},setMaxValue:{method:"setMaxValue",parameter:{maxValue:{name:"maxValue",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{minValue:{name:"minValue",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.Node"}}},setOrientation:{method:"setOrientation",parameter:{orientation:{name:"orientation",index:0,type:"brease.enum.Orientation"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setScaleOffset:{method:"setScaleOffset",parameter:{scaleOffset:{name:"scaleOffset",index:0,type:"PixelVal"}}},setShowTickNumbers:{method:"setShowTickNumbers",parameter:{showTickNumbers:{name:"showTickNumbers",index:0,type:"Boolean"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},setShowValueDisplay:{method:"setShowValueDisplay",parameter:{showValueDisplay:{name:"showValueDisplay",index:0,type:"Boolean"}}},setSmallChange:{method:"setSmallChange",parameter:{smallChange:{name:"smallChange",index:0,type:"UNumber"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setThumbSize:{method:"setThumbSize",parameter:{thumbSize:{name:"thumbSize",index:0,type:"PixelVal"}}},setTickPosition:{method:"setTickPosition",parameter:{tickPosition:{name:"tickPosition",index:0,type:"brease.enum.TickStyle"}}},setTrackSize:{method:"setTrackSize",parameter:{trackSize:{name:"trackSize",index:0,type:"PixelVal"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Number"}}},setValueDisplaySize:{method:"setValueDisplaySize",parameter:{valueDisplaySize:{name:"valueDisplaySize",index:0,type:"PixelVal"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/BusyIndicator/BusyIndicator.html",[],function(){return'<img id="WIDGETID" data-brease-widget="widgets/brease/BusyIndicator"></img>'}),define("widgets/brease/BusyIndicator/BusyIndicator",["brease/core/BaseWidget"],function(e){"use strict";var t={imgSrc:"widgets/brease/BusyIndicator/assets/busy-animated.gif"},BusyIndicator=e.extend(function BusyIndicator(){e.apply(this,arguments)},t),i=BusyIndicator.prototype;return i.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseBusyIndicator"),e.prototype.init.call(this,!0),this.elem.onload=this._bind("draw"),this.elem.onerror=this._bind("_imageLoadError"),this.elem.src=this.settings.imgSrc},i.draw=function(){this.elem.onload=null,this.elem.onerror=null,this._dispatchReady()},i.dispose=function(){this.elem.onload=null,this.elem.onerror=null,e.prototype.dispose.apply(this,arguments)},i._imageLoadError=function(){this.elem.onload=null,this.elem.onerror=null,console.iatWarn('could not load image "'+this.settings.imgSrc+'" @BusyIndicator[id="'+this.elem.id+'"]!'),this._dispatchReady()},BusyIndicator}),define("widgets/brease/BusyIndicator/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.BusyIndicator",parents:["*"],children:[],inheritance:["widgets.brease.BusyIndicator","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/Button/Button.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Button">CONTENT</div>\r\n'}),define("widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents",[],function(){"use strict";return{}}),define("widgets/brease/Button/Button",["brease/core/BaseWidget","brease/decorators/LanguageDependency","brease/enum/Enum","brease/core/Types","brease/core/Utils","widgets/brease/common/libs/wfUtils/UtilsImage","brease/events/BreaseEvent","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,t,Enum,Types,Utils,UtilsImage,BreaseEvent,i){"use strict";var s={imageAlign:Enum.ImageAlign.left,ellipsis:!1,wordWrap:!1,multiLine:!1,breakWord:!1,useSVGStyling:!0,tabIndex:0},n=e.extend(function Button(){e.apply(this,arguments)},s),a=n.prototype;n.static.multitouch=!0,a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseButton"),r.call(this),o(this),l.call(this),e.prototype.init.call(this)},a.langChangeHandler=function(e){this.settings.textkey&&this.setText(brease.language.getTextByKey(this.settings.textkey),!0),this.settings.mouseDownTextkey&&this.setMouseDownText(brease.language.getTextByKey(this.settings.mouseDownTextkey),!0)},a.setText=function(e,t){if(this.settings.text=e,!0!==t&&this.removeTextKey(),!0!==brease.config.editMode&&!0===brease.language.isKey(this.settings.text))return this.setTextKey(brease.language.parseKey(this.settings.text),!1),this.langChangeHandler(),void 0;void 0===this.textEl&&h(this),this.textEl&&this.textEl.text(brease.language.unescapeText(e)),this.setClasses()},a.getText=function(){return this.settings.text},a.setMouseDownText=function(e,t){if(this.settings.mouseDownText=e,void 0!==this.settings.mouseDownText&&""!==this.settings.mouseDownText){if(!0!==t&&this.removeMouseDownTextKey(),!0!==brease.config.editMode&&!0===brease.language.isKey(this.settings.mouseDownText))return this.setMouseDownTextKey(brease.language.parseKey(this.settings.mouseDownText),!1),this.langChangeHandler(),void 0;void 0===this.downtextEl&&d(this),this.downtextEl&&(""===this.settings.mouseDownText&&this.downtextEl.text(brease.language.unescapeText(this.settings.text)),this.downtextEl.text(brease.language.unescapeText(e))),this.setClasses()}else void 0!==this.downtextEl&&c(this)},a.getMouseDownText=function(){return this.settings.mouseDownText},a.setMouseDownImage=function(e){""===e?(this.settings.mouseDownImage=void 0,(this.el.hasClass("active")||this.el.hasClass("checked"))&&this.setImage(this.settings.image,!0)):(this.settings.mouseDownImage=e,(this.el.hasClass("active")||this.el.hasClass("checked"))&&this.setImage(this.settings.mouseDownImage,!0))},a.getMouseDownImage=function(){return this.settings.mouseDownImage},a.setEllipsis=function(e){this.settings.ellipsis=e,o(this)},a.getEllipsis=function(){return this.settings.ellipsis},a.setImageAlign=function(e){this.settings.imageAlign=e,this.setClasses(),!this.textEl||this.settings.imageAlign!==Enum.ImageAlign.left&&this.settings.imageAlign!==Enum.ImageAlign.top?(this.el.append(this.imgEl),this.el.append(this.svgEl)):(this.el.prepend(this.imgEl),this.el.prepend(this.svgEl))},a.getImageAlign=function(){return this.settings.imageAlign},a.setMultiLine=function(e){this.settings.multiLine=e,o(this)},a.getMultiLine=function(){return this.settings.multiLine},a.setWordWrap=function(e){this.settings.wordWrap=e,o(this)},a.getWordWrap=function(){return this.settings.wordWrap},a.setBreakWord=function(e){this.settings.breakWord=e,o(this)},a.getBreakWord=function(){return this.settings.breakWord},a.setTextKey=function(e,t){void 0!==e&&(this.settings.textkey=e,this.setLangDependency(!0),!1!==t&&this.langChangeHandler())},a.getTextKey=function(){return this.settings.textkey},a.removeTextKey=function(){this.settings.textkey=null,this.settings.mouseDownTextkey||this.setLangDependency(!1)},a.setMouseDownTextKey=function(e,t){void 0!==e&&(this.settings.mouseDownTextkey=e,this.setLangDependency(!0),!1!==t&&this.langChangeHandler())},a.getMouseDownTextKey=function(){return this.settings.mouseDownTextkey},a.removeMouseDownTextKey=function(){this.settings.mouseDownTextkey=null,this.settings.textkey||this.setLangDependency(!1)},a.setImage=function(e,t){var i=this;u.call(this),void 0!==e&&""!==e?(!0!==t&&(this.settings.image=e),UtilsImage.isStylable(e)&&this.settings.useSVGStyling?(this.imageDeferred=UtilsImage.getInlineSvg(e),this.imageDeferred.done(function(e){i.svgEl.replaceWith(e),i.svgEl=e}),this.imgEl.hide(),this.svgEl.show()):(this.imgEl.attr("src",e),this.svgEl.hide(),this.imgEl.show()),this.setClasses()):(this.settings.image=void 0,this.svgEl.hide(),this.imgEl.hide())},a.getImage=function(){return this.settings.image},a.removeImage=function(){this.imgEl&&(this.imgEl.hide(),this.svgEl.hide(),this.settings.image=void 0),this.setClasses()},a.removeText=function(){this.setText(""),this.setClasses()},a.removeMouseDownText=function(){this.setMouseDownText(""),this.setClasses()},a.setUseSVGStyling=function(e){this.settings.useSVGStyling=Types.parseValue(e,"Boolean",{default:!0}),this.setImage(this.settings.image,!1)},a.getUseSVGStyling=function(){return this.settings.useSVGStyling},a._initEventHandler=function(){e.prototype._initEventHandler.apply(this,arguments),this.el&&(this.el.on(BreaseEvent.DBL_CLICK,this._bind("_dblclickHandler")),this.el.on(BreaseEvent.MOUSE_DOWN,this._bind("_downHandler")))},a._clickHandler=function(t){e.prototype._clickHandler.apply(this,arguments),this.isDisabled||brease.config.editMode||(this.elem.dispatchEvent(new CustomEvent("Click",{bubbles:!0})),this._onButtonClick())},a._onButtonClick=function(e){},a._dblclickHandler=function(e){if(!this.isDisabled&&!brease.config.editMode){this.createMouseEvent("DoubleClick",{},e).dispatch()}},a._downHandler=function(e){if(!(this.isDisabled||brease.config.editMode||this.isActive)){this.isActive=!0,this.pointerId=Utils.getPointerId(e),""!==this.settings.mouseDownImage&&void 0!==this.settings.mouseDownImage&&this.setImage(this.settings.mouseDownImage,!0),this.el.addClass("active"),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_upHandler")),$(window).on("blur",this._bind("_blurOnMoveHandler"));this.createMouseEvent("MouseDown",{},e).dispatch()}},a._blurOnMoveHandler=function(){this._resetActiveState(),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler")),$(window).off("blur",this._bind("_blurOnMoveHandler")),this.createEvent("MouseUp").dispatch()},a._resetActiveState=function(){this.isActive=!1,""!==this.settings.mouseDownImage&&void 0!==this.settings.mouseDownImage&&void 0!==this.settings.image&&this.setImage(this.settings.image,!0),void 0!==this.settings.mouseDownImage&&void 0===this.settings.image&&this.setImage("",!1),this.elem.classList.remove("active")},a._upHandler=function(e){if($(window).off("blur",this._bind("_blurOnMoveHandler")),!this.isDisabled&&!brease.config.editMode&&Utils.getPointerId(e)===this.pointerId){this._resetActiveState(),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler"));this.createMouseEvent("MouseUp",{},e).dispatch()}},a.disable=function(){if(this.isActive){var t=$.Event(BreaseEvent.MOUSE_UP),i=this.elem.getBoundingClientRect();t.clientX=i.left,t.clientY=i.top,t.pointerId=this.pointerId,this.el.trigger(t)}e.prototype.disable.apply(this,arguments)},a._preventClickHandler=function(e){this._handleEvent(e)},a.wake=function(){e.prototype.wake.apply(this,arguments)},a.suspend=function(){$(window).off("blur",this._bind("_blurOnMoveHandler")),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler")),this._resetActiveState(),e.prototype.suspend.apply(this,arguments)},a.dispose=function(){$(window).off("blur",this._bind("_blurOnMoveHandler")),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler")),this._resetActiveState(),u.call(this),e.prototype.dispose.apply(this,arguments)},a.setClasses=function(){var e;if(void 0!==this.imgEl&&void 0!==this.textEl&&""!==this.settings.text){switch(this.settings.imageAlign){case Enum.ImageAlign.left:e="image-left";break;case Enum.ImageAlign.right:e="image-right";break;case Enum.ImageAlign.top:e="image-top";break;case Enum.ImageAlign.bottom:e="image-bottom";break}this.el.removeClass("image-left image-right image-top image-bottom"),this.el.addClass(e)}else this.el.removeClass("image-left image-right image-top image-bottom")};function r(){this.settings.imageAlign=Types.parseValue(this.settings.imageAlign,"Enum",{Enum:Enum.ImageAlign,default:Enum.ImageAlign.left}),void 0===this.imgEl&&void 0===this.svgEl&&(this.imgEl=$("<img/>").hide(),this.svgEl=$("<svg/>").hide()),this.setImageAlign(this.settings.imageAlign),void 0!==this.settings.image&&this.setImage(this.settings.image)}function o(e){e.settings.ellipsis=Types.parseValue(e.settings.ellipsis,"Boolean"),e.settings.multiLine=Types.parseValue(e.settings.multiLine,"Boolean"),e.settings.wordWrap=Types.parseValue(e.settings.wordWrap,"Boolean"),!0===e.settings.ellipsis?e.el.addClass("ellipsis"):e.el.removeClass("ellipsis"),!0===e.settings.multiLine?(e.el.addClass("multiLine"),!0===e.settings.wordWrap?(e.el.addClass("wordWrap"),e.el.removeClass("multiLine")):e.el.removeClass("wordWrap"),!0===e.settings.breakWord?(e.el.addClass("breakWord"),e.el.removeClass("multiLine")):e.el.removeClass("breakWord")):(e.el.removeClass("breakWord"),e.el.removeClass("wordWrap"),e.el.removeClass("multiLine"))}function l(){void 0!==this.settings.text&&""!==this.settings.text&&(!1===brease.language.isKey(this.settings.text)?this.setText(this.settings.text):this.setTextKey(brease.language.parseKey(this.settings.text),!1)),void 0!==this.settings.mouseDownText&&""!==this.settings.mouseDownText&&(!1===brease.language.isKey(this.settings.mouseDownText)?this.setMouseDownText(this.settings.mouseDownText):this.setMouseDownTextKey(brease.language.parseKey(this.settings.mouseDownText),!1)),this.langChangeHandler()}function d(e){void 0===e.downtextEl&&(e.downtextEl=$('<span class="down"></span>')),!e.imgEl||e.settings.imageAlign!==Enum.ImageAlign.right&&e.settings.imageAlign!==Enum.ImageAlign.bottom?e.el.append(e.downtextEl):e.el.prepend(e.downtextEl)}function c(e){void 0!==e.downtextEl&&(e.downtextEl.remove(),e.downtextEl=void 0)}function h(e){void 0===e.textEl&&(e.textEl=$('<span class="up"></span>')),!e.imgEl||e.settings.imageAlign!==Enum.ImageAlign.right&&e.settings.imageAlign!==Enum.ImageAlign.bottom?e.el.append(e.textEl):e.el.prepend(e.textEl)}function u(){void 0!==this.imageDeferred&&"pending"===this.imageDeferred.state()&&this.imageDeferred.reject()}return i.decorate(t.decorate(n,!1),!1)}),define("widgets/brease/Button/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Button",parents:["*"],children:[],inheritance:["widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ChartWidget/ChartWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ChartWidget">CONTENT</div>\r\n'}),define("widgets/brease/ChartWidget/ChartWidget",["brease/core/ContainerWidget","brease/enum/Enum","brease/events/BreaseEvent","widgets/brease/common/ErrorHandling/libs/CommissioningErrorHandler","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,Enum,BreaseEvent,t,i){"use strict";var s={showGrid:!0,chartMargin:"15px",minZoomLevel:20,maxZoomLevel:500,zoomType:"xy",infiniteScroll:!0},n=e.extend(function ChartWidget(){e.apply(this,arguments)},s),a=n.prototype;a.init=function(){this.addInitialClass("breaseChartWidget"),this.chartItems={xAxis:{},yAxis:{},xValues:{},yValues:{},xCursors:{},isDirty:{xaxis:!1,yaxis:!1,cursor:!1,values:!1,items:!1}},this.timer={axes:[],cursors:[],valueLists:[],chartItems:[]},this.errorHandlerInstance=new t(this),this.error=!1,this.initializationPromise=$.Deferred(),this.timerCleared={axes:$.Deferred(),cursors:$.Deferred(),valueLists:$.Deferred(),chartItems:$.Deferred()},e.prototype.init.call(this),!0!==brease.config.editMode&&this._childInitializationProgress()},a._initEditor=function(){var e=this;require(["widgets/brease/ChartWidget/libs/EditorHandles","widgets/brease/common/libs/EditorGrid"],function(EditorHandles,EditorGrid){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()};var i={layout:"5Areas",mainContainer:!0};e.el.css("padding",e.getChartMargin()),e.editorGrid=new EditorGrid(e,i),e.editorGrid.createLayout(),e.editorGrid.childrenAdded=function(t){var i=this;EditorGrid.prototype.childrenAdded.call(e.editorGrid,t);var s=brease.callWidget(t.detail.widgetId,"widget");$.when(s.allChartItemsInitializedDeferred).done(function(){s.getAxisPosition&&(s.editorGrid.configuration.axisPosition=s.getAxisPosition()),s.el.hasClass("breaseChartXAxisWidget")?("bottom"===s.editorGrid.configuration.axisPosition?(s.el.detach().appendTo(i.widget.el.find(".areaBottom")),i.bottomAreaHeight+=parseInt(s.settings.height,10),i.widget.el.find(".areaGraph").css("height",i.widget.el.find(".areaGraph").height()-parseInt(s.settings.height,10)),i.widget.el.find(".areaBottom").css("flex-basis",i.bottomAreaHeight)):(s.el.detach().appendTo(i.widget.el.find(".areaTop")),i.topAreaHeight+=parseInt(s.settings.height,10),i.widget.el.find(".areaGraph").css("height",i.widget.el.find(".areaGraph").height()-parseInt(s.settings.height,10)),i.widget.el.find(".areaTop").css("flex-basis",i.topAreaHeight)),s.el.css("order",s.el.css("z-Index"))):s.el.hasClass("breaseChartYAxisWidget")&&("left"===s.editorGrid.configuration.axisPosition?(s.el.detach().appendTo(i.widget.el.find(".areaLeft")),i.leftAreaSize=i.leftAreaSize+parseInt(s.settings.width,10),i.widget.el.find(".areaGraph").css("width",i.widget.el.find(".areaGraph").width()-parseInt(s.settings.width,10)),i.widget.el.find(".areaLeft").css("flex-basis",i.leftAreaSize)):(s.el.detach().appendTo(i.widget.el.find(".areaRight")),i.rightAreaSize=i.rightAreaSize+parseInt(s.settings.width,10),i.widget.el.find(".areaGraph").css("width",i.widget.el.find(".areaGraph").width()-parseInt(s.settings.width,10)),i.widget.el.find(".areaRight").css("flex-basis",i.rightAreaSize)),s.el.css("order",s.el.css("z-Index"))),e.editorGrid.updateAllChildren()})},e.editorGrid.childrenRemoved=function(t){EditorGrid.prototype.childrenRemoved.call(e.editorGrid,t),this.updateAllChildren()},e.editorGrid.updateAllChildren=function(){var e=this;this.leftAreaSize=0,this.rightAreaSize=0,this.topAreaHeight=0,this.bottomAreaHeight=0,Object.keys(this.children).forEach(function(t){e.children[t].el.hasClass("breaseChartYAxisWidget")?"left"===e.children[t].getAxisPosition()?e.leftAreaSize+=parseInt(e.children[t].settings.width,10):e.rightAreaSize+=parseInt(e.children[t].settings.width,10):e.children[t].el.hasClass("breaseChartXAxisWidget")&&("bottom"===e.children[t].getAxisPosition()?e.bottomAreaHeight+=parseInt(e.children[t].settings.height,10):e.topAreaHeight+=parseInt(e.children[t].settings.height,10))}),this.widget.el.find(".areaLeft").css("flex-basis",this.leftAreaSize),this.widget.el.find(".areaRight").css("flex-basis",this.rightAreaSize),this.widget.el.find(".areaTop").css("flex-basis",this.topAreaHeight),this.widget.el.find(".areaBottom").css("flex-basis",this.bottomAreaHeight),this.widget._updateChart()},e.el.find(".areaGraph").css({width:e.el.width()-o(e.el.css("padding-right"))-o(e.el.css("padding-left")),height:e.el.height()-o(e.el.css("padding-top"))-o(e.el.css("padding-bottom")),"background-image":'url("widgets/brease/LineChart/assets/LCBackground.svg")',"background-size":"contain"}),e.el.css("padding",0),e._updateChart(),e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},a.setShowGrid=function(e){this.settings.showGrid=e},a.getShowGrid=function(){return this.settings.showGrid},a.setChartMargin=function(e){this.settings.chartMargin=e.match(/[\d]*\.*[\d]+px/g)?e:"15px",brease.config.editMode&&this._updateChart()},a.getChartMargin=function(){return this.settings.chartMargin},a.setMinZoomLevel=function(e){this.settings.minZoomLevel=e},a.getMinZoomLevel=function(){return this.settings.minZoomLevel},a.setMaxZoomLevel=function(e){this.settings.maxZoomLevel=e},a.getMaxZoomLevel=function(){return this.settings.maxZoomLevel},a.setZoomType=function(e){this.settings.zoomType=e},a.getZoomType=function(){return this.settings.zoomType},a.setInfiniteScroll=function(e){this.settings.infiniteScroll=e},a.getInfiniteScroll=function(){return this.settings.infiniteScroll},a.setStyle=function(t){var i=$("#"+this.elem.id+" svg g.chart");i.length&&i.removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),e.prototype.setStyle.call(this,t),i.length&&i.addClass(this.settings.stylePrefix+"_style_"+this.settings.style)},a.errorHandler=function(e){this.error=!0,this.errorHandlerInstance[e.name](e.arg1,e.arg2)},a._setWidth=function(t){e.prototype._setWidth.call(this,t),brease.config.editMode&&this.editorGrid.updateAllChildren()},a._setHeight=function(t){e.prototype._setHeight.call(this,t),brease.config.editMode&&this.editorGrid.updateAllChildren()},a._childInitializationProgress=function(){var e=this,t=[],i=[];this._deferredInitStatesFlatList=[],this.el.find("[data-brease-widget]").each(function(){t[this.id]={},i[this.id]=$.Deferred(),i[this.id].promise(),e._deferredInitStatesFlatList.push(i[this.id])});for(var s in t)brease.uiController.getWidgetState(s)>=Enum.WidgetState.READY?i[s].resolve():$("#"+s).on(BreaseEvent.WIDGET_READY,function(e){e.target.id===e.currentTarget.id&&(i[e.target.id].resolve(),$("#"+e.target.id).off())});$.when.apply($,this._deferredInitStatesFlatList).then(function(){var i=e;i._firstChildrenInitializationPromises=[];for(var s in t)e._registerChartItem(e,s);Array.from(e.elem.querySelector("div.container").children).filter(function(e){return e.hasAttribute("data-brease-widget")}).forEach(function(e){var t=brease.callWidget(e.id,"widget");i._firstChildrenInitializationPromises.push(t._getInitializationPromise())}),$.when.apply($,i._firstChildrenInitializationPromises).done(function(){e.initializationPromise.resolve(),e._chartItemsReady()})})},a._axisIsDirty=function(e){if(this.chartItems){if(!this.chartItems.isDirty.xaxis&&!this.chartItems.isDirty.yaxis){var t=_.defer(function(e){e.timer.axes.shift(),e._axisDirtyHandler(),e.chartItems.isDirty.xaxis=!1,e.chartItems.isDirty.yaxis=!1,e.timer.axes.length||e.timerCleared.axes.resolve()},this);this.timer.axes.push(t)}"x"===e?this.chartItems.isDirty.xaxis=!0:this.chartItems.isDirty.yaxis=!0,this._chartItemIsDirty()}},a._cursorIsDirty=function(){if(!1===this.chartItems.isDirty.cursor){var e=_.defer(function(e){e.chartItems.isDirty.cursor=!1,e.timer.cursors.shift(),e._cursorDirtyHandler(),e.timer.cursors.length||e.timerCleared.cursors.resolve()},this);this.timer.cursors.push(e)}this.chartItems.isDirty.cursor=!0,this._chartItemIsDirty()},a._valueListIsDirty=function(){if(this.chartItems){if(!1===this.chartItems.isDirty.values){var e=_.defer(function(e){var t=!0;e.chartItems.isDirty.values=!1,e.timer.valueLists.shift(),e._valueListsDirtyHandler();for(var i in e.chartItems.yValues)e.chartItems.yValues[i].data&&0===e.chartItems.yValues[i].data.arraySize&&(t=!1);!e.timer.valueLists.length&&t&&e.timerCleared.valueLists.resolve()},this);this.timer.valueLists.push(e)}this.chartItems.isDirty.values=!0,this._chartItemIsDirty()}},a._chartItemIsDirty=function(){if(!1===this.chartItems.isDirty.items){var e=_.defer(function(e){e.chartItems.isDirty.items=!1,e.timer.chartItems.shift(),e._chartItemsDirtyHandler(),e.timer.chartItems.length||e.timerCleared.chartItems.resolve()},this);this.timer.chartItems.push(e)}this.chartItems.isDirty.items=!0},a._getInitializationPromise=function(){return this.initializationPromise.promise()};function r(e,t,i){for(var s in e)void 0!==i?e[s][t][i]():e[s][t]()}a._chartItemsReady=function(){var e,t,i,s,n;if(r(this.chartItems.xAxis,"_chartItemsReadyHandler"),r(this.chartItems.yAxis,"_chartItemsReadyHandler"),r(this.chartItems.xValues,"_chartItemsReadyHandler"),r(this.chartItems.yValues,"_chartItemsReadyHandler"),r(this.chartItems.xCursors,"_chartItemsReadyHandler"),!this.isThereAnyError()){this._chartItemsReadyHandler();for(e in this.chartItems.xAxis)this.chartItems.xAxis[e].setStyle(this.chartItems.xAxis[e].settings.style),this.chartItems.xAxis[e]._setActiveCursor(void 0);for(t in this.chartItems.yAxis)this.chartItems.yAxis[t].setStyle(this.chartItems.yAxis[t].settings.style);for(i in this.chartItems.xValues)this.chartItems.xValues[i].setStyle(this.chartItems.xValues[i].settings.style);for(s in this.chartItems.yValues)this.chartItems.yValues[s].setStyle(this.chartItems.yValues[s].settings.style);for(n in this.chartItems.xCursors)this.chartItems.xCursors[n].setStyle(this.chartItems.xCursors[n].settings.style);r(this.chartItems.xAxis,"allChartItemsInitializedDeferred","resolve"),r(this.chartItems.yAxis,"allChartItemsInitializedDeferred","resolve"),r(this.chartItems.xValues,"allChartItemsInitializedDeferred","resolve"),r(this.chartItems.yValues,"allChartItemsInitializedDeferred","resolve"),r(this.chartItems.xCursors,"allChartItemsInitializedDeferred","resolve")}},a.isThereAnyError=function(){return this.error},a._chartItemsReadyHandler=function(){},a._axisDirtyHandler=function(){},a._valueListsDirtyHandler=function(){},a._chartItemsDirtyHandler=function(){},a._cursorDirtyHandler=function(){},a.suspend=function(){Object.getOwnPropertyNames(this.timer).forEach(function(e){for(;this.timer[e].length;)window.clearTimeout(this.timer[e].shift())},this),Object.getOwnPropertyNames(this.chartItems.isDirty).forEach(function(e){this[e]=!1},this.chartItems.isDirty),e.prototype.suspend.apply(this,arguments)},a.dispose=function(){this.timer&&Object.getOwnPropertyNames(this.timer).forEach(function(e){for(;this.timer[e].length;)window.clearTimeout(this.timer[e].shift())},this),e.prototype.dispose.apply(this,arguments)},a._dispatchReady=function(){var t=this;brease.config.editMode?e.prototype._dispatchReady.apply(t,arguments):$.when(this.timerCleared.axes,this.timerCleared.cursors,this.timerCleared.valueLists,this.timerCleared.chartItems).done(function(){e.prototype._dispatchReady.apply(t,arguments)})},a._registerChartItem=function(e,t){var i=brease.callWidget(t,"widget");i._registerChartWidget(e),i.el.hasClass("breaseChartXAxisWidget")?e.chartItems.xAxis[t]=i:i.el.hasClass("breaseChartYAxisWidget")?e.chartItems.yAxis[t]=i:i.el.hasClass("breaseChartXValueListWidget")?e.chartItems.xValues[t]=i:i.el.hasClass("breaseChartYValueListWidget")?e.chartItems.yValues[t]=i:i.el.hasClass("breaseChartXAxisCursorWidget")&&(e.chartItems.xCursors[t]=i)},a._updateChart=function(){this.settings.areaLeft=parseInt(this.el.find(".areaLeft").css("flex-basis"),10),this.settings.areaRight=parseInt(this.el.find(".areaRight").css("flex-basis"),10),this.settings.areaTop=parseInt(this.el.find(".areaTop").css("flex-basis"),10),this.settings.areaBottom=parseInt(this.el.find(".areaBottom").css("flex-basis"),10),this.settings.borderTop=parseInt(this.el.css("border-top-width"),10),this.settings.borderBottom=parseInt(this.el.css("border-bottom-width"),10),this.settings.borderRight=parseInt(this.el.css("border-right-width"),10),this.settings.borderLeft=parseInt(this.el.css("border-left-width"),10),this._getPadding(this.settings.chartMargin),this._getAreas();for(var e in this.editorGrid.children)this.editorGrid.children[e].editorGrid&&this.editorGrid.children[e].editorGrid.updateAxis()},a._getPadding=function(e){var t=$("<div id='padding'></div>").css("padding",e);this.settings.paddingLeft=parseInt(t.css("padding-left"),10),this.settings.paddingRight=parseInt(t.css("padding-right"),10),this.settings.paddingTop=parseInt(t.css("padding-top"),10),this.settings.paddingBottom=parseInt(t.css("padding-bottom"),10),t.css("padding",0)},a._getAreas=function(){
this.editorGrid.areas.graph.css("width",this.settings.width-this.settings.areaLeft-this.settings.areaRight-parseInt(this.settings.paddingLeft,10)-parseInt(this.settings.paddingRight,10)-this.settings.borderLeft-this.settings.borderRight),this.editorGrid.areas.graph.css("height",this.settings.height-this.settings.areaTop-this.settings.areaBottom-parseInt(this.settings.paddingTop,10)-parseInt(this.settings.paddingBottom,10)-this.settings.borderTop-this.settings.borderBottom),this.el.find(".areaCenter").css("width",this.el.width()-this.settings.paddingLeft-this.settings.paddingRight-this.settings.areaLeft-this.settings.areaRight),this.el.find(".areaCenter").css("height",this.settings.height-this.settings.paddingTop-this.settings.paddingBottom),this.el.find(".areaCenter").css("position","absolute"),this.el.find(".areaCenter").css("top",this.settings.paddingTop-this.settings.borderTop-this.settings.borderBottom),this.el.find(".areaCenter").css("left",this.settings.paddingLeft+this.settings.areaLeft),this.el.find(".areaCenter").css("right",this.settings.paddingRight+this.settings.areaRight),this.el.find(".areaCenter").css("bottom",this.settings.paddingBottom),this.el.find(".areaBottom").css("width",this.el.find(".areaGraph").width()),this.el.find(".areaTop").css("width",this.el.find(".areaGraph").width()),this.el.find(".areaLeft").css("height",this.el.find(".areaGraph").height()),this.el.find(".areaRight").css("height",this.el.find(".areaGraph").height()),this.el.find(".areaRight").css("position","absolute"),this.el.find(".areaLeft").css("position","absolute"),this.el.find(".areaRight").css("top",this.settings.paddingTop+this.settings.areaTop),this.el.find(".areaLeft").css("top",this.settings.paddingTop+this.settings.areaTop),this.el.find(".areaRight").css("right",this.settings.paddingRight),this.el.find(".areaLeft").css("left",this.settings.paddingLeft)};function o(e){return e.match(/-?\d+(\.\d+)?/)[0]}return i.decorate(n,!1)}),define("widgets/brease/ChartWidget/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ChartWidget",parents:["*"],children:["*"],inheritance:["widgets.brease.ChartWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},ScrollDown:{method:"scrollDown"},ScrollLeft:{method:"scrollLeft"},ScrollRight:{method:"scrollRight"},ScrollUp:{method:"scrollUp"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setChartMargin:{method:"setChartMargin",parameter:{chartMargin:{name:"chartMargin",index:0,type:"PixelValCollection"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setInfiniteScroll:{method:"setInfiniteScroll",parameter:{infiniteScroll:{name:"infiniteScroll",index:0,type:"Boolean"}}},SetMaxZoomLevel:{method:"setMaxZoomLevel",parameter:{maxZoomLevel:{name:"maxZoomLevel",index:0,type:"UInteger"}}},SetMinZoomLevel:{method:"setMinZoomLevel",parameter:{minZoomLevel:{name:"minZoomLevel",index:0,type:"UInteger"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setShowGrid:{method:"setShowGrid",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetZoomType:{method:"setZoomType",parameter:{zoomType:{name:"zoomType",index:0,type:"brease.enum.ChartZoomType"}}},ShowTooltip:{method:"showTooltip"},ZoomIn:{method:"zoomIn"},ZoomOut:{method:"zoomOut"},ZoomReset:{method:"zoomReset"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/ChartWidget/libs/constants",[],function(){"use strict";return{ERROR_INVALID_PROPERTY_VALUE:"invalidPropertyValue"}}),define("text!widgets/brease/ChartXAxisCursorWidget/ChartXAxisCursorWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ChartXAxisCursorWidget">CONTENT</div>'}),define("widgets/brease/ChartXAxisCursorWidget/ChartXAxisCursorWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/core/Utils"],function(e,BreaseEvent,Utils){"use strict";var t={xAxisRefId:""},i=e.extend(function ChartXAxisCursorWidget(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){this.addInitialClass("breaseChartXAxisCursorWidget"),this.settings.active=!1,this.graphWidgets=[],this.allChartItemsInitializedDeferred=$.Deferred(),this.allChartItemsInitializedDeferred.promise(),this.initializationPromise=$.Deferred(),this.initializationPromise.promise(),e.prototype.init.call(this),this._xAxisCursorReadyHandler()},s.enable=function(){e.prototype.enable.call(this),$("#"+this.elem.id+"_breaseChartXAxisCursor").removeClass("disabled"),this.chartWidget&&this.chartWidget.renderer&&(this._isDirty(),this.chartWidget.renderer.xCursorEnableDrag(this.elem.id))},s.disable=function(){e.prototype.disable.call(this),$("#"+this.elem.id+"_breaseChartXAxisCursor").addClass("disabled"),this.chartWidget&&this.chartWidget.renderer&&(this._isDirty(),this.chartWidget.renderer.xCursorDisableDrag(this.elem.id))},s.updateVisibility=function(t){if(e.prototype.updateVisibility.call(this,t),!0===this.isHidden)$("#"+this.elem.id+"_breaseChartXAxisCursor").addClass("remove"),$("."+this.elem.id).addClass("remove"),this._getActive()&&(this._setActive(!1),this.axisWidget._setActiveCursor(void 0));else{if(void 0!==this.axisWidget){var i=0,s=0;for(var n in this.axisWidget.cursors)i+=1,this.axisWidget.cursors[n].settings.active&&(this.axisWidget._setActiveCursor(n),s+=1);1!==i&&0!==s||(this._setActive(!0),this.axisWidget._setActiveCursor(this.elem.id))}$("#"+this.elem.id+"_breaseChartXAxisCursor").removeClass("remove"),this.setValue(this.getValue()),$("."+this.elem.id).removeClass("remove")}this._isDirty()},s.setStyle=function(t){$("#"+this.elem.id+"_breaseChartXAxisCursor")&&$("#"+this.elem.id+"_breaseChartXAxisCursor").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),e.prototype.setStyle.call(this,t),$("#"+this.elem.id+"_breaseChartXAxisCursor")&&$("#"+this.elem.id+"_breaseChartXAxisCursor").addClass(this.settings.stylePrefix+"_style_"+this.settings.style)},s.stepLeft=function(e){},s.stepRight=function(e){},s.setValue=function(e){},s.getValue=function(){},s._getValue=function(){},s.dispose=function(){e.prototype.dispose.apply(this,arguments)},s._registerChartWidget=function(e){void 0===this.chartWidget&&(this.chartWidget=e)},s._registerAxisWidget=function(e){void 0===this.axisWidget&&(this.axisWidget=e)},s._isDirty=function(){void 0!==this.chartWidget&&this.chartWidget._cursorIsDirty()},s._getInitializationPromise=function(){return this.initializationPromise.promise()},s._xAxisCursorReadyHandler=function(){this.initializationPromise.resolve()},s._chartItemsReadyHandler=function(){},s._getActive=function(){return this.settings.active},s._setActive=function(e){if(this.settings.active="boolean"==typeof e?e:this.settings.active,$("#"+this.elem.id+"_breaseChartXAxisCursor").toggleClass("active",this.settings.active),this.settings.active)for(var t in this.graphWidgets)this.graphWidgets[t]._getIntersectionValue(Utils.isNumeric(this.getValue())?this.getValue():this._getValue(),this._getActive());this._isDirty()},s._getMaxNumberOfSamples=function(){var e;return this._isAtLeastOneGraphVisible()?(Object.keys(this.graphWidgets).filter(function(e){return this.graphWidgets[e].isVisible()},this).forEach(function(t){var i=this.graphWidgets[t],s=i.getNumberOfSamples()>i.getValue().length?i.getValue().length:i.getNumberOfSamples();s=s<0?this.graphWidgets[t].getValue().length:s,void 0===e?e=s:e<s&&(e=s)},this),e):0},s._getMaxDrawnXSampleIndex=function(e){if(!this.axisWidget)return 0;var t=this.axisWidget._xPositions(this.cursorType),i=this.axisWidget._xPositions(),s,n;return 0===t.length?0:(n=+i[e-1],s=t.filter(function(e){return e<=n}),void 0!==e&&e>=0&&0===e?0:s.length-1)},s._isAtLeastOneGraphVisible=function(){var e=[];return e=Object.keys(this.graphWidgets).map(function(e){return this[e].isVisible()},this.graphWidgets),e.reduce(function(e,t){return e||t},!1)},s._clickHandler=function(e){if(this.isDisabled){var t=this.elem.id,i=this.settings.editable&&this.settings.permissions.operate,s=this.createMouseEvent("DisabledClick",{hasPermission:i,origin:t},e);return s.dispatch(!1),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DISABLED_CLICK,{detail:{contentId:this.settings.parentContentId,hasPermission:i,origin:t,widgetId:this.elem.id,horizontalPos:s.data.eventArgs.horizontalPos,verticalPos:s.data.eventArgs.verticalPos},bubbles:!0})),this._handleEvent(e),void 0}this.createMouseEvent("Click",{origin:this.elem.id},e).dispatch(!1)},s._initEditor=function(){var e=this;require(["widgets/brease/ChartXAxisCursorWidget/libs/EditorHandles","widgets/brease/common/libs/EditorGrid"],function(EditorHandles,EditorGrid){var t={};e.editorGrid=new EditorGrid(e,t);var i=new EditorHandles(e);e.getHandles=function(){return i.getHandles()},e.designer.getSelectionDecoratables=function(){return i.getSelectionDecoratables()},e.allChartItemsInitializedDeferred.resolve()})},i}),define("widgets/brease/ChartXAxisCursorWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ChartXAxisCursorWidget",parents:["*"],children:[],inheritance:["widgets.brease.ChartXAxisCursorWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},StepLeft:{method:"stepLeft",parameter:{stepSize:{name:"stepSize",index:0,type:"UInteger"}}},StepRight:{method:"stepRight",parameter:{stepSize:{name:"stepSize",index:0,type:"UInteger"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ChartXAxisWidget/ChartXAxisWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ChartXAxisWidget">CONTENT</div>\r\n'}),define("widgets/brease/ChartXAxisWidget/ChartXAxisWidget",["brease/core/ContainerWidget","brease/enum/Enum","brease/events/BreaseEvent"],function(e,Enum,BreaseEvent){"use strict";var t={axisLabel:"",axisLabelDistance:30,axisPosition:"bottom",tickLabelRotation:"0deg",tickLabelDistance:"9px"},i=e.extend(function ChartXAxisWidget(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){this.addInitialClass("breaseChartXAxisWidget"),this.data={xPositions:[],maxArraySize:2,dataSetInfo:[]},this.axisItems=[],this.cursors=[],this.allChartItemsInitializedDeferred=$.Deferred(),this.allChartItemsInitializedDeferred.promise(),this.initializationPromise=$.Deferred(),this.initializationPromise.promise(),e.prototype.init.call(this),!0!==brease.config.editMode&&this._childInitializationProgress()},s._setHeight=function(t){e.prototype._setHeight.call(this,t),brease.config.editMode&&(this.el.css("flex-basis",""),this.el.css("height",this.settings.height),this.editorGrid.configuration.offsetY="top"===this.getAxisPosition()?this.settings.height-2:0,this.editorGrid.parentWidget.editorGrid.updateAllChildren())},s.setAxisLabelDistance=function(e){this.settings.axisLabelDistance=parseInt(e,10),brease.config.editMode&&(this.editorGrid.configuration.axisLabelDistance=parseInt(this.getAxisLabelDistance(),10),this.editorGrid.updateAxis())},s.getAxisLabelDistance=function(){return this.settings.axisLabelDistance+"px"},s.setAxisPosition=function(e){this.settings.axisPosition=e,brease.config.editMode&&this.editorGrid.configuration.axisPosition!==e&&(this.el.detach().appendTo(this.editorGrid.parentWidget.el.find(".area"+e.charAt(0).toUpperCase()+e.slice(1))),this.editorGrid.configuration.axisPosition=e,this.editorGrid.configuration.offsetY="top"===this.getAxisPosition()?this.settings.height-2:0,this.editorGrid.updateAxis(),this.editorGrid.parentWidget.editorGrid.updateAllChildren())},s.getAxisPosition=function(){return this.settings.axisPosition},s.setTickLabelRotation=function(e){this.settings.tickLabelRotation=e,brease.config.editMode&&this.editorGrid.configuration.tickLabelRotation!==e&&(this.editorGrid.configuration.tickLabelRotation=e,this.editorGrid.updateAxis())},s.getTickLabelRotation=function(){return this.settings.tickLabelRotation},s.setTickLabelDistance=function(e){this.settings.tickLabelDistance=e,brease.config.editMode&&this.editorGrid.configuration.tickLabelDistance!==e&&(this.editorGrid.configuration.tickLabelDistance=e,this.editorGrid.updateAxis())},s.getTickLabelDistance=function(){return this.settings.tickLabelDistance},s.setAxisLabel=function(e){},s.getAxisLabel=function(){},s._childInitializationProgress=function(){var e=this,t=[],i=[],s=[];this.el.find("[data-brease-widget]").each(function(){t[this.id]={},i[this.id]=$.Deferred(),i[this.id].promise(),s.push(i[this.id])});for(var a in t)brease.uiController.getWidgetState(a)>=Enum.WidgetState.READY?i[a].resolve():$("#"+a).on(BreaseEvent.WIDGET_READY,function(e){e.target.id===e.currentTarget.id&&(i[e.target.id].resolve(),$("#"+e.target.id).off())});$.when.apply($,s).then(function(){var i=[];for(var s in t)n(e,s);Array.from(e.elem.querySelector("div.container").children).filter(function(e){return e.hasAttribute("data-brease-widget")}).forEach(function(e){var t=brease.callWidget(e.id,"widget");i.push(t._getInitializationPromise())}),$.when.apply($,i).done(function(){e._axisItemsReadyHandler()})})},s._getInitializationPromise=function(){return this.initializationPromise.promise()},s._isDirty=function(){var e=this;$.when(this.allChartItemsInitializedDeferred).done(function(){e.chartWidget&&e.chartWidget._axisIsDirty("x")})},s._registerChartWidget=function(e){void 0===this.chartWidget&&(this.chartWidget=e)},s._registerGraphArraySize=function(e,t){var i,s={id:e,arraySize:t};i=this.data.dataSetInfo.findIndex(function(e){return e.id===s.id}),-1===i?i=this.data.dataSetInfo.push(s)-1:this.data.dataSetInfo[i].arraySize=t,this.data.maxArraySize=Math.max.apply(Math,this.data.dataSetInfo.map(function(e){return e.arraySize}))},s._axisItemsReadyHandler=function(){this.initializationPromise.resolve()},s._chartItemsReadyHandler=function(){},s._clickHandler=function(e){if(this.isDisabled){var t=this.elem.id,i=this.settings.editable&&this.settings.permissions.operate,s=this.createMouseEvent("DisabledClick",{hasPermission:i,origin:t},e);return s.dispatch(!1),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DISABLED_CLICK,{detail:{contentId:this.settings.parentContentId,hasPermission:i,origin:t,widgetId:this.elem.id,horizontalPos:s.data.eventArgs.horizontalPos,verticalPos:s.data.eventArgs.verticalPos},bubbles:!0})),this._handleEvent(e),void 0}this.createMouseEvent("Click",{origin:this.elem.id},e).dispatch(!1)},s._enableHandler=function(t){!0===t?$("#"+this.elem.id+"_breaseChartXAxis").removeClass("disabled"):$("#"+this.elem.id+"_breaseChartXAxis").addClass("disabled"),e.prototype._enableHandler.apply(this,arguments)},s.updateVisibility=function(t){e.prototype.updateVisibility.call(this,t),!0===this.isHidden?$("#"+this.elem.id+"_breaseChartXAxis").addClass("remove"):$("#"+this.elem.id+"_breaseChartXAxis").removeClass("remove")},s.setStyle=function(t){$("#"+this.elem.id+"_breaseChartXAxis")&&$("#"+this.elem.id+"_breaseChartXAxis").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),e.prototype.setStyle.call(this,t),$("#"+this.elem.id+"_breaseChartXAxis")&&$("#"+this.elem.id+"_breaseChartXAxis").addClass(this.settings.stylePrefix+"_style_"+this.settings.style)},s.dispose=function(){e.prototype.dispose.apply(this,arguments)},s._setActiveCursor=function(e){var t;if(void 0===e)for(t in this.cursors)if(this.cursors[t].getVisible()){e=t;break}if(this.settings.activeCursorId!==e&&void 0!==e){for(t in this.cursors)this.cursors[t]._setActive(!1),this.cursors[t]._isDirty();this.settings.activeCursorId=e,this.cursors[e]._setActive(!0),this.cursors[t]._isDirty()}},s._initEditor=function(){var e=this;require(["widgets/brease/ChartXAxisWidget/libs/EditorHandles","widgets/brease/common/libs/EditorGrid"],function(EditorHandles,EditorGrid){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()};var i={axisType:"Horizontal",axisPosition:e.getAxisPosition(),tickLabelRotation:e.getTickLabelRotation(),tickLabelDistance:e.getTickLabelDistance(),axisDomain:e.elem.className.match(/brease(On)?[Ll]ineChartTimeAxis/)?[Date.now(),Date.now()+1e4]:[0,100],tickFormat:e.settings.format||"d",scaleType:e.elem.className.match(/brease(On)?[Ll]ineChartTimeAxis/)?"time":"number",offsetX:0,offsetY:"top"===e.getAxisPosition()?e.settings.height-2:0,axisLabel:e.getAxisLabel(),axisLabelDistance:parseInt(e.getAxisLabelDistance(),10)};e.editorGrid=new EditorGrid(e,i),e.editorGrid.configuration=i,e.editorGrid.createAxis(),e.allChartItemsInitializedDeferred.resolve()})};function n(e,t){var i=brease.callWidget(t,"widget");i._registerAxisWidget(e),i.el.hasClass("breaseChartXValueListWidget")&&(e.axisItems[t]=i),i.el.hasClass("breaseChartXAxisCursorWidget")&&(e.cursors[t]=i)}return i}),define("widgets/brease/ChartXAxisWidget/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ChartXAxisWidget",parents:["*"],children:["*"],inheritance:["widgets.brease.ChartXAxisWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAxisLabel:{method:"setAxisLabel",parameter:{axisLabel:{name:"axisLabel",index:0,type:"String"}}},setAxisLabelDistance:{method:"setAxisLabelDistance",parameter:{axisLabelDistance:{name:"axisLabelDistance",index:0,type:"PixelVal"}}},setAxisPosition:{method:"setAxisPosition",parameter:{axisPosition:{name:"axisPosition",index:0,type:"brease.enum.VerticalAlign"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTickLabelDistance:{method:"setTickLabelDistance",parameter:{tickLabelDistance:{name:"tickLabelDistance",index:0,type:"PixelVal"}}},setTickLabelRotation:{method:"setTickLabelRotation",parameter:{tickLabelRotation:{name:"tickLabelRotation",index:0,type:"Rotation"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ChartYAxisWidget/ChartYAxisWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ChartYAxisWidget">CONTENT</div>\r\n'}),define("widgets/brease/ChartYAxisWidget/ChartYAxisWidget",["brease/core/ContainerWidget","brease/enum/Enum","brease/events/BreaseEvent"],function(e,Enum,BreaseEvent){"use strict";var t={axisLabel:"",axisLabelDistance:45,axisPosition:"left",tickLabelRotation:"0deg",tickLabelDistance:"9px"},i=e.extend(function ChartYAxisWidget(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){this.addInitialClass("breaseChartYAxisWidget"),this.axisItems=[],this.allChartItemsInitializedDeferred=$.Deferred(),this.allChartItemsInitializedDeferred.promise(),this.initializationPromise=$.Deferred(),this.initializationPromise.promise(),e.prototype.init.call(this),!0!==brease.config.editMode&&this._childInitializationProgress()},s._setWidth=function(t){e.prototype._setWidth.call(this,t),brease.config.editMode&&(this.el.css("flex-basis",""),this.el.css("width",this.settings.width),this.editorGrid.configuration.offsetX="left"===this.getAxisPosition()?this.settings.width-2:0,this.editorGrid.parentWidget.editorGrid.updateAllChildren())},s._clickHandler=function(e){if(this.isDisabled){var t=this.elem.id,i=this.settings.editable&&this.settings.permissions.operate,s=this.createMouseEvent("DisabledClick",{hasPermission:i,origin:t},e);return s.dispatch(!1),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DISABLED_CLICK,{detail:{contentId:this.settings.parentContentId,hasPermission:i,origin:t,widgetId:this.elem.id,horizontalPos:s.data.eventArgs.horizontalPos,verticalPos:s.data.eventArgs.verticalPos},bubbles:!0})),this._handleEvent(e),void 0}this.createMouseEvent("Click",{origin:this.elem.id},e).dispatch(!1)},s.setAxisLabelDistance=function(e){this.settings.axisLabelDistance=parseInt(e,10),brease.config.editMode&&(this.editorGrid.configuration.axisLabelDistance=parseInt(this.getAxisLabelDistance(),10),this.editorGrid.updateAxis())},s.getAxisLabelDistance=function(){return this.settings.axisLabelDistance+"px"},s.setAxisPosition=function(e){this.settings.axisPosition=e,brease.config.editMode&&this.editorGrid.configuration.axisPosition!==this.settings.axisPosition&&(this.el.detach().appendTo(this.editorGrid.parentWidget.el.find(".area"+e.charAt(0).toUpperCase()+e.slice(1))),this.editorGrid.configuration.axisPosition=this.settings.axisPosition,this.editorGrid.configuration.offsetX="right"===this.settings.axisPosition?0:this.settings.width-2,this.editorGrid.updateAxis(),this.editorGrid.parentWidget.editorGrid.updateAllChildren())},s.getAxisPosition=function(){return this.settings.axisPosition},s.setTickLabelRotation=function(e){this.settings.tickLabelRotation=e,brease.config.editMode&&this.editorGrid.configuration.tickLabelRotation!==e&&(this.editorGrid.configuration.tickLabelRotation=e,this.editorGrid.updateAxis())},s.getTickLabelRotation=function(){return this.settings.tickLabelRotation},s.setTickLabelDistance=function(e){this.settings.tickLabelDistance=e,brease.config.editMode&&this.editorGrid.configuration.tickLabelDistance!==e&&(this.editorGrid.configuration.tickLabelDistance=e,this.editorGrid.updateAxis())},s.getTickLabelDistance=function(){return this.settings.tickLabelDistance},s.setAxisLabel=function(e){},s.getAxisLabel=function(){},s._childInitializationProgress=function(){var e=this,t=[],i=[],s=[];this.el.find("[data-brease-widget]").each(function(){t[this.id]={},i[this.id]=$.Deferred(),i[this.id].promise(),s.push(i[this.id])});for(var a in t)brease.uiController.getWidgetState(a)>=Enum.WidgetState.READY?i[a].resolve():$("#"+a).on(BreaseEvent.WIDGET_READY,function(e){e.target.id===e.currentTarget.id&&(i[e.target.id].resolve(),$("#"+e.target.id).off())});$.when.apply($,s).then(function(){var i=[];for(var s in t)n(e,s);Array.from(e.elem.querySelector("div.container").children).filter(function(e){return e.hasAttribute("data-brease-widget")}).forEach(function(e){var t=brease.callWidget(e.id,"widget");i.push(t._getInitializationPromise())}),$.when.apply($,i).done(function(){e._axisItemsReadyHandler()})})},s._getInitializationPromise=function(){return this.initializationPromise.promise()},s._isDirty=function(){var e=this;$.when(this.allChartItemsInitializedDeferred).done(function(){e.chartWidget._axisIsDirty("y")})},s._registerChartWidget=function(e){void 0===this.chartWidget&&(this.chartWidget=e)},s._axisItemsReadyHandler=function(){this.initializationPromise.resolve()},s._chartItemsReadyHandler=function(){},s.enable=function(){e.prototype.enable.call(this),$("#"+this.elem.id+"_breaseChartYAxis").removeClass("disabled")},s.disable=function(){e.prototype.disable.call(this),$("#"+this.elem.id+"_breaseChartYAxis").addClass("disabled")},s.updateVisibility=function(t){e.prototype.updateVisibility.call(this,t),!0===this.isHidden?$("#"+this.elem.id+"_breaseChartYAxis").addClass("remove"):$("#"+this.elem.id+"_breaseChartYAxis").removeClass("remove")},s.setStyle=function(t){$("#"+this.elem.id+"_breaseChartYAxis")&&$("#"+this.elem.id+"_breaseChartYAxis").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),e.prototype.setStyle.call(this,t),$("#"+this.elem.id+"_breaseChartYAxis")&&$("#"+this.elem.id+"_breaseChartYAxis").addClass(this.settings.stylePrefix+"_style_"+this.settings.style)},s.dispose=function(){e.prototype.dispose.apply(this,arguments)};function n(e,t){var i=brease.callWidget(t,"widget");i._registerAxisWidget(e),i.el.hasClass("breaseChartYValueListWidget")&&(e.axisItems[t]=i)}return s._initEditor=function(){var e=this;require(["widgets/brease/ChartYAxisWidget/libs/EditorHandles","widgets/brease/common/libs/EditorGrid"],function(EditorHandles,EditorGrid){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()};var i={axisType:"Vertical",axisPosition:e.getAxisPosition(),tickLabelRotation:e.getTickLabelRotation(),tickLabelDistance:e.getTickLabelDistance(),scaleType:"number",tickFormat:e.currentFormat(),offsetX:"right"===e.getAxisPosition()?0:e.settings.width-2,offsetY:0,axisLabel:e.getAxisLabel(),axisLabelDistance:parseInt(e.getAxisLabelDistance(),10)};e.editorGrid=new EditorGrid(e,i),e.editorGrid.createAxis(),e.allChartItemsInitializedDeferred.resolve()})},i}),define("widgets/brease/ChartYAxisWidget/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ChartYAxisWidget",parents:["*"],children:["*"],inheritance:["widgets.brease.ChartYAxisWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAxisLabel:{method:"setAxisLabel",parameter:{axisLabel:{name:"axisLabel",index:0,type:"String"}}},setAxisLabelDistance:{method:"setAxisLabelDistance",parameter:{axisLabelDistance:{name:"axisLabelDistance",index:0,type:"PixelVal"}}},setAxisPosition:{method:"setAxisPosition",parameter:{axisPosition:{name:"axisPosition",index:0,type:"brease.enum.HorizontalAlign"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTickLabelDistance:{method:"setTickLabelDistance",parameter:{tickLabelDistance:{name:"tickLabelDistance",index:0,type:"PixelVal"}}},setTickLabelRotation:{method:"setTickLabelRotation",parameter:{tickLabelRotation:{name:"tickLabelRotation",index:0,type:"Rotation"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ChartYValueListWidget/ChartYValueListWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ChartYValueListWidget">CONTENT</div>\r\n'}),define("widgets/brease/ChartYValueListWidget/ChartYValueListWidget",["brease/core/BaseWidget","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var t={interpolationType:"linear",numberOfSamples:-1},i=e.extend(function ChartYValueListWidget(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){this.addInitialClass("breaseChartYValueListWidget"),this.allChartItemsInitializedDeferred=$.Deferred(),this.allChartItemsInitializedDeferred.promise(),this.initializationPromise=$.Deferred(),this.initializationPromise.promise(),e.prototype.init.call(this),this._yValueReadyHandler()},s._isDirty=function(){var e=this;$.when(this.allChartItemsInitializedDeferred).done(function(){e.chartWidget._valueListIsDirty()})},s._registerChartWidget=function(e){void 0===this.chartWidget&&(this.chartWidget=e)},s._registerAxisWidget=function(e){void 0===this.axisWidget&&(this.axisWidget=e)},s._getInitializationPromise=function(){return this.initializationPromise.promise()},s._yValueReadyHandler=function(){this.initializationPromise.resolve()},s._chartItemsReadyHandler=function(){},s._coordinates=function(){},s._clickHandler=function(e){if(this.isDisabled){var t=this.elem.id,i=this.settings.editable&&this.settings.permissions.operate,s=this.createMouseEvent("DisabledClick",{hasPermission:i,origin:t},e);s.dispatch(!1),document.body.dispatchEvent(new CustomEvent(BreaseEvent.DISABLED_CLICK,{detail:{contentId:this.settings.parentContentId,hasPermission:i,origin:t,widgetId:this.elem.id,horizontalPos:s.data.eventArgs.horizontalPos,verticalPos:s.data.eventArgs.verticalPos},bubbles:!0})),this._handleEvent(e)}else{this.createMouseEvent("Click",{origin:this.elem.id},e).dispatch(!1)}},s.setInterpolationType=function(e){this.settings.interpolationType=e},s.getInterpolationType=function(){return this.settings.interpolationType},s.setNumberOfSamples=function(e){var t=this,i;this.settings.numberOfSamples=e,$.when(this.allChartItemsInitializedDeferred).done(function(){t._isDirty();var e;for(e in t.xAxisWidget.cursors)Object.prototype.hasOwnProperty.call(t.xAxisWidget.cursors,e)&&t.xAxisWidget.cursors[e]._getActive()&&(i=e);for(e in t.xAxisWidget.cursors)Object.prototype.hasOwnProperty.call(t.xAxisWidget.cursors,e)&&!t.xAxisWidget.cursors[e]._getActive()&&t.xAxisWidget.cursors[e].setValue(t.xAxisWidget.cursors[e].getValue());i&&t.xAxisWidget.cursors[i].setValue(t.xAxisWidget.cursors[i].getValue()),t.chartWidget.renderer.updateCursor()})},s.getNumberOfSamples=function(){return this.settings.numberOfSamples},s._enableHandler=function(t){!0===t?($("#"+this.elem.id+"_breaseChartYValueList").removeClass("disabled"),$("#"+this.elem.id+"_breaseChartYValueList_line").removeClass("disabled"),$("#"+this.elem.id+"_breaseChartYValueList_area").removeClass("disabled"),$("#"+this.elem.id+"_intersectionPoints").removeClass("disabled")):($("#"+this.elem.id+"_breaseChartYValueList").addClass("disabled"),$("#"+this.elem.id+"_breaseChartYValueList_line").addClass("disabled"),$("#"+this.elem.id+"_breaseChartYValueList_area").addClass("disabled"),$("#"+this.elem.id+"_intersectionPoints").addClass("disabled")),e.prototype._enableHandler.apply(this,arguments)},s._visibleHandler=function(t){e.prototype._visibleHandler.apply(this,arguments),!0===this.settings.visible?($("#"+this.elem.id+"_breaseChartYValueList").removeClass("remove"),$("#"+this.elem.id+"_breaseChartYValueList_line").removeClass("remove"),$("#"+this.elem.id+"_breaseChartYValueList_area").removeClass("remove"),$("#"+this.elem.id+"_intersectionPoints").removeClass("remove")):($("#"+this.elem.id+"_breaseChartYValueList").addClass("remove"),
$("#"+this.elem.id+"_breaseChartYValueList_line").addClass("remove"),$("#"+this.elem.id+"_breaseChartYValueList_area").addClass("remove"),$("#"+this.elem.id+"_intersectionPoints").addClass("remove"))},s.setStyle=function(t){$("#"+this.elem.id+"_breaseChartYValueList").length>0&&($("#"+this.elem.id+"_breaseChartYValueList").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_breaseChartYValueList_line").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_breaseChartYValueList_area").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_intersectionPoints").removeClass(this.settings.stylePrefix+"_style_"+this.settings.style)),e.prototype.setStyle.call(this,t),$("#"+this.elem.id+"_breaseChartYValueList").length>0&&($("#"+this.elem.id+"_breaseChartYValueList").addClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_breaseChartYValueList_line").addClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_breaseChartYValueList_area").addClass(this.settings.stylePrefix+"_style_"+this.settings.style),$("#"+this.elem.id+"_intersectionPoints").addClass(this.settings.stylePrefix+"_style_"+this.settings.style))},s.dispose=function(){e.prototype.dispose.apply(this,arguments)},s._initEditor=function(){var e=this,t={};require(["widgets/brease/ChartYValueListWidget/libs/EditorHandles","widgets/brease/common/libs/EditorGrid"],function(EditorHandles,EditorGrid){e.editorGrid=new EditorGrid(e,t);var i=new EditorHandles(e);e.getHandles=function(){return i.getHandles()},e.designer.getSelectionDecoratables=function(){return i.getSelectionDecoratables()},e.allChartItemsInitializedDeferred.resolve()})},i}),define("widgets/brease/ChartYValueListWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ChartYValueListWidget",parents:["*"],children:[],inheritance:["widgets.brease.ChartYValueListWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setInterpolationType:{method:"setInterpolationType",parameter:{interpolationType:{name:"interpolationType",index:0,type:"brease.enum.ChartInterpolationType"}}},setNumberOfSamples:{method:"setNumberOfSamples",parameter:{numberOfSamples:{name:"numberOfSamples",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/CheckBox/CheckBox.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/CheckBox"></div>\r\n'}),define("widgets/brease/ToggleButton/ToggleButton",["widgets/brease/Button/Button","brease/enum/Enum","brease/core/Utils","brease/core/Types","brease/events/BreaseEvent","widgets/brease/common/libs/wfUtils/UtilsEditableBinding"],function(e,Enum,Utils,Types,BreaseEvent,UtilsEditableBinding){"use strict";var t={value:!1},i=e.extend(function ToggleButton(){e.apply(this,arguments)},t),s=i.prototype;i.values={checked:!0,unchecked:!1},s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseToggleButton"),e.prototype.init.call(this),this.settings.value=Types.parseValue(this.settings.value,"Boolean"),this.settings.value===i.values.checked&&this.toggle(this.settings.value,!0)},s.toggle=function(e,t){var s=!1;if(e=n.call(this,e),e===i.values.checked?(this.settings.value===i.values.unchecked&&(s=!0),this.settings.value=i.values.checked):(this.settings.value===i.values.checked&&(s=!0),this.settings.value=i.values.unchecked),a(this,this.settings.value),!0===s&&!0!==t){this.createEvent("ValueChanged",{newValue:this.getValue(),newValueBool:this.getValueBool(),newValueInteger:this.getValueInteger()}).dispatch(),this.submitChange()}this.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{bubbles:!0,cancelable:!0,detail:{checked:this.isChecked()}}))};function n(e){return void 0===e&&(e=this.settings.value===i.values.unchecked?i.values.checked:i.values.unchecked),e}s.setValueInteger=function(e,t){this.setValue(e,t)},s.setValueBool=function(e,t){this.setValue(e,t)},s.setValue=function(e,t){1===e?e=!0:0===e&&(e=!1),this.toggle(e,void 0!==t&&"server"===t.origin)},s.getValue=function(){return this.settings.value},s.getValueInteger=function(){return this.getValue()?1:0},s.getValueBool=function(){return this.getValue()},s.setImage=function(t,i){!0!==i&&(this.el.hasClass("checked")||this.el.hasClass("active"))&&void 0!==this.settings.mouseDownImage?void 0===t&&""===t||(this.settings.image=t):e.prototype.setImage.call(this,t,i)},s.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},s.isChecked=function(){return this.settings.value===i.values.checked},s.submitChange=function(){this.sendValueChange({value:this.getValue()})},s._onButtonClick=function(e){this.toggle()},s._downHandler=function(e){if(!(this.isDisabled||brease.config.editMode||this.isActive)){this.isActive=!0,this.pointerId=Utils.getPointerId(e),this.elem.classList.add("active"),$(window).on("blur",this._bind("_blurOnMoveHandler")),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_upHandler"));this.createMouseEvent("MouseDown",{},e).dispatch()}},s._resetActiveState=function(){this.isActive=!1,this.elem.classList.remove("active")},s.isToggleButton=function(){return!0};function a(e,t){t?(e.el.addClass("checked"),void 0!==e.settings.mouseDownImage&&""!==e.settings.mouseDownImage&&e.setImage(e.settings.mouseDownImage,!0)):(e.el.removeClass("checked"),void 0!==e.settings.mouseDownImage&&e.setImage(e.settings.image,!0))}return i}),define("widgets/brease/CheckBox/CheckBox",["widgets/brease/ToggleButton/ToggleButton","brease/enum/Enum","brease/events/BreaseEvent","brease/core/Types","widgets/brease/common/libs/wfUtils/UtilsImage"],function(e,Enum,BreaseEvent,Types,UtilsImage){"use strict";var t={boxSize:25,textAlign:"left",imageAlign:"left",checkedBoxImage:"",uncheckedBoxImage:"",disabledCheckedBoxImage:"",disabledUncheckedBoxImage:""},i=e.extend(function CheckBox(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseCheckBox"),r(this),e.prototype.init.call(this),a(this)},s.setBoxSize=function(e){this.settings.boxSize=e,n(this)},s.getBoxSize=function(){return this.settings.boxSize},s.setCheckedBoxImage=function(e){this.settings.checkedBoxImage=e,a(this)},s.getCheckedBoxImage=function(){return this.settings.checkedBoxImage},s.setUncheckedBoxImage=function(e){this.settings.uncheckedBoxImage=e,a(this)},s.getUncheckedBoxImage=function(){return this.settings.uncheckedBoxImage},s.setDisabledCheckedBoxImage=function(e){this.settings.disabledCheckedBoxImage=e,a(this)},s.getDisabledCheckedBoxImage=function(){return this.settings.disabledCheckedBoxImage},s.setDisabledUncheckedBoxImage=function(e){this.settings.disabledUncheckedBoxImage=e,a(this)},s.getDisabledUncheckedBoxImage=function(){return this.settings.disabledUncheckedBoxImage},s.setImage=function(){},s.removeImage=function(){},s.setUseSVGStyling=function(t){e.prototype.setUseSVGStyling.apply(this,arguments),a(this)},s.setImageAlign=function(e){this.settings.imageAlign=e,this.setClasses(),o(this)},s.toggle=function(t,i){e.prototype.toggle.call(this,t,i),a(this)},s._enableHandler=function(){e.prototype._enableHandler.apply(this,arguments),a(this)},s.setClasses=function(){var e;if(void 0===this.imgEl&&void 0===this.radiobutton&&void 0===this.checkbox||void 0===this.textEl||""===this.settings.text)this.el.removeClass("image-left image-right image-top image-bottom");else{switch(this.settings.imageAlign){case Enum.ImageAlign.left:e="image-left";break;case Enum.ImageAlign.right:e="image-right";break;case Enum.ImageAlign.top:e="image-top";break;case Enum.ImageAlign.bottom:e="image-bottom";break}this.el.removeClass("image-left image-right image-top image-bottom"),this.el.addClass(e)}};function n(e){var t=e.settings.boxSize+"px";e.imgEl.height(parseInt(e.settings.boxSize,10)).width(parseInt(e.settings.boxSize,10)).css({"font-size":t,"line-height":t}),e.svgEl.height(parseInt(e.settings.boxSize,10)).width(parseInt(e.settings.boxSize,10)).css({"font-size":t,"line-height":t}),e.checkbox.css({height:t,width:t,"font-size":t,"line-height":t})}function a(e){var t="";switch(void 0!==e.imageDeferred&&"pending"===e.imageDeferred.state()&&e.imageDeferred.reject(),e.isEnabled()<<1|e.getValue()<<0){case 1:e.el.addClass("checked"),t=e.getDisabledCheckedBoxImage();break;case 2:e.el.removeClass("checked"),t=e.getUncheckedBoxImage();break;case 3:e.el.addClass("checked"),t=e.getCheckedBoxImage();break;default:e.el.removeClass("checked"),t=e.getDisabledUncheckedBoxImage()}t="string"==typeof t&&t.length>0?t:void 0,void 0!==t?UtilsImage.isStylable(t)&&!0===e.settings.useSVGStyling?(e.imageDeferred=UtilsImage.getInlineSvg(t),e.imageDeferred.done(function(t){e._setSvgEl(t)})):e._setImgEl(t):e._setCheckBox()}s._setSvgEl=function(e){this.svgEl.replaceWith(e),this.svgEl=e,n(this),this.svgEl.show(),this.imgEl.hide(),this.checkbox.hide()},s._setImgEl=function(e){this.imgEl.attr("src",e),this.svgEl.hide(),this.imgEl.show(),this.checkbox.hide()},s._setCheckBox=function(){this.svgEl.hide(),this.imgEl.hide(),this.checkbox.show()};function r(e){e.imgEl=$("<img/>").hide(),e.svgEl=$("<svg/>").hide(),e.checkbox=$('<div class="checkbox"><div>').hide(),o(e),n(e)}function o(e){void 0!==e.checkbox&&void 0!==e.imgEl&&void 0!==e.svgEl&&(e.settings.imageAlign===Enum.ImageAlign.left||e.settings.imageAlign===Enum.ImageAlign.top?(e.el.prepend(e.checkbox),e.el.prepend(e.imgEl),e.el.prepend(e.svgEl)):(e.el.append(e.checkbox),e.el.append(e.imgEl),e.el.append(e.svgEl)))}return i}),define("widgets/brease/ToggleButton/designer/ClassInfo",["widgets/brease/Button/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ToggleButton",parents:["*"],children:[],inheritance:["widgets.brease.ToggleButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValueBool:{method:"getValueBool"},GetValueInteger:{method:"getValueInteger"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetValueBool:{method:"setValueBool",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetValueInteger:{method:"setValueInteger",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/CheckBox/designer/ClassInfo",["widgets/brease/ToggleButton/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.CheckBox",parents:["*"],children:[],inheritance:["widgets.brease.CheckBox","widgets.brease.ToggleButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValueBool:{method:"getValueBool"},GetValueInteger:{method:"getValueInteger"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBoxSize:{method:"setBoxSize",parameter:{boxSize:{name:"boxSize",index:0,type:"Integer"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setCheckedBoxImage:{method:"setCheckedBoxImage",parameter:{checkedBoxImage:{name:"checkedBoxImage",index:0,type:"String"}}},setDisabledCheckedBoxImage:{method:"setDisabledCheckedBoxImage",parameter:{disabledCheckedBoxImage:{name:"disabledCheckedBoxImage",index:0,type:"String"}}},setDisabledUncheckedBoxImage:{method:"setDisabledUncheckedBoxImage",parameter:{disabledUncheckedBoxImage:{name:"disabledUncheckedBoxImage",index:0,type:"String"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setImage:{method:"setImage"},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUncheckedBoxImage:{method:"setUncheckedBoxImage",parameter:{uncheckedBoxImage:{name:"uncheckedBoxImage",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetValueBool:{method:"setValueBool",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetValueInteger:{method:"setValueInteger",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/common/DragDropHandler/libs/dragDropArgs",[],function(){"use strict";function e(){this.originalEventArgs=null,this.target=null,this.clientX=0,this.clientY=0,this.pageX=0,this.pageY=0,this.screenX=0,this.screenY=0,this.dragItem=null,this.sourceItem=null,this.dragData=null}return e}),define("widgets/brease/common/DragDropHandler/libs/draggable",[],function(){"use strict";function Draggable(){this.id="",this.elem={},this.clone=!1,this.cloneClassList=[],this.data=null}return Draggable}),define("widgets/brease/common/DragDropHandler/libs/droppable",[],function(){"use strict";function e(){this.id="",this.elem={},this.dragEnter=function(){},this.dragLeave=function(){},this.dragMove=function(){},this.drop=function(){}}return e}),define("widgets/brease/common/DragDropHandler/libs/utils",[],function(){"use strict";function Utils(){return{mapProperties:function(e,t){for(var i in e)t.hasOwnProperty(i)&&(t[i]=e[i])},mapMethods:function(e,t){for(var i in e)"function"==typeof t[i]&&(t[i]=e[i])},addClass:function(e,t){e.classList.add(t)},removeClass:function(e,t){e.classList.remove(t)},containsClass:function(e,t){return e.classList.contains(t)}}}return new Utils}),define("widgets/brease/common/DragDropHandler/libs/eventListenerModel",[],function(){"use strict";function e(e,t){this.event=e,this.function=t}return e}),define("widgets/brease/common/DragDropHandler/libs/dragDropBase",["widgets/brease/common/DragDropHandler/libs/draggable","widgets/brease/common/DragDropHandler/libs/droppable","widgets/brease/common/DragDropHandler/libs/utils","widgets/brease/common/DragDropHandler/libs/eventListenerModel","widgets/brease/common/DragDropHandler/libs/dragDropArgs"],function(Draggable,e,Utils,t,i){"use strict";var s="drag-drop-item-clone",n="drag-drop-item-active";function a(e,t,i){for(var s=0;s<e.dragDropAreaEventListeners.length;s+=1)if(e.dragDropAreaEventListeners[s].event===t&&e.dragDropAreaEventListeners[s].function===i)return e.dragDropAreaEventListeners[s];return null}function r(e,t){var dragDropArgs=new i;return dragDropArgs.dragItem=e.dragItem,dragDropArgs.sourceItem=e.sourceItem,dragDropArgs.originalEventArgs=t,dragDropArgs.target=e._getDragDropTarget(e,t),dragDropArgs.clientX=e._getEventClientX(t),dragDropArgs.clientY=e._getEventClientY(t),dragDropArgs.pageX=e._getEventPageX(t),dragDropArgs.pageY=e._getEventPageY(t),dragDropArgs.dragData=e.dragData,dragDropArgs}function o(e){var t=0,i;for(t=0;t<e.dragDropAreaEventListeners.length;t+=1)i=e.dragDropAreaEventListeners[t],e.dragDropArea.removeEventListener(i.event,i.function);e.dragDropArea=null}function l(e,t){var i=r(e,t),s=new CustomEvent("dragstarted",{detail:i});e.dragDropArea.dispatchEvent(s)}function d(e,t){var i=r(e,t),s=new CustomEvent("dragended",{detail:i});e.dragDropArea.dispatchEvent(s)}function c(e,t){var i=r(e,t),droppable=e.getClosestDroppable(i.target);droppable&&"function"==typeof droppable.dragEnter&&droppable.dragEnter(i)}function h(e,t){var i=r(e,t),droppable=e.getClosestDroppable(i.target);droppable&&"function"==typeof droppable.dragMove&&droppable.dragMove(i)}function u(e,t){var i=r(e,t),droppable=e.getClosestDroppable(i.target);droppable&&"function"==typeof droppable.dragLeave&&droppable.dragLeave(i)}function g(e,t){var i=r(e,t),droppable=e.getClosestDroppable(i.target);droppable&&"function"==typeof droppable.drop&&droppable.drop(i)}function m(e,t){if(!e.isDisabled){var i=e._getDragDropTarget(e,t),droppable=e.getClosestDroppable(i);droppable&&(e.canDrop=!0,e.dragEntered=!0,e.dropTarget=droppable.elem,c(e,t))}}function p(e,t){h(e,t)}function f(e,t){var droppable=e.getClosestDroppable(t.target);null!==droppable&&(droppable.elem===e.dropTarget&&(e.canDrop=!1,e.dragEntered=!1,e.dropTarget=null),u(e,t))}function b(e,t){g(e,t)}function v(e,t){if(!e.isDisabled){var draggable=e.getClosestDraggable(t.target);if(e.dragActive=!0,e.sourceItem=t.target,e.dragItem=draggable.elem,!1===e.clickOperationMode){if(draggable.clone){var i=e.dragItem,s=i.cloneNode(!0);e.dragItem=s,e.setDragItemClone(e.dragItem,draggable.cloneClassList)}}else Utils.addClass(e.dragItem,n);l(e,t)}}function y(e,t){e.canDrop&&(e.isDisabled||b(e,t),f(e,t)),e.canDrop=!1,e.dragEntered=!1,e.dropTarget=null,Utils.containsClass(e.dragItem,s)&&document.body.removeChild(e.dragItem),Utils.removeClass(e.dragItem,n),e.dragActive=!1,e.dragEnabled=!1,d(e,t),e.dragItem=null,e.sourceItem=null,e.dragData=null}function w(){this.dragEnabled=!1,this.mouseDownClientX=0,this.mouseDownClientY=0,this.dragItem=null,this.sourceItem=null,this.dragActive=!1,this.dragData=null,this.canDrop=!1,this.dragEntered=!1,this.dropTarget=null,this.isDisabled=!1,this.draggables=[],this.droppables=[],this.dragDropArea=document.body,this.dragDropAreaEventListeners=[],this.clickOperationMode=!1,this.preventMouseDownEvent=!0;var e=window.devicePixelRatio>1?window.devicePixelRatio:1;this.dragDelay=10*e,this._wrapEventHandler(),this._documentAddEventListener()}var x=w.prototype;return x._wrapEventHandler=function(){var e=this;this.documentMouseUpHandler=function(t){e._documentMouseUpHandler(e,t)},this.documentMouseDownHandler=function(t){e._documentMouseDownHandler(e,t)},this.documentMouseMoveHandler=function(t){e._documentMouseMoveHandler(e,t)},this.draggableMouseMoveHandler=function(t){e._draggableMouseMoveHandler(e,t)},this.draggableMouseDownHandler=function(t){e._draggableMouseDownHandler(e,t)},this.draggableMouseLeaveHandler=function(t){e._draggableMouseLeaveHandler(e,t)},this.droppableMouseEnterHandler=function(t){e._droppableMouseEnterHandler(e,t)},this.droppableMouseMoveHandler=function(t){e._droppableMouseMoveHandler(e,t)},this.droppableMouseLeaveHandler=function(t){e._droppableMouseLeaveHandler(e,t)}},x._getEventClientX=function(e){return e.clientX},x._getEventClientY=function(e){return e.clientY},x._getEventPageX=function(e){return e.pageX},x._getEventPageY=function(e){return e.pageY},x._getDragDropTarget=function(e,t){return t.target},x._documentAddEventListener=function(){document.addEventListener("mouseup",this.documentMouseUpHandler),document.addEventListener("mousedown",this.documentMouseDownHandler),document.addEventListener("mousemove",this.documentMouseMoveHandler)},x._draggableAddEventListener=function(draggable){draggable.elem.addEventListener("mousemove",this.draggableMouseMoveHandler),draggable.elem.addEventListener("mousedown",this.draggableMouseDownHandler),draggable.elem.addEventListener("mouseleave",this.draggableMouseLeaveHandler)},x._droppableAddEventListener=function(droppable){droppable.elem.addEventListener("mouseenter",this.droppableMouseEnterHandler),droppable.elem.addEventListener("mousemove",this.droppableMouseMoveHandler),droppable.elem.addEventListener("mouseleave",this.droppableMouseLeaveHandler)},x._documentRemoveEventListener=function(){document.removeEventListener("mouseup",this.documentMouseUpHandler),document.removeEventListener("mousedown",this.documentMouseDownHandler),document.removeEventListener("mousemove",this.documentMouseMoveHandler)},x._draggableRemoveEventListener=function(draggable){draggable.elem.removeEventListener("mousemove",this.draggableMouseMoveHandler),draggable.elem.removeEventListener("mousedown",this.draggableMouseDownHandler),draggable.elem.removeEventListener("mouseleave",this.draggableMouseLeaveHandler)},x._droppableRemoveEventListener=function(droppable){droppable.elem.removeEventListener("mouseenter",this.droppableMouseEnterHandler),droppable.elem.removeEventListener("mousemove",this.droppableMouseMoveHandler),droppable.elem.removeEventListener("mouseleave",this.droppableMouseLeaveHandler)},x._documentMouseUpHandler=function(e,t){e.clickOperationMode||(e.dragActive&&y(e,t),e.dragEnabled=!1)},x._documentMouseMoveHandler=function(e,t){if(e.dragActive&&!e.clickOperationMode){var i=e._getEventClientX(t),s=e._getEventClientY(t);e.dragItem&&(e.dragItem.style.left=i-e.dragItem.offsetWidth/2+"px",e.dragItem.style.top=s-e.dragItem.offsetHeight/2+"px")}},x._documentMouseDownHandler=function(e,t){e.dragActive&&y(e,t)},x._draggableMouseDownHandler=function(e,t){t.target&&(e.mouseDownClientX=e._getEventClientX(t),e.mouseDownClientY=e._getEventClientY(t),e.dragEnabled=!0,e.clickOperationMode&&(e.dragActive?y(e,t):(e.dragActive=!0,v(e,t))))},x._draggableMouseMoveHandler=function(e,t){if(!e.clickOperationMode){var i=e._getEventClientX(t),s=e._getEventClientY(t);e.dragEnabled&&!e.dragActive&&(Math.abs(e.mouseDownClientX-i)>e.dragDelay||Math.abs(e.mouseDownClientY-s)>e.dragDelay)&&v(e,t)}},x._draggableMouseLeaveHandler=function(e,t){!e.dragActive&&e.dragEnabled&&v(e,t)},x._droppableMouseEnterHandler=function(e,t){e.dragActive&&m(e,t)},x._droppableMouseMoveHandler=function(e,t){e.dragActive&&(!1===e.dragEntered&&m(e,t),p(e,t))},x._droppableMouseLeaveHandler=function(e,t){e.dragActive&&f(e,t)},x.getDraggableByElement=function(e){var t=0;for(t=0;t<this.draggables.length;t+=1)if(this.draggables[t].elem===e)return this.draggables[t];return null},x.getClosestDraggable=function(e){for(var t=e;t;){var draggable=this.getDraggableByElement(t);if(draggable)return draggable;t=t.parentNode}return null},x.getDroppableByElement=function(e){var t=0;for(t=0;t<this.droppables.length;t+=1)if(this.droppables[t].elem===e)return this.droppables[t];return null},x.getClosestDroppable=function(e){for(var t=e;t;){var droppable=this.getDroppableByElement(t);if(droppable)return droppable;t=t.parentNode}return null},x.setDragDropArea=function(e){var t,i;for(this.dragDropArea&&o(this),this.dragDropArea=e,i=0;i<this.dragDropAreaEventListeners.length;i+=1)t=this.dragDropAreaEventListeners[i],this.dragDropArea.addEventListener(t.event,t.function)},x.getDragItem=function(){return this.dragItem},x.setDragItemClone=function(e,t,i){if(Utils.addClass(e,s),t)for(var n=0;n<t.length;n+=1)Utils.addClass(e,t[n]);e.style.pointerEvents="none";for(var a in i)i.hasOwnProperty(a)&&(e.style[a]=i[a]);this.dragItem=e,document.body.appendChild(e)},x.setClickOperationMode=function(e){this.clickOperationMode=e},x.getClickOperationMode=function(){return this.clickOperationMode},x.setPreventMouseDownEvent=function(e){this.preventMouseDownEvent=e},x.getPreventMouseDownEvent=function(){return this.preventMouseDownEvent},x.setDragData=function(e){this.dragData=e},x.getDragData=function(){return this.dragData},x.registerDraggable=function(e,t){var draggable=new Draggable;return draggable.id=e.id,draggable.elem=e,Utils.mapProperties(t,draggable),this.draggables.push(draggable),this._draggableAddEventListener(draggable),draggable},x.registerDroppable=function(t,i){var droppable=new e;return droppable.id=t.id,droppable.elem=t,Utils.mapProperties(i,droppable),Utils.mapMethods(i,droppable),this.droppables.push(droppable),this._droppableAddEventListener(droppable),droppable},x.unregisterDraggable=function(e){var draggable=this.getClosestDraggable(e);return!!draggable&&(this._draggableRemoveEventListener(draggable),this.draggables.splice(this.draggables.indexOf(draggable),1),!0)},x.unregisterDroppable=function(e){var droppable=this.getClosestDroppable(e);return!!droppable&&(this._droppableRemoveEventListener(droppable),this.droppables.splice(this.droppables.indexOf(droppable),1),!0)},x.unregisterDraggables=function(){for(var e=0;e<this.draggables.length;e+=1)this.unregisterDraggable(this.draggables[e]);this.draggables=null},x.unregisterDroppables=function(){for(var e=0;e<this.droppables.length;e+=1)this.unregisterDroppable(this.droppables[e]);this.droppables=null},x.getDraggables=function(){return this.draggables},x.getDroppables=function(){return this.droppables},x.addEventListener=function(e,i){null===a(this,e,i)&&(this.dragDropAreaEventListeners.push(new t(e,i)),this.dragDropArea.addEventListener(e,i))},x.removeEventListener=function(e,t){null!==a(this,e,t)&&this.dragDropArea.removeEventListener(e,t)},x.disable=function(){this.isDisabled=!0},x.enable=function(){this.isDisabled=!1},x.dispose=function(){o(this),this.dragDropAreaEventListeners=void 0,this.unregisterDraggables(),this.unregisterDroppables(),this._documentRemoveEventListener()},w}),define("widgets/brease/common/DragDropHandler/libs/dragDropTouch",["widgets/brease/common/DragDropHandler/libs/dragDropBase"],function(e){"use strict";function t(e,t){setTimeout(function(){var i=new Event("mouseenter",t);e.dispatchEvent(i)},0)}function i(e,t){setTimeout(function(){var i=new Event("mouseleave",t);e.dispatchEvent(i)},0)}function s(){e.call(this)}s.prototype=Object.create(e.prototype);var n=s.prototype;return n._wrapEventHandler=function(){e.prototype._wrapEventHandler.call(this);var s=this,n=null;this.documentTouchStartHandler=function(e){s._documentMouseDownHandler(s,e)},this.documentTouchEndHandler=function(e){s._documentMouseUpHandler(s,e),n&&(i(n),n=null)},this.documentTouchMoveHandler=function(e){var a=event.touches[0],r=document.elementFromPoint(a.clientX,a.clientY);if(null===n&&null!==r?(t(r),n=r):n!==r&&null!==r&&(i(n),t(r),n=r),r){var droppable=s.getClosestDroppable(r);s.dragActive&&droppable&&s._droppableMouseMoveHandler(s,e)}s._documentMouseMoveHandler(s,e)},this.draggableTouchMoveHandler=function(e){e.preventDefault(),s._draggableMouseMoveHandler(s,e)},this.draggableTouchStartHandler=function(e){e.preventDefault(),s._draggableMouseDownHandler(s,e)},this.droppableTouchMoveHandler=function(e){e.preventDefault()}},n._documentAddEventListener=function(){e.prototype._documentAddEventListener.call(this),document.addEventListener("touchstart",this.documentTouchStartHandler),document.addEventListener("touchend",this.documentTouchEndHandler),document.addEventListener("touchmove",this.documentTouchMoveHandler)},n._draggableAddEventListener=function(draggable){e.prototype._draggableAddEventListener.call(this,draggable),draggable.elem.addEventListener("touchmove",this.draggableTouchMoveHandler),draggable.elem.addEventListener("touchstart",this.draggableTouchStartHandler)},n._droppableAddEventListener=function(droppable){e.prototype._droppableAddEventListener.call(this,droppable),droppable.elem.addEventListener("touchmove",this.droppableTouchMoveHandler)},n._documentRemoveEventListener=function(){e.prototype._documentRemoveEventListener.call(this),document.removeEventListener("touchstart",this.documentTouchStartHandler),document.removeEventListener("touchend",this.documentTouchEndHandler),document.removeEventListener("touchmove",this.documentTouchMoveHandler)},n._draggableRemoveEventListener=function(draggable){e.prototype._draggableRemoveEventListener.call(this,draggable),draggable.elem.removeEventListener("touchmove",this.draggableTouchMoveHandler),draggable.elem.removeEventListener("touchstart",this.draggableTouchStartHandler)},n._droppableRemoveEventListener=function(droppable){e.prototype._droppableRemoveEventListener.call(this,droppable),droppable.elem.removeEventListener("touchmove",this.droppableTouchMoveHandler)},n._getEventClientX=function(e){return e instanceof TouchEvent?e.changedTouches[0].clientX:e.clientX},n._getEventClientY=function(e){return e instanceof TouchEvent?e.changedTouches[0].clientY:e.clientY},n._getEventPageX=function(e){return e instanceof TouchEvent?e.changedTouches[0].pageX:e.pageX},n._getEventPageY=function(e){
return e instanceof TouchEvent?e.changedTouches[0].pageY:e.pageY},n._getDragDropTarget=function(e,t){var i=t.target;if(t instanceof TouchEvent){var s=t.changedTouches.item(0);i=document.elementFromPoint(s.clientX,s.clientY)}return i},s}),define("widgets/brease/common/DragDropHandler/libs/dragDropPointer",["widgets/brease/common/DragDropHandler/libs/dragDropBase"],function(e){"use strict";function t(){e.call(this)}t.prototype=Object.create(e.prototype);var i=t.prototype;return i._wrapEventHandler=function(){e.prototype._wrapEventHandler.call(this);var t=this;this.documentPointerUpHandler=function(e){t._documentMouseUpHandler(t,e)},this.documentPointerDownHandler=function(e){t._documentMouseDownHandler(t,e)},this.documentPointerMoveHandler=function(e){t._documentMouseMoveHandler(t,e)},this.draggablePointerMoveHandler=function(e){e.target.hasPointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId),t._draggableMouseMoveHandler(t,e)},this.draggablePointerDownHandler=function(e){t._draggableMouseDownHandler(t,e)},this.draggablePointerLeaveHandler=function(e){t._draggableMouseLeaveHandler(t,e)},this.droppablePointerEnterHandler=function(e){t._droppableMouseEnterHandler(t,e)},this.droppablePointerMoveHandler=function(e){t._droppableMouseMoveHandler(t,e)},this.droppablePointerLeaveHandler=function(e){t._droppableMouseLeaveHandler(t,e)}},i._documentAddEventListener=function(){document.addEventListener("pointerup",this.documentPointerUpHandler),document.addEventListener("pointerdown",this.documentPointerDownHandler),document.addEventListener("pointermove",this.documentPointerMoveHandler)},i._draggableAddEventListener=function(draggable){draggable.elem.addEventListener("pointermove",this.draggablePointerMoveHandler),draggable.elem.addEventListener("pointerdown",this.draggablePointerDownHandler),draggable.elem.addEventListener("pointerleave",this.draggablePointerLeaveHandler)},i._droppableAddEventListener=function(droppable){droppable.elem.addEventListener("pointerenter",this.droppablePointerEnterHandler),droppable.elem.addEventListener("pointermove",this.droppablePointerMoveHandler),droppable.elem.addEventListener("pointerleave",this.droppablePointerLeaveHandler)},i._documentRemoveEventListener=function(){document.removeEventListener("pointerup",this.documentPointerUpHandler),document.removeEventListener("pointerdown",this.documentPointerDownHandler),document.removeEventListener("pointermove",this.documentPointerMoveHandler)},i._draggableRemoveEventListener=function(draggable){draggable.elem.removeEventListener("pointermove",this.draggablePointerMoveHandler),draggable.elem.removeEventListener("pointerdown",this.draggablePointerDownHandler),draggable.elem.removeEventListener("pointerleave",this.draggablePointerLeaveHandler)},i._droppableRemoveEventListener=function(droppable){droppable.elem.removeEventListener("pointerenter",this.documentPointerUpHandler),droppable.elem.removeEventListener("pointermove",this.droppablePointerMoveHandler),droppable.elem.removeEventListener("pointerleave",this.droppablePointerLeaveHandler)},t}),define("widgets/brease/common/DragDropHandler/libs/dragDropHandler",["widgets/brease/common/DragDropHandler/libs/dragDropBase","widgets/brease/common/DragDropHandler/libs/dragDropTouch","widgets/brease/common/DragDropHandler/libs/dragDropPointer"],function(e,t,i){"use strict";function s(){return s.supportsPointer()?new i:s.isTouch()?new t:new e}return s.supportsPointer=function(){return!!window.PointerEvent},s.isTouch=function(){return"ontouchstart"in window||navigator.maxTouchPoints},s}),define("widgets/brease/common/DragDropHandler/libs/draggableSettings",[],function(){"use strict";function e(){this.clone=!1,this.cloneClassList=[],this.data=null}return e}),define("widgets/brease/common/DragDropHandler/libs/droppableSettings",[],function(){"use strict";function e(){this.dragEnter=function(){},this.dragLeave=function(){},this.dragMove=function(){},this.drop=function(){}}return e}),define("widgets/brease/common/DragDropProperties/libs/HideDraggablePropertiesEvents",["brease/enum/Enum"],function(Enum){"use strict";return{}}),define("widgets/brease/common/DragDropProperties/libs/HideDroppablePropertiesEvents",["brease/enum/Enum"],function(Enum){"use strict";return{}}),define("widgets/brease/common/libs/BindingSync",["brease/core/Utils","brease/enum/Enum","brease/events/BreaseEvent"],function(Utils,Enum,BreaseEvent){"use strict";var BindingSync={};BindingSync.setupPropertyOrder=function t(i,s){function n(){var t={};s.forEach(function(e,i,s){t[e.name]={name:e.name,waitFor:e.waitFor},e.waitFor.forEach(function(e){t.hasOwnProperty(e)||(t[e]={name:e,waitFor:[]})})});for(var n in t)if(t.hasOwnProperty(n)){var a=t[n],r=Utils.setter(a.name),o=Object.getPrototypeOf(i);!function(t,s){Utils.isFunction(i[t])&&(i[t]=function(){i[t].methodCalled=!0,i[t].dependenciesResolved?o[t].apply(i,arguments):i[t].bufferedCalls.push(arguments),i.dispatchEvent(new CustomEvent("BindingEvent"))},i[t].bufferedCalls=[],i[t].inSync=!1,i[t].waitDone=!1,i[t].methodCalled=!1,i[t].dependenciesResolved=e(i,s),i[t].waitPromise=new Promise(function(n,a){i.elem.addEventListener("BindingEvent",function a(){i[t].waitDone||(i[t].dependenciesResolved=e(i,s),i[t].waitDone=i[t].dependenciesResolved&&i[t].methodCalled,i[t].waitDone&&(n(),i.elem.removeEventListener("BindingEvent",a),i.dispatchEvent(new CustomEvent("BindingEvent"))))})}).then(function(){i[t].bufferedCalls.forEach(function(e){o[t].apply(i,e)}),i[t].inSync=!0}))}(r,a)}}return i.state>=Enum.WidgetState.INITIALIZED?n():new Promise(function(e){i.elem.addEventListener(BreaseEvent.WIDGET_INITIALIZED,function(t){t.target===i.elem&&e()})}).then(n),!0};function e(e,t){return t.waitFor.reduce(function(t,i){var s=void 0!==e.bindings&&e.bindings.hasOwnProperty(i);return t&&(e[Utils.setter(i)].waitDone||!s)},!0)}return BindingSync}),define("widgets/brease/common/libs/BoxLayout",["brease/enum/Enum"],function(Enum){"use strict";var BoxLayout={};BoxLayout.CONTAINER_CLASS="box-container",BoxLayout.BOX_CLASS="box-class",BoxLayout.ORIENTATION_RIGHT="orientation-right",BoxLayout.ORIENTATION_LEFT="orientation-left",BoxLayout.ORIENTATION_TOP="orientation-top",BoxLayout.ORIENTATION_BOTTOM="orientation-bottom",BoxLayout.ALIGNMENT_TOP_LEFT="content-top-left",BoxLayout.ALIGNMENT_TOP="content-top",BoxLayout.ALIGNMENT_TOP_RIGHT="content-top-right",BoxLayout.ALIGNMENT_LEFT="content-left",BoxLayout.ALIGNMENT_CENTER="content-center",BoxLayout.ALIGNMENT_RIGHT="content-right",BoxLayout.ALIGNMENT_BOTTOM_LEFT="content-bottom-left",BoxLayout.ALIGNMENT_BOTTOM="content-bottom",BoxLayout.ALIGNMENT_BOTTOM_RIGHT="content-bottom-right";function e(e,t){if(!(e instanceof Element))return null;if(e.classList.contains(t))return e;for(e=e.parentElement;e&&!e.classList.contains(t);)e=e.parentElement;return e}return BoxLayout.resetContainerClass=function(e){for(var t=0,i;i=e.classList.item(t);){switch(i){case this.ORIENTATION_RIGHT:case this.ORIENTATION_LEFT:case this.ORIENTATION_TOP:case this.ORIENTATION_BOTTOM:e.classList.remove(i);break}t+=1}},BoxLayout.resetBoxClass=function(e){for(var t=0,i;i=e.classList.item(t);){switch(i){case this.ALIGNMENT_TOP_LEFT:case this.ALIGNMENT_TOP:case this.ALIGNMENT_TOP_RIGHT:case this.ALIGNMENT_LEFT:case this.ALIGNMENT_CENTER:case this.ALIGNMENT_RIGHT:case this.ALIGNMENT_BOTTOM_LEFT:case this.ALIGNMENT_BOTTOM:case this.ALIGNMENT_BOTTOM_RIGHT:e.classList.remove(i);break}t+=1}},BoxLayout.createBoxContainer=function(){var e=document.createElement("div");return e.classList.add(this.CONTAINER_CLASS),e},BoxLayout.createBox=function(){var e=document.createElement("div");return e.classList.add(this.BOX_CLASS),e},BoxLayout.setOrientation=function(t,i){var s=e(t,this.CONTAINER_CLASS);if(s)switch(this.resetContainerClass(s),i){case Enum.Orientation.RTL:s.classList.add(this.ORIENTATION_RIGHT);break;case Enum.Orientation.LTR:s.classList.add(this.ORIENTATION_LEFT);break;case Enum.Orientation.TTB:s.classList.add(this.ORIENTATION_TOP);break;case Enum.Orientation.BTT:s.classList.add(this.ORIENTATION_BOTTOM);break}},BoxLayout.setBoxAlign=function(t,i){var s=e(t,this.BOX_CLASS);if(s)switch(this.resetBoxClass(s),i){case"TopLeft":s.classList.add(this.ALIGNMENT_TOP_LEFT);break;case"Top":s.classList.add(this.ALIGNMENT_TOP);break;case"TopRight":s.classList.add(this.ALIGNMENT_TOP_RIGHT);break;case"Left":s.classList.add(this.ALIGNMENT_LEFT);break;case"Center":s.classList.add(this.ALIGNMENT_CENTER);break;case"Right":s.classList.add(this.ALIGNMENT_RIGHT);break;case"BottomLeft":s.classList.add(this.ALIGNMENT_BOTTOM_LEFT);break;case"Bottom":s.classList.add(this.ALIGNMENT_BOTTOM);break;case"BottomRight":s.classList.add(this.ALIGNMENT_BOTTOM_RIGHT);break}},BoxLayout}),define("widgets/brease/common/libs/BreaseTextMetrics",["brease/core/Types"],function(Types){"use strict";var BreaseTextMetrics=function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.defaultFont=this.ctx.font.slice()};return BreaseTextMetrics.prototype.measureText=function(e,t){return this.ctx.font="string"==typeof t&&t.length>0?t:this.defaultFont,this.ctx.measureText(Types.parseValue(e,"String",{default:""}))},new BreaseTextMetrics}),define("widgets/brease/common/libs/ChartUtils",["libs/d3/d3"],function(e){"use strict";var ChartUtils={};function t(e,t){var i=parseInt(e,10);return isNaN(i)?t:i}ChartUtils.rotateTickLabels=function(e,i,s,n){var r=t(n,0),l=t(s,0),d=o(r,180,180,.5,90),c="",h="",u;"top"===i?(c="y",l=-l,u=-90===d?"0.3em":"0em",h="rotate("+d+", 0, "+l+")"):"bottom"===i?(c="y",u=-90===d?"0.3em":"0.7em",h="rotate("+d+", 0, "+l+")"):"right"===i?(c="x",u=-90===d?"0.7em":"0.3em",h="rotate("+d+", "+l+", 0)"):(c="x",u=-90===d?"-0.3em":"0.3em",l=-l,h="rotate("+d+", "+l+", 0)"),e.attr(c,l).attr("dy",u).attr("transform",h).style("text-anchor",a(d,i))},ChartUtils.getNumberOfTickLabel=function(e,i){var s=o(t(i.info.tickLabelRotation,0),180,180,.5,90),n=Math.abs(s*Math.PI/180),r=a(s,i.info.position),l=10,d=e.map(function(e){var t=e.getBBox();return{width:t.width,height:t.height}}),c=Math.max.apply(null,d.map(function(e){return e.width})),h=Math.max.apply(null,d.map(function(e){return e.height})),u=c+10,g;return"middle"===r?g=Math.floor(i.width/u):(u=Math.min((h+5)/Math.sin(n),c*Math.cos(n)),u=Math.max(u,h+5),g=Math.floor(i.width/u)),g},ChartUtils.getTickLabelValues=function(t,i,n){if(i<0)return console.error("ChartUtils.getTickLabelValues: numberOfTickLabel must be >= 0"),void 0;i=i||1;var a=this._getTickLabelStep(t,i,n),r=s(t,a),o;switch(n){case"dateTime":o=e.range(r[0],r[1],a).map(function(e){return new Date(e)});break;case"index":case"secondsAsNumber":o=e.range(r[0],r[1],a);break;default:o=[0,1]}return o},ChartUtils.getMultiLine=function(t,i){var s=t;if(s.length>0&&s[0].length>0&&s[0][0]){var n=s[0][0].innerHTML.split("\n"),a,r;if(n.length>1)if("bottom"===i)for(r=0;r<s[0].length;r+=1){for(e.select(s[0][r]).append("tspan").text($(s[0][r])[0].firstChild.data.split("\n")[0]),a=1;a<n.length;a+=1)e.select(s[0][r]).append("tspan").text($(s[0][r])[0].firstChild.data.split("\n")[a]).attr("position","relative").attr("x","0").attr("dy","1em");$(s[0][r])[0].firstChild.data=""}else if("top"===i)for(r=0;r<s[0].length;r+=1){for(e.select(s[0][r]).append("tspan").text($(s[0][r])[0].firstChild.data.split("\n")[n.length-1]),a=n.length-2;a>-1;a-=1)e.select(s[0][r]).append("tspan").text($(s[0][r])[0].firstChild.data.split("\n")[a]).attr("position","relative").attr("x","0").attr("dy","-1em");$(s[0][r])[0].firstChild.data=""}}return s},ChartUtils._binarySearchSuccessor=function(e,t){if(!e.length)return-1;if(e[e.length-1]<t)return e.length-1;for(var i=0,s=e.length-1,n;i!==s;){if(n=i+s>>>1,e[n]===t)return n;e[n]<t?i=n+1:s=n}return 0===i&&e[i]<t?-1:i},ChartUtils._getTickLabelStep=function(e,t,s){switch(s){case"dateTime":return n.call(this,e,t);case"index":case"secondsAsNumber":return i(e,t);default:return 1}};function i(e,t){for(var i=Math.abs(e[1]-e[0]),s=t-1,n=[2,5,10],a,r=5,o,l,d=-1,c,h=0;h<n.length;h+=1)l=Math.pow(n[h],Math.floor(Math.log(i/s)/Math.log(n[h]))),c=Math.ceil(i/(s*l)),a=Math.floor(i/(c*l)),d<a&&a<=s&&c<=5&&(d=a,o=c*l);return o}function s(e,t){return[Math.ceil(e[0]/t)*t,Math.floor(e[1]/t)*t+.5*t]}ChartUtils._stepBases=[1,2,4,5,10,20,50,100,200,400,500,1e3,2e3,4e3,5e3,6e3,1e4,12e3,15e3,2e4,3e4,45e3,6e4,12e4,24e4,3e5,36e4,6e5,72e4,9e5,12e5,18e5,27e5,36e5,72e5,108e5,144e5,216e5,288e5,432e5,864e5,1728e5,3456e5,6048e5,12096e5,2592e6,5184e6,7776e6,31536e6,63072e6,126144e6,15768e7,31536e7,63072e7,15768e8,31536e8,63072e8,126144e8,15768e9,31536e9,63072e9,15768e10,31536e10];function n(e,t){var i=Math.abs(e[1]-e[0]),s=i/t,n=this._binarySearchSuccessor(this._stepBases,s);return-1===n?1:this._stepBases[n]}function a(e,t){switch(t){case"top":case"bottom":return r(e,t);case"right":return-90===e?"middle":"start";case"left":return-90===e?"middle":"end";default:return"middle"}}function r(e,t){return 0===e?"middle":(e+180)%180<90?"top"===t?"end":"start":"top"===t?"start":"end"}function o(e,t,i,s,n){return Math.round(t*(e/i-s-Math.floor(e/i-s))-n)}return ChartUtils}),define("widgets/brease/common/libs/ChildHandling",["brease/enum/Enum","brease/events/BreaseEvent"],function(Enum,BreaseEvent){"use strict";var ChildHandling={};return ChildHandling.setChildClasses=function e(t,i){if(t.length>0)for(var s=0;s<t.length;s+=1)$("#"+t[s]).addClass(i)},ChildHandling.removeChildClasses=function e(t,i){if(t.length>0)for(var s=0;s<t.length;s+=1)$("#"+t[s]).removeClass(i)},ChildHandling.getChildren=function e(t){var i=t.find("[data-brease-widget]"),s={id:[]};if(void 0!==i&&i.length>0){i=i.first().parent().children("[data-brease-widget]");for(var n=0;n<i.length;n+=1)s.id.push(i[n].id)}return s},ChildHandling.setSameParameterForAllChilds=function e(t,i,s){t.forEach(function(e){brease.callWidget(e,i,s)})},ChildHandling.setParameterForChild=function e(t,i,s){brease.callWidget(t,i,s)},ChildHandling.childrenInitDone=function(e,t){var i=[];0!==e.length&&(e.forEach(function(e){var t=$("#"+e)[0],s=$.Deferred();i.push(s),brease.uiController.getWidgetState(e)>=Enum.WidgetState.INITIALIZED&&brease.uiController.getWidgetState(e)!==Enum.WidgetState.SUSPENDED?s.resolve():t.addEventListener(BreaseEvent.WIDGET_INITIALIZED,function(){s.resolve()})}),$.when.apply($,i).done(function(){t()}))},ChildHandling}),define("widgets/brease/common/libs/DataAdapter",["brease/core/Class","libs/d3/d3","brease/core/Utils"],function(e,t){"use strict";var i=e.extend(function DataAdapter(t){e.call(this),this.widget=t,this.settings={chartMargin:{marginTop:15,marginRight:15,marginBottom:15,marginLeft:15},cursorAreaWidth:20},this.init()},null),s=i.prototype;s.init=function(){this.xAxisAreas=[],this.yAxisAreas=[],this.xAxisCursorAreas=[],this.chartArea={},this.yScales=[],this.xScales=[],this.xAxisCursors=[],this.graphs=[];for(var e in this.widget.chartItems.yValues)this.graphs.push({id:e,coordinates:[]});this.graphIntersectionPoints=[];for(var t=0;t<this.graphs.length;t+=1)this.graphIntersectionPoints[t]={graphId:this.graphs[t].id,xCursors:[]};d(this)},s.dispose=function(){},s.updateScales=function(){u(this)},s.updateGraphData=function(){g(this)},s.updateCursor=function(){m(this)},s.updateZoomLevelLimits=function(){f(this)},s.getXAxisAreas=function(){return this.xAxisAreas},s.getYAxisAreas=function(){return this.yAxisAreas},s.getXAxisCursorAreas=function(){return this.xAxisCursorAreas},s.getChartArea=function(){return this.chartArea},s.getGraphs=function(){return this.graphs},s.getGraphIntersectionPoints=function(){return this.graphIntersectionPoints},s.getYAxesMinimum=function(){var e=this.getYAxisAreas(),t=null;if(!this.widget||this.widget.chartItems.length<1||this.widget.chartItems.yAxis.length<0)return t;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=this.widget.chartItems.yAxis[i].minimum();(null===t||s<t)&&(t=s)}return t},s.getYAxesMaximum=function(){var e=this.getYAxisAreas(),t=null;if(!this.widget||this.widget.chartItems.length<1||this.widget.chartItems.yAxis.length<0)return t;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=this.widget.chartItems.yAxis[i].maximum();(null===t||s>t)&&(t=s)}return t};function n(e,t,i,s){var n=parseFloat(i.getTickLabelDistance()),a=parseFloat(i.getTickLabelRotation())%360;return{id:t,y:e.settings.chartMargin.marginTop,width:s,info:{coordinate:"y",position:e.widget.chartItems.yAxis[t].getAxisPosition(),axisLabelDistance:parseInt(i.getAxisLabelDistance(),10),tickLabelDistance:n||0,tickLabelRotation:a||0,minZoomLevel:e.widget.getMinZoomLevel()/100,maxZoomLevel:e.widget.getMaxZoomLevel()/100,format:i.currentFormat(),type:"number"}}}function a(e,t,i,s,n,a){var r=parseFloat(i.getTickLabelDistance()),o=parseFloat(i.getTickLabelRotation())%360;return{id:t,x:n,width:a-n,height:s,info:{coordinate:"x",position:i.getAxisPosition(),axisLabelDistance:parseInt(i.getAxisLabelDistance(),10),tickLabelDistance:r||0,tickLabelRotation:o||0,minZoomLevel:e.widget.getMinZoomLevel()/100,maxZoomLevel:e.widget.getMaxZoomLevel()/100}}}function r(e,t,i){return{id:i,xCursor:t._getValue(),yValues:[],yValueAxes:[],markerVisible:[],active:!1,x:-e.settings.cursorAreaWidth/2+e.xAxisAreas[t.axisWidget.elem.id].scale(t._getValue()),y:0,width:e.settings.cursorAreaWidth,height:e.chartArea.height,maxAvailableXPositionIndex:t._getMaxDrawnXSampleIndex(t._getMaxNumberOfSamples())}}function o(e){var t=0,i=e.widget.settings.chartMargin.match(/-?\d+(\.\d+)?px/g);for(var s in e.settings.chartMargin)e.settings.chartMargin[s]=parseFloat(i[t],10),t=i[t+1]?t+1:0}function l(e,i,s){switch(e){case"dateTime":i.xScales[s]=t.time.scale();break;case"index":case"secondsAsNumber":i.xScales[s]=t.scale.linear();break}i.xAxisAreas[s].scale=i.xScales[s]}function d(e){var i,s,d=0,u=e.widget.settings.width,g=0,m=e.widget.settings.height,p=0,f=0,b,v,y,w,x,E;o(e),y=parseInt(e.widget.el.css("border-top-width"),10),w=parseInt(e.widget.el.css("border-bottom-width"),10),x=parseInt(e.widget.el.css("border-left-width"),10),E=parseInt(e.widget.el.css("border-right-width"),10),d+=e.settings.chartMargin.marginLeft,u-=e.settings.chartMargin.marginRight+x+E,g+=e.settings.chartMargin.marginTop,m-=e.settings.chartMargin.marginBottom;for(i in e.widget.chartItems.yAxis)v=e.widget.chartItems.yAxis[i],f=parseInt(e.widget.chartItems.yAxis[i].settings.width,10),e.yAxisAreas[i]=n(e,i,v,f),u-="right"===e.yAxisAreas[i].info.position?f:0,e.yAxisAreas[i].x="left"===e.yAxisAreas[i].info.position?d:u,d+="left"===e.yAxisAreas[i].info.position?f:0,e.yScales[i]=t.scale.linear(),e.yAxisAreas[i].scale=e.yScales[i];for(i in e.widget.chartItems.xAxis)b=e.widget.chartItems.xAxis[i],p=parseInt(b.settings.height,10),e.xAxisAreas[i]=a(e,i,b,p,d,u),m-="bottom"===e.xAxisAreas[i].info.position?p:0,e.xAxisAreas[i].y="bottom"===e.xAxisAreas[i].info.position?m-w-y:g,g+="top"===e.xAxisAreas[i].info.position?p:0,l(b._getAxisType(),e,i);for(i in e.widget.chartItems.yAxis)e.yAxisAreas[i].y=g,e.yAxisAreas[i].height=m-g-y-w;e.chartArea={x:d,y:g,width:u-d,height:m-g-y-w};for(s in e.widget.chartItems.xCursors){var I=e.widget.chartItems.xCursors[s];e.xAxisCursorAreas[s]=r(e,I,s),c(e,I,s)}h(e),e._createGraphIntersectionPoints()}function c(e,t,i){for(var s in t.graphWidgets){var n=t.graphWidgets[s],a,r;r=n.getNumberOfSamples()<0?n.getValue().length:n.getNumberOfSamples(),a=t.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[i].xCursor)<=r-1,e.xAxisCursorAreas[i].yValues[s]=n.getCursorValue(),e.xAxisCursorAreas[i].yValueAxes[s]=n.axisWidget.elem.id,e.xAxisCursorAreas[i].markerVisible[s]=n.isVisible()&&t.isVisible()&&a}}function h(e){for(var t=0;t<e.graphs.length;t+=1){var i=e.graphs[t].id,s=e.widget.chartItems.yValues[i],n=s.xAxisWidget.cursors,a=e.graphs[t].intersectionPoints={};for(var r in n){var o=e.widget.chartItems.xCursors[r],l=s.getNumberOfSamples()<0?s.getValue().length:s.getNumberOfSamples(),d=o.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[r].xCursor)<=l-1;a[r]={xValue:o._getValue(),yValues:s._getYValueFromXCoordinate(o._getValue()),yValueAxes:s.axisWidget.elem.id,markerSize:parseInt(s.getIntersectionPointSize(),10),markerEnable:o.isEnabled(),markerActive:o._getActive(),markerVisible:s.isVisible()&&s.isVisible()&&o.isVisible()&&d}}}}s._createGraphIntersectionPoints=function(){var e=this;this.getGraphIntersectionPoints().forEach(function(t){var i=t.graphId,s=e.widget.chartItems.yValues[i],n=s.xAxisWidget.cursors;for(var a in n){var r=e.widget.chartItems.xCursors[a],o=s.getNumberOfSamples()<0?s.getValue().length:s.getNumberOfSamples(),l=r.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[a].xCursor)<=o-1;t.xCursors[a]={xValue:r._getValue(),yValues:s._getYValueFromXCoordinate(r._getValue()),yValueAxes:s.axisWidget.elem.id,markerSize:parseInt(s.getIntersectionPointSize(),10),markerEnable:r.isEnabled(),markerActive:r._getActive(),markerVisible:s.isVisible()&&s.isVisible()&&r.isVisible()&&l}}})},s._updateGraphIntersectionPoints=function(){var e=this;this.getGraphIntersectionPoints().forEach(function(t){var i=t.graphId,s=e.widget.chartItems.yValues[i],n=s.xAxisWidget.cursors;for(var a in n){var r=e.widget.chartItems.xCursors[a],o=s.getNumberOfSamples()<0?s.getValue().length:s.getNumberOfSamples(),l=r.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[a].xCursor)<=o-1;t.xCursors[a]={xValue:r._getValue(),yValues:s._getYValueFromXCoordinate(r._getValue()),yValueAxes:s.axisWidget.elem.id,markerSize:parseInt(s.getIntersectionPointSize(),10),markerEnable:r.isEnabled(),markerActive:r._getActive(),markerVisible:s.isVisible()&&s.isVisible()&&r.isVisible()&&l}}})};function u(e){var i,s,n,a,r;for(i in e.yAxisAreas)a=e.widget.chartItems.yAxis[i].minimum(),r=e.widget.chartItems.yAxis[i].maximum(),a===r&&(0!==a?(a*=.9,r*=1.1):(a=-1,r=1)),e.yScales[i]=t.scale.linear().domain([a,r]).range([e.yAxisAreas[i].height,0]),e.yAxisAreas[i].scale=e.yScales[i],e.yAxisAreas[i].info.format=e.widget.chartItems.yAxis[i].currentFormat();for(i in e.xAxisAreas){var o=e.widget.chartItems.xAxis[i];switch(s=o._getMinValue(),n=o._getMaxValue(),o._getAxisType()){case"dateTime":e.xScales[i]=t.time.scale(),e.xAxisAreas[i].info.type=o._getAxisType();break;case"index":case"secondsAsNumber":e.xScales[i]=t.scale.linear(),e.xAxisAreas[i].info.type=o._getAxisType();break}e.xAxisAreas[i].info.format=e.widget.chartItems.xAxis[i].currentFormat(),e.xScales[i].domain([s,n]).range([0,e.xAxisAreas[i].width]),e.xAxisAreas[i].scale=e.xScales[i]}g(e),m(e)}function g(e){for(var t,i,s,n=0;n<e.graphs.length;n+=1)t=e.widget.chartItems.yValues[e.graphs[n].id],i=t.axisWidget.elem.id,s=t.xAxisWidget.elem.id,e.graphs[n].yScale=e.yScales[i],e.graphs[n].xScale=e.xScales[s],e.graphs[n].coordinates=t._coordinates(),e.graphs[n].interpolationType=t.getInterpolationType(),e.graphs[n].isHidden=t.isHidden}function m(e){for(var t in e.widget.chartItems.xCursors){var i=e.widget.chartItems.xCursors[t];e.xAxisCursorAreas[t].xCursor=i._getValue(),e.xAxisCursorAreas[t].active=i._getActive(),e.xAxisCursorAreas[t].x=-e.settings.cursorAreaWidth/2+e.xAxisAreas[i.axisWidget.elem.id].scale(i._getValue()),e.xAxisCursorAreas[t].y=0,e.xAxisCursorAreas[t].width=e.settings.cursorAreaWidth;for(var s in i.graphWidgets){var n=i.graphWidgets[s],a,r;r=n.getNumberOfSamples()<0?n.getValue().length:n.getNumberOfSamples(),a=i.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[t].xCursor)<=r-1,e.xAxisCursorAreas[t].markerVisible[s]=n.isVisible()&&i.isVisible()&&a,e.xAxisCursorAreas[t].markerVisible[s]&&(e.xAxisCursorAreas[t].yValues[s]=n._getIntersectionValue(i._getValue(),i._getActive(),!0)),e.xAxisCursorAreas[t].yValueAxes[s]=n.axisWidget.elem.id}e.xAxisCursorAreas[t].maxAvailableXPositionIndex=i._getMaxDrawnXSampleIndex(i._getMaxNumberOfSamples())}p(e),e._updateGraphIntersectionPoints()}function p(e){for(var t=0;t<e.graphs.length;t+=1){var i=e.graphs[t].id,s=e.widget.chartItems.yValues[i],n=s.xAxisWidget.cursors,a=e.graphs[t].intersectionPoints;for(var r in n){var o=e.widget.chartItems.xCursors[r],l=s.getNumberOfSamples()<0?s.getValue().length:s.getNumberOfSamples(),d=o.axisWidget._xPositions().map(function(e){return+e}).indexOf(+e.xAxisCursorAreas[r].xCursor)<=l-1;a[r]={xValue:o._getValue(),yValues:s._getYValueFromXCoordinate(o._getValue()),yValueAxes:s.axisWidget.elem.id,markerEnable:o.isEnabled(),markerActive:o._getActive(),markerVisible:s.isVisible()&&s.isVisible()&&o.isVisible()&&d}}}}function f(e){var t;for(t in e.widget.chartItems.yAxis)e.yAxisAreas[t].info.minZoomLevel=e.widget.getMinZoomLevel()/100,e.yAxisAreas[t].info.maxZoomLevel=e.widget.getMaxZoomLevel()/100;for(t in e.widget.chartItems.xAxis)e.xAxisAreas[t].info.minZoomLevel=e.widget.getMinZoomLevel()/100,e.xAxisAreas[t].info.maxZoomLevel=e.widget.getMaxZoomLevel()/100}return i}),define("widgets/brease/common/libs/EditorGrid",["brease/core/Class","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/common/libs/ChartUtils","libs/d3/d3","globalize"],function(e,Utils,BreaseEvent,ChartUtils,t){"use strict";var i=e.extend(function EditorGrid(t,i){if(e.call(this),this.widget=t,!i.mainContainer){var s=Utils.parentWidgetElem(t.elem);s&&(this.parentWidget=brease.callWidget(s.id,"widget")),this.areas=this.parentWidget&&this.parentWidget.editorGrid?this.parentWidget.editorGrid.areas:null}this.children={},this.configuration=i,this.init()},{}),s=i.prototype;s.init=function(){this.widget.el.on(BreaseEvent.WIDGET_ADDED,this._bind("childrenAdded")),this.widget.el.on(BreaseEvent.WIDGET_REMOVED,this._bind("childrenRemoved"))},s.dispose=function(){this.widget&&this.widget.el&&(this.widget.el.off(BreaseEvent.WIDGET_ADDED,this._bind("childrenAdded")),this.widget.el.off(BreaseEvent.WIDGET_REMOVED,this._bind("childrenRemoved"))),this.widget=void 0,this.children=void 0},s.childrenAdded=function(e){if(e.target===this.widget.elem){var t=e.detail.widgetId,i=brease.callWidget(t,"widget");this.children.hasOwnProperty(t)||(this.children[t]=i)}},s.childrenRemoved=function(e){if(e.target===this.widget.elem){var t=e.detail.widgetId;this.children.hasOwnProperty(t)&&delete this.children[t]}},s.createLayout=function(){var e=this;switch(this.areas={left:$("<div class='container areaLeft'></div>"),right:$("<div class='container areaRight'></div>"),graph:$("<div class='container areaGraph'></div>")},e.configuration.layout){case"2Areas":e.leftAreaSize=0,e.widget.el.append(this.areas.left),this.areas.right.append(this.areas.graph),e.widget.el.append(this.areas.right);break;case"5Areas":this.areas.center=$("<div class='container areaCenter'></div>"),this.areas.top=$("<div class='container areaTop'></div>"),this.areas.bottom=$("<div class='container areaBottom'></div>"),e.leftAreaSize=0,e.rightAreaSize=0,e.topAreaHeight=0,e.bottomAreaHeight=0,e.actualOrder=0,this.areas.top.css({"flex-basis":""+e.topAreaHeight,overflow:"visible"}),this.areas.bottom.css({"flex-basis":""+e.bottomAreaHeight,overflow:"visible"}),this.areas.center.css({overflow:"visible"}),this.areas.left.css({overflow:"visible"}),this.areas.right.css({overflow:"visible"}),e.widget.el.append(this.areas.left),this.areas.center.append(this.areas.top),this.areas.center.append(this.areas.graph),this.areas.center.append(this.areas.bottom),e.widget.el.append(this.areas.center),e.widget.el.append(this.areas.right);break}},s.createAxis=function(){var e=this,i={},s={info:{}},a,r,l;if(i=n(e),e.scaleContainer=t.select(e.widget.el.get(0)).append("svg").attr("style","z-index:-1").attr("class","container scaleContainer"),e.scale="time"===e.widget.editorGrid.configuration.scaleType?t.time.scale():t.scale.linear(),e.scale.domain(i.domain).range(i.range),e.axis=t.svg.axis().scale(e.scale).orient(i.orient),e.widget.editorGrid.configuration.tickFormat&&e.axis.tickFormat(function(t){return o(e.widget.editorGrid.configuration.tickFormat,t,e.widget.editorGrid.configuration.scaleType)}),e.axisElement=e.scaleContainer.append("g").attr("class","axis").attr("id",i.id).call(e.axis),e.configuration.tickLabelRotation){var d=e.axisElement.selectAll(".tick>text");ChartUtils.rotateTickLabels(d,e.configuration.axisPosition,e.configuration.tickLabelDistance,e.configuration.tickLabelRotation)}if(/ChartXAxis/.test(e.widget.elem.className)){s.info.tickLabelRotation=e.configuration.tickLabelRotation,s.info.position=e.configuration.axisPosition,s.info.type="time"===e.configuration.scaleType?"dateTime":"index",s.width=document.querySelector('g.axis[id*="'+e.widget.elem.id+'"] .domain').getBBox().width;var c=document.getElementById(e.widget.elem.id+"_XAxis");c&&(a=Array.prototype.slice.call(c.querySelectorAll(".tick text")),r=Math.min(ChartUtils.getNumberOfTickLabel(a,s),10),l=ChartUtils.getTickLabelValues(i.domain,r,s.info.type),e.axis.tickValues(l)),e.axisElement.call(e.axis)}e.scaleContainer.append("g").attr("transform","translate("+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?i.axisLabelDistance:e.areas.graph.width()/2)+", "+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?e.areas.graph.height()/2:i.axisLabelDistance)+") rotate("+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?-90:0)+")").attr("id",i.id+"_axisLabel").attr("class","containerAxisDescription").append("text").attr("class","axisDescription").style("text-anchor","middle").text(i.axisLabel)},s.updateAxis=function(){var e=this,t={},i={info:{}},s,a,r,l;t=n(e),e.scale.domain(t.domain),e.scale.range(t.range),e.axis.orient(t.orient),t.tickFormat&&e.axis.tickFormat(function(t){return o(e.widget.editorGrid.configuration.tickFormat,t,e.widget.editorGrid.configuration.scaleType)}),e.axisElement.call(e.axis),e.axisElement.attr("transform","translate("+t.offsetX+","+t.offsetY+")").call(e.axis),e.configuration.tickLabelRotation&&(l=e.axisElement.selectAll(".tick>text"),l=ChartUtils.getMultiLine(l,e.configuration.axisPosition),ChartUtils.rotateTickLabels(l,e.configuration.axisPosition,e.configuration.tickLabelDistance,e.configuration.tickLabelRotation)),/ChartXAxis/.test(e.widget.elem.className)&&(i.info.tickLabelRotation=e.configuration.tickLabelRotation,i.info.position=e.configuration.axisPosition,i.info.type="time"===e.configuration.scaleType?"dateTime":"index",i.width=document.querySelector('g.axis[id*="'+e.widget.elem.id+'"] .domain').getBBox().width,s=Array.prototype.slice.call(document.getElementById(e.widget.elem.id+"_XAxis").querySelectorAll(".tick text")),a=Math.min(ChartUtils.getNumberOfTickLabel(s,i),10),r=ChartUtils.getTickLabelValues(t.domain,a,i.info.type),e.axis.tickValues(r),e.axisElement.call(e.axis)),e.configuration.tickLabelRotation&&(l=e.axisElement.selectAll(".tick>text"),l=ChartUtils.getMultiLine(l,e.configuration.axisPosition),ChartUtils.rotateTickLabels(l,e.configuration.axisPosition,e.configuration.tickLabelDistance,e.configuration.tickLabelRotation)),e.scaleContainer.select(".containerAxisDescription").attr("transform","translate("+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?t.axisLabelDistance:e.areas.graph.width()/2)+", "+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?e.areas.graph.height()/2:t.axisLabelDistance)+") rotate("+(e.widget.elem.className.match(/breaseChartYAxisWidget/)?-90:0)+")"),e.scaleContainer.select(".axisDescription").attr("dy","left"===e.configuration.axisPosition||"top"===e.configuration.axisPosition?"-0.03em":"0.75em").text(t.axisLabel)},s.updateAllChildren=function(){};function n(e){var t={};switch(e.configuration.axisType){case"Vertical":t=a(e);break;case"Horizontal":t=r(e);break;default:t=void 0}return t}function a(e){var t={};return t.domain="TopToBottom"===e.widget.settings.orientation?[0,100]:[100,0],t.range="5Areas"===e.parentWidget.editorGrid.configuration.layout?[20,e.areas.graph.height()-20]:[20,e.widget.el.height()-20],t.orient="right"===e.configuration.axisPosition?"right":"left",t.offsetX=e.configuration.offsetX||("right"===e.configuration.axisPosition?0:e.widget.settings.width-10),
t.offsetY=e.configuration.offsetY||0,t.axisLabel=e.configuration.axisLabel||null,t.axisLabelDistance=e.configuration.offsetX+1+("left"===e.configuration.axisPosition?-1:1)*e.configuration.axisLabelDistance||0,t.id=e.widget.elem.id+"_YAxis",t}function r(e){var i={};return i.domain="RightToLeft"===e.widget.settings.orientation?e.widget.editorGrid.configuration.axisDomain?e.widget.editorGrid.configuration.axisDomain:[100,0]:e.widget.editorGrid.configuration.axisDomain?e.widget.editorGrid.configuration.axisDomain:[0,100],i.format&&(i.format=e.widget.editorGrid.configuration.tickFormat&&"time"===e.widget.editorGrid.configuration.scaleType?t.time.format(e.widget.editorGrid.configuration.tickFormat):t.format("d")),i.range="5Areas"===e.parentWidget.editorGrid.configuration.layout?[20,e.areas.graph.width()-20]:[20,e.widget.el.width()-20],i.orient="top"===e.configuration.axisPosition?"top":"bottom",i.offsetX=e.configuration.offsetX||0,i.offsetY=e.configuration.offsetY||("top"===e.configuration.axisPosition?e.widget.settings.height-10:0),i.axisLabel=e.configuration.axisLabel||null,i.axisLabelDistance=e.configuration.offsetY+1+("top"===e.configuration.axisPosition?-1:1)*e.configuration.axisLabelDistance||0,i.id=e.widget.elem.id+"_XAxis",i}function o(e,i,s){switch(s){case"time":return Globalize.format(i,e);case"number":var n=0===e.decimalPlaces?e.minimumIntegerDigits:e.minimumIntegerDigits+e.decimalPlaces+1;return t.format("0"+(i<0?n+1:n)+"."+e.decimalPlaces+"f")(i);default:return t.format("d")}}return i}),define("widgets/brease/common/libs/EditorHandlesSquare",["brease/core/Class","brease/core/Utils"],function(e,Utils){"use strict";var t=e.extend(function EditorHandlesSquare(t){e.call(this),this.widget=t,this.initialPosition={}},null),i=t.prototype,s=["width","height","top","left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width"],n=["min-width","max-width","min-height","max-height"];i.getHandles=function(){var e=this;return{pointHandles:[],resizeHandles:[{start:function(){var t={},i=e.widget.el,a=i.parent(),r=window.getComputedStyle(i.get(0));s.forEach(function(e){t[e]=parseInt(r.getPropertyValue(e),10)||0}),n.forEach(function(e){var i=r.getPropertyValue(e);t[e]=parseInt(i,10),i.includes("%")&&(t[e]=(e.includes("width")?a.width():a.height())/100*t[e])}),t["max-height"]=isNaN(t["max-height"])?Number.POSITIVE_INFINITY:t["max-height"],t["max-width"]=isNaN(t["max-width"])?Number.POSITIVE_INFINITY:t["max-width"],t["min-width"]=Math.max(t["min-width"],t["border-left-width"]+t["border-right-width"]+t["padding-left"]+t["padding-right"]),t["min-height"]=Math.max(t["min-height"],t["border-top-width"]+t["border-bottom-width"]+t["padding-top"]+t["padding-bottom"]),t["max-width"]=Math.max(t["max-width"],t["min-width"]),t["max-height"]=Math.max(t["max-height"],t["min-height"]),t["min-size"]=Math.max(t["min-width"],t["min-height"]),t["max-size"]=Math.min(t["max-width"],t["max-height"]),e.initialPosition=t},update:function(t,i){i="string"==typeof i?i:"",t.width=Math.min(Math.max(t.width,e.initialPosition["min-size"]),e.initialPosition["max-size"]),t.height=Math.min(Math.max(t.height,e.initialPosition["min-size"]),e.initialPosition["max-size"]);var s={size:t.width,top:t.top,left:t.left},n=e.initialPosition;switch(i){case"n":case"s":s.size=t.height,s.top=t.top,s.left=t.left-(s.size-n.width)/2;break;case"w":case"e":s.size=t.width,s.top=t.top-(s.size-n.height)/2,s.left=t.left;break;case"se":s.size=Math.max(t.width,t.height),s.top=t.top,s.left=t.left;break;case"sw":s.size=Math.max(t.width,t.height),s.top=t.top,s.left=t.left-(s.size-n.width)/2;break;case"ne":s.size=Math.max(t.width,t.height),s.top=t.top-(s.size-n.height)/2,s.left=t.left;break;case"nw":s.size=Math.max(t.width,t.height),s.top=t.top-(s.size-n.height)/2,s.left=t.left-(s.size-n.width)/2;break;default:console.iatWarn("Direction "+i+" not valid")}i.includes("e")&&(s.size=Math.max(s.size,n["min-width"])),i.includes("s")&&(s.size=Math.max(s.size,n["min-height"])),i.includes("w")&&(s.size=Math.max(n["min-width"],Math.min(n["max-width"],s.size)),s.left=Math.max(n.left+n.width-s.size,Math.min(n.left+n.width-n["max-width"],s.left))),i.includes("n")&&(s.height=Math.max(n["min-height"],Math.min(n["max-height"],s.size)),s.top=Math.max(n.top+n.height-s.height,Math.min(n.top+n.height-n["max-height"],s.top))),e.widget.settings.top=s.top,e.widget.settings.left=s.left,e.widget.settings.width=s.size,e.widget.settings.height=s.size,Utils.isFunction(e.onResizeHandler)&&e.onResizeHandler(e.widget),a(e)},finish:function(){return{top:e.widget.settings.top,left:e.widget.settings.left,height:e.widget.settings.height,width:e.widget.settings.width}},handle:function(){return e.widget.elem}}]}},i.getSelectionDecoratables=function(){return[this.widget.elem]},i.onResize=function(e){this.onResizeHandler=e};function a(e){e.widget.el.css("top",parseInt(e.widget.settings.top,10)),e.widget.el.css("left",parseInt(e.widget.settings.left,10)),e.widget.el.css("width",parseInt(e.widget.settings.width,10)),e.widget.el.css("height",parseInt(e.widget.settings.height,10)),Utils.isFunction(e.widget._redrawInEditor)&&e.widget._redrawInEditor(e.widget.settings.height,e.widget.settings.width)}return t}),define("widgets/brease/common/libs/EjChartCache",[],function(){"use strict";var EjChartCache=function(){this.textSizeCache={}},e=EjChartCache.prototype;return e.cacheTextSize=function(e,t,i){var s=e.toString().length;this.textSizeCache[t.fontFamily]||(this.textSizeCache[t.fontFamily]={fontFamily:t.fontFamily}),this.textSizeCache[t.fontFamily][t.size]||(this.textSizeCache[t.fontFamily][t.size]={fontSize:t.size}),this.textSizeCache[t.fontFamily][t.size][s]||(i.width=1.2*i.width,this.textSizeCache[t.fontFamily][t.size][s]={bounds:i})},e.getTextSize=function(e,t){if(null==e)return{width:0,height:0};var i=e.toString().length;return this.textSizeCache[t.fontFamily]&&this.textSizeCache[t.fontFamily][t.size]&&this.textSizeCache[t.fontFamily][t.size][i]?this.textSizeCache[t.fontFamily][t.size][i].bounds:void 0},EjChartCache}),define("widgets/brease/common/libs/EjChart",["widgets/brease/common/libs/EjChartCache","widgets/brease/common/libs/external/syncfusion/datavisualization/ej.chart"],function(EjChartCache){"use strict";var EjChart=function(){},e=EjChart.prototype;return e.init=function(e,t){this.addEventListener(e,"preRender",this.onPreRender),e.ejChart(t),e.ejChart("instance").chartExtensions={cache:new EjChartCache}},e.onPreRender=function(e){for(var t=e.model&&Array.isArray(e.model._axes)?e.model._axes:[],i,s=0;s<t.length;s+=1)i=t[s],i._initialRange=null===i.range?{min:null,max:null,interval:null}:{min:i.range.min,max:i.range.max,interval:i.range.interval}},e.addEventListener=function(e,t,i){e.on("ejChart"+t,i)},new EjChart}),define("widgets/brease/common/libs/flux/mocks/MockedDispatcher",[],function(){"use strict";return function MockedDispatcher(){this.registeredStores=[],this.registerStore=function e(t){this.registeredStores.push(t)},this.resetStores=function e(){this.registeredStores=[]},this.dispatch=function e(t){this.registeredStores.forEach(function(e){e.newAction(t)})}}}),define("widgets/brease/common/libs/flux/mocks/MockedStore",["brease/enum/Enum"],function(Enum){"use strict";return function MockedView(){this.subscribedViews=[],this.registerView=function e(t){this.subscribedViews.push(t)},this.dispatchAction=function e(){this.subscribedViews.forEach(function(e){e.update()})},this.state={imageList:[""],imageListWithPrefix:[""],imageIndex:0,pathPrefix:"",sizeMode:Enum.SizeMode.CONTAIN,backgroundAlignment:["left","top"],type:"invalid",svgInline:void 0,actualImage:"",height:"auto",width:"auto",visible:!0,preloading:!1},this.getImageType=function e(){return this.state.type},this.getImagePath=function e(){return this.state.actualImage},this.getSvgInline=function e(){return this.state.svgInline},this.getImageSizeMode=function e(){return this.state.sizeMode},this.getBackgroundAlignment=function e(){return this.state.backgroundAlignment},this.getHeight=function e(){return this.state.height},this.getWidth=function e(){return this.state.width},this.getVisible=function e(){return this.state.visible},this.getPreloading=function e(){return this.state.preloading}}}),define("widgets/brease/common/libs/flux/mocks/MockedView",[],function(){"use strict";return function MockedView(){this.update=function(){this.updated=!0,this.def.resolve(!0)},this.isUpdated=function(){return this.def.promise()},this.reset=function(){this.updated=!1,this.def=$.Deferred()}}}),define("widgets/brease/common/libs/flux/stores/ImageStore/ImageActionTypes",[],function(){"use strict";return{INIT_IMAGE:"INIT_IMAGE",INIT_IMAGE_AFTER_PRELOAD:"INIT_IMAGE_AFTER_PRELOAD",SET_IMAGE_LIST:"SET_IMAGE_LIST",SET_IMAGE_FROM_INDEX:"SET_IMAGE_FROM_INDEX",SET_IMAGE_INDEX:"SET_IMAGE_INDEX",SET_PATH_PREFIX:"SET_PATH_PREFIX",SET_SIZE_MODE:"SET_SIZE_MODE",SET_BACKGROUND_ALIGNMENT:"SET_BACKGROUND_ALIGNMENT",SET_WIDTH:"SET_WIDTH",SET_HEIGHT:"SET_HEIGHT",SET_VISIBLE:"SET_VISIBLE",SET_USE_SVG_STYLING:"SET_USE_SVG_STYLING"}}),define("widgets/brease/common/libs/flux/stores/ImageStore/ImageActions",["widgets/brease/common/libs/flux/stores/ImageStore/ImageActionTypes"],function(ImageActionTypes){"use strict";var ImageActions=function(e){this.dispatcher=e};return ImageActions.prototype.initImage=function e(){this.dispatcher.dispatch({type:ImageActionTypes.INIT_IMAGE})},ImageActions.prototype.initImageAfterPreload=function e(){this.dispatcher.dispatch({type:ImageActionTypes.INIT_IMAGE_AFTER_PRELOAD})},ImageActions.prototype.setImageList=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_IMAGE_LIST,data:t})},ImageActions.prototype.setImageFromIndex=function e(t,i){this.dispatcher.dispatch({type:ImageActionTypes.SET_IMAGE_FROM_INDEX,data:{image:t,index:i}})},ImageActions.prototype.setImageIndex=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_IMAGE_INDEX,data:t})},ImageActions.prototype.setPathPrefix=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_PATH_PREFIX,data:t})},ImageActions.prototype.setSizeMode=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_SIZE_MODE,data:t})},ImageActions.prototype.setUseSVGStyling=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_USE_SVG_STYLING,data:t})},ImageActions.prototype.setBackgroundAlignment=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_BACKGROUND_ALIGNMENT,data:t})},ImageActions.prototype.setWidth=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_WIDTH,data:t})},ImageActions.prototype.setHeight=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_HEIGHT,data:t})},ImageActions.prototype.setVisible=function e(t){this.dispatcher.dispatch({type:ImageActionTypes.SET_VISIBLE,data:t})},ImageActions}),define("widgets/brease/common/libs/flux/stores/ImageStore/ImageTypes",[],function(){"use strict";return{SVG:"svg",INVALID:"invalid",OTHER:"other"}}),define("widgets/brease/common/libs/flux/stores/ImageStore/ImageStore",["widgets/brease/common/libs/flux/stores/ImageStore/ImageActionTypes","widgets/brease/common/libs/flux/stores/ImageStore/ImageTypes","widgets/brease/common/libs/wfUtils/UtilsImage","brease/enum/Enum","brease/core/Utils"],function(ImageActionTypes,ImageTypes,UtilsImage,Enum,Utils){"use strict";var ImageStore=function ImageStore(e,t){e.registerStore(this);var n=i();this.state=s(t,n),this.pending=[],this.subscribedViews=[],this.sourceOrder=[]};ImageStore.prototype.newAction=function i(s){var n=this;switch(s.type){case ImageActionTypes.INIT_IMAGE:e(n),t(n),n.processImage();break;case ImageActionTypes.INIT_IMAGE_AFTER_PRELOAD:n.state.preloading=!1;break;case ImageActionTypes.SET_IMAGE_LIST:Array.isArray(s.data)?n.state.imageList=s.data:n.state.imageList=[""],e(n),t(n),n.processImage();break;case ImageActionTypes.SET_IMAGE_FROM_INDEX:if(!1===Utils.isNumeric(s.data.index))return;var a=Utils.isString(s.data.image)?s.data.image:"";n.state.imageList[s.data.index]=a,e(n),t(n),n.processImage();break;case ImageActionTypes.SET_IMAGE_INDEX:n.state.imageIndex=Utils.isNumeric(s.data)?s.data:void 0,t(n),n.processImage();break;case ImageActionTypes.SET_PATH_PREFIX:var r=Utils.isString(s.data)?s.data:"";n.state.pathPrefix=r,e(n),t(n),n.processImage();break;case ImageActionTypes.SET_SIZE_MODE:n.state.sizeMode=s.data;break;case ImageActionTypes.SET_BACKGROUND_ALIGNMENT:n.state.backgroundAlignment=s.data.split(" ");break;case ImageActionTypes.SET_WIDTH:n.state.width=s.data;break;case ImageActionTypes.SET_HEIGHT:n.state.height=s.data;break;case ImageActionTypes.SET_VISIBLE:n.state.visible=s.data;break;case ImageActionTypes.SET_USE_SVG_STYLING:n.state.useSVGStyling=s.data,n.processImage();break}n.state.promise.then(function(e){n.state.type=e,n.dispatchAction(),n.pending=[]},function(){n.pending=[]})},ImageStore.prototype.processImage=function e(){var t=this;t.pending&&(t.pending.forEach(function(e){e()}),t.pending=[]),t.state.promise=t._processImage(t)},ImageStore.prototype.dispatchAction=function e(){this.subscribedViews.forEach(function(e){e.update()})},ImageStore.prototype.getImageType=function e(){return this.state.type},ImageStore.prototype.getImagePath=function e(){return this.state.actualImage},ImageStore.prototype.getSvgInline=function e(){return this.state.svgInline},ImageStore.prototype.getImageSizeMode=function e(){return this.state.sizeMode},ImageStore.prototype.getBackgroundAlignment=function e(){return this.state.backgroundAlignment},ImageStore.prototype.getHeight=function e(){return this.state.height},ImageStore.prototype.getWidth=function e(){return this.state.width},ImageStore.prototype.getVisible=function e(){return this.state.visible},ImageStore.prototype.getUseSVGStyling=function e(){return this.state.useSVGStyling},ImageStore.prototype.getPreloading=function e(){return this.state.preloading},ImageStore.prototype.registerView=function e(t){this.subscribedViews.push(t)},ImageStore.prototype._processImage=function(e){return new Promise(function(t,i){e.pending.push(i),void 0===e.state.actualImage||""===e.state.actualImage?t(ImageTypes.INVALID):UtilsImage.isStylable(e.state.actualImage)&&e.state.useSVGStyling?(e.sourceOrder.push(e.state.actualImage),UtilsImage.getInlineSvg(e.state.actualImage,!1,e.sourceOrder).then(function(i){e.state.svgInline=i,e.sourceOrder=[],i.remove(),i=null,t(ImageTypes.SVG)})):t(ImageTypes.OTHER)})};function e(e){void 0!==e.state.pathPrefix&&""!==e.state.pathPrefix?e.state.imageListWithPrefix=e.state.imageList.map(function(t){return void 0!==t&&""!==t?e.state.pathPrefix+t:""}):e.state.imageListWithPrefix=e.state.imageList}function t(e){var t=e.state.imageListWithPrefix[e.state.imageIndex];e.state.actualImage=void 0===t?"":t}function i(){return{imageList:[""],imageListWithPrefix:[""],imageIndex:0,pathPrefix:"",sizeMode:Enum.SizeMode.CONTAIN,backgroundAlignment:["left","top"],type:ImageTypes.INVALID,svgInline:$('<svg xmlns="http://www.w3.org/2000/svg" viewBox="1 1 1 1"></svg>'),actualImage:"",height:"auto",width:"auto",visible:!0,useSVGStyling:!0,preloading:!1}}function s(e,t){return void 0===e||!1===Utils.isObject(e)?t:(e=JSON.parse(JSON.stringify(e)),{imageList:void 0!==e.imageList?e.imageList:t.imageList,imageListWithPrefix:t.imageListWithPrefix,imageIndex:void 0!==e.imageIndex?e.imageIndex:t.imageIndex,pathPrefix:void 0!==e.pathPrefix?e.pathPrefix:t.pathPrefix,sizeMode:void 0!==e.sizeMode?e.sizeMode:t.sizeMode,backgroundAlignment:void 0!==e.backgroundAlignment?e.backgroundAlignment.split(" "):t.backgroundAlignment,type:t.type,svgInline:t.svgInline,actualImage:t.actualImage,height:void 0!==e.height?e.height:t.height,width:void 0!==e.width?e.width:t.width,visible:void 0!==e.visible?e.visible:t.visible,useSVGStyling:void 0!==e.useSVGStyling?e.useSVGStyling:t.useSVGStyling,preloading:void 0!==e.preloading?e.preloading:t.preloading})}return ImageStore}),define("widgets/brease/common/libs/flux/views/ImageView/ImageView",["widgets/brease/common/libs/flux/stores/ImageStore/ImageTypes","brease/enum/Enum"],function(ImageTypes,Enum){"use strict";var ImageView=function(e,t,i){this.dispatcher=t,this.store=e,this.store.registerView(this),this.parent=i,this._createElements()};ImageView.prototype._createElements=function e(){this.el=$('<div class="ImageView"></div>').height(this.store.getHeight()).width(this.store.getWidth()),this.imageElem=new Image,this.imageElem.draggable=!1,$(this.imageElem).css("display","none"),this.svgEl=$("<svg></svg>").css("display","none"),this.spanHelper=$('<span class="ImageView helper"></span>').css("display","none"),this.el.append(this.spanHelper).append(this.imageElem).append(this.svgEl),this.parent.append(this.el)},ImageView.prototype.update=function s(){var n=this;switch(n.el.height(this.store.getHeight()),n.el.width(this.store.getWidth()),n.svgEl.css({position:"relative",bottom:"auto",top:"auto"}),$(n.imageElem).css({position:"relative",bottom:"auto",top:"auto",left:"auto",right:"auto"}),n.store.getImageType()){case ImageTypes.INVALID:$(n.imageElem).css("display",""),n.svgEl.css("display","none"),n.spanHelper.css("display","none"),n.imageElem.src="";break;case ImageTypes.SVG:switch(n.svgEl.css("display",""),$(n.imageElem).css("display","none"),n.spanHelper.css("display","none"),n.svgEl.replaceWith(n.store.getSvgInline()),n.svgEl=n.store.getSvgInline(),n.store.getImageSizeMode()){case Enum.SizeMode.CONTAIN:n.svgEl.eq(0)[0].setAttribute("preserveAspectRatio",e(n.store.getBackgroundAlignment())),n.svgEl.eq(0)[0].setAttribute("width","100%"),n.svgEl.eq(0)[0].setAttribute("height","100%");break;case Enum.SizeMode.COVER:n.svgEl.eq(0)[0].setAttribute("preserveAspectRatio","xMinYMin");var a=n.svgEl.eq(0)[0].getAttribute("viewBox").split(" ").map(function(e){return parseInt(e)})[2],r=n.svgEl.eq(0)[0].getAttribute("viewBox").split(" ").map(function(e){return parseInt(e)})[3],o=n.store.getBackgroundAlignment();n.el.height()/n.el.width()>r/a?(n.svgEl.eq(0)[0].setAttribute("width",n.el.height()/r*a),n.svgEl.eq(0)[0].setAttribute("height",n.el.height())):(n.svgEl.eq(0)[0].setAttribute("width",n.el.width()),n.svgEl.eq(0)[0].setAttribute("height",n.el.width()/a*r)),i(o[0],n.svgEl,n.el,n.svgEl.eq(0)[0].getAttribute("width")),t(o[1],n.svgEl,n.el,n.svgEl.eq(0)[0].getAttribute("height"));break;case Enum.SizeMode.FILL:n.svgEl.eq(0)[0].setAttribute("preserveAspectRatio","none"),n.svgEl.eq(0)[0].setAttribute("width","100%"),n.svgEl.eq(0)[0].setAttribute("height","100%");break;default:break}break;case ImageTypes.OTHER:$(n.imageElem).css("display",""),n.svgEl.css("display","none"),n.spanHelper.css("display","none"),$(n.imageElem).attr("src")===n.store.getImagePath()?n._readjustImageSize():(n.imageElem.onload=n._readjustImageSize.bind(n),n.imageElem.src=n.store.getImagePath());break}},ImageView.prototype._readjustImageSize=function e(){var s=this;switch(s.store.getImageSizeMode()){case Enum.SizeMode.CONTAIN:s.spanHelper.css("display","");var n=s.store.getBackgroundAlignment()[1];n="center"===n?"middle":n,s.el.css("text-align",s.store.getBackgroundAlignment()[0]),s.spanHelper.css("vertical-align",n),$(s.imageElem).css("vertical-align",n),s.el.height()/s.el.width()>=s.imageElem.naturalHeight/s.imageElem.naturalWidth?($(s.imageElem).width("100%"),$(s.imageElem).height("auto")):($(s.imageElem).width("100%"),$(s.imageElem).width("auto"),$(s.imageElem).height("100%"));break;case Enum.SizeMode.COVER:var a=s.store.getBackgroundAlignment();s.el.height()/s.el.width()>s.imageElem.naturalHeight/s.imageElem.naturalWidth?($(s.imageElem).width("auto"),$(s.imageElem).height("100%")):($(s.imageElem).width("100%"),$(s.imageElem).height("auto")),i(a[0],$(s.imageElem),s.el,$(s.imageElem).width()),t(a[1],$(s.imageElem),s.el,$(s.imageElem).height());break;case Enum.SizeMode.FILL:$(s.imageElem).width("100%"),$(s.imageElem).height("100%");break;default:break}};function e(e){var t,i;switch(e[0]){case"left":t="Min";break;case"center":t="Mid";break;case"right":t="Max";break;default:t="Min"}switch(e[1]){case"top":i="Min";break;case"center":i="Mid";break;case"bottom":i="Max";break;default:i="Min"}return"x"+t+"Y"+i}function t(e,t,i,s){switch(e){case"bottom":t.css({position:"absolute",bottom:"0px",top:"auto"});break;case"top":t.css({position:"absolute",top:"0px",bottom:"auto"});break;case"center":var n=i.height()/2-s/2;t.css({position:"absolute",top:n+"px",bottom:"auto"});break}}function i(e,t,i,s){switch(e){case"left":t.css({position:"absolute",left:"0px",right:"auto"});break;case"right":t.css({position:"absolute",left:"auto",right:"0px"});break;case"center":var n=i.width()/2-s/2;t.css({position:"absolute",left:n+"px",right:"auto"});break}}return ImageView}),define("widgets/brease/common/libs/HideableWidgetEvents",{CLOSED:"Closed",OPENED:"Opened",BEFORE_OPEN:"BeforeOpen"}),define("widgets/brease/common/libs/HideableWidgetState",{CLOSED:"closed",OPEN:"open",TRANSITION:"transition"}),define("widgets/brease/common/libs/ImageHandling",["widgets/brease/common/libs/wfUtils/UtilsImage"],function(UtilsImage){"use strict";var ImageHandling={};ImageHandling.helpers={utilsImage:UtilsImage},ImageHandling.setImage=function(e,t){var i;ImageHandling.helpers.utilsImage.isStylable(e)?(i=ImageHandling.createSvgTag(),void 0!==this.imageDeferred&&"pending"===this.imageDeferred.state()&&this.imageDeferred.reject(),this.imageDeferred=ImageHandling.helpers.utilsImage.getInlineSvg(e),this.imageDeferred.done(function(e){i.replaceWith(e),i=e,i.removeClass("remove"),t(i)})):(void 0!==this.imageDeferred&&this.imageDeferred.reject(),i=ImageHandling.createImgTag(),i.attr("src",e),void 0!==e&&""!==e&&i.removeClass("remove"),t(i))},ImageHandling.createImgTag=function(){return $("<img/>").addClass("remove")},ImageHandling.createSvgTag=function(){return $("<svg/>").addClass("remove")},ImageHandling.createImgSvgTags=function(){return{imgEl:ImageHandling.createImgTag(),svgEl:ImageHandling.createSvgTag()}};function e(){return{setImage:ImageHandling.setImage,createImgTag:ImageHandling.createImgTag,createSvgTag:ImageHandling.createSvgTag,createImgSvgTags:ImageHandling.createImgSvgTags}}return e}),define("widgets/brease/common/libs/redux/reducers/DataHandler/DataHandlerActions",[],function(){"use strict";var DataHandlerActions={COLLECT_CHILDREN:"COLLECT_CHILDREN",collectChildren:function e(){return{type:DataHandlerActions.COLLECT_CHILDREN}},CHILD_ADDED:"CHILD_ADDED",childrenAdded:function e(t,i){return{type:DataHandlerActions.CHILD_ADDED,event:t,widget:i}},CHILD_REMOVED:"CHILD_REMOVED",childrenRemoved:function e(t,i){return{type:DataHandlerActions.CHILD_REMOVED,event:t,widget:i}},CHILDREN_CONFIG_CHANGED:"CHILDREN_CONFIG_CHANGED",childrenConfigChanged:function e(t){return{type:DataHandlerActions.CHILDREN_CONFIG_CHANGED,items:t}},CHILDREN_INITIALISED:"CHILDREN_INITIALISED",childrenInitialised:function e(t,i){return{type:DataHandlerActions.CHILDREN_INITIALISED,childrenList:t,childrenIdList:i}},DISABLE_CHILDREN:"DISABLE_CHILDREN",disableChildren:function e(){return{type:DataHandlerActions.DISABLE_CHILDREN}},ENABLE_CHILDREN:"ENABLE_CHILDREN",enableChildren:function e(){return{type:DataHandlerActions.ENABLE_CHILDREN}}};return DataHandlerActions}),define("widgets/brease/common/libs/redux/middleware/DataHandler/DataHandlerMiddleware",["brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","widgets/brease/common/libs/redux/reducers/DataHandler/DataHandlerActions"],function(BreaseEvent,Enum,Utils,DataHandlerActions){"use strict";var e={};return e.childrenInitialized=function t(i){return function(t){return function(s){return function(n){i.settings.childrenInitialized?s(n):brease.config.editMode?e._initEditor(i):e._initChildren(i,t)}}}},e._initEditor=function(e){!0===brease.config.editMode&&(e.elem.addEventListener(BreaseEvent.WIDGET_ADDED,e._bind(e.childrenAdded)),e.elem.addEventListener(BreaseEvent.WIDGET_REMOVED,e._bind(e.childrenRemoved)),e.settings.childrenInitialized=!0)},e._initChildren=function(t,i){var s=[],n=[];t.el.find("[data-brease-widget]").each(function(){var e=this,t=e.id,i=$.Deferred();s.push(i),n.push(t),brease.uiController.getWidgetState(t)>=Enum.WidgetState.INITIALIZED&&brease.uiController.getWidgetState(t)!==Enum.WidgetState.SUSPENDED?i.resolve():e.addEventListener(BreaseEvent.WIDGET_INITIALIZED,function(e){i.resolve()})}),$.when.apply($,s).done(function(){t.settings.childrenInitialized=!0,e.childrenInitializedHandler(t,n,i),e._setChildWidgetEnableState(t)})},e.childrenInitializedHandler=function(e,t,i){var s=[];t.forEach(function(e){var t=brease.callWidget(e,"widget");s.push(t)}),t.forEach(function(t){var i=brease.callWidget(t,"widget");Utils.isFunction(i.setParentWidget)&&i.setParentWidget(e)});var n=DataHandlerActions.childrenInitialised(s,t);i.dispatch(n),e.childrenInitializedHandler()},e._setChildWidgetEnableState=function(e){e.settings.childrenIdList.forEach(function(t){brease.uiController.callWidget(t,"setParentEnableState",!e.isDisabled)})},e}),define("widgets/brease/common/libs/redux/utils/UtilsDataHandler",[],function(){"use strict";var UtilsDataHandler={};return UtilsDataHandler.order=function(e){for(var t=e.el.find("[data-brease-widget]"),i=[],s=0;s<t.length;s+=1)i.push($(t)[s].id);return i},UtilsDataHandler}),define("widgets/brease/common/libs/redux/reducers/DataHandler/DataHandlerReducer",["widgets/brease/common/libs/redux/reducers/DataHandler/DataHandlerActions","widgets/brease/common/libs/redux/utils/UtilsDataHandler"],function(DataHandlerActions,UtilsDataHandler){"use strict";return function DataHandlerReducer(e,t){if(void 0===e)return null;var i,s;switch(t.type){case DataHandlerActions.CHILDREN_INITIALISED:return e.childrenList=t.childrenList,e.childrenIdList=t.childrenIdList,e;case DataHandlerActions.CHILD_ADDED:if(t.event.target===t.widget.elem){i=event.detail.widgetId,s=brease.callWidget(i,"widget"),e.childrenIdList.push(i),e.childrenList.push(s);var n=UtilsDataHandler.order(t.widget);e.childrenList.sort(function(e,t){return n.indexOf(e.elem.id)-n.indexOf(t.elem.id)}),e.childrenIdList.sort(function(e,t){return n.indexOf(e)-n.indexOf(t)})}return e;case DataHandlerActions.CHILD_REMOVED:if(t.event.target===t.widget.elem){i=event.detail.widgetId,s=brease.callWidget(i,"widget");var a=e.childrenIdList.indexOf(i);a>-1&&(e.childrenList.splice(a,1),e.childrenIdList.splice(a,1))}return e;case DataHandlerActions.CHILDREN_CONFIG_CHANGED:return e.items=t.items,e;case DataHandlerActions.DISABLE_CHILDREN:return e;case DataHandlerActions.ENABLE_CHILDREN:return e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Format/FormatActions",[],function(){"use strict";var FormatActions={FORMAT_CHANGE:"FORMAT_CHANGE",changeFormat:function e(t){return{type:FormatActions.FORMAT_CHANGE,format:t}}};return FormatActions}),define("widgets/brease/common/libs/redux/reducers/Format/FormatReducer",["widgets/brease/common/libs/redux/reducers/Format/FormatActions"],function(FormatActions){"use strict";return function FormatReducer(e,t){if(void 0===e)return null;switch(t.type){case FormatActions.FORMAT_CHANGE:return e.format=t.format,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Image/ImageActions",[],function(){"use strict";var ImageActions={UPDATE_IMAGE_LIST:"UPDATE_IMAGE_LIST",updateImageList:function e(t){return{type:ImageActions.UPDATE_IMAGE_LIST,imageList:t}},UPDATE_IMAGE_PATH:"UPDATE_IMAGE_PATH",updateImagePath:function e(t){return{type:ImageActions.UPDATE_IMAGE_PATH,imagePath:t}},UPDATE_IMAGE_SETTINGS:"UPDATE_IMAGE_SETTINGS",updateImageSettings:function e(t){return{type:ImageActions.UPDATE_IMAGE_SETTINGS,imageSettings:t}}};return ImageActions}),define("widgets/brease/common/libs/redux/utils/UtilsImage",[],function(){"use strict";var UtilsImage={};return UtilsImage.createImageList=function(e){e=e||[];var t=[],i=0;for(i=0;i<e.length;i+=1)void 0!==e[i].image?t.push(e[i].image):t.push(i.toString()+".png");return t},UtilsImage.createImageElements=function(e,t){e=e||[];var i={},s=0;for(s=0;s<e.length;s+=1){var n=s.toString();i[n]={},i[n].id=n,i[n].imagePath=void 0!==t&&""!==t?t+e[s]:void 0}return i},UtilsImage}),define("widgets/brease/common/libs/redux/reducers/Image/ImageReducer",["widgets/brease/common/libs/redux/reducers/Image/ImageActions","widgets/brease/common/libs/redux/utils/UtilsImage"],function(ImageActions,UtilsImage){"use strict";return function ImageReducer(e,t){if(void 0===e)return null;var i;switch(t.type){case ImageActions.UPDATE_IMAGE_LIST:return i=UtilsImage.createImageElements(t.imageList,e.imagePath),_.assign({},e,{imageList:t.imageList,imageElements:i});case ImageActions.UPDATE_IMAGE_PATH:return i=UtilsImage.createImageElements(e.imageList,t.imagePath),_.assign({},e,{imagePath:t.imagePath,imageElements:i});default:return e}}}),define("widgets/brease/common/libs/redux/reducers/List/ListActions",[],function(){"use strict";var e={UPDATE_ITEM_LIST:"UPDATE_ITEM_LIST",updateItemList:function t(i){return{type:e.UPDATE_ITEM_LIST,itemList:i}},UPDATE_ITEM_SETTINGS:"UPDATE_ITEM_SETTINGS",updateItemSettings:function t(i){return{type:e.UPDATE_ITEM_SETTINGS,itemSettings:i}},UPDATE_SELECTED_ITEM:"UPDATE_SELECTED_ITEM",updateSelectedItem:function t(i){return{type:e.UPDATE_SELECTED_ITEM,selectedItemIndex:i}},UPDATE_SELECTED_VALUE:"UPDATE_SELECTED_VALUE",updateSelectedValue:function t(i){return{type:e.UPDATE_SELECTED_VALUE,selectedItemValue:i}},TOGGLE_LIST_STATUS:"TOGGLE_LIST_STATUS",toggleListStatus:function t(){return{type:e.TOGGLE_LIST_STATUS}},SET_LIST_OFFLINE:"SET_LIST_OFFLINE",setListOffline:function t(){return{type:e.SET_LIST_OFFLINE}},SET_LIST_ONLINE:"SET_LIST_ONLINE",setListOnline:function t(){return{type:e.SET_LIST_ONLINE}},CLOSE_LIST:"CLOSE_LIST",closeList:function t(){return{type:e.CLOSE_LIST}},OPEN_LIST:"OPEN_LIST",openList:function t(){return{type:e.OPEN_LIST}},UPDATE_LIST_SETTINGS:"UPDATE_LIST_SETTINGS",updateListSettings:function t(i){return{type:e.UPDATE_LIST_SETTINGS,listSettings:i}}};return e}),define("widgets/brease/common/libs/redux/utils/UtilsList",["brease/enum/Enum","brease/core/Utils"],function(Enum,e){"use strict";var UtilsList={};return UtilsList.parseJSONtoObject=function(t,i){var s=[];return Array.isArray(t)&&(s=t.map(function(t){return"string"==typeof t?e.parsePseudoJSON(t,"malformed data provider - widgetId: "+i):null!==t&&"object"==typeof t?t:void 0},this).filter(function(e){return void 0!==e})),s},UtilsList.getItemsFromItems=function(e,t){var i=[],s;for(s=0;s<e.length;s+=1)i.push({imageId:s.toString(),textId:s.toString(),value:e[s].value,selected:s===t});return i},UtilsList.getSelectedValueFromItems=function(e,t){return void 0!==e[t]?e[t].value:""},UtilsList.calculateListHeight=function(e,t,i,s){return(i>t||e?t:i)*s},UtilsList.getDataProviderForLanguage=function(e){return Object.keys(e).map(function(t){return{value:t,text:e[t].description,image:t+".png",index:void 0!==e[t].index?e[t].index:0}}).sort(function(e,t){return e.index-t.index})},UtilsList.getDataProviderForMeasurement=function(e){return Object.keys(e).map(function(t){return{value:t,text:e[t].description,image:t+".png"}}).sort(function(e,t){return e.index-t.index})},UtilsList.getShowValues=function(e){return{showTexts:e===Enum.DropDownDisplaySettings.default||e===Enum.DropDownDisplaySettings.text||e===Enum.DropDownDisplaySettings.imageAndText,showImages:e===Enum.DropDownDisplaySettings.default||e===Enum.DropDownDisplaySettings.image||e===Enum.DropDownDisplaySettings.imageAndText,showTextsInButton:e===Enum.DropDownDisplaySettings.default||e===Enum.DropDownDisplaySettings.text||e===Enum.DropDownDisplaySettings.imageAndText,showImagesInButton:e===Enum.DropDownDisplaySettings.image||e===Enum.DropDownDisplaySettings.imageAndText}},UtilsList.isEqualIntBool=function(e,t){return!(e!==t&&(!0!==e&&1!==e||!0!==t&&1!==t)&&(!1!==e&&0!==e||!1!==t&&0!==t))},UtilsList}),
define("widgets/brease/common/libs/redux/reducers/List/ListReducer",["widgets/brease/common/libs/redux/reducers/List/ListActions","widgets/brease/common/libs/redux/utils/UtilsList","brease/core/Utils"],function(ListActions,UtilsList,Utils){"use strict";var ListReducer=function ListReducer(s,n){if(void 0===s)return null;var a,r,o,l;switch(n.type){case ListActions.UPDATE_ITEM_LIST:return r=t(n.itemList,s.selectedValue),l=e(n.itemList,r),a=UtilsList.getSelectedValueFromItems(l,r),_.assign({},s,{itemList:l,selectedValue:a,selectedIndex:r,previousSelectedIndex:s.selectedIndex,listSettings:_.assign({},s.listSettings,{listHeight:UtilsList.calculateListHeight(s.listSettings.fitHeight2Items,n.itemList.length,s.listSettings.maxVisibleEntries,s.itemSettings.itemHeight)})});case ListActions.UPDATE_SELECTED_ITEM:return r=i(n.selectedItemIndex,s.itemList.length),l=e(s.itemList,r),a=UtilsList.getSelectedValueFromItems(l,r),_.assign({},s,{itemList:l,selectedIndex:r,selectedValue:a,previousSelectedIndex:s.selectedIndex,listOpen:!1});case ListActions.UPDATE_SELECTED_VALUE:return r=t(s.itemList,n.selectedItemValue),l=e(s.itemList,r),a=UtilsList.getSelectedValueFromItems(l,r),_.assign({},s,{itemList:l,selectedIndex:r,selectedValue:a,previousSelectedIndex:s.selectedIndex,listOpen:!1});case ListActions.UPDATE_ITEM_SETTINGS:return _.assign({},s,{itemSettings:{itemHeight:void 0===n.itemSettings.itemHeight?s.itemSettings.itemHeight:n.itemSettings.itemHeight,imageAlign:void 0===n.itemSettings.imageAlign?s.itemSettings.imageAlign:n.itemSettings.imageAlign}});case ListActions.TOGGLE_LIST_STATUS:return o=!s.listOpen,_.assign({},s,{listOpen:o});case ListActions.CLOSE_LIST:return _.assign({},s,{listOpen:!1});case ListActions.OPEN_LIST:return _.assign({},s,{listOpen:!0});case ListActions.UPDATE_LIST_SETTINGS:return _.assign({},s,{listSettings:{fitHeight2Items:void 0===n.listSettings.fitHeight2Items?s.listSettings.fitHeight2Items:n.listSettings.fitHeight2Items,listPosition:void 0===n.listSettings.listPosition?s.listSettings.listPosition:n.listSettings.listPosition,listWidth:void 0===n.listSettings.listWidth?s.listSettings.listWidth:n.listSettings.listWidth,listHeight:void 0===n.listSettings.listHeight?s.listSettings.listHeight:n.listSettings.listHeight,maxVisibleEntries:void 0===n.listSettings.maxVisibleEntries?s.listSettings.maxVisibleEntries:n.listSettings.maxVisibleEntries,cropToParent:void 0===n.listSettings.cropToParent?s.listSettings.cropToParent:n.listSettings.cropToParent,showTexts:void 0===n.listSettings.showTexts?s.listSettings.showTexts:n.listSettings.showTexts,showImages:void 0===n.listSettings.showImages?s.listSettings.showImages:n.listSettings.showImages,showTextsInButton:void 0===n.listSettings.showTextsInButton?s.listSettings.showTextsInButton:n.listSettings.showTextsInButton,showImagesInButton:void 0===n.listSettings.showImagesInButton?s.listSettings.showImagesInButton:n.listSettings.showImagesInButton}});case ListActions.SET_LIST_OFFLINE:return _.assign({},s,{offline:!0});case ListActions.SET_LIST_ONLINE:return _.assign({},s,{offline:!1});default:return s}};function e(e,t){return e.map(function(e,i){return e.selected=i===t,e})}function t(e,t){var i;for(i=0;i<e.length;i+=1)if(e[i].value===t)return i;return 0}function i(e,t){var i=0;return i=Utils.isNumeric(e)&&e<t&&e>0||null===e?e:!0===e?1:0,i}return ListReducer}),define("widgets/brease/common/libs/redux/reducers/Numeric/NumericActions",[],function(){"use strict";var NumericActions={UPDATE_VALUE:"UPDATE_VALUE",updateValue:function e(t){return{type:NumericActions.UPDATE_VALUE,value:t}},UPDATE_MINVALUE:"UPDATE_MINVALUE",updateMinValue:function e(t){return{type:NumericActions.UPDATE_MINVALUE,minValue:t}},UPDATE_MAXVALUE:"UPDATE_MAXVALUE",updateMaxValue:function e(t){return{type:NumericActions.UPDATE_MAXVALUE,maxValue:t}}};return NumericActions}),define("widgets/brease/common/libs/redux/reducers/Numeric/NumericReducer",["widgets/brease/common/libs/redux/reducers/Numeric/NumericActions"],function(NumericActions){"use strict";return function NumericReducer(e,t){if(void 0===e)return null;switch(t.type){case NumericActions.UPDATE_VALUE:return e.value=t.value,e;case NumericActions.UPDATE_MINVALUE:return e.minValue=t.minValue,e;case NumericActions.UPDATE_MAXVALUE:return e.maxValue=t.maxValue,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Orientation/OrientationActions",[],function(){"use strict";var OrientationActions={ORIENTATION_CHANGE:"ORIENTATION_CHANGE",changeOrientation:function e(t){return{type:OrientationActions.ORIENTATION_CHANGE,orientation:t}}};return OrientationActions}),define("widgets/brease/common/libs/redux/reducers/Orientation/OrientationReducer",["widgets/brease/common/libs/redux/reducers/Orientation/OrientationActions"],function(OrientationActions){"use strict";return function OrientationReducer(e,t){if(void 0===e)return null;switch(t.type){case OrientationActions.ORIENTATION_CHANGE:return e.orientation=t.orientation,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Scale/ScaleActions",[],function(){"use strict";var ScaleActions={SCALEDOMAIN_CHANGE:"SCALEDOMAIN_CHANGE",changeScaleDomain:function e(t){return{type:ScaleActions.SCALEDOMAIN_CHANGE,scaleDomain:t}},SCALERANGE_CHANGE:"SCALERANGE_CHANGE",changeScaleRange:function e(t){return{type:ScaleActions.SCALERANGE_CHANGE,scaleRange:t}},SCALEOFFSET_CHANGE:"SCALEOFFSET_CHANGE",changeScaleOffset:function e(t){return{type:ScaleActions.SCALEOFFSET_CHANGE,scaleOffset:t}},SCALEPOSITION_CHANGE:"SCALEPOSITION_CHANGE",changeScalePosition:function e(t){return{type:ScaleActions.SCALEPOSITION_CHANGE,tickPosition:t}},SCALEMAJORTICKS_CHANGE:"SCALEMAJORTICKS_CHANGE",changeScaleMajorTicks:function e(t){return{type:ScaleActions.SCALEMAJORTICKS_CHANGE,majorTicks:t}},SCALESHOWTICKNUMBERS_CHANGE:"SCALESHOWTICKNUMBERS_CHANGE",changeScaleShowTickNumbers:function e(t){return{type:ScaleActions.SCALESHOWTICKNUMBERS_CHANGE,showTickNumbers:t}}};return ScaleActions}),define("widgets/brease/common/libs/redux/reducers/Scale/ScaleReducer",["widgets/brease/common/libs/redux/reducers/Scale/ScaleActions"],function(ScaleActions){"use strict";return function ScaleReducer(e,t){if(void 0===e)return null;switch(t.type){case ScaleActions.SCALEDOMAIN_CHANGE:return e.scaleDomain=t.scaleDomain,e;case ScaleActions.SCALERANGE_CHANGE:return e.scaleRange=t.scaleRange,e;case ScaleActions.SCALEOFFSET_CHANGE:return e.scaleOffset=parseInt(t.scaleOffset,10),e;case ScaleActions.SCALEPOSITION_CHANGE:return e.tickPosition=t.tickPosition,e;case ScaleActions.SCALEMAJORTICKS_CHANGE:return e.majorTicks=t.majorTicks,e;case ScaleActions.SCALESHOWTICKNUMBERS_CHANGE:return e.showTickNumbers=t.showTickNumbers,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Size/SizeActions",[],function(){"use strict";var SizeActions={HEIGHT_CHANGE:"HEIGHT_CHANGE",changeHeight:function e(t){return{type:SizeActions.HEIGHT_CHANGE,height:t}},WIDTH_CHANGE:"WIDTH_CHANGE",changeWidth:function e(t){return{type:SizeActions.WIDTH_CHANGE,width:t}}};return SizeActions}),define("widgets/brease/common/libs/redux/reducers/Size/SizeReducer",["widgets/brease/common/libs/redux/reducers/Size/SizeActions"],function(SizeActions){"use strict";return function SizeReducer(e,t){if(void 0===e)return null;switch(t.type){case SizeActions.HEIGHT_CHANGE:return e.height=t.height,e;case SizeActions.WIDTH_CHANGE:return e.width=t.width,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Status/StatusActions",[],function(){"use strict";var StatusActions={VISIBLE_CHANGE:"VISIBLE_CHANGE",changeVisible:function e(t){return{type:StatusActions.VISIBLE_CHANGE,visibility:t}},ENABLE_CHANGE:"ENABLE_CHANGE",changeEnable:function e(t){return{type:StatusActions.ENABLE_CHANGE,enable:t}},ACTIVE_CHANGE:"ACTIVE_CHANGE",changeActive:function e(t){return{type:StatusActions.ACTIVE_CHANGE,active:t}}};return StatusActions}),define("widgets/brease/common/libs/redux/reducers/Status/StatusReducer",["widgets/brease/common/libs/redux/reducers/Status/StatusActions"],function(StatusActions){"use strict";return function StatusReducer(e,t){if(void 0===e)return null;switch(t.type){case StatusActions.VISIBLE_CHANGE:return e.visible=t.visibility,e;case StatusActions.ENABLE_CHANGE:return e.enabled=t.enable,e;case StatusActions.ACTIVE_CHANGE:return e.active=t.active,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Style/StyleActions",[],function(){"use strict";var StyleActions={STYLE_CHANGE:"STYLE_CHANGE",styleChange:function(e){return{type:StyleActions.STYLE_CHANGE,style:e}},ADDITIONAL_STYLE_CHANGE:"ADDITIONAL_STYLE_CHANGE",additionalStyleChange:function(e){return{type:StyleActions.ADDITIONAL_STYLE_CHANGE,styles:e}},THEME_CHANGE:"THEME_CHANGE",themeChange:function(){return{type:StyleActions.THEME_CHANGE}}};return StyleActions}),define("widgets/brease/common/libs/redux/utils/UtilsStyle",[],function(){"use strict";var UtilsStyle={};return UtilsStyle.addStylePrefix=function(e,t){return e+"_style_"+t},UtilsStyle}),define("widgets/brease/common/libs/redux/reducers/Style/StyleReducer",["widgets/brease/common/libs/redux/reducers/Style/StyleActions","widgets/brease/common/libs/redux/utils/UtilsStyle"],function(StyleActions,UtilsStyle){"use strict";return function StyleReducer(e,t){if(void 0===e)return null;switch(t.type){case StyleActions.STYLE_CHANGE:return e=_.assign({},e,{style:t.style,styleToApply:UtilsStyle.addStylePrefix(e.stylePrefix,t.style)}),e;case StyleActions.ADDITIONAL_STYLE_CHANGE:return e=_.assign({},e,{additionalStyleToApply:t.styles.map(function(t){return UtilsStyle.addStylePrefix(e.stylePrefix,t)}).join(" ")}),e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Text/TextActions",[],function(){"use strict";var TextActions={LANGUAGE_CHANGE:"LANGUAGE_CHANGE",changeLanguage:function e(){return{type:TextActions.LANGUAGE_CHANGE}},UPDATE_TEXT:"UPDATE_TEXT",updateText:function e(t){return{type:TextActions.UPDATE_TEXT,textElements:t}},UPDATE_TEXT_SETTINGS:"UPDATE_TEXT_SETTINGS",updateTextSettings:function e(t){return{type:TextActions.UPDATE_TEXT_SETTINGS,textSettings:t}}};return TextActions}),define("widgets/brease/common/libs/redux/utils/UtilsText",[],function(){"use strict";var UtilsText={};return UtilsText.getTextsFromItems=function(e){var t={},i;for(i=0;i<e.length;i+=1){var s=i.toString();t[s]=UtilsText.getTextElement(e[i].text,s)}return t},UtilsText.getTextElement=function(e,t){var i={textId:t};return brease.language.isKey(e)?(i.textKey=brease.language.parseKey(e),i.displayText=brease.language.getTextByKey(i.textKey)):(i.textKey=void 0,i.displayText=e),i},UtilsText.translateTextElements=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=UtilsText.translateTextElement(e[i]));return t},UtilsText.translateTextElement=function(e){return void 0===e.textKey?e:_.assign({},e,{displayText:brease.language.getTextByKey(e.textKey)})},UtilsText}),define("widgets/brease/common/libs/redux/reducers/Text/TextReducer",["widgets/brease/common/libs/redux/reducers/Text/TextActions","widgets/brease/common/libs/redux/utils/UtilsText"],function(TextActions,UtilsText){"use strict";return function TextReducer(e,t){if(void 0===e)return null;switch(t.type){case TextActions.LANGUAGE_CHANGE:return _.assign({},e,{textElements:UtilsText.translateTextElements(e.textElements)});case TextActions.UPDATE_TEXT:return _.assign({},e,{textElements:t.textElements});case TextActions.UPDATE_TEXT_SETTINGS:return _.assign({},e,{textSettings:{multiLine:void 0===t.textSettings.multiLine?e.textSettings.multiLine:t.textSettings.multiLine,wordWrap:void 0===t.textSettings.wordWrap?e.textSettings.wordWrap:t.textSettings.wordWrap,ellipsis:void 0===t.textSettings.ellipsis?e.textSettings.ellipsis:t.textSettings.ellipsis}});default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Thumb/ThumbActions",[],function(){"use strict";var ThumbActions={THUMBSIZE_CHANGE:"THUMBSIZE_CHANGE",changeThumbSize:function e(t){return{type:ThumbActions.THUMBSIZE_CHANGE,thumbSize:parseInt(t,10)}},THUMBIMAGE_CHANGE:"THUMBIMAGE_CHANGE",changeThumbImage:function e(t){return{type:ThumbActions.THUMBIMAGE_CHANGE,thumbImage:t}},SELECT_THUMB:"SELECT_THUMB",selectThumb:function e(){return{type:ThumbActions.SELECT_THUMB}},UNSELECT_THUMB:"UNSELECT_THUMB",unselectThumb:function e(){return{type:ThumbActions.UNSELECT_THUMB}}};return ThumbActions}),define("widgets/brease/common/libs/redux/reducers/Thumb/ThumbReducer",["widgets/brease/common/libs/redux/reducers/Thumb/ThumbActions"],function(ThumbActions){"use strict";return function ThumbReducer(e,t){if(void 0===e)return null;switch(t.type){case ThumbActions.THUMBSIZE_CHANGE:return e.thumbSize=parseInt(t.thumbSize,10),e;case ThumbActions.THUMBIMAGE_CHANGE:return e.thumbImage=t.thumbImage,e;case ThumbActions.SELECT_THUMB:return e.thumbSelected=!0,e;case ThumbActions.UNSELECT_THUMB:return e.thumbSelected=!1,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/Track/TrackActions",[],function(){"use strict";var TrackActions={TRACKSIZE_CHANGE:"TRACKSIZE_CHANGE",changeTrackSize:function e(t){return{type:TrackActions.TRACKSIZE_CHANGE,trackSize:parseInt(t,10)}},TRACK_LOCKED:"TRACK_LOCKED",lockTrack:function e(t){return{type:TrackActions.TRACK_LOCKED,trackLocked:t}}};return TrackActions}),define("widgets/brease/common/libs/redux/reducers/Track/TrackReducer",["widgets/brease/common/libs/redux/reducers/Track/TrackActions"],function(TrackActions){"use strict";return function TrackReducer(e,t){if(void 0===e)return null;switch(t.type){case TrackActions.TRACKSIZE_CHANGE:return e.trackSize=parseInt(t.trackSize,10),e;case TrackActions.TRACK_LOCKED:return e.trackLocked=t.trackLocked,e;default:return e}}}),define("widgets/brease/common/libs/redux/reducers/ValueDisplay/ValueDisplayActions",["brease/core/Class"],function(e){"use strict";var ValueDisplayActions={VALUEDISPLAYSIZE_CHANGE:"VALUEDISPLAYSIZE_CHANGE",changeValueDisplaySize:function e(t){return{type:ValueDisplayActions.VALUEDISPLAYSIZE_CHANGE,valueDisplaySize:parseInt(t,10)}},SHOWVALUEDISPLAY_CHANGE:"SHOWVALUEDISPLAY_CHANGE",changeShowValueDisplay:function e(t){return{type:ValueDisplayActions.SHOWVALUEDISPLAY_CHANGE,showValueDisplay:t}},SHOWUNIT_CHANGE:"SHOWUNIT_CHANGE",changeShowUnit:function e(t){return{type:ValueDisplayActions.SHOWUNIT_CHANGE,showUnit:t}},UNITSYMBOL_CHANGE:"UNITSYMBOL_CHANGE",changeUnitSymbol:function e(t){return{type:ValueDisplayActions.UNITSYMBOL_CHANGE,unitSymbol:t}},ELLIPSIS_CHANGE:"ELLIPSIS_CHANGE",changeEllipsis:function e(t){return{type:ValueDisplayActions.ELLIPSIS_CHANGE,ellipsis:t}}};return ValueDisplayActions}),define("widgets/brease/common/libs/redux/reducers/ValueDisplay/ValueDisplayReducer",["widgets/brease/common/libs/redux/reducers/ValueDisplay/ValueDisplayActions"],function(ValueDisplayActions){"use strict";return function ValueDisplayReducer(e,t){if(void 0===e)return null;switch(t.type){case ValueDisplayActions.VALUEDISPLAYSIZE_CHANGE:return e.valueDisplaySize=parseInt(t.valueDisplaySize,10),e;case ValueDisplayActions.SHOWVALUEDISPLAY_CHANGE:return e.showValueDisplay=t.showValueDisplay,e;case ValueDisplayActions.SHOWUNIT_CHANGE:return e.showUnit=t.showUnit,e;case ValueDisplayActions.UNITSYMBOL_CHANGE:return e.unitSymbol=t.unitSymbol,e;case ValueDisplayActions.ELLIPSIS_CHANGE:return e.ellipsis=t.ellipsis,e;default:return e}}}),define("widgets/brease/common/libs/redux/utils/UtilsNumeric",["brease/config/NumberFormat"],function(NumberFormat){"use strict";var UtilsNumeric={};return UtilsNumeric.getFormatedNumber=function(e,t){var i=NumberFormat.getFormat(t,brease.measurementSystem.getCurrentMeasurementSystem());return e=brease.formatter.formatNumber(e,i),e},UtilsNumeric.getDecimalPlaces=function(e){return NumberFormat.getFormat(e,brease.measurementSystem.getCurrentMeasurementSystem()).decimalPlaces},UtilsNumeric}),define("widgets/brease/common/libs/redux/utils/UtilsAxis",["libs/d3/d3","widgets/brease/common/libs/redux/utils/UtilsNumeric","brease/enum/Enum"],function(e,UtilsNumeric,Enum){"use strict";var UtilsAxis={};UtilsAxis.createSVGContainer=function(t,i,s){return e.select(t).append("svg").attr("height",i).attr("width",s).attr("class","Axis")},UtilsAxis.createAxisTop=function(i,s,n,a,r){var o=t(s,n,a);return e.svg.axis().orient("top").tickValues(o).tickFormat(e.format(",."+UtilsNumeric.getDecimalPlaces(r)+"f")).scale(i)},UtilsAxis.createAxisRight=function(i,s,n,a,r){var o=t(s,n,a);return e.svg.axis().orient("right").tickValues(o).tickFormat(e.format(",."+UtilsNumeric.getDecimalPlaces(r)+"f")).scale(i)},UtilsAxis.createAxisBottom=function(i,s,n,a,r){var o=t(s,n,a);return e.svg.axis().orient("bottom").tickValues(o).tickFormat(e.format(",."+UtilsNumeric.getDecimalPlaces(r)+"f")).scale(i)},UtilsAxis.createAxisLeft=function(i,s,n,a,r){var o=t(s,n,a);return e.svg.axis().orient("left").tickValues(o).tickFormat(e.format(",."+UtilsNumeric.getDecimalPlaces(r)+"f")).scale(i)},UtilsAxis.appendAxisHorizontal=function(e,t,i){e.append("g").attr("transform","translate(0,"+i+")").call(t)},UtilsAxis.appendAxisVertical=function(e,t,i){e.append("g").attr("transform","translate("+i+",0)").call(t)},UtilsAxis.showTickNumber=function(e,t){t?e.selectAll("g.tick text").classed("remove",!1):e.selectAll("g.tick text").classed("remove",!0)},UtilsAxis.showUnitSymbol=function(e,t){t?e.selectAll("text.UnitSymbol").classed("remove",!1):e.selectAll("text.UnitSymbol").classed("remove",!0)},UtilsAxis.createCombinedAxis=function(e){var t=this.createSVGContainer(e.elem,e.height,e.width,e.additionalClasses);switch(e.orientation){case Enum.Orientation.LTR:case Enum.Orientation.RTL:this.createCombinedAxisHorizontal(e,t);break;case Enum.Orientation.BTT:case Enum.Orientation.TTB:this.createCombinedAxisVertical(e,t);break}return this.showTickNumber(t,e.showTickNumbers),t},UtilsAxis.updateCombinedAxis=function(t){var i=e.select(t.elem).select("svg").attr("height",t.height).attr("width",t.width);switch(i.selectAll("g").remove(),t.orientation){case Enum.Orientation.LTR:case Enum.Orientation.RTL:this.createCombinedAxisHorizontal(t,i);break;case Enum.Orientation.BTT:case Enum.Orientation.TTB:this.createCombinedAxisVertical(t,i);break}return this.showTickNumber(i,t.showTickNumbers),i},UtilsAxis.createCombinedAxisHorizontal=function(e,t){var i;switch(e.tickPosition){case Enum.TickStyle.NONE:break;case Enum.TickStyle.TOP:i=this.createAxisTop(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisHorizontal(t,i,e.height/2-e.scaleOffset);break;case Enum.TickStyle.BOTTOM:i=this.createAxisBottom(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisHorizontal(t,i,e.height/2+e.scaleOffset);break;case Enum.TickStyle.TOPBOTTOM:i=this.createAxisTop(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisHorizontal(t,i,e.height/2-e.scaleOffset),i=this.createAxisBottom(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisHorizontal(t,i,e.height/2+e.scaleOffset);break}},UtilsAxis.createCombinedAxisVertical=function(e,t){var i;switch(e.tickPosition){case Enum.TickStyle.NONE:break;case Enum.TickStyle.TOP:i=this.createAxisLeft(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisVertical(t,i,e.width/2-e.scaleOffset);break;case Enum.TickStyle.BOTTOM:i=this.createAxisRight(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisVertical(t,i,e.width/2+e.scaleOffset);break;case Enum.TickStyle.TOPBOTTOM:i=this.createAxisLeft(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisVertical(t,i,e.width/2-e.scaleOffset),i=this.createAxisRight(e.scale,e.limitMin,e.limitMax,e.majorTicks,e.format),this.appendAxisVertical(t,i,e.width/2+e.scaleOffset);break}};function t(e,t,i){var s=[],n=t-e;if(0===i)s=[];else if(1===i)s=[n/2+e];else for(var a=n/(i-1),r=0;r<i;r+=1)s.push(e+a*r);return s}return UtilsAxis}),define("widgets/brease/common/libs/redux/utils/UtilsJSON",[],function(){"use strict";var UtilsJSON={};return UtilsJSON.convertJSONtoObject=function(e){if(e=e||{},"string"==typeof e&&e.length>0)try{return JSON.parse(e.replace(/'/g,'"'))}catch(e){return console.iatWarn("JSON string erroneous"),{}}return e},UtilsJSON.convertObjectToJSON=function(e){if(e=e||"","object"==typeof e&&e.length>0)try{return JSON.stringify(e)}catch(e){return console.iatWarn("JSON string erroneous"),""}return""},UtilsJSON}),define("widgets/brease/common/libs/redux/utils/UtilsScale",["libs/d3/d3"],function(e){"use strict";var UtilsScale={};return UtilsScale.createScaleLinear=function(t,i){return e.scale.linear().domain(t).range(i)},UtilsScale.updateDomain=function(e,t){e.domain(t)},UtilsScale.updateRange=function(e,t){e.range(t)},UtilsScale}),define("widgets/brease/common/libs/redux/utils/UtilsSvg",[],function(){"use strict";var UtilsSvg={};return UtilsSvg.setViewBox=function(e,t){e&&"function"==typeof e.setAttribute&&e.setAttribute("viewBox",""+t)},UtilsSvg}),define("widgets/brease/common/libs/redux/view/AxisView/AxisView",["widgets/brease/common/libs/redux/utils/UtilsAxis"],function(UtilsAxis){"use strict";var AxisView=function(e,t,i){void 0===i?(this.create(e,t),this.render(e,t)):i.render(e,t),this.props=e},e=AxisView.prototype;return e.create=function(e,t){UtilsAxis.createCombinedAxis(e),this.el=t.find("svg.Axis"),this.el.addClass("AxisView")},e.render=function e(t,i){UtilsAxis.updateCombinedAxis(t)},e.dispose=function e(){},AxisView}),define("widgets/brease/common/libs/wfUtils/UtilsCommon",[],function(){return{addCssClasses:function(e,t,i){e.addClass("TextView"),!0===t.ellipsis?e.addClass("ellipsis"):e.removeClass("ellipsis"),i?e.addClass("textSelected"):e.removeClass("textSelected"),!0===t.multiLine?(e.addClass("multiLine"),!0===t.wordWrap?(e.addClass("wordWrap"),e.removeClass("multiLine")):e.removeClass("wordWrap"),!0===t.breakWord?(e.addClass("breakWord"),e.removeClass("multiLine")):e.removeClass("breakWord")):(e.removeClass("breakWord"),e.removeClass("wordWrap"),e.removeClass("multiLine"))}}}),define("widgets/brease/common/libs/redux/view/HTMLView/HTMLView",["widgets/brease/common/libs/BoxLayout","widgets/brease/common/libs/wfUtils/UtilsCommon"],function(BoxLayout,Utils){"use strict";var HTMLView=function(e,t){this.render(e,t)},e=HTMLView.prototype;return e.render=function e(t,i){this.el=$(BoxLayout.createBox()),this.el.addClass("HTMLView"),t.html=""+t.html,"<"===t.html[0]?this.el.html(t.html):(this.el.addClass("TextView"),this.span=$("<span></span>"),Utils.addCssClasses(this.el,t.textSettings,t.selected),this.span.text(brease.language.unescapeText(t.html)),this.el.append(this.span)),i.append(this.el)},e.dispose=function e(){this.span&&this.span.remove(),this.el.remove()},HTMLView}),define("widgets/brease/common/libs/redux/view/ImageView/ImageView",["widgets/brease/common/libs/BoxLayout","widgets/brease/common/libs/wfUtils/UtilsImage"],function(BoxLayout,UtilsImage){"use strict";var ImageView=function(e,t){this.render(e,t)},e=ImageView.prototype;return e.render=function e(t,i){if(this.el=$(BoxLayout.createBox()),this.el.addClass("ImageView"),void 0!==t.subClasses&&""!==t.subClasses&&this.el.addClass(t.subClasses),UtilsImage.isStylable(t.image)&&!0!==t.notStyleable){var s=this;this.imageDeferred=UtilsImage.getInlineSvg(t.image,!1,void 0,t.cache),this.imageDeferred.done(function(e){s.image=e,s.el.append(s.image)})}else this.image=$("<img src="+t.image+">"),this.el.append(this.image);i.append(this.el)},e.dispose=function e(){void 0!==this.imageDeferred&&"pending"===this.imageDeferred.state()&&this.imageDeferred.reject(),this.image.remove(),this.el.remove()},ImageView}),define("widgets/brease/common/libs/redux/view/TextView/TextView",["widgets/brease/common/libs/BoxLayout","widgets/brease/common/libs/wfUtils/UtilsCommon"],function(BoxLayout,Utils){"use strict";var TextView=function(e,t){this.render(e,t)},e=TextView.prototype;return e.render=function e(t,i){this.el=$(BoxLayout.createBox()),this.span=$("<span></span>"),Utils.addCssClasses(this.el,t.textSettings,t.selected),t.text=""+t.text,this.span.text(brease.language.unescapeText(t.text)),this.el.append(this.span),i.append(this.el)},e.dispose=function e(){this.span.remove(),this.el.remove()},TextView}),define("widgets/brease/common/libs/redux/view/ItemView/ItemView",["widgets/brease/common/libs/redux/view/ImageView/ImageView","widgets/brease/common/libs/redux/view/TextView/TextView","widgets/brease/common/libs/BoxLayout","brease/events/BreaseEvent","brease/enum/Enum"],function(ImageView,TextView,BoxLayout,BreaseEvent,Enum){"use strict";var ItemView=function(e,t){this.render(e,t)},e=ItemView.prototype;e.render=function e(i,s){if(this.el=$(BoxLayout.createBoxContainer()),this.el.on(BreaseEvent.CLICK,i.onClick),t(this.el,i.status,i.itemSettings.imageAlign),i.status.visible){if(this.el.height(i.itemSettings.itemHeight),void 0!==i.imageIndicator&&i.imageIndicator.showImage){var n="ImageIndicator";n=i.itemSettings.imageAlign===Enum.ImagePosition.left?n.concat(" orientation-left"):n.concat(" orientation-right"),this.imageIndicator=new ImageView({image:"widgets/brease/common/libs/redux/view/ItemView/assets/Down.svg",cache:!0,showImage:!0,subClasses:n},this.el)}void 0!==i.image.image&&i.image.showImage&&(this.image=new ImageView(i.image,this.el)),void 0!==i.text&&i.text.showText&&(i.text.text=i.offline?brease.settings.noValueString:i.text.text,""!==i.text.text&&void 0!==i.text.text&&(this.text=new TextView({text:i.text.text,textSettings:i.text.textSettings,selected:i.status.selected},this.el))),s.append(this.el)}};function t(e,t,i){e.addClass("ItemView"),t.visible?(t.selected&&e.addClass("itemSelected"),t.enabled||e.addClass("itemDisabled")):e.addClass("itemInvisible"),t.lastItem&&e.addClass("lastItem");var s=i===Enum.ImagePosition.left?Enum.Orientation.LTR:Enum.Orientation.RTL;BoxLayout.setOrientation(e[0],s)}return e.dispose=function e(){void 0!==this.image&&(this.image.dispose(),this.image=void 0),void 0!==this.text&&(this.text.dispose(),this.text=void 0),this.el.off(),this.el.remove()},ItemView}),define("widgets/brease/common/libs/redux/view/ListView/ListView",["widgets/brease/common/libs/redux/view/ItemView/ItemView","brease/helper/Scroller","brease/events/BreaseEvent"],function(ItemView,Scroller,BreaseEvent){"use strict";var ListView=function(e,t){this.render(e,t)},e=ListView.prototype;e.render=function e(t,n){if(this.elContainer=$('<div class="ListView Container"></div>'),this.elList=$('<div class="ListView List"></div>'),this.elContainer.append(this.elList),brease.config.isKeyboardOperationEnabled()&&!brease.appElem.contains(n[0])&&this.elContainer.on(BreaseEvent.MOUSE_DOWN,function(e){e.preventDefault()}),this.items=[],i(this.elContainer,t.status.visible,t.status.enabled),t.status.visible){var a=0;for(a=0;a<t.items.itemList.length;a+=1){var r=t.text.textElements[t.items.itemList[a].textId],o=t.image.imageElements[t.items.itemList[a].imageId],l={text:{text:void 0===r?"":r.displayText,textSettings:t.text.textSettings,showText:t.items.listSettings.showTexts},image:{image:void 0===o?void 0:o.imagePath,showImage:t.items.listSettings.showImages},itemSettings:t.items.itemSettings,status:{enabled:t.status.enabled,visible:t.status.visible,selected:t.items.itemList[a].selected,lastItem:a===t.items.itemList.length-1},onClick:function(e){var i=e;return function(e){t.onClick(i,e)}}(a)},d=new ItemView(l,this.elList);this.items.push(d)}n.append(this.elContainer);var c=void 0===this.items[t.items.selectedIndex]?void 0:this.items[t.items.selectedIndex].el[0],h=void 0===this.items[t.items.previousSelectedIndex]?void 0:this.items[t.items.previousSelectedIndex].el[0];this.scroller=s(!t.items.itemSettings.fitHeight2Items,t.status.editMode,this.elContainer[0],c,h)}},e.dispose=function e(){t(this),void 0!==this.scroller&&this.scroller.destroy(),this.elList.remove(),this.elContainer.remove()};function t(e){if(void 0!==e.items){var t=0;for(t=0;t<e.items.length;t+=1)e.items[t].dispose()}e.items=void 0}function i(e,t,i){t?(e.removeClass("invisible"),i?e.removeClass("disabled"):e.addClass("disabled")):e.addClass("invisible")}function s(e,t,i,s,a){var r;return e&&(r=n(i),t?(r.subsequentlyDisableTouch(),r.subsequentlyDisableMouse()):(void 0!==a&&r.scrollToElement(a,0,!0,!0),void 0!==s&&r.scrollToElement(s,400,!0,!0))),r}function n(e){var t={mouseWheel:!0,scrollX:!0,scrollY:!0};return Scroller.addScrollbars(e,t)}return ListView}),define("widgets/brease/common/libs/redux/view/ThumbView/ThumbView",["brease/events/BreaseEvent"],function(BreaseEvent){"use strict";var ThumbView=function(e,t,i){return void 0===i?(this.create(e,t),this.render(e),this):(i.render(e),i)},e=ThumbView.prototype;return e.create=function e(t,i){void 0!==t.additionalId?this.id=i[0].id+"_Thumb_"+t.additionalId:this.id=i[0].id+"_Thumb",this.el=$('<div id="'+this.id+'"></div>'),void 0!==t.additionalClass&&this.el[0].classList.add(t.additionalClass),this.el[0].classList.add("ThumbView"),this.el.append("<img/>"),i[0].appendChild(this.el[0])},e.render=function(e){void 0!==e.thumbImage&&""!==e.thumbImage?(this.el[0].querySelector("img").src=e.thumbImage,this.el[0].querySelector("img").style.display="block"):this.el[0].querySelector("img").style.display="none",this.el[0].style.left=e.left+"px",this.el[0].style.top=e.top+"px",this.el[0].style.height=e.thumbSize+"px",this.el[0].style.width=e.thumbSize+"px",void 0!==e.selected&&e.selected?this.el[0].style.zIndex=5:this.el[0].style.zIndex=0,this.dragBehavior(e)},e.dragBehavior=function(e){!brease.config.editMode&&e.enabled&&(this.mouseMove=e.onMouseMove,this.mouseUp=e.onMouseUp,this.mouseDown=e.onMouseDown,e.selected?($(document.body).on(BreaseEvent.MOUSE_MOVE,e.onMouseMove),$(document).on(BreaseEvent.MOUSE_UP,e.onMouseUp),$(window).on("blur",e.onMouseUp)):this.el.on(BreaseEvent.MOUSE_DOWN,e.onMouseDown))},e.dispose=function e(){$(document.body).off(BreaseEvent.MOUSE_MOVE,this.mouseMove),$(document).off(BreaseEvent.MOUSE_UP,this.mouseUp),this.el.off(BreaseEvent.MOUSE_DOWN,this.mouseDown),$(window).off("blur",this.onMouseUp)},ThumbView}),define("widgets/brease/common/libs/redux/view/TrackView/TrackView",[],function(){"use strict";var TrackView=function(e,t,i){return void 0===i?(this.create(e,t),this.render(e),this):(i.render(e),i)},e=TrackView.prototype;return e.create=function(e,t){void 0!==e.additionalId?this.id=t[0].id+"_TrackView_"+e.additionalId:this.id=t[0].id+"_TrackView",this.el=$('<div id="'+this.id+'"></div>'),this.el[0].classList.add("TrackView"),""===e.additionalClass&&void 0===e.additionalClass||(this.el[0].classList.add(e.additionalClass),void 0!==e.arrowClasses&&("TrackYView"===e.additionalClass&&("top"!==e.arrowClasses[0]&&"bottom"!==e.arrowClasses[1]||(this.arrowTop=$("<div class='arrow top'></div>"),this.arrowBottom=$("<div class='arrow bottom'></div>"))),"TrackXView"===e.additionalClass&&("left"!==e.arrowClasses[0]&&"right"!==e.arrowClasses[1]||(this.arrowLeft=$("<div class='arrow left'></div>"),this.arrowRight=$("<div class='arrow right'></div>"))))),t[0].appendChild(this.el[0])},e.render=function e(t){var i,s;void 0!==t.arrowClasses?(i=t.left+t.borderWidth.left,s=t.top+t.borderWidth.top):(i=t.left,s=t.top),this.el[0].style.height=t.height+"px",this.el[0].style.left=i+"px",this.el[0].style.top=s+"px",this.el[0].style.width=t.width+"px",void 0!==t.arrowClasses&&"TrackXView"===t.additionalClass&&(this.container=document.querySelector("#"+t.widgetId+"_squareContainer"),null!==this.container&&(this.container.style.height=t.size+"px",this.container.style.width=t.size+"px",$(this.container).css({"margin-left":t.left})),this.el.append(this.arrowLeft),this.el.append(this.arrowRight),"left"===t.arrowClasses[0]&&this.arrowLeft.css({"margin-left":t.width-18,"margin-top":t.height/2-18}),"right"===t.arrowClasses[1]&&this.arrowRight.css({"margin-left":0,"margin-top":t.height/2-18})),void 0!==t.arrowClasses&&"TrackYView"===t.additionalClass&&(this.container=document.querySelector("#"+t.widgetId+"_squareContainer"),null!==this.container&&(this.container.style.height=t.size+"px",
this.container.style.width=t.size+"px",$(this.container).css({"margin-top":t.top})),this.el.append(this.arrowTop),this.el.append(this.arrowBottom),"top"===t.arrowClasses[0]&&this.arrowTop.css({"margin-top":t.height-18,"margin-left":t.width/2-18}),"bottom"===t.arrowClasses[1]&&this.arrowBottom.css({"margin-top":0,"margin-left":t.width/2-18}))},e.dispose=function e(){},TrackView}),define("widgets/brease/common/libs/redux/view/ValueDisplayView/ValueDisplayView",["brease/enum/Enum"],function(Enum){"use strict";var ValueDisplayView=function(e,t,i){return void 0===i?(this.create(e,t),this.render(e),this):(i.render(e),i)},e=ValueDisplayView.prototype;return e.create=function(e,t){this.el=$("<output></output>"),this.el[0].classList.add("ValueDisplayView"),this.addElements(e),t[0].appendChild(this.el[0])},e.render=function e(t){this.zIndex(t),this.visible(t),this.showUnit(t),this.orientation(t),this.ellipsis(t),this.position(t),this.updateElements(t)},e.position=function(e){!0===e.ellipsis||void 0===e.ellipsis?this.el[0].style.width=e.width+"px":this.el[0].style.width="auto",void 0!==e.left&&(this.el[0].style.left=e.left+"px",this.el[0].style.right="initial"),void 0!==e.right&&(this.el[0].style.right=e.right+"px",this.el[0].style.left="initial"),this.el[0].style.height=e.height+"px",this.el[0].style.top=e.top+"px"},e.ellipsis=function(e){!0===e.ellipsis?this.el[0].classList.add("ellipsis"):this.el[0].classList.remove("ellipsis")},e.zIndex=function(e){void 0!==e.selected&&e.selected?this.el[0].style.zIndex=5:this.el[0].style.zIndex=0},e.visible=function(e){!0===e.visible?this.el[0].classList.remove("remove"):this.el[0].classList.add("remove")},e.orientation=function(e){e.orientation===Enum.Orientation.LTR||e.orientation===Enum.Orientation.RTL?this.el[0].classList.add("horizontal"):e.orientation!==Enum.Orientation.BTT&&e.orientation!==Enum.Orientation.TTB||this.el[0].classList.add("vertical")},e.addElements=function e(t){this.outputValEl=$("<span/>").attr("class","valueOutput").text(t.value),this.outputUnitEl=$("<span/>").attr("class","unitOutput").text(t.unitSymbol),this.outputArrowEl=$("<span/>").attr("class","arrowOutput"),this.el.append([this.outputValEl,this.outputUnitEl,this.outputArrowEl])},e.showUnit=function(e){!0===e.showUnit?this.outputUnitEl[0].classList.remove("remove"):this.outputUnitEl[0].classList.add("remove")},e.updateElements=function(e){this.outputValEl.text(e.value),this.outputUnitEl.text(e.unitSymbol)},e.dispose=function e(){this.el[0].classList.remove("horizontal","vertical")},ValueDisplayView}),define("widgets/brease/common/libs/Renderer",["brease/core/Class","libs/d3/d3","brease/core/Utils","brease/enum/Enum","widgets/brease/common/libs/ChartUtils","brease/events/BreaseEvent","globalize"],function(e,t,Utils,Enum,ChartUtils,BreaseEvent){"use strict";var i={enableZoomingBehavior:!0},s=e.extend(function Renderer(t,i){e.call(this),this.settings=void 0!==i?$.extend(!0,{},this.defaultSettings,i):Utils.deepCopy(this.defaultSettings),this.widget=t,this.dataAdapter=t.dataAdapter,this.clipPathId=Utils.uniqueID(this.widget.elem.id+"_svg_clipPath"),this.init()},i),n=s.prototype;n.init=function(){this.svg=t.select(this.widget.elem).append("svg").attr("width",this.widget.el.width()).attr("height",this.widget.el.height()),this.forceRepaint=_.throttle(a.bind(this),100,{trailing:!0,leading:!1}),this.mainZoomBehavior=null,this.savedX=null,this.savedY=null,this.scaleXY=null,this.scaleX=null,this.scaleY=null,this.roundScale=.05,this.previousMainScale=null,this.zoomBehaviorXAxes=[],this.zoomBehaviorYAxes=[],o(this),l(this),this.settings.enableZoomingBehavior&&g(this),A(this),d(this),this._createGraphIntersectionPoints(),k(this)},n.updateAxis=function(){c(this),this.settings.enableZoomingBehavior&&f(this)},n.updateCursor=function(){u(this)},n.updateGraphs=function(){this.forceRepaint(),L(this)},n.updateZoomLevelLimits=function(){p(this)},n.updateZoomType=function(e){b(this,e)},n.zoomIn=function(){P(this,this.widget.settings.zoomFactor,{x:0,y:0})},n.zoomOut=function(){P(this,1/this.widget.settings.zoomFactor,{x:0,y:0})},n.zoomReset=function(){var e=this.widget.getZoomType();e!==Enum.ChartZoomType.none&&(this.mainZoomBehavior.scale(1),this.mainZoomBehavior.translate([0,0]),this.previousMainScale=1,this.scaleX=1,this.scaleY=1),e===Enum.ChartZoomType.x?(this.savedX=null,this.savedY=0):e===Enum.ChartZoomType.y&&(this.savedX=0,this.savedY=null),y(this,!0)},n.scrollLeft=function(){P(this,1,{x:this.widget.settings.scrollFactor,y:0})},n.scrollRight=function(){P(this,1,{x:-this.widget.settings.scrollFactor,y:0})},n.scrollUp=function(){P(this,1,{x:0,y:this.widget.settings.scrollFactor})},n.scrollDown=function(){P(this,1,{x:0,y:-this.widget.settings.scrollFactor})},n.xCursorStepLeft=function(e,t){R(this,e,t)},n.xCursorStepRight=function(e,t){B(this,e,t)},n.xCursorDisableDrag=function(e){M(this,e)},n.xCursorEnableDrag=function(e){V(this,e)},n._updateGraphIntersectionPoints=function(){var renderer=this,e=this.dataAdapter.getChartArea();this.svg.select("g.chart").selectAll("g.intersectionPoints").each(function(e){var i=t.select(this);for(var s in e.xCursors){var n=e.xCursors[s],a=i.selectAll('circle[data-xCursorId="'+s+'"].marker'),r=renderer.widget.chartItems.xCursors[s],o=renderer.dataAdapter.xAxisAreas[r.axisWidget.elem.id].scale(n.xValue),l=renderer.dataAdapter.yAxisAreas[n.yValueAxes].scale(n.yValues);a.attr("cx",o).attr("cy",void 0!==l&&null!==l?l:renderer.dataAdapter.getChartArea().height).classed("disabled",!n.markerEnable).classed("active",n.markerActive).classed("remove",!n.markerVisible)}})};function a(){var renderer=this,e=renderer.svg.attr("style")||"";renderer.svg.attr("style","transform:rotateZ(0deg);"+e),r.call(renderer),renderer._timeoutRepaint=window.setTimeout(function(){renderer.svg.attr("style",e)},80)}function r(){this._timeoutRepaint&&window.clearTimeout(this._timeoutRepaint)}n.dispose=function(){r.call(this),this.forceRepaint.cancel()};function o(renderer){var e=renderer.dataAdapter.getChartArea();renderer.svg.append("defs").append("clipPath").attr("id",renderer.clipPathId).append("rect").attr("x",.5).attr("y",.5).attr("width",e.width-1).attr("height",e.height-1),renderer.svg.append("g").attr("class","chart").attr("transform","translate("+(e.x+.5)+","+(e.y+.5)+")").append("rect").attr("width",e.width).attr("height",e.height),renderer.svg.selectAll("g.xAxis").data(t.values(renderer.dataAdapter.getXAxisAreas())).enter().append("g").attr("class","axis xAxisArea").attr("transform",function(e){return"translate("+(e.x+.5)+","+(e.y+.5)+")"}),renderer.svg.selectAll("g.yAxis").data(t.values(renderer.dataAdapter.getYAxisAreas())).enter().append("g").attr("class","axis yAxisArea").attr("transform",function(e){return"translate("+(e.x+.5)+","+(e.y+.5)+")"})}function l(renderer){var e=renderer.dataAdapter.getChartArea();renderer.svg.selectAll("g.xAxisArea").each(function(i){var s=renderer.widget.chartItems.xAxis[i.id],n=t.select(this).append("g").attr("id",i.id+"_breaseChartXAxis").attr("class","xAxis").classed("disabled",!s.isEnabled()).classed("remove",s.isHidden).attr("fill","none").attr("transform",function(e){return"translate(0, "+("top"===e.info.position?e.height:0)+")"});n.append("rect").attr("id",i.id+"_rect").attr("height",s.settings.height).attr("width",e.width).attr("pointer-events","visible").attr("transform",function(e){return"translate(0, "+("top"===e.info.position?-1*e.height:0)+")"});var a=n[0][0];$(a).on(BreaseEvent.CLICK,s._bind("_clickHandler")),n.append("g").attr("transform","translate("+e.width/2+", "+("top"===i.info.position?-i.info.axisLabelDistance:i.info.axisLabelDistance)+")").append("text").attr("class","xAxisDescription").attr("dy","top"===i.info.position?"-0.03em":"0.75em").attr("text-anchor","middle")}),renderer.svg.selectAll("g.chart").append("g").attr("class","xGrid gridLines").attr("clip-path","url("+document.location.pathname+document.location.search+"#"+renderer.clipPathId+")"),renderer.svg.selectAll("g.chart").append("g").attr("class","yGrid gridLines").attr("clip-path","url("+document.location.pathname+document.location.search+"#"+renderer.clipPathId+")"),renderer.svg.selectAll("g.yAxisArea").each(function(i){var s=renderer.widget.chartItems.yAxis[i.id],n=t.select(this).append("g").attr("id",i.id+"_breaseChartYAxis").attr("class","yAxis").classed("disabled",!s.isEnabled()).classed("remove",s.isHidden).attr("fill","none").attr("transform",function(e){return"translate("+("left"===e.info.position?e.width:0)+", 0)"});n.append("rect").attr("id",i.id+"_rect").attr("height",e.height).attr("width",s.settings.width).attr("pointer-events","visible").attr("transform",function(e){return"translate("+("left"===e.info.position?-1*e.width:0)+",0)"});var a=n[0][0];$(a).on(BreaseEvent.CLICK,s._bind("_clickHandler")),n.append("g").attr("transform","rotate(-90) translate(-"+i.height/2+", "+("left"===i.info.position?-i.info.axisLabelDistance:i.info.axisLabelDistance)+")").append("text").attr("class","yAxisDescription").attr("dy","left"===i.info.position?"-0.03em":"0.75em").style("text-anchor","middle")})}function d(renderer){var e=renderer.dataAdapter.getChartArea();renderer.svg.select("g.chart").selectAll("g.xCursorAreas").data(t.values(renderer.dataAdapter.getXAxisCursorAreas())).enter().append("g").attr("class","xCursorArea").classed("disabled",function(e){return!renderer.widget.chartItems.xCursors[e.id].isEnabled()}).classed("remove",function(e){return!renderer.widget.chartItems.xCursors[e.id].isVisible()}).attr("clip-path","url("+document.location.pathname+document.location.search+"#"+renderer.clipPathId+")").append("rect").attr("class",function(e){return"cursor "+e.id}).classed("remove",function(e){return renderer.widget.chartItems.xCursors[e.id].isHidden}).attr("transform",function(e){return"translate("+(e.x+.5)+","+(e.y+.5)+")"}).attr("height",function(e){return e.height}).attr("width",function(e){return e.width}).style("fill","transparent").style("stroke","transparent"),renderer.svg.selectAll("g.xCursorArea").each(function(i){var s=renderer.widget.chartItems.xCursors[i.id],n=t.select(this).attr("id",i.id+"_breaseChartXAxisCursor").append("line").attr("class","cursor "+i.id).classed("remove",renderer.widget.chartItems.xCursors[i.id].isHidden).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",e.height)}),renderer.svg.selectAll("g.xCursorArea").each(function(e){var i=renderer.widget.chartItems.xCursors[e.id],s=t.select(this),n=s[0][0];$(n).on(BreaseEvent.CLICK,i._bind("_clickHandler"))})}function c(renderer){var e={top:[],bottom:[]};renderer.svg.selectAll("g.xAxisArea").each(function(i){var s=renderer.widget.chartItems.xAxis[i.id],n,a,r,o=t.svg.axis().scale(i.scale).orient(i.info.position).tickFormat(function(e){return W(renderer.dataAdapter.xAxisAreas[s.elem.id].info.format,e,renderer.dataAdapter.xAxisAreas[s.elem.id].info.type)});t.select(this).selectAll("g.xAxis").call(o),t.select(this).selectAll("text.xAxisDescription").text(s.getAxisLabel());var l=t.select(this).selectAll(".tick>text");l=ChartUtils.getMultiLine(l,i.info.position),ChartUtils.rotateTickLabels(l,i.info.position,i.info.tickLabelDistance,i.info.tickLabelRotation),n=Array.prototype.slice.call(renderer.widget.elem.getRootNode().getElementById(i.id+"_breaseChartXAxis").querySelectorAll(".tick text")),a=Math.min(ChartUtils.getNumberOfTickLabel(n,i),10),r=ChartUtils.getTickLabelValues(i.scale.domain(),a,i.info.type),e[i.info.position]=r,o=t.svg.axis().scale(i.scale).orient(i.info.position).tickFormat(function(e){return W(renderer.dataAdapter.xAxisAreas[s.elem.id].info.format,e,renderer.dataAdapter.xAxisAreas[s.elem.id].info.type)}).tickValues(r),t.select(this).selectAll("g.xAxis").call(o),l=t.select(this).selectAll(".tick>text"),l=ChartUtils.getMultiLine(l,i.info.position),ChartUtils.rotateTickLabels(l,i.info.position,i.info.tickLabelDistance,i.info.tickLabelRotation)}),renderer.svg.selectAll("g.yAxisArea").each(function(e){var i=renderer.widget.chartItems.yAxis[e.id],s=t.svg.axis().scale(e.scale).orient(e.info.position).tickFormat(function(e){return W(renderer.dataAdapter.yAxisAreas[i.elem.id].info.format,e,renderer.dataAdapter.yAxisAreas[i.elem.id].info.type)});t.select(this).selectAll("g.yAxis").call(s),t.select(this).selectAll("text.yAxisDescription").text(i.getAxisLabel()+" "+i.currentUnitSymbol());var n=t.select(this).selectAll(".tick>text");ChartUtils.rotateTickLabels(n,e.info.position,e.info.tickLabelDistance,e.info.tickLabelRotation)}),h(renderer,renderer.widget.settings.showGrid,e),L(renderer),u(renderer)}function h(renderer,e,i){var s=renderer.dataAdapter.getChartArea(),n=renderer.dataAdapter.getYAxisAreas(),a=null,r=null,o=null,l=renderer.dataAdapter.getXAxisAreas(),d=null,c=null,h=null,u,g,m,p;for(p in n)"left"===n[p].info.position&&(a=n[p]),"right"===n[p].info.position&&(r=n[p]);o=a||r;for(p in l)"bottom"===l[p].info.position&&(c=l[p]),"top"===l[p].info.position&&(d=l[p]);c?(h=c,u=i.bottom):(h=d,u=i.top),e&&h&&o?(g=t.svg.axis().scale(h.scale).outerTickSize(0).innerTickSize(-s.height).orient("top").tickValues(u),m=t.svg.axis().scale(o.scale).outerTickSize(0).innerTickSize(-s.width).orient("left"),renderer.svg.selectAll("g.xGrid").call(g),renderer.svg.selectAll("g.yGrid").call(m)):(renderer.svg.selectAll("g.xGrid").selectAll("*").remove(),renderer.svg.selectAll("g.yGrid").selectAll("*").remove())}function u(renderer){renderer.svg.selectAll("g.xCursorArea").each(function(e){var t=renderer.widget.chartItems.xCursors[e.id];if(t.axisWidget.elem.id){var i=renderer.dataAdapter.xAxisAreas[t.axisWidget.elem.id].scale(t._getValue());renderer.svg.select("rect."+e.id).attr("transform","translate("+(i-renderer.dataAdapter.settings.cursorAreaWidth/2)+", 0)"),renderer.svg.select("line."+e.id).attr("transform","translate("+i+", 0)")}}),renderer._updateGraphIntersectionPoints()}function g(renderer){renderer.mainZoomBehavior=m(renderer);var e="";for(e in renderer.dataAdapter.xAxisAreas)Object.prototype.hasOwnProperty.call(renderer.dataAdapter.xAxisAreas,e)&&(renderer.zoomBehaviorXAxes[e]=t.behavior.zoom());for(e in renderer.dataAdapter.yAxisAreas)Object.prototype.hasOwnProperty.call(renderer.dataAdapter.yAxisAreas,e)&&(renderer.zoomBehaviorYAxes[e]=t.behavior.zoom());renderer.svg.selectAll("g.chart").call(renderer.mainZoomBehavior)}function m(renderer){var e=renderer.widget.getMinZoomLevel()/100,i=renderer.widget.getMaxZoomLevel()/100,s=t.behavior.zoom().x(T(renderer)).y(D(renderer)).scaleExtent([e,i]).on("zoomstart",function(){t.event.sourceEvent&&(t.event.sourceEvent.stopPropagation(),t.event.sourceEvent.stopImmediatePropagation())}).on("zoom.stopPropagation",function(){t.event.sourceEvent&&(t.event.sourceEvent.stopPropagation(),t.event.sourceEvent.stopImmediatePropagation())}).on("zoom.throttledHandleZooming",_.throttle(_.partial(y,renderer),50,{trailing:!1,leading:!0})),n=s.scale();return renderer.scaleX=n,renderer.scaleY=n,renderer.scaleXY=n,renderer.previousMainScale=n,s}function p(renderer){renderer.mainZoomBehavior.scaleExtent([renderer.widget.getMinZoomLevel()/100,renderer.widget.getMaxZoomLevel()/100]),renderer.svg.selectAll("g.chart").call(renderer.mainZoomBehavior)}function f(renderer){var e=renderer.dataAdapter.getYAxisAreas(),t=renderer.dataAdapter.getXAxisAreas();renderer.svg.selectAll("g.xAxisArea").each(function(e){renderer.zoomBehaviorXAxes[e.id].x(t[e.id].scale)}),renderer.svg.selectAll("g.yAxisArea").each(function(t){renderer.zoomBehaviorYAxes[t.id].y(e[t.id].scale)}),v(renderer);var i=renderer.widget.chartItems.isDirty&&!0===renderer.widget.chartItems.isDirty.xaxis&&!0===renderer.widget.chartItems.isDirty.yaxis;y(renderer,i)}function b(renderer,e){v(renderer);var t=renderer.mainZoomBehavior,i=t.translate();e===Enum.ChartZoomType.xy&&(renderer.savedX=null,renderer.savedY=null),e===Enum.ChartZoomType.x&&(renderer.mainZoomBehavior.scale(renderer.scaleX),renderer.previousMainScale=renderer.scaleX,renderer.savedX=null,renderer.savedY=i[1]),e===Enum.ChartZoomType.y&&(renderer.mainZoomBehavior.scale(renderer.scaleY),renderer.previousMainScale=renderer.scaleY,renderer.savedX=i[0],renderer.savedY=null),e===Enum.ChartZoomType.none&&(renderer.savedX=i[0],renderer.savedY=i[1])}function v(renderer){var e=renderer.mainZoomBehavior,t=e.translate(),i=t;null!==renderer.savedX&&(i[0]=renderer.savedX),null!==renderer.savedY&&(i[1]=renderer.savedY),e.translate(i)}function y(renderer,e){var t=new CustomEvent("Zoomed");renderer.widget.dispatchEvent(t);var i=renderer.widget.getZoomType();if(i!==Enum.ChartZoomType.none){var s=renderer.mainZoomBehavior.scale()-renderer.previousMainScale,n=1+s/renderer.previousMainScale,a=Utils.getChromeScale(renderer.widget.elem),r=renderer.mainZoomBehavior.translate(),o=renderer.scaleX,l=renderer.scaleY;if(renderer.scaleX=renderer.scaleX*n,renderer.scaleY=renderer.scaleY*n,!renderer.widget.getInfiniteScroll()){renderer.scaleX=parseFloat(renderer.scaleX.toFixed(5)),renderer.scaleY=parseFloat(renderer.scaleY.toFixed(5)),renderer.scaleX<=1+renderer.roundScale&&(renderer.scaleX=1),renderer.scaleY<=1+renderer.roundScale&&(renderer.scaleY=1);var d;d=w(renderer),x(renderer,r,d.x,d.y,a),renderer.mainZoomBehavior.scale()<1&&renderer.mainZoomBehavior.scale(1)}if(i===Enum.ChartZoomType.xy||e){var h;h=w(renderer),renderer.scaleX=h.x,renderer.scaleY=h.y,h.limited?(renderer.scaleX=o,renderer.scaleY=l,renderer.mainZoomBehavior.scale(renderer.previousMainScale),renderer.mainZoomBehavior.translate(renderer.previousZoomTranslate)):(E(renderer,h.x,r),I(renderer,h.y,r))}else i===Enum.ChartZoomType.x?(renderer.scaleY=l,renderer.mainZoomBehavior.scale(renderer.scaleX),E(renderer,renderer.scaleX,r)):i===Enum.ChartZoomType.y&&(renderer.scaleX=o,renderer.mainZoomBehavior.scale(renderer.scaleY),I(renderer,renderer.scaleY,r));c(renderer),L(renderer),u(renderer),renderer.previousMainScale=renderer.mainZoomBehavior.scale(),renderer.previousZoomTranslate=renderer.mainZoomBehavior.translate()}else renderer.mainZoomBehavior.scale(renderer.previousMainScale)}function w(renderer){var e=renderer.widget.getMinZoomLevel()/100,t=renderer.widget.getMaxZoomLevel()/100,i={x:renderer.scaleX,y:renderer.scaleY,limited:!1};return i.x<e?i.x=e:renderer.scaleX>t&&(i.x=t),i.y<e?i.y=e:renderer.scaleY>t&&(i.y=t),i.x===renderer.scaleX&&i.y===renderer.scaleY||(i.limited=!0),i}function x(renderer,e,t,i,s){e[0]=C(renderer,t,e[0]),e[0]=Math.abs(e[0])>renderer.roundScale?e[0]:0,e[1]=S(renderer,i,e[1]),e[1]=Math.abs(e[1])>renderer.roundScale?e[1]:0,e=e.map(function(e){return e/s}),renderer.mainZoomBehavior.translate(e)}function E(renderer,e,t){var i="";for(i in renderer.zoomBehaviorXAxes)Object.prototype.hasOwnProperty.call(renderer.zoomBehaviorXAxes,i)&&renderer.zoomBehaviorXAxes[i].scale(e).translate(t)}function I(renderer,e,t){var i="";for(i in renderer.zoomBehaviorYAxes)Object.prototype.hasOwnProperty.call(renderer.zoomBehaviorYAxes,i)&&renderer.zoomBehaviorYAxes[i].scale(e).translate(t)}function C(renderer,e,t){for(var i=renderer.dataAdapter.chartArea.width,s=t,n=renderer.dataAdapter.graphs,a=0,r=0;r<n.length;r+=1){var o=n[r],l=o.xScale;if(o.coordinates.length>0){var d=i/((l.domain()[1]-l.domain()[0])*e),c=0,h=-((l.domain()[0]-l.domain()[1])*e+(l.range()[1]-(l.range()[1]-i*e/d)))*d-0;s>0?s=0:s<h&&(s=h)}}return s}function S(renderer,e,t){for(var i=renderer.dataAdapter.chartArea.height,s=t,n=renderer.dataAdapter.graphs,a=renderer.dataAdapter.getYAxesMinimum(),r=renderer.dataAdapter.getYAxesMaximum(),o=0,l=0;l<n.length;l+=1){var d=n[l],c=d.yScale;if(d.coordinates.length>0){var h=i/((c.domain()[1]-c.domain()[0])*e),u=((c.domain()[0]-c.domain()[1])*e+(r-a))*h*e+0,g=-((c.domain()[0]-c.domain()[1])*e+(r-(r-i*e/h)))*h-0;c.domain()[1]+s>r?s=0:s>u?s=u:s<g&&(s=g)}}return s}function T(renderer){for(var e in renderer.dataAdapter.xAxisAreas)if(Object.prototype.hasOwnProperty.call(renderer.dataAdapter.xAxisAreas,e))return renderer.dataAdapter.xScales[e];return null}function D(renderer){for(var e in renderer.dataAdapter.yAxisAreas)if(Object.prototype.hasOwnProperty.call(renderer.dataAdapter.yAxisAreas,e))return renderer.dataAdapter.yScales[e];return null}function A(renderer){renderer.svg.select("g.chart").selectAll("g.graph").data(renderer.dataAdapter.getGraphs()).enter().append("g").attr("clip-path","url("+document.location.pathname+document.location.search+"#"+renderer.clipPathId+")").attr("class","graph").each(function(e){var i=t.svg.area(),s=renderer.widget.chartItems.yValues[e.id];t.select(this).attr("id",e.id+"_breaseChartYValueList").append("path").datum(e.coordinates).attr("id",e.id+"_breaseChartYValueList_area").attr("class","area").style("stroke","none").attr("pointer-events","none").classed("disabled",!s.isEnabled()).classed("remove",s.isHidden).attr("d",i(e.coordinates));var n=t.svg.line(),a=t.select(this).append("path").attr("id",e.id+"_breaseChartYValueList_line").attr("class","graph").style("fill","none").classed("disabled",!s.isEnabled()).classed("remove",s.isHidden).attr("d",n(e.coordinates)),r=a[0][0];$(r).on(BreaseEvent.CLICK,s._bind("_clickHandler"))})}n._createGraphIntersectionPoints=function(){var renderer=this,e=this.dataAdapter.getChartArea();this.svg.select("g.chart").selectAll("g.intersectionPoints").data(this.dataAdapter.getGraphIntersectionPoints()).enter().append("g").attr("clip-path","url("+document.location.pathname+document.location.search+"#"+this.clipPathId+")").attr("class","intersectionPoints").each(function(i){var s=this;s.setAttribute("id",i.graphId+"_intersectionPoints"),Object.keys(i.xCursors).forEach(function(n){var a=i.xCursors[n],r=renderer.dataAdapter.yAxisAreas[a.yValueAxes].scale(a.yValues),o=renderer.widget.chartItems.xCursors[n];t.select(s).append("circle").attr("class","marker").attr("data-xCursorId",n).classed("active",a.markerActive).classed("disabled",!a.markerEnable).classed("remove",!a.markerVisible).attr("cx",renderer.dataAdapter.xAxisAreas[o.axisWidget.elem.id].scale(a.xValue)).attr("cy",void 0!==r&&null!==r?r:e.height).attr("r",a.markerSize/2);for(var l=renderer.widget.chartItems.xCursors[n],d=$(s)[0].children,c=0;c<d.length;c+=1)d[c].attributes[1].nodeValue===n&&$(d[c]).on(BreaseEvent.CLICK,l._bind("_clickHandler"))})})};function L(renderer){renderer.svg.select("g.chart").selectAll("g.graph").data(renderer.dataAdapter.getGraphs()).each(function(e){var i=e.yScale,s=e.xScale;if(!e.isHidden){var n=t.svg.area().interpolate(e.interpolationType).x(function(e){return s(e.x)}).y0(renderer.dataAdapter.chartArea.height).y1(function(e){return i(e.y)});t.select(this).selectAll("path.area").attr("d",n(e.coordinates));var a=t.svg.line().interpolate(e.interpolationType).x(function(e){return s(e.x)}).y(function(e){return i(e.y)});t.select(this).selectAll("path.graph").attr("d",a(e.coordinates))}})}function P(renderer,e,t){var i=renderer.mainZoomBehavior,s=renderer.dataAdapter.getChartArea(),n=[s.width/2,s.height/2],a={x:i.translate()[0],y:i.translate()[1],s:i.scale()},r=[(n[0]-a.x)/a.s,(n[1]-a.y)/a.s],o={x:a.x+s.width*t.x,y:a.y+s.height*t.y,s:i.scale()*e},l;o.s<i.scaleExtent()[0]?o.s=i.scaleExtent()[0]:o.s>i.scaleExtent()[1]&&(o.s=i.scaleExtent()[1]),l=[r[0]*o.s+a.x,r[1]*o.s+a.y],o.x+=n[0]-l[0],o.y+=n[1]-l[1],i.scale(o.s),i.translate([o.x,o.y]),y(renderer)}function O(renderer){return t.behavior.drag().on("dragstart",function(e){var i=t.event.sourceEvent.target.getAttribute("data-xCursorId"),s;e.currentXCursorId=i||e.id,s=renderer.widget.chartItems.xCursors[e.currentXCursorId],t.event.sourceEvent.stopPropagation(),s._getActive()||s.axisWidget._setActiveCursor(e.currentXCursorId)}).on("drag",function(e){var i=Utils.getChromeScale(renderer.widget.elem),s=t.event.x/i+renderer.dataAdapter.getChartArea().x/i-renderer.dataAdapter.getChartArea().x,n=e.currentXCursorId,a=(n,renderer.widget.chartItems.xCursors[n]),r=a.axisWidget._xPositions(a.cursorType),o=renderer.dataAdapter.xAxisAreas[a.axisWidget.elem.id].scale.invert(s),l=a._getValue(),d,c=t.bisectLeft(r,o),h=r[Math.max(c-1,0)],u=r[Math.min.apply(Math,[c,r.length-1,renderer.dataAdapter.xAxisCursorAreas[a.elem.id].maxAvailableXPositionIndex])],g=!1;for(var m in a.graphWidgets)a.graphWidgets[m].settings.visible&&(g=!0);g&&(d=+o-(+u+ +h)/2<0?h:u,d!==l&&a._updateValue(d))}).on("dragend",function(){})}function N(e,t){for(var i in e.graphWidgets)if(Object.prototype.hasOwnProperty.call(e.graphWidgets,i)){var s=e.graphWidgets[i].getIndexOfXCoordinate(t),n=e.graphWidgets[i].getNumberOfSamples();if(n<0||s<n&&s>=0)return!0}return!1}function k(renderer){var e=O(renderer);renderer.svg.selectAll("g.xCursorArea").each(function(i){if(renderer.widget.chartItems.xCursors[i.id].isEnabled()){t.select(this).call(e);Array.from(document.querySelectorAll("circle.marker")).filter(function(e){return e.getAttribute("data-xCursorId")===i.id}).forEach(function(i){t.select(i).call(e)})}})}function R(renderer,e,t){var i=renderer.widget.chartItems.xCursors[e],s=i.axisWidget._xPositions(i.cursorType).map(function(e){return+e}).indexOf(+i._getValue()),n;n=s-t>=0?s-t:s,n!==s&&(renderer.widget.chartItems.xCursors[e]._updateValue(i.axisWidget._xPositions(i.cursorType)[n]),u(renderer))}function B(renderer,e,t){var i=renderer.widget.chartItems.xCursors[e],s=i.axisWidget._xPositions(i.cursorType).map(function(e){return+e}).indexOf(+i._getValue()),n;n=s+t<=renderer.dataAdapter.xAxisCursorAreas[i.elem.id].maxAvailableXPositionIndex?s+t:s,n!==s&&(renderer.widget.chartItems.xCursors[e]._updateValue(i.axisWidget._xPositions(i.cursorType)[n]),u(renderer))}function M(renderer,e){var i=renderer.svg.selectAll("g.xCursorArea").filter(function(t){return t.id===e?this:null}),s=Array.from(document.querySelectorAll("circle.marker")).filter(function(t){return t.getAttribute("data-xCursorId")===e});i.on(".drag",null),s.forEach(function(e){t.select(e).on(".drag",null)})}function V(renderer,e){var i=renderer.svg.selectAll("g.xCursorArea").filter(function(t){return t.id===e?this:null}),s=Array.from(document.querySelectorAll("circle.marker")).filter(function(t){return t.getAttribute("data-xCursorId")===e}),n=O(renderer);i.call(n),s.forEach(function(e){t.select(e).call(n)})}function W(e,i,s){var n;switch(s){case"dateTime":return Globalize.format(i,e);case"secondsAsNumber":return n=t.format("0.6f"),n(i);default:var a=0===e.decimalPlaces?e.minimumIntegerDigits:e.minimumIntegerDigits+e.decimalPlaces+1;return n=t.format("0"+(i<0?a+1:a)+"."+e.decimalPlaces+"f"),n(i)}}return s});define("widgets/brease/common/libs/ReorderingByJson",["widgets/brease/common/libs/redux/utils/UtilsJSON"],function(UtilsJSON){"use strict";var ReorderingByJson={};return ReorderingByJson.helpers={utilsJson:UtilsJSON},ReorderingByJson.ordering=function e(t,i,s){for(var n=ReorderingByJson.helpers.utilsJson.convertJSONtoObject(t),a=[],r=0;r<n.length;r+=1)a.push(n[r].wRef);a.forEach(function(e){var t=$("#"+s+"_"+e).detach();i.append(t)})},ReorderingByJson.getOrder=function e(t){for(var i=[],s=0,n,a=t.find("> .breaseGridLineItem"),r=0;r<a.length;r+=1)n=brease.callWidget(a[r].id,"widget"),s=n.settings.parentContentId.length,i.push({wRef:a[r].id.slice(s+1),s:n.getStatus()});return ReorderingByJson.helpers.utilsJson.convertObjectToJSON(i)},ReorderingByJson}),define("widgets/brease/common/libs/ShakeElements",["widgets/brease/common/libs/ChildHandling"],function(ChildHandling){"use strict";var ShakeElements={};return ShakeElements.helpers={childHandling:ChildHandling},ShakeElements.startShaking=function e(t){if(t.length>0)for(var i=0;i<t.length;i+=1)i%2==0?$("#"+t[i]).addClass("shakeAlternate"):$("#"+t[i]).addClass("shake")},ShakeElements.stopShaking=function e(t){ShakeElements.helpers.childHandling.removeChildClasses(t,"shake shakeAlternate")},ShakeElements}),define("widgets/brease/common/libs/SVGUtils",[],function(){"use strict";var SVGUtils={},e;return SVGUtils.importToSVGNamespace=function(t){if(void 0===e&&(e=document.createElementNS("http://www.w3.org/2000/svg","svg")),t instanceof Element){var i=t.parentNode;e.innerHTML=t.outerHTML;var s=e.firstElementChild;return i.replaceChild(s,t),s}return t},SVGUtils}),define("widgets/brease/common/libs/TextEditor/Commands",["ace/ext/searchbox"],function(e){"use strict";var Commands={};Commands.commandList=["vCopy","vPaste","vCut","insertCharacter","removeline","copylinesdown","copylinesup","movelinesdown","movelinesup","removetolineend","removetolinestart","removewordleft","removewordright","selectall","selectleft","selectright","selectwordleft","selectwordright","selecttolineend","selecttolinestart","selectup","selectdown","selectup","selectpageup","selectpagedown","duplicateSelection","gotoleft","gotoright","gotowordleft","gotowordright","golineup","golinedown","golineup","gotolinestart","gotolineend","gotopageup","gotopagedown","gotostart","gotoend","scrolldown","scrollup","jumptomatching","find","replace","findnext","findprevious","indent","outdent","undo","redo","tolowercase","touppercase","overwrite","del","backspace"],Commands.addCommands=function(i){i.editor.commands.addCommand({name:"backspace",bindKey:t("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){if(void 0!==e.searchBox)if(e.searchBox.active&&e.searchBox.isFocused()){var t=e.searchBox.activeInput.selectionStart,i=e.searchBox.activeInput.selectionEnd,s=i-t+1;if(t>0){var n=e.searchBox.activeInput.value.split("");n.splice(t-1,s),e.searchBox.activeInput.value=n.join(""),e.searchBox.activeInput.setSelectionRange(t-1,t-1)}}else e.remove("left");else e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"}),i.editor.commands.addCommand({name:"del",bindKey:t("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){if(void 0!==e.searchBox)if(e.searchBox.active&&e.searchBox.isFocused()){var t=e.searchBox.activeInput.selectionStart,i=e.searchBox.activeInput.selectionEnd,s=i-t;if(s=0===s?1:s,t<e.searchBox.activeInput.value.length){var n=e.searchBox.activeInput.value.split("");n.splice(t,s),e.searchBox.activeInput.value=n.join(""),e.searchBox.activeInput.setSelectionRange(t,t)}}else e.remove("right");else e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"}),i.editor.commands.addCommand({name:"find",bindKey:t("Ctrl-F","Command-F"),exec:function(t){e.Search(t),i.addListenersSearchBox.apply(i)},readOnly:!0}),i.editor.commands.addCommand({name:"replace",bindKey:t("Ctrl-H","Command-Option-F"),exec:function(t){e.Search(t,!0),i.addListenersSearchBox.apply(i)}}),i.editor.commands.addCommand({name:"vCopy",exec:function(e){document.execCommand("copy"),i.setClipboardText(e.getCopyText())}}),i.editor.commands.addCommand({name:"vPaste",scrollIntoView:"cursor",exec:function(e){e.insert(i.getClipboardText())}}),i.editor.commands.addCommand({name:"vCut",exec:function(e){i.setClipboardText(e.getCopyText()),document.execCommand("cut")}}),i.editor.commands.addCommand({name:"insertCharacter",exec:function(e,t){document.execCommand("insertText",!1,t[0]),e.renderer.scrollCursorIntoView()}}),i.editor.commands.addCommand({name:"gotoleft",bindKey:t("Left","Left|Ctrl-B"),exec:function(e,t){if(void 0!==e.searchBox)if(e.searchBox.active&&e.searchBox.isFocused()){var i=Math.max(0,e.searchBox.activeInput.selectionStart-1);e.searchBox.activeInput.setSelectionRange(i,i)}else e.navigateLeft(t.times);else e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0}),i.editor.commands.addCommand({name:"gotoright",bindKey:t("Right","Right|Ctrl-F"),exec:function(e,t){if(void 0!==e.searchBox)if(e.searchBox.active&&e.searchBox.isFocused()){var i=e.searchBox.activeInput.selectionStart+1;e.searchBox.activeInput.setSelectionRange(i,i)}else e.navigateRight(t.times);else e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0}),i.editor.commands.addCommand({name:"gotolinestart",bindKey:t("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){void 0!==e.searchBox&&e.searchBox.active&&e.searchBox.isFocused()?e.searchBox.activeInput.setSelectionRange(0,0):e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0}),
i.editor.commands.addCommand({name:"gotolineend",bindKey:t("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){if(void 0!==e.searchBox)if(e.searchBox.active&&e.searchBox.isFocused()){var t=e.searchBox.activeInput.value.length+1;e.searchBox.activeInput.setSelectionRange(t,t)}else e.navigateLineEnd();else e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0}),i.editor.commands.addCommand({name:"overwrite",bindKey:"Insert",exec:function(e){void 0!==e.searchBox&&e.searchBox.active&&e.searchBox.isFocused()||e.toggleOverwrite()},readOnly:!0})},Commands.isValidCommand=function(e){return void 0!==e&&""!==e&&this.commandList.indexOf(e)>-1};function t(e,t){return{win:e,mac:t}}return Commands}),define("widgets/brease/common/libs/TextEditor/TextEditor",["ace/ace","widgets/brease/common/libs/TextEditor/Commands","brease/core/Utils","ace/ext/language_tools","ace/tooltip"],function(e,Commands,Utils,t,i){"use strict";var s="";function TextEditor(config){this.settings=n(config),this.settings.element instanceof Element&&(this._initAceElement(this.settings.element),this._createBoundFunctionCalls(),this._addEventListenersKeyboard(),this._addEventListenersDebug(),this.isEnabled()||this.disableInteraction(!0),Commands.addCommands(this),this.settings.keyboard&&(this.boundOnKeyboardInput=this.onKeyboardInput.bind(this),this.keyboard=new config.Keyboard))}TextEditor.prototype._initAceElement=function(i){this.editor=e.edit(i),this.editor.setTheme("ace/theme/"+this.settings.theme),this.editor.session.setMode("ace/mode/"+this.settings.mode),this.editor.setShowPrintMargin(!1),this.editor.setOption("hasCssTransforms",!0),this.editor.setOption("enableBasicAutocompletion",this.settings.enableBasicAutocompletion),this.editor.renderer.setShowGutter(this.settings.showLineNumber),this.editor.setHighlightGutterLine(this.settings.highlightGutter),this.editor.on("change",this.settings.onModified);var s=this.settings.autocompletionList;this.tooltipAnnotation="",this.tooltipTimeout=void 0,this.tooltip=new a(this.editor.container),this.gutter=this.editor.renderer.$gutter,this.staticWordCompleter={getCompletions:function(e,t,i,n,a){a(null,s.map(function(e){return{caption:e,value:e,meta:"static"}}))}},t.setCompleters([this.staticWordCompleter])},TextEditor.prototype.mousestopped=function(e){0===e.originalEvent.movementX&&0===e.originalEvent.movementY?this.showTooltip(e,e.clientX,e.clientY):this.hideTooltip()},TextEditor.prototype._createBoundFunctionCalls=function(){void 0!==this.boundOnFocus&&void 0!==this.boundOnBlur&&void 0!==this.boundOnGutterClick||(this.boundOnFocus=this.onFocus.bind(this),this.boundOnBlur=this.onBlur.bind(this),this.boundOnGutterClick=this.onGutterClick.bind(this))},TextEditor.prototype._addEventListenersKeyboard=function(){this.editor.on("focus",this.boundOnFocus),this.editor.on("blur",this.boundOnBlur)},TextEditor.prototype._addEventListenersDebug=function(){this.editor.on("guttermousedown",this.boundOnGutterClick)},TextEditor.prototype._removeEventListenersDebug=function(){this.editor.off("guttermousedown",this.boundOnGutterClick)},TextEditor.prototype.setMode=function(e){this.settings.mode=e,this.editor.session.setMode("ace/mode/"+this.settings.mode)},TextEditor.prototype.getMode=function(){return this.settings.mode},TextEditor.prototype.getKeyboard=function(){return this.settings.keyboard},TextEditor.prototype.setOnModified=function(e){this.editor.off("change",this.settings.onModified),this.settings.onModified=e,this.editor.on("change",this.settings.onModified)},TextEditor.prototype.getOnModified=function(){return this.settings.onModified},TextEditor.prototype.setClipboardText=function(e){s=e},TextEditor.prototype.getClipboardText=function(){return s},TextEditor.prototype.setValue=function(e,t){this.editor&&(this.editor.setValue(e),this.editor.clearSelection(),!0===t&&this.editor.getSession().getUndoManager().reset())},TextEditor.prototype.setAutocompleteDictionary=function(e){t.setCompleters([this.staticWordCompleter,e])},TextEditor.prototype.getValue=function(){return this.editor.getValue()},TextEditor.prototype.getSelectedText=function(){return this.editor.getSelectedText()},TextEditor.prototype.setShowLineNumber=function(e){this.settings.showLineNumber=e,this.editor.renderer.setShowGutter(e)},TextEditor.prototype.getShowLineNumber=function(){return this.settings.showLineNumber},TextEditor.prototype.appendText=function(e){var t=this.editor.session;t.insert({row:t.getLength(),column:0},"\n"+e)},TextEditor.prototype.getNumberOfLines=function(){return this.editor.session.getLength()},TextEditor.prototype.disable=function(e){this.settings.disabled=!0,this.disableInteraction(e)},TextEditor.prototype.enable=function(){this.settings.disabled=!1,this.enableInteraction()},TextEditor.prototype.disableInteraction=function(e,t){this.editor.off("focus",this.boundOnFocus),void 0!==this.editor.searchBox&&this.editor.searchBox.hide(),void 0!==this.cover&&this.cover.remove(),this.cover=document.createElement("div"),this.editor.container.appendChild(this.cover),this.cover.style.cssText="position:absolute;top:0;bottom:0;right:0;left:0;background:rgba(150,150,150,"+(e?.5:0)+");z-index:100",this.editor.renderer.scrollBarH.element.style.zIndex="101",this.editor.renderer.scrollBarV.element.style.zIndex="101",this.editor.renderer.$gutter.style.zIndex="101",this.editor.renderer.$cursorLayer.element.style.opacity=0,!0!==t&&this.editor.setOptions({highlightActiveLine:!1,highlightSelectedWord:!1,readOnly:!0,highlightGutterLine:!1}),this.editor.off("blur",this.boundOnBlur)},TextEditor.prototype.enableInteraction=function(){void 0!==this.cover&&this.cover.remove(),this.editor.renderer.$cursorLayer.element.style.opacity=1,this.editor.setOptions({highlightActiveLine:!0,highlightSelectedWord:!0,readOnly:!1,highlightGutterLine:this.settings.highlightGutter}),this._addEventListenersDebug(),this.settings.monitorMode||this._addEventListenersKeyboard()},TextEditor.prototype.isEnabled=function(){return!this.settings.disabled},TextEditor.prototype.resize=function(e){this.editor.resize(e)},TextEditor.prototype.dispose=function(){void 0!==this.editor&&(this.editor.off("change",this.settings.onModified),$(this.editor.container).children().off(),this.editor.destroy())},TextEditor.prototype.onFocus=function(){this.settings.keyboard&&this.openKeyboard()},TextEditor.prototype.onSearchFocus=function(){this.settings.keyboard&&this.openKeyboard()},TextEditor.prototype.onBlur=function(){this.editor.clearSelection(),this.settings.keyboard&&this.closeKeyboard()},TextEditor.prototype.onSearchBlur=function(){this.settings.keyboard&&this.closeKeyboard()},TextEditor.prototype.onGutterClick=function(e){if(-1!==e.domEvent.target.className.indexOf("ace_gutter-cell")){var t=e.getDocumentPosition().row;e.stop(),this.settings.onToggleBreakPoint(t)}},TextEditor.prototype.onKeyboardInput=function(e){var t=e.data.action,i=e.data.args;Commands.isValidCommand(t)?this.editor.execCommand(t,i):"close"===t&&(this.keyboard.removeCallback(this.boundOnKeyboardInput),this.editor.blur())},TextEditor.prototype.openKeyboard=function(){void 0!==this.keyboard&&(this.keyboard.show(),this.keyboard.addCallback(this.boundOnKeyboardInput))},TextEditor.prototype.closeKeyboard=function(){void 0!==this.keyboard&&(this.keyboard.hide(),this.keyboard.removeCallback(this.boundOnKeyboardInput))},TextEditor.prototype.addListenersSearchBox=function(){this.listenersAdded||($(this.editor.container).find(".ace_search_field").on("focus",this.onSearchFocus.bind(this)),$(this.editor.container).find(".ace_replace_field").on("focus",this.onSearchFocus.bind(this)),$(this.editor.container).find(".ace_search_field").on("blur",this.onSearchBlur.bind(this)),$(this.editor.container).find(".ace_replace_field").on("blur",this.onSearchBlur.bind(this)),this.listenersAdded=!0,this.openKeyboard())},TextEditor.prototype.disableMonitorMode=function(){this.settings.monitorMode=!1,$(this.editor.container).removeClass("ace-debugging"),this.removeAllHighlightLines(),this.editor.getSession().clearBreakpoints(),this.isEnabled()?this.enableInteraction():this.disableInteraction(!0)},TextEditor.prototype.enableMonitorMode=function(){this.settings.monitorMode=!0,$(this.editor.container).addClass("ace-debugging"),this.disableInteraction(!this.isEnabled(),!1)},TextEditor.prototype.setBreakPointList=function(e){void 0!==e&&this.editor.getSession().setBreakpoints(e)},TextEditor.prototype.clearBreakPointList=function(){this.editor.getSession().clearBreakpoints()},TextEditor.prototype.moveToLine=function(e,t){var i=t?1/0:0;this.editor.moveCursorTo(e,i),this.scrollToLine(e)},TextEditor.prototype.scrollToLine=function(e){this.editor.isRowFullyVisible(e)||this.editor.scrollToLine(e,!1,!0,function(){})},TextEditor.prototype.highlightLine=function e(t,i,s){var n=0,a=!1;for(n=0;n<this.settings.highlightedLines.length;n+=1)if(this.settings.highlightedLines[n].id===i){this.editor.session.removeMarker(this.settings.highlightedLines[n].marker.id),this.settings.highlightedLines[n].marker=this.editor.session.highlightLines(t,t,"",0),a=!0;break}if(!a){var r={id:i,marker:void 0};r.marker=this.editor.session.highlightLines(t,t,"",0),this.settings.highlightedLines.push(r)}s&&this.scrollToLine(t)},TextEditor.prototype.removeAllHighlightLines=function e(){var t=0;for(t=0;t<this.settings.highlightedLines.length;t+=1)this.editor.session.removeMarker(this.settings.highlightedLines[t].marker.id);this.settings.highlightedLines=[]},TextEditor.prototype.showTooltip=function(e,t){if(0!==e.length){var i;e&&!t?i="No value available":e&&t&&(i="value: "+t);var s={text:[e,i]};this.tooltipAnnotation!==s&&(this.tooltipAnnotation=s.text.join("<br/>"),this.tooltip.setHtml(this.tooltipAnnotation),this.tooltip.show(),this.editor._signal("showGutterTooltip",this.tooltip),this.editor.on("mousewheel",this.hideTooltip))}},TextEditor.prototype.getLine=function(e){return this.editor.session.getLine(e)},TextEditor.prototype.getCursorInformation=function(e){return this.editor.renderer.screenToTextCoordinates(e.clientX,e.clientY)},TextEditor.prototype.hideTooltip=function(){this.tooltipTimeout&&(this.tooltipTimeout=clearTimeout(this.tooltipTimeout)),this.tooltipAnnotation&&(this.tooltip.hide(),this.tooltipAnnotation=null,this.editor._signal("hideGutterTooltip",this.tooltip),this.editor.removeEventListener("mousewheel",this.hideTooltip))},TextEditor.prototype.moveTooltip=function(e){var t=this.tooltip.getElement().style;t.left=e.clientX+10+"px",t.top=e.clientY+10+"px"},TextEditor.prototype.updateHScrollBar=function(){this.editor.renderer.$updateScrollBarH()};function n(config){var e=config instanceof Object?config:{};return{element:e.element,mode:Utils.isString(e.mode)?e.mode:"plain",theme:Utils.isString(e.theme)?e.theme:"brace",onModified:Utils.isFunction(e.onModified)?e.onModified:function e(){},onToggleBreakPoint:Utils.isFunction(e.onToggleBreakPoint)?e.onToggleBreakPoint:function(){},disabled:!!e.disabled,keyboard:Utils.isObject(e.Keyboard),showLineNumber:!1!==e.showLineNumber,highlightGutter:!1!==e.highlightGutter,enableBasicAutocompletion:!0===e.autocomplete,autocompletionList:e.autocompletelist?e.autocompletelist:[],monitorMode:!1,highlightedLines:[]}}function a(e){i.Tooltip.call(this,e)}return TextEditor}),define("widgets/brease/common/libs/WebSocket",["brease/core/Class","brease/core/Utils"],function(e,Utils){"use strict";var t=4194304,i={WARNING:0,CONNECTION_ATTEMPT_CONNECTED:1,DISCONNECTION_ATTEMPT_DISCONNECTED:2,SEND_MSG_DISCONNECTED:3,SOCKET_ERRORS:999,HOST_NOT_REACHEABLE:1e3,CONNECTION_CLOSED_CLIENT:1005,CONNECTION_CLOSED_SERVER:1006,CONNECTION_ERRORS:1999,WRONG_HOST:2e3,WRONG_PORT:2001,UNEXPECTED_ERROR_CONNECTION:2002,UNEXPECTED_ERROR_SOCKET:2003,WRONG_PROTOCOL_IN_CONNECTION:2004,CRITICAL_ERRORS:3e3,BUFFER_FULL:3001,BUFFER_NOT_ENOUGH_DATA:3002},s=e.extend(function i(){e.apply(this,arguments),this._resolver,this._rejecter,this.textDecoder=new TextDecoder,this.buffer=new ArrayBuffer(t),this.bufferView=new Uint8Array(this.buffer),this.bytesQueued=0,this.endIndex=0,this.beginIndex=0},null),n=s.prototype;n.getString=function(e){var t=this;return this.getBytesFromBuffer(e).then(function(e){return t.textDecoder.decode(e)}).catch(function(){return Promise.reject(new Error("Connection closed"))})},n.getDataView=function(e){return this.getBytesFromBuffer(e).then(function(e){return new DataView(e)}).catch(function(){return Promise.reject(new Error("Connection closed"))})},n.getBytesFromBuffer=function(e){var t=this;return this.bytesQueued>=e?(this.queueingBytes=!1,Promise.resolve(o(e,t))):(this.queueingBytes=!0,this.byteToQueue=e,new Promise(function(e,i){t._resolver=e,t._rejecter=i}))},n.connect=function(e,t){this.onError=!1;var s=a(e,t);if(0===s)this.errorHandling(i.WRONG_HOST);else if(1===s)this.errorHandling(i.WRONG_PORT);else if(2===s)this.errorHandling(i.WRONG_PROTOCOL_IN_CONNECTION);else if(void 0===this.WSocket||this.WSocket.readyState===WebSocket.CLOSED||this.WSocket.readyState===WebSocket.CLOSING)try{this.WSocket=new WebSocket(s),this.WSocket.onmessage=this.socketReceivedMessage.bind(this),this.WSocket.onopen=this.socketOpened.bind(this),this.WSocket.onclose=this.socketClosed.bind(this),this.WSocket.onerror=this.socketError.bind(this)}catch(e){this.errorHandling(i.UNEXPECTED_ERROR_CONNECTION)}else this.errorHandling(i.CONNECTION_ATTEMPT_CONNECTED)},n.disconnect=function(){void 0!==this.WSocket?this.WSocket.readyState===WebSocket.OPEN||this.WSocket.readyState===WebSocket.CONNECTING?(this.WSocket.close(),this.WSocket.onmessage=function(){},this.WSocket=void 0):this.errorHandling(i.UNEXPECTED_ERROR_CONNECTION):this.errorHandling(i.DISCONNECTION_ATTEMPT_DISCONNECTED)},n.sendMessage=function(e){void 0!==this.WSocket&&this.WSocket.readyState===WebSocket.OPEN&&this.WSocket.send(e)},n.dispose=function(){void 0!==this.WSocket&&(this.WSocket.onmessage=function(){},this.WSocket.onopen=function(){},this.WSocket.onclose=function(){},this.WSocket.onerror=function(){},this.disconnect()),this.bytesQueued=0,this.endIndex=0,this.beginIndex=0,e.prototype.dispose.apply(this,arguments)},n.socketReceivedMessage=function(e){var t=this,i=new FileReader;i.onload=function(){void 0!==t.WSocket&&(r(i.result,t),t.onMessageRecived(),t.queueingBytes&&t.bytesQueued>=t.byteToQueue&&(t._resolver(o(t.byteToQueue,t)),t.queueingBytes=!1))},i.readAsArrayBuffer(e.data)},n.socketOpened=function(e){this.bytesQueued=0,this.endIndex=0,this.beginIndex=0,this.onConnect(e)},n.socketClosed=function(e){this.bytesQueued=0,this.endIndex=0,this.beginIndex=0,this.queueingBytes&&this._rejecter(),e.code!==i.CONNECTION_CLOSED_CLIENT?this.errorHandling(e.code):this.onError||this.onDisconnect()},n.socketError=function(){this.bytesQueued=0,this.endIndex=0,this.beginIndex=0,this.queueingBytes&&this._rejecter(),this.errorHandling(i.UNEXPECTED_ERROR_SOCKET)},n.errorHandling=function(e){e<=i.SOCKET_ERRORS?this.onWarning(e):this.onError||(this.onError=!0,e>=i.CRITICAL_ERRORS&&this.disconnect(),this.onConnectionFailed(e))},n.onMessageRecived=function(){},n.onConnect=function(){},n.onDisconnect=function(){},n.onConnectionFailed=function(){},n.onWarning=function(){};function a(e,t){var i="";if(!Utils.isString(e))return 0;var s=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(e),n=/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/.test(e);if(!s&&!n)return 0;if(!Utils.isNumeric(t))return 1;if(t<0||t>65535)return 1;if("http:"===window.location.protocol)i="ws://";else{if("https:"!==window.location.protocol)return 2;i="wss://"}return i+window.location.host+"/ws2tcp?host="+e+"&port="+t}function r(e,s){if(s.bytesQueued+e.byteLength>t)s.errorHandling(i.BUFFER_FULL);else{if(s.endIndex+e.byteLength<t+1)s.bufferView.set(new Uint8Array(e),s.endIndex),s.endIndex=s.endIndex+e.byteLength,s.endIndex===t&&(s.endIndex=0);else{var n=e.slice(0,t-s.endIndex),a=e.slice(t-s.endIndex);s.bufferView.set(new Uint8Array(n),s.endIndex),s.bufferView.set(new Uint8Array(a),0),s.endIndex=s.endIndex+e.byteLength-t}s.bytesQueued=s.bytesQueued+e.byteLength}}function o(e,s){if(!(e>s.bytesQueued)){var n;if(s.beginIndex+e<t+1)n=s.buffer.slice(s.beginIndex,e+s.beginIndex),s.beginIndex=s.beginIndex+e;else{var a=t-s.beginIndex,r=e-a,o=s.buffer.slice(s.beginIndex),l=s.buffer.slice(0,r),d;n=new ArrayBuffer(e),d=new Uint8Array(n),d.set(new Uint8Array(o)),d.set(new Uint8Array(l),a),s.beginIndex=r}return s.bytesQueued=s.bytesQueued-e,n}s.errorHandling(i.BUFFER_NOT_ENOUGH_DATA)}return s}),define("widgets/brease/common/libs/wfUtils/UtilsLocalize",["libs/d3/d3"],function(e){"use strict";var UtilsLocalize={};return UtilsLocalize.getTimeFormatD3=function(t){t=t||brease.culture.getCurrentCulture().key;var i;i=null===Globalize.findClosestCulture(t)?Globalize.cultures[Globalize.cultures.default.name]:Globalize.cultures[t];var s=e.locale({dateTime:i.calendar.patterns.F,date:i.calendar.patterns.D,time:i.calendar.patterns.T,periods:[null===i.calendar.AM?"AM":i.calendar.AM[0],null===i.calendar.PM?"PM":i.calendar.PM[0]],days:i.calendar.days.names,shortDays:i.calendar.days.namesAbbr,months:i.calendar.months.names.slice(0,12),shortMonths:i.calendar.months.namesAbbr.slice(0,12)}),n=[[s.timeFormat.utc("%Y"),function(){return!0}],[s.timeFormat.utc("%B"),function(e){return e.getUTCMonth()}],[s.timeFormat.utc("%b %d"),function(e){return 1!==e.getUTCDate()}],[s.timeFormat.utc("%a %d"),function(e){return e.getUTCDay()&&1!==e.getUTCDate()}],[s.timeFormat.utc("%H:%M"),function(e){return e.getUTCHours()}],[s.timeFormat.utc("%H:%M"),function(e){return e.getUTCMinutes()}],[s.timeFormat.utc("%Ss"),function(e){return e.getUTCSeconds()}],[s.timeFormat.utc("%Lms"),function(e){return e.getUTCMilliseconds()}]];return function(e){return function(t){for(var i=e.length-1,s=e[i];!s[1](t);)i-=1,s=e[i];return s[0](t)}}(n)},UtilsLocalize}),define("widgets/brease/common/libs/wfUtils/UtilsObject",["brease/core/Utils"],function(Utils){"use strict";var UtilsObject={createFormatObject:function(e,t,i){var s=UtilsObject.parseObject(t,i);return s=s||{},Utils.isObject(e)&&e.default&&(s.default=Utils.deepCopy(e.default)),s},parseObject:function(e,t){var i=null;if(Utils.isObject(e)||null===e)i=e;else if(brease.language.isKey(e)){var s=brease.language.parseKey(e);if(i=Utils.parsePseudoJSON(brease.language.getTextByKey(s),t),!i)return null}else if(Utils.isString(e)&&(i=Utils.parsePseudoJSON(e,t),!i))return null;return i}};return UtilsObject}),define("widgets/brease/common/libs/wfUtils/Utils_FileTransfer",[],function(){"use strict";var Utils_FileTransfer={};Utils_FileTransfer.transferFileToClient=function(t){this.widget=t,this.settings=e(t.settings),this.targetHostname=location.hostname,this.targetPort=location.port,this.executeHTTPTransfer()},Utils_FileTransfer.executeHTTPTransfer=function(){var e=document.createElement("a");e.download=this.settings.fileName,e.href=this.buildTransferUrl(),document.body.appendChild(e),e.click(),document.body.removeChild(e)},Utils_FileTransfer.buildTransferUrl=function(){return"http://"+this.targetHostname+":"+this.targetPort+"/FileDevice:"+this.settings.fileDeviceName+this.settings.filePath+this.settings.fileName},Utils_FileTransfer.executeFTPTransfer=function(e,t,i){var s="ftp://"+i.FTPUser+":"+i.FTPPass+"@"+this.targetHost+i.filePath+i.filename,n=i.filename,a=document.createElement("a");a.download=n,a.href=s,a.click()};function e(e){return/^\//.test(e.filePath)||(e.filePath="/"+e.filePath),/\/$/.test(e.filePath)||(e.filePath=e.filePath+"/"),e}return Utils_FileTransfer}),define("text!widgets/brease/DataHandlerWidget/DataHandlerWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/DataHandlerWidget">CONTENT</div>\r\n'}),define("text!widgets/brease/DateTimeInput/DateTimeInput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TimeInput"></div>\r\n'}),define("widgets/brease/DateTimeInput/libs/FocusHandler",["brease/events/BreaseEvent","brease/helper/DateFormatter","brease/enum/Enum","brease/controller/libs/KeyActions","brease/core/Utils"],function(BreaseEvent,e,Enum,KeyActions,Utils){"use strict";var t=[Enum.KeyAction.ScrollDown,Enum.KeyAction.ScrollUp,Enum.KeyAction.ScrollRight,Enum.KeyAction.ScrollLeft,Enum.KeyAction.ScrollDownFast,Enum.KeyAction.ScrollUpFast],FocusHandler=function(e){this.widget=e,this.editMode=!1,this.showTimePicker=!0,this.closeTimePicker=!1,brease.config.isKeyboardOperationEnabled()&&(this.widget.el.on(BreaseEvent.FOCUS_OUT,this.onFocusOut.bind(this)),this.widget.el.on(BreaseEvent.BEFORE_ENABLE_CHANGE,this.onBeforeStateChange.bind(this)),this.widget.el.on(BreaseEvent.BEFORE_VISIBLE_CHANGE,this.onBeforeStateChange.bind(this)))},i=FocusHandler.prototype,s="elementFocus";i.handleKeyDown=function(e){var i=KeyActions.getActionForKey(e.key);this.showTimePicker=!0,this.closeTimePicker=!1,this.editMode?this.editModeKeyDownHandler(i,e):"any"===brease.config.keyboardHandling.onStart.action?i===Enum.KeyAction.Accept?f.call(this):t.includes(i)?(this.widget.showTimePicker(),f.call(this),this.editModeKeyDownHandler(i,e)):i===Enum.KeyAction.Cancel&&b.call(this):i===Enum.KeyAction.Accept?f.call(this):i===Enum.KeyAction.Cancel&&b.call(this),this.widget.internalData.timePickerOpen&&(this.editMode=!0)},i.editModeKeyDownHandler=function(e,t){e===Enum.KeyAction.ScrollDown?(u.call(this,1),y(t)):e===Enum.KeyAction.ScrollUp?(u.call(this,-1),y(t)):e===Enum.KeyAction.ScrollRight?(g.call(this,1),y(t)):e===Enum.KeyAction.ScrollLeft?(g.call(this,-1),y(t)):e===Enum.KeyAction.ScrollDownFast?(u.call(this,5),y(t)):e===Enum.KeyAction.ScrollUpFast?(u.call(this,-5),y(t)):e===Enum.KeyAction.Accept?c.call(this)?this.widget.setValue(this.widget.oldValue):(this.widget.timePicker._submitValue(t),v.call(this),this.closeTimePicker=!0,this.showTimePicker=!1):e===Enum.KeyAction.Cancel&&b.call(this)},i.onFocusOut=function(e){this.editMode&&("focus"===brease.config.keyboardHandling.onEnd.action?(this.widget.timePicker._submitValue(e),v.call(this)):"accept"===brease.config.keyboardHandling.onEnd.action&&b.call(this))},i.onBeforeStateChange=function(e){e.detail.value||b.call(this)},i.dispose=function(){this.widget.el.off(BreaseEvent.FOCUS_OUT).off(BreaseEvent.BEFORE_ENABLE_CHANGE).off(BreaseEvent.BEFORE_VISIBLE_CHANGE),this.widget=void 0},i.focusLeftColumn=function(){var e=o.call(this,this.widget);(this.widget.timePicker.DateTimePickerObjArray.forEach(function(e){e.$el?(e.$el[0].style.padding="",Utils.removeClass(e.$el[0],s)):(e[0].style.padding="",Utils.removeClass(e[0],s))}),void 0!==e)&&(Utils.addClass(e.$el[0],s),n(e,Utils.getHighestZindex(document.querySelectorAll(".dtfragment, .dateTimePickerReset, .dateTimePickerEnter"))),r())},i.removeFocusSelectedColumn=function(){this.widget.timePicker.el.find("."+s).removeClass(s)};function n(e,t){e.$el.css("z-index",t+1)}function a(e,t){e.css("z-index",t+1)}function r(){var e=$("."+s).css("outline-offset"),t=5,i;if(e=parseInt(e,10),-1===Math.sign(e))for(var n=document.querySelectorAll(".dtfragment"),a=n.length,r=5+e,o=0;o<a;o+=1)i=$(n[o]),i.css("padding",""),o===a-1?i.css("margin-right",e+"px"):0===o?(i.css("margin-left",e+"px"),i.css("margin-right",r+"px")):i.css("margin-right",r+"px"),i.css("padding","0 "+-1*e+"px")}function o(t){var i=e.getFormat4Pattern(t.settings.format);return i||(i=t.settings.format),l.call(this,i)}function l(e){return-1!==e.indexOf("y")||-1!==e.indexOf("Y")?this.widget.timePicker.DateTimePickerYear:-1!==e.indexOf("M")?this.widget.timePicker.DateTimePickerMonth:-1!==e.indexOf("d")||-1!==e.indexOf("D")?this.widget.timePicker.DateTimePickerDay:-1!==e.indexOf("h")||-1!==e.indexOf("H")?this.widget.timePicker.DateTimePickerHour:-1!==e.indexOf("m")?this.widget.timePicker.DateTimePickerMinute:-1!==e.indexOf("s")||-1!==e.indexOf("S")?this.widget.timePicker.DateTimePickerSecond:void 0}function d(e){return e.hasClass("year")?this.widget.timePicker.DateTimePickerYear:e.hasClass("month")?this.widget.timePicker.DateTimePickerMonth:e.hasClass("day")?this.widget.timePicker.DateTimePickerDay:e.hasClass("hour")?this.widget.timePicker.DateTimePickerHour:e.hasClass("minute")?this.widget.timePicker.DateTimePickerMinute:e.hasClass("second")?this.widget.timePicker.DateTimePickerSecond:e.hasClass("dateTimePickerReset")?this.widget.timePicker.btnReset:e.hasClass("dateTimePickerEnter")?this.widget.timePicker.btnEnter:void 0}function c(){return $(".dateTimePickerReset").hasClass(s)}function h(e,t){var i=0;return Object.keys(e).forEach(function(s){e[s]&&e[s].columnIndex&&(i=e[s].columnIndex,t&&t.columnIndex&&e[s].columnIndex===t.columnIndex+1&&(i=e[s].columnIndex))}),i}function u(e){var t=this.widget.timePicker.el.find("."+s),i,n;if(n=d.call(this,t),void 0!==n){i=n.index;var a=parseInt(i,10)+e;a<=-1?p.call(this,0,n):a>=n.data.length?p.call(this,n.data.length-1,n):p.call(this,a,n)}}function g(e){var t=this.widget.timePicker.el.find("."+s),i=d.call(this,t),a=this.widget.timePicker.DateTimePickerObjArray,r,o=a[7],l=a[6];r=h(a,i),void 0===i&&this.focusLeftColumn(),Utils.removeClass(t[0],s);var c=Utils.getHighestZindex(document.querySelectorAll(".dtfragment, .dateTimePickerReset, .dateTimePickerEnter"));Utils.removeClass(t[0],s),a.forEach(function(t){t&&i&&t.columnIndex&&(t.columnIndex===i.columnIndex+e&&(Utils.addClass(t.$el[0],s),n(t,c)),m(e,i,l,o,t,c,r))})}function m(e,t,i,r,o,l,d){1===e?".dateTimePickerReset"===t.selector?(Utils.addClass(i[0],s),a(i,l)):".dateTimePickerEnter"===t.selector?1===o.columnIndex&&(Utils.addClass(o.$el[0],s),n(o,l)):t.columnIndex===d&&(Utils.addClass(r[0],s),a(r,l)):-1===e&&(".dateTimePickerReset"===t.selector?o.columnIndex===d&&(Utils.addClass(o.$el[0],s),n(o,l)):".dateTimePickerEnter"===t.selector?(Utils.addClass(r[0],s),a(r,l)):1===t.columnIndex&&(Utils.addClass(i[0],s),a(i,l)))}function p(e,t){"function"==typeof t._setIndex&&t._setIndex(e)}function f(){this.editMode=!0,this.focusLeftColumn()}function b(){v.call(this),this.widget.timePicker.hide()}function v(){this.editMode&&(this.editMode=!1)}function y(e){e.stopPropagation(),e.preventDefault()}return FocusHandler}),define("widgets/brease/DateTimePicker/libs/SliderWheel",["brease/core/Class","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var SliderWheel=e.extend(function SliderWheel(t,s,n){if(e.call(this),"function"!=typeof n)throw new SyntaxError("callback required");this.callback=n,this.$el=t,this.settings=s,this.itemHeight=i.itemHeight,this.initialize()},null),t=SliderWheel.prototype,i={itemHeight:40};t.initialize=function(){var e=$('<div class="marker">'),t=$('<div class="marker">');this.fragment=$('<div class="fragment"></div>'),this.data=[],this.drawSlider(),this.$el.append([e,t,this.fragment]),this.fragment.on(BreaseEvent.MOUSE_DOWN,this._bind("_onMouseDown")),this._setIndex(0)},t.drawSlider=function(){var e=0,t,i="";if(void 0!==this.settings.range){for(var n=this.settings.range.start;n<=this.settings.range.end;n+=this.settings.range.offset)t=void 0!==this.settings.digits?s(n,this.settings.digits):n,i+='<button data-index="'+e+'" data-value="'+n+'">'+t+"</button>",this.data[e]={value:n,text:t},e+=1;this.offset=0,this.max=2*this.itemHeight,this.min=(e-3)*-this.itemHeight}else if(void 0!==this.settings.data){for(var a in this.settings.data)i+='<button data-index="'+e+'" data-value="'+this.settings.data[a].value+'">'+this.settings.data[a].text+"</button>",this.data[e]={value:this.settings.data[a].value,text:this.settings.data[a].text},e+=1;this.offset=0,this.max=2*this.itemHeight,this.min=(e-3)*-this.itemHeight}this.fragment.append(i)},t.dispose=function(){this.$el.empty(),this.callback=null},t.update=function(e){for(var t=0;t<e.length;t+=1){var i=e[t];this.fragment.find("[data-value="+i.value+"]").html(i.text)}},t._onClick=function(e){e.originalEvent.preventDefault();var t=$(e.target).attr("data-index");void 0!==t&&this._setIndex(t)},t._onMouseDown=function(e){this.oldOffset=this.offset,e.originalEvent.preventDefault(),e.originalEvent.touches?this.pageY=e.originalEvent.touches[0].pageY-this.offset:this.pageY=e.pageY-this.offset,this.fragment.removeClass("transition"),brease.docEl.on(BreaseEvent.MOUSE_MOVE,this._bind("_onMouseMove")),brease.docEl.on(BreaseEvent.MOUSE_UP,this._bind("_onMouseUp"))},t._onMouseMove=function(e){var t,i;t=e.originalEvent.touches?e.originalEvent.touches[0].pageY:e.pageY,i=t-this.pageY,i>=this.min&&i<=this.max&&(this.offset=t-this.pageY),this.fragment.css("top",this.offset)},t._onMouseUp=function(e){if(brease.docEl.off(BreaseEvent.MOUSE_MOVE,this._bind("_onMouseMove")),brease.docEl.off(BreaseEvent.MOUSE_UP,this._bind("_onMouseUp")),this.offset!==this.oldOffset){var t=Math.round(this.offset/-this.itemHeight+2);this._setIndex(t)}else this._onClick(e)},t._setIndex=function(e){this.index=e;var t=e*-this.itemHeight+2*this.itemHeight,i=this.data[e].value;this.fragment.addClass("transition"),this.fragment.css("top",t),this.offset=t,this.callback(i)},t.getValue=function(){return this.data[this.index].value},t.setValue=function(e){var t=this.fragment.find("button[data-value='"+e+"']"),i;t.length>0&&(i=t.attr("data-index")),void 0!==i&&this._setIndex(i)},t.show=function(){this.$el.show()},t.hide=function(){this.$el.hide()},t.detach=function(){this.$el.detach()},t.insert=function(){this.$el.appendTo(".dateTimePickerButtons")};function s(e,t){var i=e+"";return i.length<t?(i="000000000"+i,i.substr(i.length-t)):i}return SliderWheel}),define("widgets/brease/DateTimePicker/DateTimePicker",["widgets/brease/Window/Window","widgets/brease/DateTimePicker/libs/SliderWheel","brease/events/BreaseEvent","brease/helper/DateFormatter","brease/decorators/CultureDependency"],function(e,SliderWheel,BreaseEvent,t,i){"use strict";var s={html:"widgets/brease/DateTimePicker/DateTimePicker.html",stylePrefix:"widgets_brease_DateTimePicker",dateTimeFormat:"S",modal:!0,scale2fit:!0},n=e.extend(function DateTimePicker(t,i,s,n){if(!0===n)e.call(this,null,null,!0,!0);else{if(void 0!==S)return S;e.call(this,null,null,!0,!0),o(this)}},s),a=n.prototype;n.minWidth=84,n.borderWidth=9;var r={year:{elName:"DateTimePickerYear",pattern:["y"]},month:{elName:"DateTimePickerMonth",pattern:["M"]},day:{elName:"DateTimePickerDay",pattern:["d"]},hour:{elName:"DateTimePickerHour",pattern:["h","H"]},minute:{elName:"DateTimePickerMinute",pattern:["m"]},second:{elName:"DateTimePickerSecond",pattern:["s"]}};function o(e){require(["text!"+e.settings.html],function(t){e.deferredInit(document.body,t),e.readyHandler()})}a.init=function(){this.el.prependTo(document.body),!0!==this.settings.omitClass&&this.addInitialClass("breaseDateTimePicker"),this.settings.windowType="DateTimePicker",e.prototype.init.call(this,!0),this.value=new Date(1970,0,1,0,0,0,0),this.error=!1,this.DateTimePickerYear=new SliderWheel(this.el.find(".dtfragment.year"),{range:{start:1900,end:2100,offset:1},colIndex:0},this._bind("_setYear")),this.DateTimePickerMonth=new SliderWheel(this.el.find(".dtfragment.month"),{data:f(),colIndex:0},this._bind("_setMonth")),this.DateTimePickerDay=new SliderWheel(this.el.find(".dtfragment.day"),{range:{start:1,end:31,offset:1},digits:2,colIndex:0},this._bind("_setDay")),this.DateTimePickerHour=new SliderWheel(this.el.find(".dtfragment.hour"),{range:{start:0,end:23,offset:1},digits:2,colIndex:0},this._bind("_setHour")),this.DateTimePickerMinute=new SliderWheel(this.el.find(".dtfragment.minute"),{range:{start:0,end:59,offset:1},digits:2,colIndex:0},this._bind("_setMinute")),this.DateTimePickerSecond=new SliderWheel(this.el.find(".dtfragment.second"),{range:{start:0,end:59,offset:1},digits:2,colIndex:0},this._bind("_setSecond")),g.call(this),this.DateTimePickerString=this.el.find(".actDate"),this.btnEnter=this.el.find(".dateTimePickerEnter").on(BreaseEvent.CLICK,this._bind("_submitValue")).on(BreaseEvent.MOUSE_DOWN,this._bind(l)),this.btnReset=this.el.find(".dateTimePickerReset").on(BreaseEvent.CLICK,this._bind("_resetValue")).on(BreaseEvent.MOUSE_DOWN,this._bind(c)),
this.DateTimePickerObjArray=[this.DateTimePickerYear,this.DateTimePickerMonth,this.DateTimePickerDay,this.DateTimePickerHour,this.DateTimePickerMinute,this.DateTimePickerSecond,this.btnEnter,this.btnReset],document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler")),u(this)};function l(){this.btnEnter.addClass("active"),brease.bodyEl.on(BreaseEvent.MOUSE_UP,this._bind(d))}function d(){brease.bodyEl.off(BreaseEvent.MOUSE_UP,this._bind(d)),this.btnEnter.removeClass("active")}function c(){this.btnReset.addClass("active"),brease.bodyEl.on(BreaseEvent.MOUSE_UP,this._bind(h))}function h(){brease.bodyEl.off(BreaseEvent.MOUSE_UP,this._bind(h)),this.btnReset.removeClass("active")}function u(e){e.btnReset.html(brease.language.getSystemTextByKey("BR/IAT/brease.common.reset")),e.btnEnter.html(brease.language.getSystemTextByKey("BR/IAT/brease.common.enter"))}a.langChangeHandler=function(){u(this),e.prototype.langChangeHandler.apply(this,arguments)},a.cultureChangeHandler=function(){this.DateTimePickerMonth.update(f()),w.call(this,this.value)},a.setValue=function(e){void 0!==e&&""!==e&&(this.value=new Date(e.valueOf()),this.oldValue=new Date(e.valueOf()),w.call(this,this.value))},a.getValue=function(){return this.value},a.show=function(t,i){t=x(t),t.format=this._addOptionsDateTimeFormat(t),_.call(this),t.width=C.call(this,t.format),void 0!==this.height&&void 0!==t.width||(t.height=this.el.outerHeight(),this.height=t.height),t.height=this.height,e.prototype.show.apply(this,arguments),this.closeOnLostContent(i),this._setTimeComponents(),(void 0===this.settings.time||"function"!=typeof this.settings.time.getTime||isNaN(this.settings.time.getTime()))&&(this.settings.time=new Date),this.setValue(this.settings.time)},a.themeChangeHandler=function(){g.call(this),this.height=void 0};function g(){var e=this;e.dtpw={},Object.keys(r).forEach(function(t){e.dtpw[t]=0})}a.dispose=function(){this.el.find("#breaseDateTimePickerButtons").off(),brease.bodyEl.off(BreaseEvent.MOUSE_UP,this._bind(d)),brease.bodyEl.off(BreaseEvent.MOUSE_UP,this._bind(h)),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler")),e.prototype.dispose.apply(this,arguments)},a._submitValue=function(e){this._handleEvent(e,!0),this.dispatchEvent(new CustomEvent(BreaseEvent.SUBMIT,{detail:{value:this.getValue()}})),this.hide()},a._addOptionsDateTimeFormat=function(e){var i;return 1===e.dateTimeFormat.length?(i=t.getFormat4Pattern(e.dateTimeFormat),void 0===i&&(console.iatWarn('invalid pattern "'+e.dateTimeFormat+'" in dateTimeFormat -> take default pattern "'+s.dateTimeFormat+'"'),e.dateTimeFormat=s.dateTimeFormat,i=t.getFormat4Pattern(e.dateTimeFormat))):i=e.dateTimeFormat,i},a._setTimeComponents=function(){var e;1===this.settings.dateTimeFormat.length?(e=t.getFormat4Pattern(this.settings.dateTimeFormat),void 0===e&&(console.iatWarn('invalid pattern "'+this.settings.dateTimeFormat+'" in dateTimeFormat -> take default pattern "'+s.dateTimeFormat+'"'),this.settings.dateTimeFormat=s.dateTimeFormat,e=t.getFormat4Pattern(this.settings.dateTimeFormat))):e=this.settings.dateTimeFormat;var i=this,n=0;Object.keys(r).forEach(function(t){E.call(i,t,e)?(i[r[t].elName].insert(),n+=1,i[r[t].elName].columnIndex=n):(i[r[t].elName].detach(),i[r[t].elName].columnIndex=0)}),this._setPosition()},a._resetValue=function(){this.setValue(this.oldValue)},a._setHour=function(e){this.value.setHours(e)},a._setMinute=function(e){this.value.setMinutes(e)},a._setSecond=function(e){this.value.setSeconds(e)},a._setYear=function(e){this.value.setYear(e),b.call(this)},a._setMonth=function(e){this.value.setMonth(e),b.call(this)},a._setDay=function(e){this.value.setDate(e),b.call(this)};var m=[31,28,31,30,31,30,31,31,30,31,30,31],p=[{value:0,text:"January"},{value:1,text:"February"},{value:2,text:"March"},{value:3,text:"April"},{value:4,text:"May"},{value:5,text:"June"},{value:6,text:"July"},{value:7,text:"August"},{value:8,text:"September"},{value:9,text:"October"},{value:10,text:"November"},{value:11,text:"December"}];function f(){for(var e=p,t=brease.culture.getCurrentCulture().culture,i=t.calendar.months.names,s=0;s<e.length;s+=1)e[s].text=i[s];return e}function b(){if(this.DateTimePickerDay&&this.check){if(this.value.getDate()!==this.DateTimePickerDay.getValue()){var e=v(this.DateTimePickerMonth.getValue(),this.DateTimePickerYear.getValue());this.DateTimePickerDay.setValue(e),this.value.setDate(e),this.value.setMonth(this.DateTimePickerMonth.getValue())}}}function v(e,t){return 1!==e?m[e]:y(t)?29:28}function y(e){return e%4==0&&e%100!=0||e%400==0}function w(e){var i=this;this.check=!1,this.DateTimePickerYear.setValue(e.getFullYear()),this.DateTimePickerMonth.setValue(e.getMonth()),this.DateTimePickerDay.setValue(e.getDate()),this.DateTimePickerHour.setValue(e.getHours()),this.DateTimePickerMinute.setValue(e.getMinutes()),this.DateTimePickerSecond.setValue(e.getSeconds()),t.format(this.value,this.settings.dateTimeFormat,function(e){i.DateTimePickerString.text(e)}),this.check=!0}function x(e){if(e.position){var t=e.position;e.arrow=e.arrow||{},"left"===t.horizontal?(t.vertical="middle",e.arrow.position="right",e.arrow.show=!0):"right"===t.horizontal?(t.vertical="middle",e.arrow.position="left",e.arrow.show=!0):"top"===t.vertical?(t.horizontal="center",e.arrow.position="bottom",e.arrow.show=!0):"bottom"===t.vertical?(t.horizontal="center",e.arrow.position="top",e.arrow.show=!0):(t.vertical="middle",t.horizontal="center",e.arrow.show=!1)}return e}function E(e,t){for(var i=r[e].pattern,s=0;s<i.length;s+=1)if(-1!==t.indexOf(i[s]))return!0;return!1}function I(e,t){return E.call(this,e,t)?0===this.dtpw[e]?this[r[e].elName].$el.outerWidth():this.dtpw[e]:0}function C(e){var t=this;Object.keys(r).forEach(function(i){t.dtpw[i]=I.call(t,i,e)});var i=2*n.borderWidth,s=this.dtpw.year+this.dtpw.month+this.dtpw.day+this.dtpw.hour+this.dtpw.minute+this.dtpw.second;return 0===s?n.minWidth:s+i}function _(){var e=this;Object.keys(r).forEach(function(t){e[r[t].elName].insert()})}var S=new n;return i.decorate(n,!0)}),define("widgets/brease/DateTimeInput/DateTimeInput",["brease/core/BaseWidget","widgets/brease/DateTimeInput/libs/FocusHandler","brease/decorators/CultureDependency","brease/enum/Enum","widgets/brease/DateTimePicker/DateTimePicker","brease/events/BreaseEvent","brease/helper/DateFormatter","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,FocusHandler,t,Enum,DateTimePicker,BreaseEvent,i,UtilsEditableBinding,s){"use strict";var n={pickerPosition:Enum.Position.right,submitOnChange:!0,format:"F",value:"1970-01-01T00:00:00.000Z",tabIndex:0},a=e.extend(function DateTimeInput(){e.apply(this,arguments)},n),r=a.prototype;r.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseDateTimeInput"),this.settings.overlayPosition=this.settings.pickerPosition,this.timePicker=new DateTimePicker,this.data={value:new Date(0),timeZoneCorrectedValue:new Date,timeZoneOffset:0},this.input=$("<span>"),this.el.append(this.input),this.timePicker.state===Enum.WidgetState.READY?e.prototype.init.call(this):document.body.addEventListener(BreaseEvent.WIDGET_READY,this._bind("timePicker_readyHandler")),this.initText(),d(this,this.settings.value),c(this),this.focusHandler=new FocusHandler(this)},r._handleFocusKeyDown=function(t){e.prototype._handleFocusKeyDown.apply(this,arguments);var i=this.focusHandler.editMode;this.focusHandler.handleKeyDown(t),!this.focusHandler.editMode&&i&&(this.internalData.isKeyDown=!1)},r.timePicker_readyHandler=function(t){"breaseDateTimePicker"===t.target.id&&(document.body.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("timePicker_readyHandler")),e.prototype.init.call(this,!0),this._dispatchReady())},r.setValue=function(e){void 0!==e&&(d(this,e),c(this))},r.getValue=function(){if(!isNaN(new Date(this.data.value).getTime()))return this.data.value.toISOString()},r.setPickerPosition=function(e){this.settings.pickerPosition=e},r.getPickerPosition=function(){return this.settings.pickerPosition},r.setSubmitOnChange=function(e){this.settings.submitOnChange=e},r.getSubmitOnChange=function(){return this.settings.submitOnChange},r.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},r.initText=function(){void 0!==this.settings.format&&(!1===brease.language.isKey(this.settings.format)?this.setFormat(this.settings.format):this.setFormatKey(brease.language.parseKey(this.settings.format)))},r.setFormatKey=function(e){if(void 0!==e){this.settings.textkey=e,this.setCultureDependency(!0);var t=brease.language.getTextByKey(this.settings.textkey);"undefined key"!==t?this.settings.format=t:console.iatWarn(this.elem.id+": Format textKey not found: "+e)}else this.settings.textkey=void 0,console.iatInfo(this.elem.id+": The text key is not valid : "+e)},r.cultureChangeHandler=function(e){e&&e.detail&&e.detail.textkey&&e.detail.textkey!==this.settings.textkey||(this.setFormatKey(this.settings.textkey),c(this))},r.setFormat=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.format=e,this.settings.textkey=void 0):this.setFormatKey(brease.language.parseKey(e))),c(this)},r.getFormat=function(){return this.settings.format},r.submitChange=function(){this.sendValueChange({value:this.getValue()}),h(this)},r.showTimePicker=function(){o.call(this),l.call(this),this._generatePickerSettings(),this.timePicker.show(this.settings.pickerSettings,this.elem)},r._clickHandler=function(t){this._handleEvent(t),this.isDisabled||(this.el.addClass("active"),!0===this.focusHandler.showTimePicker&&(this.internalData.timePickerOpen=!0,this.showTimePicker()),this.focusHandler.editMode||this.focusHandler.removeFocusSelectedColumn(),this.focusHandler.closeTimePicker&&this.el.removeClass("active"),this.elem.focus()),this.focusHandler.closeTimePicker=!1,this.focusHandler.showTimePicker=!0,e.prototype._clickHandler.call(this,t)},r._mouseDownHandler=function(e){e.originalEvent.preventDefault(),this.focusHandler.removeFocusSelectedColumn()},r._timePickerCloseHandler=function(){o.call(this),this.internalData.timePickerOpen=!1,this.focusHandler.editMode=!1,this.el.removeClass("active")},r._timePickerSubmitHandler=function(e){this.data.value=new Date(e.detail.value),this.data.timeZoneCorrectedValue=new Date(e.detail.value),this.data.timeZoneOffset=this.data.value.getTimezoneOffset(),this.data.value.setMinutes(this.data.value.getMinutes()-this.data.timeZoneOffset),c(this),this.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{detail:{value:this.data.value}})),this.settings.submitOnChange&&this.submitChange()},r._generatePickerSettings=function(){this.settings.pickerSettings={time:this.data.timeZoneCorrectedValue,dateTimeFormat:this.settings.format,pointOfOrigin:"element",position:"top"===this.settings.pickerPosition||"bottom"===this.settings.pickerPosition?{vertical:this.settings.pickerPosition}:{horizontal:this.settings.pickerPosition},arrow:{show:!0,width:12,position:"right"===this.settings.pickerPosition||"left"===this.settings.pickerPosition?"right"===this.settings.pickerPosition?"left":"right":"top"===this.settings.pickerPosition?"bottom":"top"}}},r.dispose=function(){o.call(this),this.timePicker&&(this.timePicker=null),e.prototype.dispose.apply(this,arguments)},r._enableHandler=function(){this.internalData.timePickerOpen&&this.timePicker.hide(),e.prototype._enableHandler.apply(this,arguments)},r._visibleHandler=function(){this.internalData.timePickerOpen&&this.timePicker.hide(),e.prototype._visibleHandler.apply(this,arguments)};function o(){this.timePicker&&this.timePicker.elem&&(this.timePicker.removeEventListener(BreaseEvent.CLOSED,this._bind("_timePickerCloseHandler")),this.timePicker.removeEventListener(BreaseEvent.SUBMIT,this._bind("_timePickerSubmitHandler")),this.timePicker.el.off(BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler")))}function l(){this.timePicker&&this.timePicker.elem&&(this.timePicker.addEventListener(BreaseEvent.CLOSED,this._bind("_timePickerCloseHandler")),this.timePicker.addEventListener(BreaseEvent.SUBMIT,this._bind("_timePickerSubmitHandler")),this.timePicker.el.on(BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler")))}function d(e,t){e.data.value=new Date(t),e.data.timeZoneCorrectedValue=new Date(t),e.data.timeZoneOffset=e.data.value.getTimezoneOffset(),e.data.timeZoneCorrectedValue.setMinutes(e.data.timeZoneCorrectedValue.getMinutes()+e.data.timeZoneOffset)}function c(e){i.format(e.data.timeZoneCorrectedValue,e.settings.format,function(t){e.input.text(t)})}function h(e){e.createEvent("ValueChanged",{value:e.getValue()}).dispatch()}return s.decorate(t.decorate(a,!0),!1)}),define("widgets/brease/DateTimeInput/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DateTimeInput",parents:["*"],children:[],inheritance:["widgets.brease.DateTimeInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPickerPosition:{method:"setPickerPosition",parameter:{pickerPosition:{name:"pickerPosition",index:0,type:"brease.enum.Position"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"DateTime"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/DateTimeOutput/DateTimeOutput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/DateTimeOutput"></div>\r\n'}),define("widgets/brease/DateTimeOutput/DateTimeOutput",["brease/core/BaseWidget","brease/helper/Timer","brease/decorators/CultureDependency","brease/enum/Enum","brease/core/Utils","brease/events/BreaseEvent","brease/helper/DateFormatter","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,Timer,t,Enum,Utils,BreaseEvent,i,s){"use strict";var n,a={format:"F",textAlign:Enum.TextAlign.center,useClientTime:!0},r=e.extend(function DateTimeOutput(){e.apply(this,arguments)},a),o=r.prototype;o.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseDateTimeOutput"),e.prototype.init.call(this),this._invalidate(),this.active=!0,this.data={value:Utils.getActDate(),timeZoneCorrectedValue:Utils.getActDate(),timeZoneOffset:0},this.textEl=$("<span></span>"),this.el.append(this.textEl),void 0===n&&(n=new Timer(1e3)),n.addEventListener(BreaseEvent.TICK,this._bind("timerHandler")),this.initText(),l(this,this.data.value),d(this)},o.setValue=function(e){void 0!==e&&"string"==typeof e&&(l(this,e),d(this),this.settings.useClientTime&&(this.settings.useClientTime=!1,n.removeEventListener(BreaseEvent.TICK,this._bind("timerHandler"))))},o.getValue=function(){if(!isNaN(new Date(this.data.value).getTime()))return this.data.value.toISOString()},o.initText=function(){void 0!==this.settings.format&&(!1===brease.language.isKey(this.settings.format)?this.setFormat(this.settings.format):this.setFormatKey(brease.language.parseKey(this.settings.format)))},o.setFormatKey=function(e){if(void 0!==e){this.settings.textkey=e,this.setCultureDependency(!0);var t=brease.language.getTextByKey(this.settings.textkey);"undefined key"!==t?this.settings.format=t:console.iatWarn(this.elem.id+": Format textKey not found: "+e)}else this.settings.textkey=void 0,console.iatInfo(this.elem.id+": The text key is not valid : "+e)},o.cultureChangeHandler=function(){void 0!==this.settings.textkey&&this.setFormatKey(this.settings.textkey),d(this)},o.setFormat=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.format=e,this.settings.textkey=void 0):this.setFormatKey(brease.language.parseKey(e))),d(this)},o.getFormat=function(){return this.settings.format},o.timerHandler=function(e){this.data.value=new Date(e.detail.timestamp),this.data.timeZoneCorrectedValue=new Date(e.detail.timestamp),this.data.timeZoneOffset=this.data.value.getTimezoneOffset(),this.data.value.setMinutes(this.data.value.getMinutes()-this.data.timeZoneOffset),d(this)},o.dispose=function(){this.timeDisplay=null,this.dateDisplay=null,void 0!==n&&n.removeEventListener(BreaseEvent.TICK,this._bind("timerHandler")),e.prototype.dispose.apply(this,arguments)};function l(e,t){e.data.value=new Date(t),e.data.timeZoneCorrectedValue=new Date(t),e.data.timeZoneOffset=e.data.value.getTimezoneOffset(),e.data.timeZoneCorrectedValue.setMinutes(e.data.timeZoneCorrectedValue.getMinutes()+e.data.timeZoneOffset)}function d(e){i.format(e.data.timeZoneCorrectedValue,e.settings.format,function(t){e.textEl.text(t)})}return s.decorate(t.decorate(r,!0),!1)}),define("widgets/brease/DateTimeOutput/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DateTimeOutput",parents:["*"],children:[],inheritance:["widgets.brease.DateTimeOutput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"DateTime"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/DateTimePicker/DateTimePicker.html",[],function(){return'<div id="breaseDateTimePicker" data-brease-widget="widgets/brease/DateTimePicker">\r\n    <header></header>\r\n    <div class="dateTimePickerBody">\r\n        <section class="dateTimePickerHeadings">\r\n            <span class="actDate"></span>\r\n        </section>\r\n        <section class="dateTimePickerButtons">\r\n            <div class="dtfragment year"></div>\r\n            <div class="dtfragment month"></div>\r\n            <div class="dtfragment day"></div>\r\n            <div class="dtfragment hour"></div>\r\n            <div class="dtfragment minute"></div>\r\n            <div class="dtfragment second"></div>\r\n        </section>\r\n        <section class="dateTimePickerControl">\r\n            <button class="dateTimePickerReset"></button>\r\n            <div class="space"></div>\r\n            <button class="dateTimePickerEnter"></button>\r\n        </section>\r\n    </div>\r\n</div>\r\n'}),define("widgets/brease/DateTimePicker/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DateTimePicker",parents:["*"],children:[],inheritance:["widgets.brease.DateTimePicker","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/DialogWindow/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DialogWindow",parents:["*"],children:[],inheritance:["widgets.brease.DialogWindow","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/DialogWindow/DialogWindow.html",[],function(){return'<div id="{{ID}}" data-brease-widget="widgets/brease/DialogWindow">\r\n    <header class="breaseDialogWindowHeader">\r\n        <div class="innerHeader">\r\n            <div class="imageDiv"><img src="" class="dummyImage" alt="" /></div>\r\n            <div class="textDiv"></div>\r\n        </div>\r\n        <a class="breaseWindowClose"></a>\r\n    </header>\r\n    <div id="{{ID}}_breaseDialogContent" class="breaseDialogWindowContentBox contentBox"></div>\r\n</div>'}),define("widgets/brease/DialogWindow/DialogWindow",["widgets/brease/Window/Window","brease/events/BreaseEvent","brease/enum/Enum","brease/controller/libs/KeyActions","brease/core/Utils"],function(e,BreaseEvent,Enum,KeyActions,Utils){"use strict";var t={modal:!0,arrow:{show:!1},forceInteraction:!0,showCloseButton:!0,position:{horizontal:"center",vertical:"middle"},pointOfOrigin:Enum.PointOfOrigin.CONTAINER,html:"widgets/brease/DialogWindow/DialogWindow.html",stylePrefix:"system_brease_Dialog",width:400,height:200},i=e.extend(function DialogWindow(t,i,s,n){!0===n?e.call(this,null,null,!0,!0):(e.call(this,null,i,!0,!0),a(this))},t),s=i.prototype,n=0;i.ErrorClass="dialogWindowError";function a(e){require(["text!"+e.settings.html],function t(i){var s="DialogWindow"+(n+=1);i=i.replace(/\{\{ID\}\}/g,s),e.deferredInit(document.body,i),e.headerEl=e.el.find("header .textDiv"),e.imgEl=e.el.find("header img.dummyImage"),e.$imageDiv=e.el.find("header .imageDiv"),e.innerHeader=e.el.find(".innerHeader"),e.readyHandler()})}s.init=function(){this.addInitialClass("breaseDialogWindow"),this.contentBox=this.el.find(".contentBox"),this.settings.windowType="DialogWindow",e.prototype.init.call(this,!0)},s._setDimensions=function(){if(this.internalData.perform){var t=brease.pageController.getDialogById(this.settings.id);if(this.contentBox.children().length>0){var i=r(this.contentBox,t);this.contentBox.css({height:i.height,width:i.width}),this.settings.width=void 0,this.settings.height=void 0}else this.settings.height=this.defaultSettings.height,this.settings.width=this.defaultSettings.width;if(t){var s=brease.pageController.getLayoutById(t.layout),n=parseInt(this.header.css("border-right-width"),10)+parseInt(this.header.css("border-left-width"),10);this.innerHeader.css("max-width",s.width-Math.max(0,n-2)-("none"===this.closeButton.css("display")?0:this.closeButton.outerWidth())+"px")}e.prototype._setDimensions.call(this),0===this.header.height()?this.contentBox.css({borderTopRightRadius:this.el.css("borderTopRightRadius"),borderTopLeftRadius:this.el.css("borderTopLeftRadius")}):this.contentBox.css({borderTopRightRadius:"0px",borderTopLeftRadius:"0px"})}};function r(e,t){var i={width:0,height:0},s=brease.pageController.getLayoutById(t?t.layout:void 0);if(s){var n=e.find('[data-brease-layoutid="'+s.id+'"]').position();i.width=s.width+(void 0!==n?n.left:0),i.height=s.height+(void 0!==n?n.top:0)}else e.find("> div").each(function(){var e=$(this),t=e.position();i.width=Math.max(i.width,t.left+e.width()),i.height=Math.max(i.height,t.top+e.height())});return i}s.show=function(t,i){t=t||{};var s=brease.pageController.getDialogById(t.id),n={success:!0};if(t.header=o(t,s),t.style=l(t.style,s),t.zoomFactor=d(this.el,s),t.id?this.el.attr("data-brease-dialogId",t.id):this.el.removeAttr("data-brease-dialogId"),this.internalData.perform=!1,e.prototype.show.call(this,t,i),void 0===s)n.success=!1,n.errorCode="NOT_FOUND";else{brease.pageController.loadDialog(t.id,this.contentBox[0])||(n.success=!1,n.errorCode="NOT_LOADED")}return n.success||c.call(this,t.id,n.errorCode),this.internalData.perform=!0,this._setDimensions(),this._setPosition(),brease.config.visu.keyboardOperation&&this.elem.addEventListener("keydown",this._bind("_keydownHandler")),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("_themeChangeHandler")),n.success},s._setPosition=function(){this.internalData.perform&&e.prototype._setPosition.call(this)};function o(e,t){return void 0!==e.headerText?e.header={text:e.headerText}:void 0!==t&&void 0!==t.displayName&&(e.header={text:t.displayName}),e.header}function l(e,t){return t&&t.style&&(e=t.style),e}function d(e,t){var i=1;if(void 0!==t){var s=brease.pageController.getVisuById(t.visuId);if(s&&s.containerId){var n=brease.pageController.getPageById(brease.pageController.getCurrentPage(s.containerId));if(n){var a=document.querySelector('[data-brease-layoutid="'+n.layout+'"][data-brease-pageId="'+n.id+'"]');i=Utils.getScaleFactor(a)}}}return e.css({transform:"scale("+i+","+i+")","transform-origin":"0 0"}),i}function c(e,t){var s=this,n="NOT_FOUND"===t?"BR/IAT/brease.error.DIALOG_NOT_FOUND":"BR/IAT/brease.error.DIALOG_NOT_LOADED",a=brease.language.getSystemTextByKey(n);this.setStyle(i.ErrorClass),this.setModal(!1),this.setForceInteraction(!1),this.el.find(".contentBox").css("width","auto"),brease.textFormatter.format(a,[e]).then(function(e){var t=$('<div class="errorText" ></div>');t.text(e),s.contentBox.append(t)})}return s._keydownHandler=function(e){-1!==KeyActions.getActionsForKey(e.key).indexOf(Enum.KeyAction.Close)&&this.debouncedHide()},s._themeChangeHandler=function(){this._setImage()},s._setImage=function(){var e=Utils.getBackgroundImageUrl(this.$imageDiv.get(0));void 0!==e?(this.imgEl.attr("src",e),this.$imageDiv.css("display","inline-block")):this.$imageDiv.css("display","none");var t=Math.floor(this.el.find("header").outerWidth()-this.headerEl.outerWidth()-this.closeButton.outerWidth()-20);this.$imageDiv.css("max-width",t+"px")},s._setCloseButton=function(){e.prototype._setCloseButton.apply(this,arguments),this.closeButton.css("display","")},s._setContent=function(){e.prototype._setContent.apply(this,arguments),this._setImage()},s.onBeforeHide=function(){var e=this.el.attr("data-brease-dialogid");e?brease.overlayController.closeDialog(e):this.hide()},s.hide=function(){brease.pageController.emptyContainer(this.contentBox[0],!0),this.el.removeAttr("data-brease-dialogId"),this.elem.removeEventListener("keydown",this._bind("_keydownHandler")),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("_themeChangeHandler")),e.prototype.hide.call(this)},s.dispose=function(){this.elem.removeEventListener("keydown",this._bind("_keydownHandler")),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("_themeChangeHandler")),e.prototype.dispose.apply(this,arguments)},i}),define("widgets/brease/DropDownBox/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.DropDownBox",parents:["*"],children:[],inheritance:["widgets.brease.DropDownBox","brease.core.BaseWidget"],actions:{Close:{method:"close"},Focus:{method:"focus"},GetSelectedIndex:{method:"getSelectedIndex"},GetSelectedValue:{method:"getSelectedValue"},Open:{method:"open"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setCropToParent:{method:"setCropToParent",parameter:{cropToParent:{name:"cropToParent",index:0,type:"brease.enum.CropToParent"}}},SetDataProvider:{method:"setDataProvider",parameter:{value:{name:"value",index:0,type:"ItemCollection"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},setDisplaySettings:{method:"setDisplaySettings",parameter:{displaySettings:{name:"displaySettings",index:0,type:"brease.enum.DropDownDisplaySettings"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFitHeight2Items:{method:"setFitHeight2Items",parameter:{fitHeight2Items:{name:"fitHeight2Items",index:0,type:"Boolean"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},setImagePath:{method:"setImagePath",parameter:{imagePath:{name:"imagePath",index:0,type:"DirectoryPath"}}},setItemHeight:{method:"setItemHeight",parameter:{itemHeight:{name:"itemHeight",index:0,type:"Integer"}}},setListPosition:{method:"setListPosition",parameter:{listPosition:{name:"listPosition",index:0,type:"brease.enum.Position"}}},setListWidth:{method:"setListWidth",parameter:{listWidth:{name:"listWidth",index:0,type:"Integer"}}},setMaxVisibleEntries:{method:"setMaxVisibleEntries",parameter:{maxVisibleEntries:{name:"maxVisibleEntries",index:0,type:"Integer"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetSelectedIndex:{method:"setSelectedIndex",parameter:{index:{name:"index",index:0,type:"Integer"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},SetSelectedValue:{method:"setSelectedValue",parameter:{value:{name:"value",index:0,type:"String"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{
method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},Toggle:{method:"toggle"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/DropDownBox/DropDownBox.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/DropDownBox"></div>\r\n'}),define("widgets/brease/DropDownBox/libs/FocusHandler",["brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/controller/libs/KeyActions"],function(BreaseEvent,Enum,Utils,KeyActions){"use strict";var e=[Enum.KeyAction.ScrollDown,Enum.KeyAction.ScrollUp,Enum.KeyAction.ScrollDownFast,Enum.KeyAction.ScrollUpFast],FocusHandler=function(e){this.widget=e,this.editMode=!1,brease.config.isKeyboardOperationEnabled()&&(this.widget.el.on(BreaseEvent.FOCUS_OUT,this.onFocusOut.bind(this)),this.widget.el.on(BreaseEvent.BEFORE_ENABLE_CHANGE,this.onBeforeStateChange.bind(this)),this.widget.el.on(BreaseEvent.BEFORE_VISIBLE_CHANGE,this.onBeforeStateChange.bind(this)))},t=FocusHandler.prototype,i="elementFocus";t.handleKeyDown=function(t){var i=KeyActions.getActionForKey(t.key);this.editMode?this.editModeKeyDownHandler(i,t):"any"===brease.config.keyboardHandling.onStart.action?i===Enum.KeyAction.Accept?(this.widget.open(),l.call(this)):-1!==e.indexOf(i)&&(this.widget.open(),l.call(this),this.editModeKeyDownHandler(i,t)):i===Enum.KeyAction.Accept&&(this.widget.open(),l.call(this))},t.editModeKeyDownHandler=function(e,t){this.widget.settings.dataProvider.length>0&&(e===Enum.KeyAction.ScrollDown?(s(t),m.call(this)):e===Enum.KeyAction.ScrollUp?(s(t),p.call(this)):e===Enum.KeyAction.Accept?(g.call(this),d.call(this),this.widget.triggerToggleStateChanged()):e===Enum.KeyAction.Cancel?(s(t),c.call(this)):e===Enum.KeyAction.ScrollDownFast?(s(t),y.call(this)):e===Enum.KeyAction.ScrollUpFast&&(s(t),w.call(this)))};function s(e){e.stopPropagation(),e.preventDefault()}function n(){var e=this.widget.getItemContainer(),t=e.getBoundingClientRect();this.dimensions={itemHeight:this.widget.settings.dataProvider.length>0?this.widget.getAllItems()[0].getBoundingClientRect().height:this.widget.settings.itemHeight,container:{height:t.height,offsetHeight:e.offsetHeight}},this.maxIndex=this.widget.settings.dataProvider.length-1,this.pageIndexOffset=Math.ceil(this.dimensions.container.height/this.dimensions.itemHeight)-1}t.getDimensions=function(){return this.dimensions||n.call(this),this.dimensions},t.onFocusOut=function(){this.editMode&&("focus"===brease.config.keyboardHandling.onEnd.action?(g.call(this),d.call(this),this.widget.triggerToggleStateChanged()):"accept"===brease.config.keyboardHandling.onEnd.action&&c.call(this))},t.onRender=function(){if(this.editMode){n.call(this);var e=this.widget.getSelectedIndex();Number.isInteger(e)&&I.call(this,e)}},t.onToggleStateChanged=function(e){e?this.editMode||l.call(this):this.editMode=!1},t.onBeforeStateChange=function(e){e.detail.value||c.call(this)},t.dispose=function(){this.widget.el.off(BreaseEvent.FOCUS_IN),this.widget.el.off(BreaseEvent.FOCUS_OUT),this.widget.el.off(BreaseEvent.BEFORE_ENABLE_CHANGE),this.widget.el.off(BreaseEvent.BEFORE_VISIBLE_CHANGE),this.widget=void 0};function a(){return this.widget.dropDownBoxView.listContainer[0].querySelector("."+i)}function r(e){return Array.prototype.indexOf.call(e.parentNode.children,e)}function o(){var e=a.call(this);return e?r(e):-1}function l(){this.editMode=!0,n.call(this),h.call(this)}function d(){this.editMode&&(u.call(this),_.call(this),this.editMode=!1)}function c(){d.call(this),this.widget.close()}function h(){Utils.addClass(this.widget.getSelectedItem(),i)}function u(){this.widget.getAllItems().forEach(function(e){Utils.removeClass(e,i)})}function g(){var e=o.call(this);-1!==e&&this.widget.setSelectedIndex(e)}function m(){var e=o.call(this),t=e+1;t>this.maxIndex&&(t=0),I.call(this,t)}function p(){var e=o.call(this),t=e-1;-1===t&&(t=this.maxIndex),I.call(this,t)}function f(e){e=void 0===e||e;var t=this.widget.getScroller();return t?e?-t.y*t.zoomFactor:-t.y:0}function b(){var e=this.getDimensions().itemHeight,t=f.call(this),i=this.getDimensions().container.height,s=(i+t)/e,n=Utils.roundTo(s,3),a=Math.floor(n)-1;return Math.min(a,this.maxIndex)}function v(){var e=this.getDimensions().itemHeight,t=f.call(this),i=t/e,s=Utils.roundTo(i,3),n=Math.ceil(s);return Math.max(n,0)}function y(){var e=b.call(this),t=o.call(this);if(e===t){var i=Math.min(t+this.pageIndexOffset,this.maxIndex);if(i>t){E.call(this,i,!1);var s=this.widget.getAllItems()[i];T.call(this,s,-(this.getDimensions().container.offsetHeight-this.widget.settings.itemHeight))}}else E.call(this,e)}function w(){var e=v.call(this),t=o.call(this);if(e===t){var i=Math.max(t-this.pageIndexOffset,0);if(i<t){E.call(this,i,!1);var s=this.widget.getAllItems()[i];T.call(this,s,0)}}else E.call(this,e)}function x(e){var t=f.call(this,!1),i=r(e),s=this.widget.settings.itemHeight,n=this.getDimensions().container.offsetHeight,a=i*s-t;return a>=0&&a+s<=n}function E(e){if(e>-1){u.call(this);var t=this.widget.getAllItems()[e];C.call(this,t)}}function I(e){if(e>-1){u.call(this);var t=this.widget.getAllItems()[e];C.call(this,t),S.call(this,t)}}function C(e){e&&Utils.addClass(e,i)}function _(){S.call(this,this.widget.getSelectedItem())}function S(e){var t=this.widget.getScroller();t&&e&&!x.call(this,e)&&t.scrollToElement(e,100,!0,!0)}function T(e,t){var i=this.widget.getScroller();i&&e&&i.scrollToElement(e,100,0,t)}return FocusHandler}),define("widgets/brease/DropDownBox/libs/config/Config",["brease/enum/Enum"],function(Enum){"use strict";return{selectedIndex:0,selectedValue:"",itemHeight:40,imageAlign:Enum.ImageAlign.left,imagePath:"",ellipsis:!1,wordWrap:!1,multiLine:!1,fitHeight2Items:!0,dataProvider:[],listPosition:Enum.Position.right,listWidth:150,maxVisibleEntries:4,cropToParent:Enum.CropToParent.none,displaySettings:Enum.DropDownDisplaySettings.default,tabIndex:0}}),define("widgets/brease/DropDownBox/libs/config/InitState",["widgets/brease/common/libs/redux/utils/UtilsImage","widgets/brease/common/libs/redux/utils/UtilsText","widgets/brease/common/libs/redux/utils/UtilsList","widgets/brease/common/libs/redux/utils/UtilsStyle"],function(UtilsImage,UtilsText,UtilsList,UtilsStyle){"use strict";var InitState={};return InitState.calculateInitState=function(e,t,i){var s={};return s.text={textElements:UtilsText.getTextsFromItems(e.dataProvider),textSettings:{multiLine:e.multiLine,wordWrap:e.wordWrap,ellipsis:e.ellipsis}},s.image={imageList:UtilsImage.createImageList(e.dataProvider),imagePath:e.imagePath,imageElements:UtilsImage.createImageElements(UtilsImage.createImageList(e.dataProvider),e.imagePath),imageSettings:{}},s.items={itemList:UtilsList.getItemsFromItems(e.dataProvider,e.selectedIndex),itemSettings:{itemHeight:e.itemHeight,imageAlign:e.imageAlign},selectedIndex:e.selectedIndex,selectedValue:UtilsList.getSelectedValueFromItems(e.dataProvider,e.selectedIndex),previousSelectedIndex:0,listOpen:!1,listSettings:{fitHeight2Items:e.fitHeight2Items,listPosition:e.listPosition,listWidth:e.listWidth,listHeight:UtilsList.calculateListHeight(e.fitHeight2Items,e.dataProvider.length,e.maxVisibleEntries,e.itemHeight),maxVisibleEntries:e.maxVisibleEntries,cropToParent:e.cropToParent,showTexts:UtilsList.getShowValues(e.displaySettings).showTexts,showImages:UtilsList.getShowValues(e.displaySettings).showImages,showTextsInButton:UtilsList.getShowValues(e.displaySettings).showTextsInButton,showImagesInButton:UtilsList.getShowValues(e.displaySettings).showImagesInButton},offline:!1},s.status={enabled:t,visible:i,active:!0},s.size={height:e.height,width:e.width},s.style={stylePrefix:e.stylePrefix,style:e.style,styleToApply:UtilsStyle.addStylePrefix(e.stylePrefix,e.style)},s},InitState}),define("widgets/brease/DropDownBox/libs/SubmitQueue",[],function(){"use strict";var SubmitQueue=function(e){this.widget=e,this.queue=[]},e=SubmitQueue.prototype;return e.add=function(config){var e=this;this.queue.push(config),window.clearTimeout(this.timeout),this.timeout=window.setTimeout(function(){e.queue[0].deferred=!1,e.widget.submitChange(e.queue[0]),e.clear()},100)},e.clear=function(){window.clearTimeout(this.timeout),this.queue=[]},e.getPrevious=function(){return this.queue.length>0?this.queue[0].previous:void 0},e.length=function(){return this.queue.length},SubmitQueue}),define("widgets/brease/DropDownBox/libs/reducer/DropDownBoxActions",["widgets/brease/common/libs/redux/reducers/Text/TextActions","widgets/brease/common/libs/redux/reducers/Image/ImageActions","widgets/brease/common/libs/redux/reducers/Status/StatusActions","widgets/brease/common/libs/redux/reducers/Size/SizeActions","widgets/brease/common/libs/redux/reducers/List/ListActions","widgets/brease/common/libs/redux/reducers/Style/StyleActions"],function(TextActions,ImageActions,StatusActions,SizeActions,ListActions,StyleActions){"use strict";return _.assign({},TextActions,ImageActions,StatusActions,SizeActions,ListActions,StyleActions)}),define("widgets/brease/DropDownBox/libs/view/DropDownBoxView/DropDownBoxView",["widgets/brease/common/libs/redux/view/ListView/ListView","widgets/brease/common/libs/redux/view/ItemView/ItemView","widgets/brease/DropDownBox/libs/reducer/DropDownBoxActions","brease/enum/Enum","brease/core/Utils","brease/events/BreaseEvent","brease/controller/PopUpManager","brease/events/EventDispatcher"],function(ListView,ItemView,DropDownBoxActions,Enum,Utils,BreaseEvent,e,EventDispatcher){"use strict";var DropDownBoxView=function(e,t,i){this.el=t,this.elem=this.el.get(0),this.store=e,this.widget=i,this.render()};DropDownBoxView.prototype=new EventDispatcher;var t=DropDownBoxView.prototype;t.render=function e(){this.borderColors=this.getBorderColors(),this.dispose(),this.el.addClass("breaseDropDownBox DropDownBoxView");var t=this.store.getState();if(t.status.visible&&t.status.active){var a=t.items.itemList[t.items.selectedIndex],o=void 0===a?void 0:t.text.textElements[a.textId],c=void 0===a?void 0:t.image.imageElements[a.imageId],h={imageIndicator:{showImage:!0},text:{text:void 0===o?"":o.displayText,textSettings:t.text.textSettings,showText:t.items.listSettings.showTextsInButton},image:{image:void 0===c?void 0:c.imagePath,showImage:t.items.listSettings.showImagesInButton},itemSettings:{itemHeight:"100%",imageAlign:t.items.itemSettings.imageAlign},status:{enabled:t.status.enabled,visible:t.status.visible,selected:t.items.listOpen,lastItem:!0},offline:t.items.offline,onClick:s.bind(this)};if(this.itemView=new ItemView(h,this.el),t.items.listOpen){this.listContainer=$("<div id='"+this.elem.id+"_listBoxWrapper' class='listBoxContainer "+t.style.styleToApply+(t.style.additionalStyleToApply?" "+t.style.additionalStyleToApply:"")+"'></div>"),this.arrow=$("<div class='arrow'></div>"),this.listContainer.append(this.arrow),brease.bodyEl.append(this.listContainer);var u=d(this.listContainer),g=Utils.getScaleFactor(this.elem),m={height:this.elem.offsetHeight,width:this.elem.offsetWidth},p=this.getLimits(t.items.listSettings.cropToParent,this.el,brease.appView,brease.bodyEl),f=this.elem.getBoundingClientRect(),b={height:t.items.listSettings.listHeight+u,width:t.items.listSettings.listWidth},v=this.getLocation(t.items.listSettings.listPosition,b,f,p,g);this._listContainerSizePos(this.listContainer,v,g),l.call(this,t.items.listSettings.listPosition,m,v.width,g);var y={status:t.status,items:t.items,text:t.text,image:t.image,onClick:function(e,t,s){return function(n,a){i(e,n,t,a,s),a.preventDefault()}}(this.store,this.widget,this.elem)};this.listView=new ListView(y,this.listContainer),this.closeOnMouseDownBound=n.bind(this),this.closeOnWheelBound=r.bind(this),brease.bodyEl.on(BreaseEvent.MOUSE_DOWN,this.closeOnMouseDownBound),brease.bodyEl.on("wheel",this.closeOnWheelBound),this.dispatchEvent({type:"ViewRendered"})}}},t.dispose=function e(){void 0!==this.listView&&this.listView.dispose(),void 0!==this.itemView&&this.itemView.dispose(),void 0!==this.arrow&&this.arrow.remove(),void 0!==this.listContainer&&this.listContainer.remove(),void 0!==this.closeOnMouseDownBound&&brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,this.closeOnMouseDownBound),void 0!==this.closeOnWheelBound&&brease.bodyEl.off("wheel",this.closeOnWheelBound),void 0!==this.closeOnMouseMoveBound&&brease.bodyEl.off(BreaseEvent.MOUSE_MOVE,this.closeOnMouseMoveBound)};function i(e,t,i,s,n){if(n){var a=n.getBoundingClientRect();if(s.clientX=a.left,s.clientY=a.top,i._clickHandler.call(i,s),e.getState().status.enabled){var r=DropDownBoxActions.updateSelectedItem(t);e.dispatch(r),i.valueChangeFromUI()}}}function s(e){if(this.openEventTimeStamp=e.timeStamp,this.store.getState().status.enabled){var t=DropDownBoxActions.toggleListStatus();this.store.dispatch(t),this.widget.triggerToggleStateChanged()}}function n(e){this.openEventTimeStamp===e.timeStamp||$.contains(this.listContainer.find(".ListView")[0],e.target)||this.elem.contains(e.target)?$.contains(this.elem,e.target)&&(this.closeOnMouseMoveBound=a.bind(this),brease.bodyEl.on(BreaseEvent.MOUSE_MOVE,this.closeOnMouseMoveBound)):o(this.store,this.widget)}function a(){o(this.store,this.widget)}function r(e){$.contains(this.listContainer.find(".ListView")[0],e.target)||o(this.store,this.widget)}function o(e,t){var i=DropDownBoxActions.closeList();e.dispatch(i),t.triggerToggleStateChanged()}t._listContainerSizePos=function(e,t,i){e.css({position:"fixed",height:t.height,width:t.width,top:t.top,left:t.left,"z-index":t.zIndex,transform:"scale("+i+","+i+")","transform-origin":"0px 0px 0px"})};function l(e,t,i,s){switch(e){case Enum.Position.bottom:this.listContainer.addClass("bottom"),this.arrow.addClass("bottom"),this.arrow.css({"margin-left":i/2-8,"border-bottom-color":this.borderColors.top});break;case Enum.Position.top:this.listContainer.addClass("top"),this.arrow.addClass("top"),this.arrow.css({"margin-left":i/2-8,"border-top-color":this.borderColors.bottom});break;case Enum.Position.left:this.listContainer.addClass("left"),this.arrow.addClass("left"),this.arrow.css({"margin-top":(this.el.offset().top-this.arrow.offset().top)/s+t.height/2-8,"border-left-color":this.borderColors.right});break;case Enum.Position.right:this.listContainer.addClass("right"),this.arrow.addClass("right"),this.arrow.css({"margin-top":(this.el.offset().top-this.arrow.offset().top)/s+t.height/2-8,"border-right-color":this.borderColors.left});break;case Enum.Position.center:this.listContainer.addClass("center"),this.arrow.addClass("center");break;case Enum.Position.middle:this.listContainer.addClass("right"),this.arrow.addClass("middle");break}}function d(e){var t=$('<div class="ListView Container"></div>');e.append(t);var i=Utils.roundTo(parseFloat(t.css("border-top-width")),0),s=Utils.roundTo(parseFloat(t.css("border-bottom-width")),0),n=i+s;return t.remove(),n}t.getLocation=function t(i,s,n,a,r){var o={top:0,left:0,width:s.width,height:s.height},l=8;switch(i){case Enum.Position.bottom:o.height+=8,o.top=n.bottom,o.left=n.left+(n.width-s.width*r)/2;break;case Enum.Position.top:o.height+=8,o.top=n.top-(s.height+8)*r,o.left=n.left+(n.width-s.width*r)/2;break;case Enum.Position.left:o.top=n.top,o.left=n.left-s.width*r;break;case Enum.Position.right:o.top=n.top,o.left=n.right;break;case Enum.Position.center:o.top=n.top,o.left=n.left+(n.width-s.width*r)/2;break;case Enum.Position.middle:o.top=n.top+(n.height-s.height*r)/2,o.left=n.left+(n.width-s.width*r)/2;break}return u(o,a,r,i),o.zIndex=e.getHighestZindex()+1,o};function c(e,t){var i=this.el.closest("div[data-brease-areaId]"),s=e.get(0).getBoundingClientRect();if(i.length>0&&!t){var n=i[0].getBoundingClientRect();return{top:Math.min(n.top,s.top),bottom:Math.max(n.bottom,s.bottom),left:Math.min(n.left,s.left),right:Math.max(n.right,s.right)}}return s}t.getLimits=function(e,t,i,s){var n={top:0,right:0,bottom:0,left:0,width:0,height:0},a=h(t.get(0)),r=null!==a,o=c.call(this,i,r),l=g(s),d=t.parent().get(0).getBoundingClientRect();switch(e){case Enum.CropToParent.height:case Enum.CropToParent.both:n.top=d.top,n.right=r?l.right:o.right,n.bottom=d.bottom,n.left=o.left;break;default:n.top=o.top,n.right=r?l.right:o.right,n.bottom=r?l.bottom:o.bottom,n.left=o.left}return n.top=Math.max(l.top,n.top),n.right=Math.min(l.right,n.right),n.bottom=Math.min(l.bottom,n.bottom),n.left=Math.max(l.left,n.left),n.width=n.right-n.left,n.height=n.bottom-n.top,n},t.getBorderColors=function(){if(!this.itemView)return[];var e=getComputedStyle(this.itemView.el.get(0));return{bottom:e.getPropertyValue("border-bottom-color"),left:e.getPropertyValue("border-left-color"),right:e.getPropertyValue("border-right-color"),top:e.getPropertyValue("border-top-color")}};function h(e){return Utils.getClosestDialogElem(e)}function u(e,t,i,s){e.top<t.top&&(s!==Enum.Position.top&&s!==Enum.Position.middle||(e.height-=Math.abs(e.top-t.top)/i),e.top=t.top),e.top+e.height*i>t.top+t.height&&(e.height-=(e.top+e.height*i-t.top-t.height)/i),e.left<t.left&&(e.left=t.left),e.left+e.width*i>t.right&&(e.left=Math.max(t.right-e.width*i,0))}function g(e){if(window.visualViewport){var t=window.visualViewport,i=Math.max(1,t.scale);return m({top:t.offsetTop*i,left:t.offsetLeft*i,bottom:(t.offsetTop+t.height)*i,right:(t.offsetLeft+t.width)*i,width:t.width*i,height:t.height*i})}return m(e.get(0).getBoundingClientRect())}function m(e){var t={top:e.top,right:e.right,bottom:e.bottom,left:e.left};return t.top=0,t.left=0,t.width=t.right-t.left,t.height=t.bottom-t.top,t.bottom=t.height,t.right=t.width,t}return DropDownBoxView}),define("widgets/brease/DropDownBox/libs/reducer/DropDownBoxReducer",["widgets/brease/common/libs/redux/reducers/Text/TextReducer","widgets/brease/common/libs/redux/reducers/Image/ImageReducer","widgets/brease/common/libs/redux/reducers/Status/StatusReducer","widgets/brease/common/libs/redux/reducers/Size/SizeReducer","widgets/brease/common/libs/redux/reducers/List/ListReducer","widgets/brease/common/libs/redux/reducers/Style/StyleReducer","widgets/brease/common/libs/external/redux"],function(TextReducer,ImageReducer,StatusReducer,SizeReducer,ListReducer,StyleReducer,e){"use strict";return e.combineReducers({text:TextReducer,items:ListReducer,image:ImageReducer,status:StatusReducer,size:SizeReducer,style:StyleReducer})}),define("widgets/brease/DropDownBox/DropDownBox",["brease/core/BaseWidget","widgets/brease/DropDownBox/libs/FocusHandler","widgets/brease/DropDownBox/libs/config/Config","widgets/brease/DropDownBox/libs/config/InitState","widgets/brease/DropDownBox/libs/SubmitQueue","brease/decorators/LanguageDependency","brease/decorators/VisibilityDependency","widgets/brease/DropDownBox/libs/view/DropDownBoxView/DropDownBoxView","widgets/brease/DropDownBox/libs/reducer/DropDownBoxActions","widgets/brease/DropDownBox/libs/reducer/DropDownBoxReducer","widgets/brease/common/libs/external/redux","widgets/brease/common/libs/redux/utils/UtilsList","widgets/brease/common/libs/redux/utils/UtilsImage","widgets/brease/common/libs/redux/utils/UtilsText","widgets/brease/common/libs/BindingSync","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,FocusHandler,Config,InitState,SubmitQueue,t,i,DropDownBoxView,DropDownBoxActions,DropDownBoxReducer,s,UtilsList,UtilsImage,UtilsText,BindingSync,UtilsEditableBinding,n){"use strict";var a=Config,r=e.extend(function DropDownBox(){e.apply(this,arguments)},a),o=r.prototype;o.init=function(){e.prototype.init.apply(this,arguments),BindingSync.setupPropertyOrder(this,[{name:"selectedValue",waitFor:["dataProvider"]},{name:"selectedIndex",waitFor:["dataProvider"]}]),this.submitQueue=new SubmitQueue(this);var t=InitState.calculateInitState(this.settings,this.isEnabled(),this.isVisible());this.store=s.createStore(DropDownBoxReducer,t),this.dropDownBoxView=new DropDownBoxView(this.store,this.el,this),this.store.subscribe(this.dropDownBoxView.render.bind(this.dropDownBoxView)),this.offlineAttributes=new Set,this.focusHandler=new FocusHandler(this),brease.config.isKeyboardOperationEnabled()&&this.dropDownBoxView.addEventListener("ViewRendered",this.focusHandler.onRender.bind(this.focusHandler)),window.addEventListener("scroll",this._bind("close"))},o._initEditor=function(){this.designer.trySetProperty=f.bind(this)},o._handleFocusKeyDown=function(t){e.prototype._handleFocusKeyDown.apply(this,arguments),this.focusHandler.handleKeyDown(t)},o.getItemContainer=function(){if(void 0!==this.dropDownBoxView.listContainer)return this.dropDownBoxView.listContainer[0].querySelector(".ListView.Container")},o.getSelectedItem=function(){if(void 0!==this.dropDownBoxView.listContainer)return this.dropDownBoxView.listContainer[0].querySelector(".ItemView.itemSelected")},o.getAllItems=function(){if(void 0!==this.dropDownBoxView.listContainer)return this.dropDownBoxView.listContainer[0].querySelectorAll(".ItemView")},o.getScroller=function(){return this.dropDownBoxView.listView.scroller},o.valueChangeFromUI=function(){this.submitChange(),this.triggerToggleStateChanged()},o.setStyle=function(t){e.prototype.setStyle.apply(this,arguments);var i=DropDownBoxActions.styleChange(t);this.store.dispatch(i)},o.setAdditionalStyle=function(t){e.prototype.setAdditionalStyle.apply(this,arguments),void 0!==this.dropDownBoxView.listContainer&&this.dropDownBoxView.listContainer.addClass(this._createStyleClass(t));var i=DropDownBoxActions.additionalStyleChange(this.getAdditionalStyles());this.store.dispatch(i)},o.removeAdditionalStyle=function(t){e.prototype.removeAdditionalStyle.apply(this,arguments),void 0!==this.dropDownBoxView.listContainer&&this.dropDownBoxView.listContainer.removeClass(this._createStyleClass(t));var i=DropDownBoxActions.additionalStyleChange(this.getAdditionalStyles());this.store.dispatch(i)},o.langChangeHandler=function(){var e=DropDownBoxActions.changeLanguage();this.store.dispatch(e)},o._setWidth=function(t){e.prototype._setWidth.apply(this,arguments);var i=DropDownBoxActions.changeWidth(t);this.store.dispatch(i)},o._setHeight=function(t){e.prototype._setHeight.apply(this,arguments);var i=DropDownBoxActions.changeHeight(t);this.store.dispatch(i)},o.open=function(){if(!this.isOffline()&&!this.store.getState().items.listOpen){var e=DropDownBoxActions.openList();this.store.dispatch(e),this.triggerToggleStateChanged()}},o.close=function(){if(this.store.getState().items.listOpen){var e=DropDownBoxActions.closeList();this.store.dispatch(e),this.triggerToggleStateChanged()}},o.toggle=function(){if(!this.isOffline()){var e=DropDownBoxActions.toggleListStatus();this.store.dispatch(e),this.triggerToggleStateChanged()}},o.triggerToggleStateChanged=function(){var e=this.store.getState();this.focusHandler.onToggleStateChanged(e.items.listOpen),this.createEvent("ToggleStateChanged",{newValue:e.items.listOpen}).dispatch()},o.setDataProvider=function(e){if(null===e)return this.settings.dataProvider=e,d.call(this,"dataProvider"),void 0;this.settings.dataProvider=UtilsList.parseJSONtoObject(e,this.elem.id),c.call(this,"dataProvider");var t=m.call(this),i=h(arguments[arguments.length-1]),s=UtilsText.getTextsFromItems(this.settings.dataProvider),n=DropDownBoxActions.updateText(s),a=UtilsImage.createImageList(this.settings.dataProvider),r=DropDownBoxActions.updateImageList(a),o=UtilsList.getItemsFromItems(this.settings.dataProvider),l=DropDownBoxActions.updateItemList(o);this.store.dispatch(n),this.store.dispatch(r),this.store.dispatch(l),p.call(this,"selectedIndex")||p.call(this,"selectedValue")?this.submitChange({previous:t,triggeredByBinding:i,deferred:!0}):this.submitChange({previous:t,triggeredByBinding:i}),this.internalData.selectedValue?this.setSelectedValue(this.internalData.selectedValue):this.internalData.selectedIndex&&this.setSelectedIndex(this.internalData.selectedIndex)},o.getDataProvider=function(){return this.settings.dataProvider},o.setSelectedValue=function(e){l.call(this,"selectedValue",DropDownBoxActions.updateSelectedValue(e),e,arguments[arguments.length-1])},o.getSelectedValue=function(){return null===this.settings.selectedValue?this.settings.selectedValue:this.store.getState().items.selectedValue},o.setSelectedIndex=function(e){l.call(this,"selectedIndex",DropDownBoxActions.updateSelectedItem(e),e,arguments[arguments.length-1])},o.getSelectedIndex=function(){return null===this.settings.selectedIndex?this.settings.selectedIndex:this.store.getState().items.selectedIndex},o.setMultiLine=function(e){this.settings.multiLine=e;var t=DropDownBoxActions.updateTextSettings({multiLine:e});this.store.dispatch(t)},o.getMultiLine=function(){return this.settings.multiLine},o.setEllipsis=function(e){this.settings.ellipsis=e;var t=DropDownBoxActions.updateTextSettings({ellipsis:e});this.store.dispatch(t)},o.getEllipsis=function(){return this.settings.ellipsis},o.setWordWrap=function(e){this.settings.wordWrap=e;var t=DropDownBoxActions.updateTextSettings({wordWrap:e});this.store.dispatch(t)},o.getWordWrap=function(){return this.settings.wordWrap},o.setFitHeight2Items=function(e){this.settings.fitHeight2Items=e;var t=DropDownBoxActions.updateItemSettings({fitHeight2Items:e});this.store.dispatch(t)},o.getFitHeight2Items=function(){return this.settings.fitHeight2Items},o.setItemHeight=function(e){this.settings.itemHeight=e;var t=DropDownBoxActions.updateItemSettings({itemHeight:e});this.store.dispatch(t)},o.getItemHeight=function(){return this.settings.itemHeight},o.setImageAlign=function(e){this.settings.imageAlign=e;var t=DropDownBoxActions.updateItemSettings({imageAlign:e});this.store.dispatch(t)},o.getImageAlign=function(){return this.settings.imageAlign},o.setImagePath=function(e){this.settings.imagePath=e;var t=DropDownBoxActions.updateImagePath(e);this.store.dispatch(t)},o.getImagePath=function(){return this.settings.imagePath},o.setListPosition=function(e){this.settings.listPosition=e;var t=DropDownBoxActions.updateListSettings({listPosition:e});this.store.dispatch(t)},o.getListPosition=function(){return this.settings.listPosition},o.setListWidth=function(e){this.settings.listWidth=e;var t=DropDownBoxActions.updateListSettings({listWidth:e});this.store.dispatch(t)},o.getListWidth=function(){return this.settings.listWidth},o.setMaxVisibleEntries=function(e){this.settings.maxVisibleEntries=e;var t=DropDownBoxActions.updateListSettings({maxVisibleEntries:e});this.store.dispatch(t)},o.getMaxVisibleEntries=function(){return this.settings.maxVisibleEntries},o.setCropToParent=function(e){this.settings.cropToParent=e;var t=DropDownBoxActions.updateListSettings({cropToParent:e});this.store.dispatch(t)},o.getCropToParent=function(){return this.settings.cropToParent},o.setDisplaySettings=function(e){this.settings.displaySettings=e;var t=UtilsList.getShowValues(this.settings.displaySettings),i=DropDownBoxActions.updateListSettings({showTexts:t.showTexts,showImages:t.showImages,showTextsInButton:t.showTextsInButton,showImagesInButton:t.showImagesInButton});this.store.dispatch(i)},o.getDisplaySettings=function(){return this.settings.displaySettings},o._clickHandler=function(t){e.prototype._clickHandler.call(this,t,{origin:this.elem.id})},o.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["selectedIndex","selectedValue"])},o.updateVisibility=function(){if(e.prototype.updateVisibility.apply(this,arguments),void 0!==this.store){var t=DropDownBoxActions.changeVisible(this.isVisible());this.store.dispatch(t)}},o._enableHandler=function(){if(this.isOffline())this.isEnabled()&&this.disable();else{e.prototype._enableHandler.apply(this,arguments);var t=DropDownBoxActions.changeEnable(this.isEnabled());this.store.dispatch(t)}},o.isOffline=function(){return this.offlineAttributes.size>0},o.dispose=function(){window.removeEventListener("scroll",this._bind("close")),this.dropDownBoxView.dispose(),this.submitQueue.clear(),e.prototype.dispose.apply(this,arguments)},o.suspend=function(){if(void 0!==this.store){var t=DropDownBoxActions.closeList();this.store.dispatch(t);var i=DropDownBoxActions.changeActive(!1);this.store.dispatch(i)}this.submitQueue.clear(),e.prototype.suspend.apply(this,arguments)},o.onBeforeSuspend=function(){this.bindings&&this.bindings.dataProvider&&(this.settings.dataProvider=[])},o.wake=function(){if(void 0!==this.store){var t=DropDownBoxActions.changeActive(!0);this.store.dispatch(t)}e.prototype.wake.apply(this,arguments)},o.submitChange=function(config){var e=!1;if(config=config||{},config.previous=config.previous||{},config&&!0===config.deferred)return this.submitQueue.add(config),void 0;this.submitQueue.length()>0&&(config.previous=this.submitQueue.getPrevious(),this.submitQueue.clear(),e=!0);var t=this.store.getState();if(!UtilsList.isEqualIntBool(config.previous.selectedIndex,t.items.selectedIndex)||config.previous.selectedValue!==t.items.selectedValue){this.createEvent("SelectedIndexChanged",{selectedIndex:this.getSelectedIndex(),selectedValue:this.getSelectedValue()}).dispatch()}var i={};config&&!0===config.triggeredByBinding?!0===e?(u("selectedIndex",i,t.items,config.previous),u("selectedValue",i,t.items,config.previous)):(u("selectedIndex",i,t.items,this.settings),u("selectedValue",i,t.items,this.settings)):(u("selectedIndex",i,t.items,config.previous),u("selectedValue",i,t.items,config.previous)),this.settings.selectedIndex=t.items.selectedIndex,this.settings.selectedValue=t.items.selectedValue,void 0===i.selectedIndex&&void 0===i.selectedValue||this.sendValueChange(i)};function l(e,t,i,s){if(this.settings[e]=i,null===i)return d.call(this,e),void 0;if(c.call(this,e),!this.isOffline()&&this.settings.dataProvider.length>0){this.internalData[e]=void 0;var n=m.call(this),a=h(s);this.store.dispatch(t),p.call(this,e)&&!0!==a?this.submitChange({previous:n,triggeredByBinding:a,deferred:!0}):this.submitChange({previous:n,triggeredByBinding:a})}else this.internalData[e]=i}function d(e){this.isOffline()||(this.store.dispatch(DropDownBoxActions.setListOffline()),this.close(),this.disable()),this.offlineAttributes.add(e)}function c(e){this.offlineAttributes.delete(e)&&!this.isOffline()&&(this.setEnable(this.settings.enable),this.store.dispatch(DropDownBoxActions.setListOnline()))}function h(e){return void 0!==e&&"server"===e.origin}function u(e,t,i,s){g(e,i[e],s[e])||(t[e]=i[e])}function g(e,t,i){return"selectedIndex"===e?UtilsList.isEqualIntBool(t,i):t===i}function m(){return{selectedIndex:this.getSelectedIndex(),selectedValue:this.getSelectedValue()}}function p(e){return void 0!==this.bindings&&void 0!==this.bindings[e]}function f(e,t){var i={};return i[e]=t,"selectedIndex"===e?i=Object.assign(i,b.call(this,t)):"selectedValue"===e?i=Object.assign(i,v.call(this,t)):"dataProvider"===e&&(i=Object.assign(i,y.call(this,t))),i}function b(e){var t={};return this.settings.dataProvider[e]&&(t.selectedValue=this.settings.dataProvider[e].value),t}function v(e){var t={},i=w(this.settings.dataProvider,e);return-1!==i&&(t.selectedIndex=i),t}function y(e){var t={};return 0===e.length?(t.selectedIndex=a.selectedIndex,t.selectedValue=a.selectedValue):e[this.settings.selectedIndex]?-1===w(e,this.settings.selectedValue)&&(t.selectedValue=e[this.settings.selectedIndex].value):(t.selectedIndex=e.length-1,t.selectedValue=e[e.length-1].value),t}function w(e,t){return e.findIndex(function(e){return e.value===t})}return n.decorate(i.decorate(t.decorate(r,!0),!1),!1)}),define("widgets/brease/Rectangle/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Rectangle",parents:["*"],children:[],inheritance:["widgets.brease.Rectangle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},
SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/Ellipse/designer/ClassInfo",["widgets/brease/Rectangle/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Ellipse",parents:["*"],children:[],inheritance:["widgets.brease.Ellipse","widgets.brease.Rectangle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/Ellipse/Ellipse.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Ellipse"></div>\r\n'}),define("widgets/brease/Rectangle/Rectangle",["brease/core/BaseWidget","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,t){"use strict";var i={},s=e.extend(function Rectangle(){e.apply(this,arguments)},i);return s.prototype.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseRectangle"),this._invalidate(),e.prototype.init.call(this)},t.decorate(s,!1)}),define("widgets/brease/Ellipse/Ellipse",["widgets/brease/Rectangle/Rectangle","brease/enum/Enum","brease/core/Types"],function(e,Enum,Types){"use strict";var t={},i=e.extend(function Ellipse(){e.apply(this,arguments)},t);return i.prototype.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseEllipse"),e.prototype.init.call(this)},i}),define("widgets/brease/FileExplorer/designer/ClassInfo",["widgets/brease/TableWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.FileExplorer",parents:["*"],children:["widgets.brease.FileExplorerItem"],inheritance:["widgets.brease.FileExplorer","widgets.brease.TableWidget","widgets.brease.DataHandlerWidget","brease.core.BaseWidget"],actions:{Browse:{method:"browse",parameter:{path:{name:"path",index:0,type:"String"}}},Copy:{method:"copy"},CreateFolder:{method:"createFolder",parameter:{FolderName:{name:"FolderName",index:0,type:"String"}}},Cut:{method:"cut"},Delete:{method:"delete"},Focus:{method:"focus"},GetMultiSelect:{method:"getMultiSelect"},GetPath:{method:"getPath"},GoToFirstPage:{method:"goToFirstPage"},GoToLastPage:{method:"goToLastPage"},GoToNextPage:{method:"goToNextPage"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"Integer"}}},GoToPreviousPage:{method:"goToPreviousPage"},Open:{method:"open"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"MappTableConfigurationType"}}},Paste:{method:"paste"},Rename:{method:"rename",parameter:{NewName:{name:"NewName",index:0,type:"String"}}},SelectAll:{method:"selectAll"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},setHeaderHeight:{method:"setHeaderHeight",parameter:{headerHeaderHeight:{name:"headerHeaderHeight",index:0,type:"PixelVal"}}},setHeaderSorting:{method:"setHeaderSorting",parameter:{headerSorting:{name:"headerSorting",index:0,type:"Boolean"}}},setImageBin:{method:"setImageBin",parameter:{imageBin:{name:"imageBin",index:0,type:"ImagePath"}}},setImageBr:{method:"setImageBr",parameter:{imageBr:{name:"imageBr",index:0,type:"ImagePath"}}},setImageCsv:{method:"setImageCsv",parameter:{imageCsv:{name:"imageCsv",index:0,type:"ImagePath"}}},setImageDoc:{method:"setImageDoc",parameter:{imageDoc:{name:"imageDoc",index:0,type:"ImagePath"}}},setImageDrive:{method:"setImageDrive",parameter:{imageDrive:{name:"imageDrive",index:0,type:"ImagePath"}}},setImageFile:{method:"setImageFile",parameter:{imageFile:{name:"imageFile",index:0,type:"ImagePath"}}},setImageFolder:{method:"setImageFolder",parameter:{imageFolder:{name:"imageFolder",index:0,type:"ImagePath"}}},setImageHtml:{method:"setImageHtml",parameter:{imageHtml:{name:"imageHtml",index:0,type:"ImagePath"}}},setImageImg:{method:"setImageImg",parameter:{imageImg:{name:"imageImg",index:0,type:"ImagePath"}}},setImageMov:{method:"setImageMov",parameter:{imageMov:{name:"imageMov",index:0,type:"ImagePath"}}},setImagePdf:{method:"setImagePdf",parameter:{imagePdf:{name:"imagePdf",index:0,type:"ImagePath"}}},setImageRoot:{method:"setImageRoot",parameter:{imageRoot:{name:"imageRoot",index:0,type:"ImagePath"}}},setImageUnplugged:{method:"setImageUnplugged",parameter:{imageUnplugged:{name:"imageUnplugged",index:0,type:"ImagePath"}}},setImageXls:{method:"setImageXls",parameter:{imageXls:{name:"imageXls",index:0,type:"ImagePath"}}},setImageXml:{method:"setImageXml",parameter:{imageXml:{name:"imageXml",index:0,type:"ImagePath"}}},setItemsPerPage:{method:"setItemsPerPage",parameter:{itemsPerPage:{name:"itemsPerPage",index:0,type:"Integer"}}},SetMultiSelect:{method:"setMultiSelect",parameter:{multiSelect:{name:"multiSelect",index:0,type:"Boolean"}}},setNextText:{method:"setNextText",parameter:{nextText:{name:"nextText",index:0,type:"String"}}},setNextTextKey:{method:"setNextTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setPaging:{method:"setPaging",parameter:{paging:{name:"paging",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPreviousText:{method:"setPreviousText",parameter:{previousText:{name:"previousText",index:0,type:"String"}}},setPreviousTextKey:{method:"setPreviousTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"String"}}},setSearchBox:{method:"setSearchBox",parameter:{searchBox:{name:"searchBox",index:0,type:"Boolean"}}},setShowPagingButtons:{method:"setShowPagingButtons",parameter:{showPagingButtons:{name:"showPagingButtons",index:0,type:"Boolean"}}},setSortConfiguration:{method:"setSortConfiguration",parameter:{sortConfiguration:{name:"sortConfiguration",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setStyleConfiguration:{method:"setStyleConfiguration",parameter:{styleConfiguration:{name:"styleConfiguration",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/FileExplorer/FileExplorer.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/FileExplorer">CONTENT</div>'}),define("widgets/brease/FileExplorer/libs/Model",["widgets/brease/TableWidget/libs/Model"],function(e){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t,this.firstConnection=!0},t),s=i.prototype;s.initialize=function(){this.errorMode=!1,this.files=[],this.itr=0,this.branches=1,this.fileCount={},this.resetPaths(),e.prototype.initialize.call(this)},s.browse=function(e){e&&(this.updateTable(e),this.settings.expectedDataLength=e.length,this.settings.actualDataLength=0,this.widget.el.find("img").on("load",this._bind("_imageLoad")))},s._imageLoad=function(e){var t=e.target.src.split("/").pop().split(".")[0];"folder"!==t&&"file"!==t||(this.settings.actualDataLength+=1),this.settings.actualDataLength===this.settings.expectedDataLength&&(this.widget._refreshScroller(),this.settings.actualDataLength=0,this.widget.el.find("img").off("load",this._bind("_imageLoad")))},s.updateTable=function(e){if(e){this.currentData=$.extend(!0,[],e);for(var t=0;t<e.length;t+=1){var i=e[t].Type,s=e[t].Path.split("/");e[t].Path="FILE"===i?s[s.length-1]:"DRIVE"===i?s[s.length-2]+(e[t].Text.length>0?" ("+e[t].Text+")":""):"USB_DRIVE"===i?e[t].Text:s[s.length-2],"FILE"===i&&(e[t].Type=this._fixFileType(i,e[t].Path)),e[t].Path=this._addIconSVG(e[t].Path,i),void 0!==e[t].Date?e[t].Date=this._fixTimestamp(e[t].Date):e[t].Date={display:"",value:0},e[t].Size=this._fixSize(e[t].Size)}this.data=e,brease.config.editMode||this.widget.renderer.updateData()}},s.setMockData=function(){if(!brease.config.editMode)return!1;this.fetchData(r()),this.updateTable(this.telegram.data)},s.getFolderToPaste=function(e){var t=!1;return this.currentData.forEach(function(i){e===i.Path.substring(i.Path.substring(0,i.Path.length-1).lastIndexOf("/")+1,i.Path.length-1)&&(t=!0)}),t?this.getHighestFolderNumber(e):e},s.getHighestFolderNumber=function(e){var t=e.match(/.*[^ (?:(\d+))]/),i=0;return this.currentData.forEach(function(e){var s=e.Path.split("/"),n=s[s.length-2],a=n.match(/\d+(?:\.\d+)?(?=\))/);null!==a&&n.includes(t)&&(i=Math.max(parseInt(a[0]),i))}),i>0?t[0]+" ("+(i+1).toString()+")":t[0]+" (1)"},s.getNameToPaste=function(e,t){var i=!1;return this.currentData.forEach(function(s){var n=s.Path.split(e)[1];void 0!==n&&n.split(".")[0]===t&&(i=!0)}),i?this.getHighestCopyNumber(e,t):t},s.getHighestCopyNumber=function(e,t){t=t.match(/.*[^ (?:(\d+))]/);var i=0,s=!1;return this.currentData.forEach(function(n){var a=n.Path.split(e)[1],r=a.match(/\d+(?:\.\d+)?(?=\))/);null!==r&&a.includes(t)&&(s=!0,i=Math.max(parseInt(r[0]),i))}),void 0===this.fileCount[t[0]]?(i+=1,this.fileCount[t[0]]=i):this.fileCount[t[0]]<i?this.fileCount[t[0]]=i:(i=this.fileCount[t[0]]+(s?1:0),this.fileCount[t[0]]=i),i>0?t+" ("+i.toString()+")":t},s.setRootPath=function(e){e=n(e),this.rootpath=e},s.getRootPath=function(){return this.rootpath},s.resetPaths=function(){this.rootpath="",this.rootname="",this.roottype="",this.openpath=""},s.setRootName=function(e){this.rootname=e},s.getRootName=function(){return this.rootname},s.setRootType=function(e){this.roottype=e},s.getRootType=function(){return this.roottype},s.setCurrentPath=function(e,t){"FILE"===t&&(e=e.substring(0,e.lastIndexOf("/")+1)),e=n(e),this.fileCount={},this.openpath=e},s.getCurrentPath=function(){return this.openpath},s.getBreadcrumbPath=function(){return""!==this.rootpath&&""!==this.openpath?this.openpath.split(this.rootpath)[1]:this.openpath},s.getPath=function(e){return this.currentData[e].Path},s.getSize=function(e){return this.currentData[e].Size},s.getType=function(e){return this.currentData[e].Type},s.getName=function(e){return this.currentData[e].Text},s.setData=function(e){this.fetchData(e)},s.fetchData=function(e){null!==e&&(this.telegram=$.extend(!0,{},e))},s._fixSize=function(e){var t=e;return e=Math.ceil(e/1024).toString(),{value:t||0,display:isNaN(e)?"":e.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1 ")+" KB"}},s._fixFileType=function(e,t){var i=t.split("."),s=e;return i.length>1&&(s=i[i.length-1].toUpperCase()),'<span style="display:none;">'+e+"</span>"+s},s._addIconSVG=function(e,t){var i="widgets/brease/FileExplorer/assets/";return"DRIVE"===t?i+="drive.svg":"USB_DRIVE"===t?i+="usb.svg":"FOLDER"===t?i+="folder.svg":"FILE"===t?i+=a(e):"DRIVE_UNPLUGGED"===t&&(i+="unplugged.svg"),'<img src="'+i+'" /><div>'+e+"</div>"};function n(e){return e.length-1!==e.lastIndexOf("/")&&(e+="/"),e}function a(e){var t;return t=e.indexOf(".csv")>-1?"csv.svg":e.indexOf(".pdf")>-1?"pdf.svg":e.indexOf(".xml")>-1?"xml.svg":e.indexOf(".doc")>-1?"doc.svg":e.indexOf(".xls")>-1?"xls.svg":e.indexOf(".jpg")>-1||e.indexOf(".png")>-1||e.indexOf(".bmp")>-1?"img.svg":e.indexOf(".mpeg")>-1||e.indexOf(".avi")>-1?"mov.svg":e.indexOf(".html")>-1?"html.svg":e.indexOf(".bin")>-1?"bin.svg":e.indexOf(".br")>-1?"br.svg":"file.svg",t}function r(){return{data:[{Path:"foldUp",Type:"FOLDER",Locked:0,ReadOnly:1,Size:"",Date:"1970-01-01T00:00:00.000+00:00"},{Path:"C:/Temp/Logger.csv",Type:"FILE",Locked:0,ReadOnly:0,Size:"10Mb",Date:"1970-01-01T00:00:01.000+00:00"},{Path:"C:/Temp/Spec.pdf",Type:"FILE",Locked:0,ReadOnly:1,Size:"10Mb",Date:"1970-01-01T00:00:02.000+00:00"},{Path:"C:/Temp/A12_45_ArSim_18_04_12.csv",Type:"FILE",Locked:1,ReadOnly:0,Size:"10Mb",Date:"1970-01-01T00:00:03.000+00:00"},{Path:"C:/Temp/Recipe/",Type:"FOLDER",Locked:1,ReadOnly:1,Size:"",Date:"1970-01-01T00:00:04.000+00:00"},{Path:"USB/",Type:"DRIVE_UNPLUGGED",Locked:0,ReadOnly:0,Size:"",Date:"1970-01-01T00:00:05.000+00:00"},{Path:"C:/Temp/Config.xml",Type:"FILE",Locked:0,ReadOnly:0,Size:"10Mb",Date:"1970-01-01T00:00:06.000+00:00"},{Path:"C:/Temp/Instructions.docx",Type:"FILE",Locked:0,ReadOnly:0,Size:"10Mb",Date:"1970-01-01T00:00:07.000+00:00"},{Path:"C:/Temp/Logo.png",Type:"FILE",Locked:0,ReadOnly:0,Size:"10Mb",Date:"1970-01-01T00:00:08.000+00:00"}],methodID:"GetBrowse",response:"OK"}}return i}),define("widgets/brease/FileExplorer/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{title:"Configuration dialogue for FileExplorer",delete:{title:"Delete this file",pretext:"Are you sure you want to delete ",posttext:"? This action cannot be undone!"},rename:{title:"Rename this file",text:"Please give the file a new name"},mkdir:{title:"Create a new folder",text:"To create a new folder, please enter a name and press ok."},error:{title:"A mistake has been made!",text:"There seems to be a problem. Backend is reporting the following issue ",nbr:"The following error code is reported: "},saveas:{title:"Save file as",text:"To save the file, please enter a name and press ok."}},de:{}}}return new DialogueTexts}),define("widgets/brease/FileExplorer/libs/DiagRename",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/FileExplorer/libs/DialogueTexts"],function(e,BreaseEvent,t,Texts){"use strict";var i=e.extend(function DiagRename(t,i,s,n){this.lang=s,this.dialog=t,this.widget=i,this.header=Texts[this.lang].rename.title,this.file=n,e.call(this)},null),s=i.prototype;return s.initialize=function(){this.config={startWidgets:[]},this.config.startWidgets.push(this._getImage("rename_image")),this.config.startWidgets.push(this._getLabel("rename_label")),this.config.startWidgets.push(this._getInputText("rename_inputtext"));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);return $("#"+this.config.startWidgets[1].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")),this.config},s.retrieveData=function(){return brease.callWidget(this.config.startWidgets[2].id,"getValue")},s._updateTexts=function(e){$("#"+e.target.id).off(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")).css({"font-size":"20px","font-bold":"bold"})},s._getImage=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Image",i.x=50,i.y=75,i.width=70,i.height=70,i.options={image:"widgets/brease/FileExplorer/assets/delete.svg"},i},s._getInputText=function(e){var i=new t;return i.name=e,i.type="widgets/brease/TextInput",i.x=160,i.y=110,i.width=400,i.height=50,i.options={value:this.file},i},s._getLabel=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Label",i.x=160,i.y=60,i.width=400,i.height=50,i.options={text:Texts[this.lang].rename.text,multiLine:!0,breakWord:!0,wordWrap:!0},i},i}),define("widgets/brease/FileExplorer/libs/DiagDelete",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/FileExplorer/libs/DialogueTexts"],function(e,BreaseEvent,t,Texts){"use strict";var i=e.extend(function DiagDelete(t,i,s,n){this.lang=s,this.dialog=t,this.widget=i,this.header=Texts[this.lang].delete.title,this.file=n,e.call(this)},null),s=i.prototype;return s.initialize=function(e){this.config={startWidgets:[]},this.config.startWidgets.push(this._getImage("delete_image")),this.config.startWidgets.push(this._getLabel("delete_label",e));for(var t=0;t<this.config.startWidgets.length;t+=1)this.dialog.addWidget(this.config.startWidgets[t]);return $("#"+this.config.startWidgets[1].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")),this.config},s._updateTexts=function(e){$("#"+e.target.id).off(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")).css({"font-size":"20px","font-bold":"bold"})},s._getImage=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Image",i.x=50,i.y=75,i.width=70,i.height=70,i.options={image:"widgets/brease/FileExplorer/assets/delete.svg"},i},s._getLabel=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Label",i.x=160,i.y=60,i.width=400,i.height=100,i.options={text:Texts[this.lang].delete.pretext+this.file+Texts[this.lang].delete.posttext,multiLine:!0,breakWord:!0,wordWrap:!0},i},i}),define("widgets/brease/FileExplorer/libs/DiagMkdir",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/FileExplorer/libs/DialogueTexts"],function(e,BreaseEvent,t,Texts){"use strict";var i=e.extend(function DiagMkdir(t,i,s,n){this.lang=s,this.dialog=t,this.widget=i,this.header=Texts[this.lang].mkdir.title,this.file=n,e.call(this)},null),s=i.prototype;return s.initialize=function(){this.config={startWidgets:[]},this.config.startWidgets.push(this._getImage("mkdir_image")),this.config.startWidgets.push(this._getLabel("mkdir_label")),this.config.startWidgets.push(this._getInputText("mkdir_inputtext"));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);return $("#"+this.config.startWidgets[1].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")),this.config},s.retrieveData=function(){return brease.callWidget(this.config.startWidgets[2].id,"getValue")},s._updateTexts=function(e){$("#"+e.target.id).off(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")).css({"font-size":"20px","font-bold":"bold"})},s._getImage=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Image",i.x=50,i.y=75,i.width=70,i.height=70,i.options={image:"widgets/brease/FileExplorer/assets/folder.svg"},i},s._getInputText=function(e){var i=new t;return i.name=e,i.type="widgets/brease/TextInput",i.x=160,i.y=110,i.width=400,i.height=50,i.options={value:"New Folder"},i},s._getLabel=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Label",i.x=160,i.y=60,i.width=400,i.height=50,i.options={text:Texts[this.lang].mkdir.text,multiLine:!0,breakWord:!0,wordWrap:!0},i},i}),define("widgets/brease/FileExplorer/libs/DiagError",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/FileExplorer/libs/DialogueTexts"],function(e,BreaseEvent,t,Texts){"use strict";var i=e.extend(function DiagDelete(t,i,s,n,a){this.lang=s,this.dialog=t,this.widget=i,this.header=Texts[this.lang].error.title,this.text=n,this.nbr=a,e.call(this)},null),s=i.prototype;return s.initialize=function(){this.config={startWidgets:[]},this.config.startWidgets.push(this._getImage("error_image")),this.config.startWidgets.push(this._getLabel("error_label","nbr",this.nbr));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);return $("#"+this.config.startWidgets[1].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")),this.config},s._updateTexts=function(e){$("#"+e.target.id).off(BreaseEvent.WIDGET_READY,this._bind("_updateTexts")).css({"font-size":"20px","font-bold":"bold"})},s._getImage=function(e){var i=new t;return i.name=e,i.type="widgets/brease/Image",i.x=50,i.y=75,i.width=70,i.height=70,i.options={image:"widgets/brease/FileExplorer/assets/warn.svg"},i},s._getLabel=function(e,i){var s=new t;return s.name=e,s.type="widgets/brease/Label",s.x=160,s.y=60,s.width=400,s.height=100,s.options={text:Texts[this.lang].error[i]+this.text,multiLine:!0,breakWord:!0,wordWrap:!0},s},i}),define("widgets/brease/FileExplorer/libs/Dialogue",["widgets/brease/TableWidget/libs/Dialogue","brease/events/BreaseEvent","widgets/brease/GenericDialog/GenericDialog","widgets/brease/GenericDialog/libs/config","widgets/brease/FileExplorer/libs/DiagRename","widgets/brease/FileExplorer/libs/DiagDelete","widgets/brease/FileExplorer/libs/DiagMkdir","widgets/brease/FileExplorer/libs/DiagError","widgets/brease/TableWidget/libs/FilterSettings","widgets/brease/TableWidget/libs/SortingSettings","widgets/brease/TableWidget/libs/StylingSettings","widgets/brease/FileExplorer/libs/DialogueTexts"],function(e,BreaseEvent,t,i,DiagRename,DiagDelete,DiagMkdir,DiagError,FilterSettings,SortingSettings,StylingSettings,DialogueTexts){"use strict";var s=e.extend(function Dialogue(){e.apply(this,arguments)},null),n=s.prototype;n.initializeFilter=function(e){return this.filter=new FilterSettings(this.dialog,this.widget,e),this._initializeEmptyDialogConfig(DialogueTexts[e].title,480,600),this.config},n.initializeSort=function(e){return this.sort=new SortingSettings(this.dialog,this.widget,e),this._initializeEmptyDialogConfig(DialogueTexts[e].title,480,600),this.config},n.initializeStyle=function(e){return this.style=new StylingSettings(this.dialog,this.widget,e),this._initializeEmptyDialogConfig(DialogueTexts[e].title,480,600),this.config},n.openDelete=function(e){this.lang=a();var i=new t(this.widget.elem);this.delete=new DiagDelete(i,this.widget,this.lang,e),this._initializeEmptyDialogConfig(this.delete.header,200,600),this.open(i,this.config,"delete")},n.openRename=function(e){this.lang=a();var i=new t(this.widget.elem);this.rename=new DiagRename(i,this.widget,this.lang,e),this._initializeEmptyDialogConfig(this.rename.header,200,600),this.open(i,this.config,"rename")},n.openMkdir=function(e){this.lang=a();var i=new t(this.widget.elem);this.mkdir=new DiagMkdir(i,this.widget,this.lang,e),this._initializeEmptyDialogConfig(this.mkdir.header,200,600),this.open(i,this.config,"mkdir")},n.openError=function(e,i){this.lang=a();var s=new t(this.widget.elem);this.error=new DiagError(s,this.widget,this.lang,e,i),this._initializeEmptyDialogConfig(this.error.header,200,600),this.open(s,this.config,"error")},n.open=function(e,config,t){e.show(config,this.widget.elem);var i=this;e.isReady().then(function(){$("#"+e.elem.id).on(BreaseEvent.WIDGET_READY,{diag:t,id:e.elem.id},i._bind("_widgetAddedToDiag")),$("#"+e.elem.id).on("window_closing",{diag:t,id:e.elem.id},i._bind("_closeDialogue"))})},n._initializeEmptyDialogConfig=function(e,t,s){this.config=new i,this.config.forceInteraction=!0,this.config.contentWidth=s,this.config.contentHeight=t,this.config.header.text=e,this.config.buttons.ok=!0,this.config.buttons.cancel=!0},n._widgetAddedToDiag=function(e){void 0===e.data.id&&null===e.data.id||($("#"+e.data.id).off(BreaseEvent.WIDGET_READY,this._bind("_widgetAddedToDiag")),this[e.data.diag].initialize(),this._updateColors(e.data.id))},n._closeDialogue=function(e){var t=brease.callWidget(e.data.id,"getDialogResult");"delete"===e.data.diag&&"ok"===t?this.widget.controller._delete():"rename"===e.data.diag&&"ok"===t?this.widget.controller._rename(this[e.data.diag].retrieveData()):"mkdir"===e.data.diag&&"ok"===t&&this.widget.controller._mkdir(this[e.data.diag].retrieveData())},n._updateColors=function(e){$("#"+e).find(".breaseButton").each(function(e,t){$(t).addClass("widgets_brease_Button_style_safety")})};function a(){var e=brease.language.getCurrentLanguage();return"de"!==e&&(e="en"),e}return n.dispose=function(){this.dialog.dispose(),e.prototype.dispose.call(this)},s}),define("widgets/brease/FileExplorer/libs/Controller",["widgets/brease/TableWidget/libs/Controller","brease/events/BreaseEvent","widgets/brease/FileExplorer/libs/Dialogue"],function(e,BreaseEvent,Dialogue){"use strict";var t=e.extend(function Controller(t){e.call(this),this.widget=t,this.diag=new Dialogue(this.widget),this.flags={copy:"RESETLOCK",cut:"RESETLOCK|MOVE"},this.initSource(),this.selectedItems=[]},null),i=t.prototype;return i._addClassSpecificEventListeners=function(e){document.body.addEventListener(BreaseEvent.CONTENT_ACTIVATED,e._bind("_contentActivatedHandler"))},i._rendererInitialized=function(){e.prototype._rendererInitialized.apply(this,arguments)},i.addEventListenerToBreadCrumb=function(e,t){e.on(BreaseEvent.CLICK,{path:t,id:this.widget.elem.id},this._bind("_breadcrumbHandler"))},i.selectAll=function(){var e=this.widget;this.widget.el.find("tr").each(function(t){e.renderer.select(t)}),this.setSelectedItems(this._getRowIndices())},i._itemSelectHandler=function(e){if(this.widget.isDisabled)return!1;var t=$(e.target).closest("tbody").find("tr.selected"),i=$(e.target).closest("tr");this.widget.settings.multiSelect?(t.toArray().includes(i[0])?this.widget.renderer.deselect(i[0]):this.widget.renderer.select(i),this.setSelectedItems(this._getRowIndices())):t[0]!==i[0]&&(this.widget.renderer.deselect(),this.widget.renderer.select(i),this.setSelectedItem(this._getRowIndex())),this.dispatchItemClickEvent(this.widget.renderer.index(i),e)},i.setSelectedItems=function(e){e&&(this.selectedItems=e)},i.getSelectedItems=function(){return!this.widget.isDisabled&&this.selectedItems},i._itemDoubleSelectHandler=function(e){if(this.widget.isDisabled)return!1;var t=$(e.target).closest("tr");this.openFile(this.widget.renderer.index(t))},i.open=function(){var e=$("#"+this.widget.elem.id+"> > > > > .selected");this.openFile(this.widget.renderer.index(e))},i.openFile=function(e){if(void 0!==e){var t=this._getType(e),i=this._getPath(e);this._setCurrentPath(i,t),"FOLDER"===t||"DRIVE"===t||"USB_DRIVE"===t?("FOLDER"!==t&&(this._setRootName(this._getName(e)),this._setRootType(t)),this.browse(i,!1)):this.widget._openFileHandler(i,t,this.widget.model.getSize(e))}},i.rename=function(){if(void 0!==this.selectedItem){var e=this._getType(this.selectedItem);"DRIVE"!==e&&"USB_DRIVE"!==e&&"UNPLUGGED"!==e&&this.diag.openRename(this._getFileName(this._getPath(this.selectedItem).split("/")))}},i.delete=function(){if(void 0!==this.selectedItem)if(this.widget.settings.multiSelect){var e=this,t="";this.selectedItems.forEach(function(i,s){s>0&&(t+=", ");var n=e._getType(i);"DRIVE"!==n&&"USB_DRIVE"!==n&&"UNPLUGGED"!==n&&(t+=e._getFileName(e._getPath(i).split("/")))}),e.diag.openDelete(t)}else{var i=this._getType(this.selectedItem);if("DRIVE"===i||"USB_DRIVE"===i||"UNPLUGGED"===i)return;this.diag.openDelete(this._getFileName(this._getPath(this.selectedItem).split("/")))}},i.error=function(e){for(var t=0;t<e.length;t+=1)this.widget._onErrorHandler(e[t].Code,e[t].Path,e[t].Description,e[t].User,e[t].UserType,e[t].LockTime)},i._delete=function(){var e=this,t="";if(this.widget.settings.multiSelect){var i=this;this.selectedItems.forEach(function(e,s){s>0&&(t+="|");var n=i._getType(e);"DRIVE"!==n&&"USB_DRIVE"!==n&&"UNPLUGGED"!==n&&(t+=i._getPath(e))})}else t=this._getPath(this.selectedItem);this.widget.filemanager.delete(this.widget.elem.id,t).then(function(){e.browse("",!0)}).catch(function(){e.getError()}),this.widget.setMultiSelect(!1)},i._rename=function(e){var t=this,i=this._getPath(this.selectedItem),s="";this.widget.filemanager.rename(this.widget.elem.id,i,e,"").then(function(){t.browse("",!0)}).catch(function(){t.getError()})},i.copy=function(){this.pasteFlag=this.flags.copy,this.copyPaste()},i.cut=function(){this.pasteFlag=this.flags.cut,this.copyPaste()},i.initSource=function(){this.sourceItem=[],this.sourcePos=[],this.sourceEl=[],this.sourceType=[]},i.copyPaste=function(){if(this.sourceItem.length>0)return this.sourceEl.forEach(function(e){e.css("opacity","1")}),this.initSource(),void 0;var e=this;if(this.widget.settings.multiSelect)this.selectedItems.forEach(function(t){if(!e.sourcePos.includes(t)){var i=e._getType(t);"DRIVE"!==i&&"USB_DRIVE"!==i&&"UNPLUGGED"!==i&&(e.sourceItem.push(e._getPath(t)),e.sourceType.push(e._getType(t)),e.sourcePos.push(t),e.sourceEl.push(e.widget.el.find(".selected").css("opacity","0.25")))}}),this.widget.setMultiSelect(!1);else{var t=e._getType(this.selectedItem);if("DRIVE"===t||"USB_DRIVE"===t||"UNPLUGGED"===t)return;e.sourceItem.push(e._getPath(this.selectedItem)),e.sourceType.push(t),e.sourcePos.push(this.selectedItem),e.sourceEl.push(e.widget.el.find(".selected").css("opacity","0.25"))}},i.paste=function(e){if(0!==this.sourceItem.length&&void 0!==this.sourceItem[0]){for(var t="",i="",s=0;s<this.sourceItem.length;s+=1)i+=this.sourceItem[s],"FILE"===this.sourceType[s]?t+=this.pasteItem(this.sourceItem[s],this.pasteFlag,e):t+=this.pasteFolder(this.sourceItem[s],this.pasteFlag,e),s<this.sourceItem.length-1&&(t+="|",i+="|");var n=this;this.widget.filemanager.copy(this.widget.elem.id,i,t,this.pasteFlag).then(function(){n.browse("",!0)}).catch(function(){n.getError()}),this.sourceEl.forEach(function(e){e.css("opacity","1")}),this.initSource()}},i.pasteItem=function(e,t,i){var s=e.lastIndexOf("/")+1,n=e.lastIndexOf("."),a=e.substring(0,s),r=e.substring(s,n),o=e.substring(n,e.length);return i||(i=this._getCurrentPath()),i!==a&&t===this.flags.copy?(a=i,r=this.widget.model.getNameToPaste(a,r)+o):i===a&&t===this.flags.cut?r+=o:(a=i,r=this.widget.model.getNameToPaste(a,r)+o),a+r},i.pasteFolder=function(e,t,i){var s=e.substring(0,e.substring(0,e.length-1).lastIndexOf("/")+1),n=e.substring(e.substring(0,e.length-1).lastIndexOf("/")+1,e.length-1);return i||(i=this._getCurrentPath()),i!==s&&t===this.flags.copy?(s=i,n=this.widget.model.getFolderToPaste(n)):i===s&&t===this.flags.cut||(s=i,n=this.widget.model.getFolderToPaste(n)),i+n+"/"},i.mkdir=function(e){void 0===e||""===e?this.diag.openMkdir():this._mkdir(e)},i._mkdir=function(e){var t=this;this.widget.filemanager.createFolder(this.widget.elem.id,this._getCurrentPath()+e+"/").then(function(){t.browse("",!0)}).catch(function(){t.getError()})},i.restrictions=function(e){var t=this;this.widget.filemanager.restriction(this.widget.elem.id,e).then(function(e){if(e.length>1){e[0].BrowseUp||(t._setRootPath(e[0].Path),t._setRootName(e[0].Name),t._setRootType(e[0].Type)),t._setCurrentPath(e[0].Path,"FOLDER");var i="FILES|FOLDERS";e[0].BrowseDown||(i="FILES"),t.browse(e[0].Path,!1,i)}else t.browse("",!1)}).catch(function(){t.getError()})},i.getError=function(){var e=this;this.widget.filemanager.error(this.widget.elem.id).then(function(t){e.error(t)}).catch(function(e){console.debug("error in getError:",e)})},i.browse=function(e,t,i){t&&(e=this._getCurrentPath()),void 0===i&&(i="FILES|FOLDERS");var s=this.widget;this.widget.filemanager&&this.widget.filemanager.browse(this.widget.elem.id,e,i).then(function(e){s.model.browse(e)}).catch(function(e){console.debug("error in browse:",e)})},i.subscribe=function(e){
this.widget.filemanager.notification(this.widget.elem.id,this.notification,e,"")},i.notification=function(){return null},i._contentActivatedHandler=function(e){document.body.removeEventListener(BreaseEvent.CONTENT_ACTIVATED,this._bind("_contentActivatedHandler")),e.detail.contentId===this.widget.settings.parentContentId&&this&&this.subscribe("")},i._breadcrumbHandler=function(e){e.data.id===this.widget.elem.id&&(this._setCurrentPath(e.data.path,"FOLDER"),0===e.data.path.length&&this._setRootType(""),this.browse(e.data.path,!1))},i._getPath=function(e){return this.widget.model.getPath(e)},i._getType=function(e){return this.widget.model.getType(e)},i._getName=function(e){return this.widget.model.getName(e)},i._setRootPath=function(e){this.widget.model.setRootPath(e)},i._setRootName=function(e){this.widget.model.setRootName(e)},i._setRootType=function(e){this.widget.model.setRootType(e)},i._setCurrentPath=function(e,t){this.widget.model.setCurrentPath(e,t)},i._getCurrentPath=function(){return this.widget.model.getCurrentPath()},i._contentDeactivatedHandler=function(){this.widget.filemanager.denotification(this.widget.elem.id)},i.languageChanged=function(){this.browse(this._getCurrentPath(),!1),this.widget.langChanged=!0},i.openConf=function(e){this.configDialogue=new Dialogue(this.widget),this.configDialogue.open(e)},i.getEventItem=function(e){if(void 0!==e){var t=this.widget.model.getRowFromCurrentData(e);return{Path:t.Path,Type:t.Type,Ext:t.Path.includes(".")?t.Path.split(".")[t.Path.split(".").length-1]:"",Locked:t.Locked,ReadOnly:t.ReadOnly,Size:t.Size,Date:t.Date}}},i.updateData=function(){this.widget.model.setMockData(),this.widget.renderer.updateData()},i._getFileName=function(e){return"FILE"===this._getType(this.selectedItem)?e[e.length-1]:e[e.length-2]},t}),define("widgets/brease/FileExplorer/libs/Config",[],function(){"use strict";return{showExtension:!0,showIcons:!0,imageBin:"",imageBr:"",imageCsv:"",imageDoc:"",imageDrive:"",imageHtml:"",imageFolder:"",imageFile:"",imageImg:"",imageMov:"",imagePdf:"",imageRoot:"",imageUnplugged:"",imageXls:"",imageXml:"",mpLink:"FileManagement",optimize:!1,multiSelect:!1,type:"FileExplorer",config:{columns:[],allColumns:["Path","Type","Locked","ReadOnly","Size","Date"],columnWidths:[],columnTypes:{Path:"str",Type:"str",Locked:"bool",ReadOnly:"bool",Size:"int",Date:"date"},style:[],order:[],hidden:{data:"Type"},filter:[],sort:[],original:{order:[]}}}}),define("widgets/brease/FileExplorer/libs/Renderer",["widgets/brease/TableWidget/libs/Renderer"],function(e){"use strict";var t=e.extend(function Renderer(t){e.call(this),this.widget=t},null);return t.prototype._drawCallback=function(){e.prototype._drawCallback.call(this);var t=this.widget.model.getBreadcrumbPath(),i=this.widget.model.getRootType(),s;switch(i){case"DRIVE":s="drive";break;case"USB_DRIVE":s="usb";break;case"UNPLUGGED":s="unplugged";break;default:s="root";break}void 0!==$("#"+this.widget.elem.id+"> > > .fe_breadcrumbs")&&$("#"+this.widget.elem.id+"> > > .fe_breadcrumbs").remove();var n=$('<div class="fe_breadcrumbs" />'),a=$('<img src="widgets/brease/FileExplorer/assets/'+s+'.svg" style="max-height:22px"/>').css("cursor","pointer");if(this.widget.controller.addEventListenerToBreadCrumb(a,this.widget.model.getRootPath()),n.append(a).css("float","left"),void 0!==t)for(var r=t.split("/"),o="",l=0;l<r.length-1;l+=1){o+=r[l]+"/",a=$("<span />").text(0===l?this.widget.model.getRootName():r[l]).css({color:"#007bff",cursor:"pointer"});var d=$("<span />").text(" / ");this.widget.controller.addEventListenerToBreadCrumb(a,o),n.append(d).append(a)}n.css("font-size","20px"),$("#"+this.widget.elem.id+"> > .tw_top_bar").prepend(n)},t}),define("widgets/brease/FileManager/FileManager",["brease/core/BaseWidget","brease/events/BreaseEvent","widgets/brease/common/MpLinkHandler/libs/MpLinkHandler"],function(e,BreaseEvent,MpLinkHandler){"use strict";var t={mpLink:"FileManagement"},i,s=e.extend(function FileManager(t){if(void 0===i){i=this;var s=document.createElement("div");s.id="FESVirt_FileManager",s.classList.add("breaseFileManager"),document.getElementsByTagName("body")[0].appendChild(s),e.apply(this,[s]),this.addPromises(t)}},t),n=s.prototype;return s.createWidget=function(e){return i?i.addPromises(e):(i=new s(e),i.settings.parentContentId=brease.settings.globalContent,brease.uiController.addWidget(i),i._dispatchReady()),i},n.init=function(){this.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),e.prototype.init.apply(this,arguments),this.linkHandler=new MpLinkHandler(this),this.isError=!1,this.isConnected=!1,this.errorMessage="",this.promises={},this.data={},this.chunkSize=102400},n.addPromises=function(e){this.promises[e]={Browse:{},Load:{},Restriction:{},ErrorDetails:{},Save:{},Delete:{},Rename:{},Lock:{},ClearFlags:{},CreateFolder:{},Copy:{},Subcriptions:{}}},n.removePromises=function(e){this.promises[e]={}},n.dispose=function(){},n.setUpMpLinkConnection=function(){var e=brease.pageController.getVisu4Page(brease.pageController.getCurrentPage(brease.appElem.id)),t=this;return brease.uiController.bindingController.activateVirtualContent("FESVirt",e).then(function i(){brease.uiController.createBindings("FESVirt",e,[{mode:"twoWay",source:{type:"mapp",refId:"FileManagement",attribute:"link"},target:{type:"brease",refId:t.elem.id,attribute:"mpLink"}}]).then(function e(){t.isConnected=!0,t.isError=!1},function e(i){console.log("MpLink for FileHandler is not connecting: "+i.message),t.isConnected=!1,t.isError=!0,t.errorMessage=i})},function e(i){console.log("FileExplorer cannot create virtual binding: "+i.message),t.isError=!0,t.isConnected=!1,t.errorMessage=i})},n._widgetReadyHandler=function(e){e.target.id===this.elem.id&&(this.setUpMpLinkConnection(),this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")))},n.setMpLink=function(e){this.linkHandler.incomingMessage(e)},n.getMpLink=function(){return this.settings.mpLink},n.browse=function(e,t,i){return null!==t&&void 0!==t||(t=""),this._handleGetter(e,"Browse",{Path:t,Flags:i})},n.load=function(e,t,i,s,n,a){return this.data[e]&&delete this.data[e],this.data[e]={path:t,data:""},this._handleGetter(e,"Load",{Path:t,Flags:i,Encoding:s,MaxSize:n>this.chunkSize?this.chunkSize:n,Offset:a})},n._load=function(e,t,i,s,n,a){this._handleGetterNoPromise(e,"Load",{Path:t,Flags:i,Encoding:s,MaxSize:n,Offset:a})},n.notification=function(e,t,i,s){this.promises[e].Subcriptions=t,this.linkHandler.subscribeWithCallback("Notification",this._subscribeUpdate,{},{Path:"Files/",Flags:"",elemId:e})},n.denotification=function(){this.linkHandler.unSubscribe("Notification")},n.restriction=function(e,t){return this._handleGetter(e,"Restriction",{Component:t})},n.error=function(e){return this._handleGetter(e,"ErrorDetails",{})},n.save=function(e,t,i,s,n){return this._handleSetter(e,"Save",{Path:t,Flags:i,Encoding:s},n)},n.delete=function(e,t){return this._handleSetter(e,"Delete",{Path:t})},n.rename=function(e,t,i,s){return this._handleSetter(e,"Rename",{Path:t,Flags:s,Name:i})},n.copy=function(e,t,i,s){return this._handleSetter(e,"Copy",{Source:t,Dest:i,Flags:s})},n.lock=function(e,t){return this._handleSetter(e,"Lock",{Path:t})},n.clearFlags=function(e,t){return this._handleSetter(e,"ClearFlags",{Path:t})},n.createFolder=function(e,t){return this._handleSetter(e,"CreateFolder",{Path:t})},n._handleSetter=function(e,t,i,s){return i.elemId=e,this.linkHandler.sendDataAndProvideCallback(t,this._return,s,i),this._getPromise(e,t)},n._handleGetter=function(e,t,i){return i.elemId=e,this.promises[e][t]&&this.promises[e][t].reject&&this._handlePromise({error:{code:-120202020,text:"Loading of data from "+i.Path+" abruptly halted"}},e,t,"reject"),this.linkHandler.sendRequestAndProvideCallback(t,this._return,void 0,i),this._getPromise(e,t)},n._handleGetterNoPromise=function(e,t,i){i.elemId=e,this.linkHandler.sendRequestAndProvideCallback(t,this._return,void 0,i)},n._getPromise=function(e,t){var i=this;return new Promise(function(s,n){i.promises[e][t].reject=n,i.promises[e][t].resolve=s,i.isError&&n(i.errorMessage)})},n._return=function(e,t){"GetError"===e||"SetError"===e?this._handlePromise(t,t.parameter.elemId,t.methodID,"reject"):"Load"===t.methodID?this._loadingChunks(t):this._handlePromise(t.data,t.parameter.elemId,t.methodID,"resolve")},n._handlePromise=function(e,t,i,s){try{this.promises[t][i][s](e),this.promises[t][i].resolve=null,this.promises[t][i].reject=null,this.promises[t][i]={}}catch(n){console.log("DozerPad failed at",e,t,i,s)}},n._loadingChunks=function(e){this.data[e.parameter.elemId].path===e.parameter.Path&&(e.data.Eof?(this.data[e.parameter.elemId].data+=e.data.Content,"BINARY"===e.parameter.Encoding&&(this.data[e.parameter.elemId].data=this._decodeHEX(this.data[e.parameter.elemId].data)),this._handlePromise(this.data[e.parameter.elemId].data,e.parameter.elemId,e.methodID,"resolve"),delete this.data[e.parameter.elemId]):(this.data[e.parameter.elemId].data+=e.data.Content,this._load(e.parameter.elemId,e.parameter.Path,e.parameter.Flags,e.parameter.Encoding,this.chunkSize,e.parameter.Offset+e.data.BytesRead)))},n._subscribeUpdate=function(e,t){brease.callWidget(t.parameter.elemId,this.promises[t.parameter.elemId].Subcriptions,t)},n._onErrorHandler=function(e){console.iatWarn(e)},n._decodeHEX=function(e){return btoa(e)},s}),define("widgets/brease/FileExplorer/FileExplorer",["widgets/brease/TableWidget/TableWidget","widgets/brease/FileExplorer/libs/Model","widgets/brease/FileExplorer/libs/Controller","widgets/brease/FileExplorer/libs/Config","widgets/brease/FileExplorer/libs/Renderer","widgets/brease/FileManager/FileManager"],function(e,Model,Controller,t,Renderer,FileManager){"use strict";var i=t,s=e.extend(function FileExplorer(){e.apply(this,arguments)},i),n=s.prototype;return n.initModel=function(){this.model=new Model(this),this.model.initialize()},n.initController=function(){brease.config.preLoadingState||(this.filemanager=FileManager.createWidget(this.elem.id)),this.controller=new Controller(this),this.controller.initialize()},n.initRenderer=function(){this.renderer=new Renderer(this),this.renderer.initialize(),this.el.addClass("breaseFileExplorer")},n.setHeaderSorting=function(e){this.settings.headerSorting=e},n.getHeaderSorting=function(){return this.settings.headerSorting},n.setImageBin=function(e){this.settings.imageBin=e,brease.config.editMode&&this.controller.updateData()},n.getImageBin=function(){return this.settings.imageBin},n.setImageBr=function(e){this.settings.imageBr=e,brease.config.editMode&&this.controller.updateData()},n.getImageBr=function(){return this.settings.imageBr},n.setImageCsv=function(e){this.settings.imageCsv=e,brease.config.editMode&&this.controller.updateData()},n.getImageCsv=function(){return this.settings.imageCsv},n.setImageDoc=function(e){this.settings.imageDoc=e,brease.config.editMode&&this.controller.updateData()},n.getImageDoc=function(){return this.settings.imageDoc},n.setImageDrive=function(e){this.settings.imageDrive=e,brease.config.editMode&&this.controller.updateData()},n.getImageDrive=function(){return this.settings.imageDrive},n.setImageFile=function(e){this.settings.imageFile=e,brease.config.editMode&&this.controller.updateData()},n.getImageFile=function(){return this.settings.imageFile},n.setImageFolder=function(e){this.settings.imageFolder=e,brease.config.editMode&&this.controller.updateData()},n.getImageFolder=function(){return this.settings.imageFolder},n.setImageHtml=function(e){this.settings.imageHtml=e,brease.config.editMode&&this.controller.updateData()},n.getImageHtml=function(){return this.settings.imageFolder},n.setImageImg=function(e){this.settings.imageImg=e,brease.config.editMode&&this.controller.updateData()},n.getImageImg=function(){return this.settings.imageImg},n.setImageMov=function(e){this.settings.imageMov=e,brease.config.editMode&&this.controller.updateData()},n.getImageMov=function(){return this.settings.imageMov},n.setImagePdf=function(e){this.settings.imagePdf=e,brease.config.editMode&&this.controller.updateData()},n.getImagePdf=function(){return this.settings.imagePdf},n.setImageRoot=function(e){this.settings.imageRoot=e,brease.config.editMode&&this.controller.updateData()},n.getImageRoot=function(){return this.settings.imageRoot},n.setImageUnplugged=function(e){this.settings.imageUnplugged=e,brease.config.editMode&&this.controller.updateData()},n.getImageUnplugged=function(){return this.settings.imageUnplugged},n.setImageXls=function(e){this.settings.imageXls=e,brease.config.editMode&&this.controller.updateData()},n.getImageXls=function(){return this.settings.imageXls},n.setImageXml=function(e){this.settings.imageXml=e,brease.config.editMode&&this.controller.updateData()},n.getImageXml=function(){return this.settings.imageXml},n.browse=function(e){this.controller.browse(e)},n.rename=function(e){this.controller.rename(e)},n.delete=function(){this.controller.delete()},n.copy=function(){this.controller.copy()},n.cut=function(){this.controller.cut()},n.paste=function(){this.controller.paste()},n.open=function(){this.controller.open()},n.selectAll=function(){this.setMultiSelect(!0),this.controller.selectAll()},n.setMultiSelect=function(e){this.settings.multiSelect=e},n.createFolder=function(e){this.controller.mkdir(e)},n.getMultiSelect=function(){return this.settings.multiSelect},n.getPath=function(){return this.model.getCurrentPath()},n.resetPaths=function(){return this.model.resetPaths()},n.restrictions=function(e){this.controller.restrictions(e)},n.subscribeToNotications=function(){this.controller.subscribe()},n._openFileHandler=function(e,t,i){if(!this.isDisabled){this.createEvent("Open",{path:e,type:t,size:i}).dispatch()}},n._onErrorHandler=function(e,t,i,s,n,a){if(!brease.config.editMode){this.createEvent("OnError",{code:e,path:t,description:i,user:s,usertype:n,locktime:a}).dispatch()}},n._itemClickHandler=function(e){if(!this.isDisabled&&void 0!==e){this.createEvent("ItemClick",{path:e.Path,type:e.Type,locked:e.Locked,readonly:e.ReadOnly,size:e.Size,date:e.Date}).dispatch()}},n._errors=function(e,t){this.controller.error(t)},n.dispose=function(){this.controller._contentDeactivatedHandler(),e.prototype.dispose.apply(this,arguments)},n.wake=function(){this.internalData.preLoaded&&(this.internalData.preLoaded=!1,this.filemanager=FileManager.createWidget(this.elem.id)),this.controller._addClassSpecificEventListeners(this.controller),e.prototype.wake.apply(this,arguments)},n.suspend=function(){this.controller._contentDeactivatedHandler(),e.prototype.suspend.apply(this,arguments)},s}),define("widgets/brease/FileExplorerItem/designer/ClassInfo",["widgets/brease/TableColumnWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.FileExplorerItem",parents:["widgets.brease.FileExplorer"],children:[],inheritance:["widgets.brease.FileExplorerItem","widgets.brease.TableColumnWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setColumnType:{method:"setColumnType",parameter:{columnType:{name:"columnType",index:0,type:"String"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/FileExplorerItem/FileExplorerItem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/FileExplorerItem">CONTENT</div>'}),define("widgets/brease/FileExplorerItem/FileExplorerItem",["widgets/brease/TableColumnWidget/TableColumnWidget"],function(e){"use strict";var t={text:"",columnType:"Path"},i=e.extend(function FileExplorerItem(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){e.prototype.init.call(this),this.el.addClass("breaseFileExplorerItem")},s.setColumnType=function(e){this.settings.columnType=e;var t=new CustomEvent("ColumnTypeChanged",{detail:{columnType:e},bubbles:!0,cancelable:!0});this.dispatchEvent(t)},s.getColumnType=function(){return this.settings.columnType},s.getShortColumnType=function(){return"Size"!==this.settings.columnType&&"Date"!==this.settings.columnType?{data:this.settings.columnType}:{data:this.settings.columnType,type:"num",render:{_:"display",sort:"value"}}},s.setData=function(e){this.telegram=e},i}),define("widgets/brease/FileExplorerStyle/designer/ClassInfo",["widgets/brease/TableWidgetStyle/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.FileExplorerStyle",parents:["*"],children:[],inheritance:["widgets.brease.FileExplorerStyle","widgets.brease.TableWidgetStyle","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/FileExplorerStyle/FileExplorerStyle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/FileExplorerStyle">CONTENT</div>\r\n'}),define("widgets/brease/FileExplorerStyle/FileExplorerStyle",["widgets/brease/TableWidgetStyle/TableWidgetStyle"],function(e){"use strict";return e.extend(function FileExplorerStyle(){e.apply(this,arguments)},!1)}),define("widgets/brease/FileExplorerSystem/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.FileExplorerSystem",parents:["*"],children:[],inheritance:["widgets.brease.FileExplorerSystem","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/FileExplorerSystem/FileExplorerSystem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/FileExplorerSystem">CONTENT</div>'}),define("widgets/brease/FileExplorerSystem/libs/Config",[],function(){"use strict";return{format:"F",widgets:[],buttons:[],width:620,path:"",visuId:brease.config.visuId}}),define("widgets/brease/FileExplorerSystem/libs/Texts",[],function(){"use strict";function Texts(){return{en:{delete:"Delete",rename:"Rename",copy:"Copy",cut:"Cut",paste:"Paste",createFolder:"New Folder",open:"Open",saveas:"Save As",cancel:"Cancel"},de:{delete:"Löschen",rename:"Umbenennen",copy:"Kopieren",cut:"Ausschneiden",paste:"Einfügen",createFolder:"Neuer Ordner",open:"Öffnen",saveas:"Speichern",cancel:"Abbrechen"}}}return new Texts}),define("widgets/brease/FileExplorerSystem/FileExplorerSystem",["widgets/brease/Window/Window","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/FileExplorerSystem/libs/Config","widgets/brease/FileExplorerSystem/libs/Texts"],function(e,Utils,BreaseEvent,t,Texts){"use strict";var i=t,s,n=e.extend(function FileExplorerSystem(){if(void 0!==s)return s;e.apply(this,arguments),s=this},i),a=n.prototype;return a.init=function(){brease.config.editMode||(this.resolver=null,this.rejecter=null,!0!==this.settings.omitClass&&this.addInitialClass("breaseFileExplorerSystem"),e.prototype.init.call(this,arguments),this.addWidget(this._getExplorer("FileExplorerSystem",this.settings.width),!1),this.elem.children[1].appendChild(this.elem.children[1].children[0].cloneNode()),$(".breaseFileExplorerSystem > .contentBox > .content").css("padding","5px"))},a.open=function(e,t,i){return this.show(e,t,this._getType(e),"",["open","cancel"],i)},a.saveas=function(e,t,i,s){return this.show(e,t,this._getType(e),i,["saveas","cancel"],s)},a.show=function(t,i,s,n,a,r){this.lang=brease.language.getCurrentLanguage(),"de"!==this.lang&&(this.lang="en"),this.settings.path=i;var o="";return""!==s&&void 0!==s&&(o=this._getFilter(t)),brease.callWidget("FESVirt_FileExplorerSystem","setFilterConfiguration",o),e.prototype.show.call(this,{header:{text:Texts[this.lang][a[0]]},zoomFactor:this._setZoom(this.el,brease.config.visuId)},r),this.closeOnLostContent(this.elem),brease.callWidget("FESVirt_FileExplorerSystem","subscribeToNotications",""),brease.callWidget("FESVirt_FileExplorerSystem","restrictions",t),$("#FESVirt_FileExplorerSystem").css("margin-left","2px"),this._updateSearchField(),$("#"+this.elem.id).on(BreaseEvent.CLOSED,this._bind("_interruptHandler")),$("#FESVirt_FileExplorerSystem").on("draw.dt",this._bind("_updateSearchField")),this._addTextInput(n),this._addButtons(a),this._setPosition(),this._getPromise()},a._addButtons=function(e){this.settings.buttons=e;for(var t=0;t<this.settings.buttons.length;t+=1)this.addWidget(this._getButton(this.settings.buttons[t],Texts[this.lang][this.settings.buttons[t]],100,10*(t+2)),!0);e.includes("cancel")&&$("#FESVirt_button_cancel").on("Click",this._bind("_interruptHandler")),e.includes("saveas")&&($("#FESVirt_button_saveas").on("Click",this._bind("_saveAsHandler")),$(this.elem).on("Open",this._bind("_saveAsHandler"))),e.includes("open")&&($(this.elem).on("Open",this._bind("_openHandler")),$("#FESVirt_button_open").on("Click",this._bind("_openFileSelectedByFE")))},a._addTextInput=function(e){this.addWidget(this._getTextInput(e,360),!0),$("#FESVirt_FileExplorerSystem").on("ItemClick",this._bind("_updateInputFieldHandler"))},a._closeFileExplorerSysHandler=function(){brease.callWidget("FESVirt_FileExplorerSystem","resetPaths"),$("#"+this.elem.id).off(BreaseEvent.CLOSED,this._bind("_interruptHandler")),$("#FESVirt_button_cancel").off("Click",this._bind("_interruptHandler")),$("#FESVirt_FileExplorerSystem").off("ItemClick",this._bind("_updateInputFieldHandler")),$("#FESVirt_FileExplorerSystem").off("draw.dt"),$(this.elem).off("Open",this._bind("_openHandler")),$(this.elem).off("Open",this._bind("_saveAsHandler")),$("#FESVirt_button_saveas").off("Click",this._bind("_saveAsHandler")),$("#FESVirt_button_open").off("Click",this._bind("_openFileSelectedByFE"));for(var t=this.settings.buttons.length;t>=0;t-=1)this.removeWidget(this.settings.widgets[t]);e.prototype.hide.apply(this,arguments)},a._getPromise=function(){var e=this;return new Promise(function(t,i){e.rejecter=i,e.resolver=t})},a._getType=function(e){var t="";switch(e){case"_CNCEditor":t=".cnc";break;case"_STEditor":t=".st";break;default:t="";break}return t},a._getFilter=function(e){var t='[{"logicalOperator":"or","value":"FILE","conditionType":"Does not contain","columnType":"Type"},{"value":"';switch(e){case"_CNCEditor":t+=".cnc";break;case"_STEditor":t+='.st","conditionType":"Contains","columnType":"Path","logicalOperator":"or"},{"value":".fun","conditionType":"Contains","columnType":"Path","logicalOperator":"or"},{"value":".var","conditionType":"Contains","columnType":"Path","logicalOperator":"or"},{"value":".typ';break;default:t+="";break}return t+='","conditionType":"Contains","columnType":"Path"}]',t},a._updateInputFieldHandler=function(e){if("FILE"===e.detail.type){var t=e.detail.path.split("/");brease.callWidget("FESVirt_textinput","setValue",t[t.length-1])}},a._updateSearchField=function(){$(".breaseFileExplorerSystem > .contentBox > .breaseFileExplorer > > > .breaseTextInput ").outerWidth(.3*(this.settings.width-20))},a._interruptHandler=function(e){this.rejecter("FileExplorerSystem closed unexpectedly"),this._closeFileExplorerSysHandler(e)},a._saveAsHandler=function(e){if(!this.isDisabled){var t=brease.callWidget("FESVirt_FileExplorerSystem","getPath")+brease.callWidget("FESVirt_textinput","getValue");this.resolver({path:t}),this._closeFileExplorerSysHandler(e)}},a._openHandler=function(e){this.resolver({path:e.detail.path,size:e.detail.size}),this._closeFileExplorerSysHandler(e)},a._openFileSelectedByFE=function(){brease.callWidget("FESVirt_FileExplorerSystem","open")},a.addWidget=function(e,t){e.id="FESVirt_"+e.name,e.options.style=this.settings.style;var i=this.createWidgetElem(e);i&&(this.settings.widgets.push(e),t?this.elem.children[1].insertBefore(i,this.elem.children[1].lastElementChild):this.elem.children[1].appendChild(i),brease.uiController.parse(i,!0))},a.removeWidget=function(e){var t=brease.callWidget(e.id,"widget");if(t){var i=this.settings.widgets.indexOf(e);i>-1&&this.settings.widgets.splice(i,1),brease.uiController.dispose(t.elem,!0)}},a.createWidgetElem=function(e){if(e&&e.type){var t=$("<div/>").addClass().attr("id",e.id).attr("data-brease-options",JSON.stringify(e.options).replace(/"/g,"'")).attr("data-brease-widget",e.type).css("width",e.width).css("height",e.height).css("left",e.x).css("top",e.y),i=t.get(0);if(void 0!==e.content&&null!==e.content)for(var s=0;s<e.content.length;s+=1){e.content[s].id=e.id.split("_")[0]+"_"+e.content[s].name;var n=this.createWidgetElem(e.content[s]);null!==n&&i.appendChild(n)}return i}return null},a._getButton=function(e,t,i,s){var n={};return n.name="button_"+e,n.id="",n.type="widgets/brease/Button",n.x=s,n.y=0,n.width=i,n.height=30,n.options={text:t},n},a._getItem=function(e,t){var i={};return i.name="FileExplorerItem_"+e,i.id="",i.type="widgets/brease/FileExplorerItem",i.x=0,i.y=0,i.width=t,i.height="auto",i.options={columnType:e,text:e,width:t},i},a._getExplorer=function(e,t){var i={};return i.name=e,i.id="",i.type="widgets/brease/FileExplorer",i.x=10,i.y=0,i.width=t-20,i.height=379,i.options={width:t-20,height:379,format:"F",paging:!1},i.content=[this._getItem("Path",280),this._getItem("Date",180),this._getItem("Type",70),this._getItem("Size",70)],i},a._getTextInput=function(e,t){var i={};return i.name="textinput",i.id="",i.type="widgets/brease/TextInput",i.x=10,i.y=0,i.width=t,i.height=30,i.options={value:e},i},a._setZoom=function(e,t){var i=brease.pageController.getVisuById(t),s=1;if(i&&i.containerId){var n=brease.pageController.getPageById(brease.pageController.getCurrentPage(i.containerId));if(n){var a=document.querySelector('[data-brease-layoutid="'+n.layout+'"][data-brease-pageId="'+n.id+'"]');s=Utils.getScaleFactor(a)}}return e.css({transform:"scale("+s+","+s+")","transform-origin":"0 0"}),s},n}),define("widgets/brease/FileManager/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.FileManager",parents:["*"],children:[],inheritance:["widgets.brease.FileManager","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setMpLink:{method:"setMpLink",parameter:{telegram:{name:"telegram",index:0,type:"MpComIdentType"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUpMpLinkConnection:{method:"setUpMpLinkConnection"},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/FileManager/FileManager.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/FileManager">CONTENT</div>'}),define("widgets/brease/GenericDialog/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.GenericDialog",parents:["*"],children:[],inheritance:["widgets.brease.GenericDialog","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/GenericDialog/GenericDialog.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/GenericDialog"></div>\r\n\r\n'}),define("widgets/brease/GroupBox/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.GroupBox",parents:["*"],children:["*"],inheritance:["widgets.brease.GroupBox","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAlignment:{method:"setAlignment",parameter:{alignment:{name:"alignment",index:0,type:"brease.enum.Direction"}}},setChildPositioning:{method:"setChildPositioning",parameter:{childPositioning:{name:"childPositioning",index:0,type:"brease.enum.ChildPositioning"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFloat:{method:"setFloat",parameter:{float:{name:"float",index:0,type:"brease.enum.Floating"}}},setImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,
type:"brease.enum.ImagePosition"}}},setMaxHeight:{method:"setMaxHeight",parameter:{maxHeight:{name:"maxHeight",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/GroupBox/GroupBox.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/GroupBox">CONTENT</div>'}),define("widgets/brease/GroupBox/GroupBox",["brease/core/ContainerWidget","brease/events/BreaseEvent","brease/decorators/LanguageDependency","brease/enum/Enum","brease/core/Types","brease/core/Utils","brease/helper/Scroller","widgets/brease/common/libs/wfUtils/UtilsImage","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,t,Enum,Types,Utils,Scroller,UtilsImage,i){"use strict";var s={alignment:Enum.Direction.vertical,borderTop:!0,borderBottom:!0,borderLeft:!0,borderRight:!0,childPositioning:Enum.ChildPositioning.absolute,imageAlign:Enum.ImagePosition.left,useSVGStyling:!0,float:"left",maxHeight:0},n=e.extend(function GroupBox(){e.apply(this,arguments)},s),a=n.prototype;n.static.multitouch=!0,a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseGroupBox"),this.debouncedResize=_.debounce(this.resize.bind(this),100),e.prototype.init.call(this),!0!==brease.config.editMode&&this._initEvents(),this.settings.childPositioning===Enum.ChildPositioning.relative?(this.el.on(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),this.widgetReady=new $.Deferred,this.groupBoxReady=new $.Deferred,l(this),this._startInitialisation()):(b(this),v(this)),r.call(this),void 0===this.settings.text&&void 0===this.settings.image||(d(this),m(this)),this.settings.childPositioning===Enum.ChildPositioning.relative&&(f(this),this.container.on("VisibleChanged",this._bind("_scrollUpdateHandler"))),g(this),this.el.addClass("initialized"),this._refreshScroller()},a._startInitialisation=function(){var e=this;$.when(this.widgetReady.promise(),this.groupBoxReady.promise()).then(function t(){e.createEvent("GroupBoxReady",{}).dispatch(),b(e),v(e),S.call(e)&&e.debouncedResize()})},a._onStylePropertiesChanged=function(){m(this),this._refreshScroller()},a._initEvents=function(e){var t=!0===e?"off":"on";this.el[t]("VisibleChanged",this._bind("_visibleChangeHandler")),this.el[t]("SizeChanged",this._bind("_sizeChangeHandler")),this.el[t](BreaseEvent.MOUSE_DOWN,this._bind("_downHandler")),!0===e&&$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler"))},a._initEditor=function(){var e=this;this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_onStylePropertiesChanged")),this.elem.classList.add("iatd-outline"),require(["widgets/brease/GroupBox/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},a.langChangeHandler=function(){void 0!==this.settings.textkey&&o.call(this,brease.language.getTextByKey(this.settings.textkey))},a.setText=function(e){this.settings.text=e,r.call(this),o.call(this,this.getCurrentText())};function r(){!0===brease.language.isKey(this.settings.text)?(this.settings.textkey=brease.language.parseKey(this.settings.text),this.setLangDependency(!0)):(this.settings.textkey=void 0,this.setLangDependency(!1))}function o(e){p(this,e),g(this)}a.getText=function(){return this.settings.text},a.getCurrentText=function(){return void 0!==this.settings.textkey?brease.language.getTextByKey(this.settings.textkey):this.settings.text},a.setChildPositioning=function(e){this.settings.childPositioning=e,b(this)},a.getChildPositioning=function(){return this.settings.childPositioning},a.setEllipsis=function(e){this.settings.ellipsis=e,this.header&&(!0===e?this.header.addClass("ellipsis"):!1===e&&this.header.removeClass("ellipsis"))},a.getEllipsis=function(){return this.settings.ellipsis},a.setImage=function(e){this.settings.image=e,h(this)},a.getImage=function(){return this.settings.image},a.setImageAlign=function(e){this.settings.imageAlign=e,u(this)},a.getImageAlign=function(){return this.settings.imageAlign},a.setUseSVGStyling=function(e){this.settings.useSVGStyling=Types.parseValue(e,"Boolean",{default:!0}),h(this),u(this)},a.getUseSVGStyling=function(){return this.settings.useSVGStyling},a.setAlignment=function(e){this.settings.alignment=e,f(this)},a.getAlignment=function(){return this.settings.alignment},a.setFloat=function(e){this.settings.float=e,this.settings.childPositioning===Enum.ChildPositioning.relative&&v(this)},a.getFloat=function(){return this.settings.float},a.setTextKey=function(e){void 0!==e&&(this.settings.textkey=e,this.setLangDependency(!0),this.langChangeHandler())},a.setMaxHeight=function(e){this.settings.maxHeight=e},a.getMaxHeight=function(){return this.settings.maxHeight},a.resize=function(){var e=this.el.outerHeight(),t=this.el.innerHeight(),i=Types.parseValue(this.settings.height,"Integer"),s=e-t,n=C(this)+(this.header?this.header.outerHeight():0);n<t&&n>i-s?this.el.css("height",n+s+"px"):n<t&&n<=i-s?this.el.css("height",i+"px"):n>=t&&n<this.settings.maxHeight-s?this.el.css("height",n+s+"px"):n>=t&&n>=this.settings.maxHeight-s&&this.el.css("height",this.settings.maxHeight+"px"),this.debouncedRefresh(),this.sizeChanged()},a.sizeChanged=function(){this.createEvent("SizeChanged").dispatch()},a._downHandler=function(e){if(!(this.isDisabled||brease.config.editMode||this.isActive)){this.isActive=!0,this.pointerId=Utils.getPointerId(e),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_upHandler"));this.createMouseEvent("MouseDown",{},e).dispatch()}},a._upHandler=function(e){if(!this.isDisabled&&!brease.config.editMode&&Utils.getPointerId(e)===this.pointerId){this.isActive=!1,$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler"));this.createMouseEvent("MouseUp",{},e).dispatch()}},a._scrollUpdateHandler=function(e){this._handleEvent(e),void 0!==this.scroller?this._refreshScroller():f(this)},a._refreshScroller=function(){this.debouncedRefresh()},a._widgetReadyHandler=function(e){e.target.id===this.elem.id&&(this.widgetReady.resolve(),this.el.off(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")))},a._sizeChangeHandler=function(e){S.call(this)?null!==this.getContainer().get(0).children.namedItem(e.target.id)&&(this.debouncedRefresh.cancel(),this.debouncedResize()):this._refreshScroller()},a._visibleHandler=function(){S.call(this)?(this.debouncedRefresh&&this.debouncedRefresh.cancel(),this.debouncedResize()):this._refreshScroller()},a._visibleChangeHandler=function(e){S.call(this)?null!==this.getContainer().get(0).children.namedItem(e.target.id)&&(this.debouncedRefresh.cancel(),this.debouncedResize()):this._refreshScroller()},a.widgetAddedHandler=function(e){e.target.id===this.elem.id&&($("#"+e.detail.widgetId).css("float",void 0!==this.settings.float?this.settings.float:"none"),this.scrollWrapper||this.settings.childPositioning!==Enum.ChildPositioning.relative?this.scrollWrapper&&this.settings.childPositioning===Enum.ChildPositioning.relative&&x(this):f(this))},a.getContainer=function(){return e.prototype.getContainer.apply(this,arguments),void 0!==this.scrollWrapper?this.scrollWrapper:this.container},a.widgetRemovedHandler=function(){I(this)},a.wake=function(){e.prototype.wake.apply(this,arguments),this._initEvents(),S.call(this)&&this.debouncedResize(),this._refreshScroller()},a.suspend=function(){this._initEvents(!0),this.debouncedRefresh.cancel(),this.debouncedResize.flush(),this.debouncedRefresh.flush(),e.prototype.suspend.apply(this,arguments)},a.dispose=function(){this._initEvents(!0),this.debouncedResize.cancel(),this.debouncedRefresh.cancel(),this.container.off(),this.scroller&&(this.scroller.destroy(),this.scroller=null),e.prototype.dispose.apply(this,arguments)};function l(e){var t=Array.prototype.map.call(e.getContainer().get(0).children,function(e){var t=$.Deferred();return brease.uiController.getWidgetState(e.id)===Enum.WidgetState.READY?t.resolve():(e.addEventListener(BreaseEvent.WIDGET_READY,t.resolve),t.always(function(){e.removeEventListener(BreaseEvent.WIDGET_READY,t.resolve)})),t});$.when.apply($,t).done(function(){e.groupBoxReady.resolve()})}function d(e){var t=$('<div class="header"></div>'),i,s;if(!0===e.settings.ellipsis&&t.addClass("ellipsis"),void 0!==e.settings.text&&0!==e.settings.text.length){var n=void 0!==e.settings.textkey?brease.language.getTextByKey(e.settings.textkey):e.settings.text;i=$("<span></span>").text(n)}else t.addClass("no-text");s=c(e.settings.image,e.settings.useSVGStyling),e.settings.imageAlign===Enum.ImagePosition.left?t.addClass("image-left").append(s).append(i):t.addClass("image-right").append(i).append(s),e.header=t.prependTo(e.el),e.textEl=i}function c(e,t){var i;return"string"!=typeof e||0===e.length?i:(UtilsImage.isStylable(e)&&t?(i=$("<svg />"),i.hide(),UtilsImage.getInlineSvg(e).then(function(e){i.replaceWith(e),i=e,i.show()})):i=$('<img src="'+e+'"/>'),i)}function h(e){if(e.header){e.header.children("svg").remove(),e.header.children("img").remove();var t=c(e.settings.image,e.settings.useSVGStyling);e.settings.imageAlign===Enum.ImagePosition.right?e.header.append(t):e.header.prepend(t)}else d(e);g(e)}function u(e){var t;e.header&&(t=UtilsImage.isStylable(e.settings.image)?e.header.children("svg"):e.header.children("img"),void 0===e.settings.imageAlign&&""===e.settings.imageAlign||("right"===e.settings.imageAlign&&(e.header.removeClass("image-left"),e.header.addClass("image-right"),t.appendTo(e.header)),"left"===e.settings.imageAlign&&(e.header.removeClass("image-right"),e.header.addClass("image-left"),t.prependTo(e.header))))}function g(e){""!==e.settings.image&&void 0!==e.settings.image||""!==e.settings.text&&void 0!==e.settings.text||e.header&&(e.header.remove(),e.header=void 0),m(e)}function m(e){e.header?e.container.css("top",e.header.outerHeight()+"px"):e.container.css("top","0px")}function p(e,t){e.header?(e.header.removeClass("no-text"),t&&0!==t.length?e.textEl?e.textEl.text(t):(e.textEl=$("<span>"+t+"</span>"),"left"===e.settings.imageAlign?e.header.append(e.textEl):"right"===e.settings.imageAlign&&e.header.prepend(e.textEl)):(e.textEl&&(e.textEl.remove(),e.textEl=void 0),e.header.addClass("no-text"))):d(e)}function f(e){e.el.removeClass("vertical","horizontal");var t;"horizontal"===e.settings.alignment?(e.el.addClass("horizontal"),t={mouseWheel:!0,tap:!0,scrollY:!1,scrollX:!0}):"vertical"===e.settings.alignment&&(e.el.addClass("vertical"),t={mouseWheel:!0,tap:!0,scrollY:!0,scrollX:!1}),e.container.off("VisibleChanged",e._bind("_scrollUpdateHandler")),e.settings.childPositioning===Enum.ChildPositioning.relative?(e.container.on("VisibleChanged",e._bind("_scrollUpdateHandler")),e.scrollWrapper?(brease.config.editMode&&E(e,t),x(e)):(y(e,t),e.scrollWrapper.addClass("widgetContainer"),e.el.addClass("autoScroll")),e.container.removeClass("widgetContainer")):(e.el.removeClass("autoScroll"),e.container.addClass("widgetContainer"))}function b(e){var t={float:void 0!==e.settings.float?e.settings.float:"none",position:e.settings.childPositioning===Enum.ChildPositioning.relative?"relative":"absolute"};e.settings.childPositioning===Enum.ChildPositioning.relative?e.scrollWrapper||f(e):e.settings.childPositioning===Enum.ChildPositioning.absolute&&(e.scrollWrapper&&w(e),f(e)),e.getContainer().children("[data-brease-widget]").css(t),e.scrollWrapper&&e.debouncedRefresh()}function v(e){e.settings.childPositioning===Enum.ChildPositioning.relative&&void 0!==e.settings.float&&e.getContainer().children().css("float",e.settings.float)}function y(e,t){e.scrollWrapper=$("<div/>").addClass("scrollWrapper"),e.container.children().appendTo(e.scrollWrapper),e.container.append(e.scrollWrapper),void 0===e.scroller&&(e.scroller=Scroller.addScrollbars(e.container[0],t)),e._refreshScroller()}function w(e){e.scroller&&(e.debouncedRefresh.cancel(),e.scroller.destroy(),e.scroller=void 0),e.scrollWrapper.children(".breaseWidget").appendTo(e.container),e.scrollWrapper.remove(),e.scrollWrapper=void 0}function x(e){e._refreshScroller()}function E(e,t){e.debouncedRefresh.cancel(),e.scroller.destroy(),e.scroller=void 0,e.scroller=Scroller.addScrollbars(e.container[0],t)}function I(e){e._refreshScroller()}function C(e){var t,i=0;return e.getContainer().children().each(function(){this.classList.contains("remove")||(t=this.offsetTop+this.offsetHeight+parseInt(getComputedStyle(this).marginBottom,10),t>i&&(i=t))}),i}function S(){var e=this.settings;return!0!==brease.config.editMode&&!0===this.isVisible()&&e.childPositioning===Enum.ChildPositioning.relative&&Types.parseValue(e.height,"Integer")<e.maxHeight}return i.decorate(t.decorate(n,!1),!1)}),define("widgets/brease/Image/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Image",parents:["*"],children:[],inheritance:["widgets.brease.Image","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setSizeMode:{method:"setSizeMode",parameter:{sizeMode:{name:"sizeMode",index:0,type:"brease.enum.SizeMode"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/Image/Image.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Image"></div>\r\n'}),define("widgets/brease/Image/libs/config/Config",["brease/enum/Enum"],function(Enum){"use strict";return{image:"",useSVGStyling:!0,sizeMode:Enum.SizeMode.CONTAIN}}),define("widgets/brease/Image/Image",["brease/core/BaseWidget","widgets/brease/Image/libs/config/Config","widgets/brease/common/libs/flux/stores/ImageStore/ImageStore","widgets/brease/common/libs/flux/stores/ImageStore/ImageActions","widgets/brease/common/libs/flux/views/ImageView/ImageView","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,Config,ImageStore,ImageActions,ImageView,t){"use strict";var i=Config,s=e.extend(function Image(){e.apply(this,arguments)},i),n=s.prototype;return n.registerStore=function e(t){this.registeredStores.push(t)},n.dispatch=function e(t){this.registeredStores.forEach(function(e){e.newAction(t)})},n.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseImage"),this.registeredStores=[],e.prototype.init.call(this);var t={imageList:[this.settings.image],sizeMode:this.settings.sizeMode,useSVGStyling:this.settings.useSVGStyling,height:"100%",width:"100%",visible:this.isVisible(),preloading:brease.config.preLoadingState};this.imageStore=new ImageStore(this,t),this.imageActions=new ImageActions(this),this.imageView=new ImageView(this.imageStore,this,this.el),this.imageActions.initImage()},n._initEditor=function(){var e=this;e.el.addClass("iatd-outline"),require(["widgets/brease/Image/libs/EditorHandles","brease/events/BreaseEvent"],function(EditorHandles,BreaseEvent){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},n._setWidth=function(t){e.prototype._setWidth.apply(this,arguments),this.imageActions.setWidth("100%")},n._setHeight=function(t){e.prototype._setHeight.apply(this,arguments),this.imageActions.setHeight("100%")},n.setImage=function(e){this.settings.image=e,this.imageActions.setImageFromIndex(e,0)},n.getImage=function(){return this.imageStore.getImagePath()},n.setUseSVGStyling=function(e){this.settings.useSVGStyling=e,this.imageActions.setUseSVGStyling(e)},n.getUseSVGStyling=function(){return this.imageStore.getUseSVGStyling()},n.setSizeMode=function(e){this.settings.sizeMode=e,this.imageActions.setSizeMode(e)},n.getSizeMode=function(){return this.imageStore.getImageSizeMode()},n.updateVisibility=function(t){e.prototype.updateVisibility.apply(this,arguments),void 0!==this.imageActions&&this.imageActions.setVisible(this.isVisible())},n.wake=function(){this.internalData.preLoaded&&(this.imageActions.initImageAfterPreload(),this.internalData.preLoaded=!1),e.prototype.wake.apply(this,arguments)},t.decorate(s,!1)}),define("widgets/brease/ImageList/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ImageList",parents:["*"],children:[],inheritance:["widgets.brease.ImageList","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.BackgroundPosition"}}},setImageList:{method:"setImageList",parameter:{imageList:{name:"imageList",index:0,type:"GraphicCollection"}}},setImagePrefix:{method:"setImagePrefix",parameter:{imagePrefix:{name:"imagePrefix",index:0,type:"DirectoryPath"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetSelectedIndex:{method:"setSelectedIndex",parameter:{index:{name:"index",index:0,type:"Integer"}}},setSizeMode:{method:"setSizeMode",parameter:{sizeMode:{name:"sizeMode",index:0,type:"brease.enum.SizeMode"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ImageList/ImageList.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ImageList"></div>\r\n'}),define("widgets/brease/ImageList/libs/config/Config",["brease/enum/Enum"],function(Enum){"use strict";return{sizeMode:Enum.SizeMode.CONTAIN,imagePrefix:"",imageList:[],selectedIndex:0,imageAlign:"center center",useSVGStyling:!0}}),define("widgets/brease/ImageList/ImageList",["brease/core/BaseWidget","brease/events/BreaseEvent","widgets/brease/ImageList/libs/config/Config","widgets/brease/common/libs/flux/stores/ImageStore/ImageStore","widgets/brease/common/libs/flux/stores/ImageStore/ImageActions","widgets/brease/common/libs/flux/views/ImageView/ImageView","brease/decorators/DragAndDropCapability","widgets/brease/common/libs/BreaseResizeObserver","brease/decorators/ContentActivatedDependency","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,Config,ImageStore,ImageActions,ImageView,t,BreaseResizeObserver,ContentActivatedDependency){"use strict";var i=Config,s=e.extend(function ImageList(){e.apply(this,arguments)},i),n=s.prototype;n.registerStore=function e(t){this.registeredStores.push(t)},n.dispatch=function e(t){this.registeredStores.forEach(function(e){e.newAction(t)})},n.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseImageList"),this.registeredStores=[],this.observer=new BreaseResizeObserver(this.elem,this._bind(a)),e.prototype.init.call(this);var t={imageList:this.settings.imageList,imageIndex:this.settings.selectedIndex,pathPrefix:this.settings.imagePrefix,sizeMode:this.settings.sizeMode,useSVGStyling:this.settings.useSVGStyling,backgroundAlignment:this.settings.imageAlign,height:"100%",width:"100%",visible:this.isVisible(),preloading:brease.config.preLoadingState};this.imageStore=new ImageStore(this,t),this.imageActions=new ImageActions(this),this.imageView=new ImageView(this.imageStore,this,this.el),this.imageActions.initImage(),this.addListeners()},n._initEditor=function(){var e=this;e.el.addClass("iatd-outline"),require(["widgets/brease/ImageList/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0})),e.observer.init()})},n._setWidth=function(t){e.prototype._setWidth.apply(this,arguments),this.imageActions.setWidth("100%")},n._setHeight=function(t){e.prototype._setHeight.apply(this,arguments),this.imageActions.setHeight("100%")},n.updateSize=function(){this.imageActions.setWidth("100%"),this.imageActions.setHeight("100%")},n.setImageList=function(e){this.settings.imageList=e,this.imageActions.setImageList(e)},n.getImageList=function(){return this.settings.imageList},n.setSizeMode=function(e){this.settings.sizeMode=e,this.imageActions.setSizeMode(e)},n.getSizeMode=function(){return this.imageStore.getImageSizeMode()},n.setImagePrefix=function(e){this.settings.imagePrefix=e,this.imageActions.setPathPrefix(e)},n.getImagePrefix=function(){return this.settings.imagePrefix},n.setImageAlign=function(e){this.settings.imageAlign=e,this.imageActions.setBackgroundAlignment(e)},n.getImageAlign=function(){return this.settings.imageAlign},n.setSelectedIndex=function(e){var t=Number(e);this.settings.selectedIndex=t,this.imageActions.setImageIndex(t),this.createEvent("SelectedIndexChanged",{selectedIndex:t}).dispatch()},n.getSelectedIndex=function(){return this.settings.selectedIndex},n.setUseSVGStyling=function(e){this.settings.useSVGStyling=e,this.imageActions.setUseSVGStyling(e)},n.getUseSVGStyling=function(){return this.imageStore.getUseSVGStyling()},n._visibleHandler=function(){e.prototype._visibleHandler.apply(this,arguments),void 0!==this.imageActions&&this.imageActions.setVisible(this.isVisible()),a.call(this)},n.addListeners=function(){document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind(a))},n.removeListeners=function(){document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind(a))},n.suspend=function(){this.removeListeners(),this.observer.suspend(),e.prototype.suspend.apply(this,arguments)},n.wake=function(){this.internalData.preLoaded&&(this.imageActions.initImageAfterPreload(),this.internalData.preLoaded=!1),this.addListeners(),e.prototype.wake.apply(this,arguments)},n.dispose=function(){this.removeListeners(),this.observer.dispose(),this.observer=void 0,e.prototype.dispose.apply(this,arguments)},n.contentActivatedHandler=function(){this.observer.initialized?this.observer.wake():this.observer.init()};function a(){this.isVisible()&&this.imageActions&&this.updateSize()}return ContentActivatedDependency.decorate(t.decorate(s,!1),!0)}),define("widgets/brease/KeyBoard/designer/ClassInfo",["system/widgets/KeyBoard/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.KeyBoard",parents:["*"],children:[],inheritance:["widgets.brease.KeyBoard","system.widgets.KeyBoard","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAlternativeLayouts:{method:"setAlternativeLayouts",parameter:{alternativeLayouts:{name:"alternativeLayouts",index:0,type:"Object"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/KeyBoard/KeyBoard.html",[],function(){return'<div id="breaseKeyBoard" data-brease-widget="widgets/brease/KeyBoard">\r\n    layouts in assets folder\r\n</div>\r\n'}),define("widgets/brease/KeyBoard/libs/composer/composer_zh_chs",[],function(){"use strict";var e=function(){this.value="",this.startIndex=-1},t=e.prototype;return t.init=function(){this.value="",this.startIndex=-1},t.parseInput=function(e){return[]},t.setValue=function(e){this.value=e,this.len=e.length},t.getValue=function(){return this.value},t.clearValue=function(){this.value=""},t.setStartIndex=function(e){e<0&&(e=0),this.startIndex=e},t.resetStartIndex=function(){this.startIndex=-1},t.getStartIndex=function(){return this.startIndex},t.addChar=function(e,t){var i=t-this.startIndex,s=this.value.slice(0,i),n=this.value.slice(i,this.value.length);i>=0&&i<=this.value.length+1&&(this.value=s+e+n)},t.getLen=function(){return"string"==typeof this.value?this.value.length:null},t.removeChar=function(e,t){var i=t-this.startIndex,s=this.value.slice(0,i),n=this.value.slice(i+1,this.value.length);i===this.value.length&&(s=this.value.slice(0,i-1)),i>=0&&i<=this.value.length&&(this.value=s+n)},t.dispose=function(){this.value=null,this.startIndex=null},new e}),define("widgets/brease/KeyBoard/libs/composer/RomajiToKana",["widgets/brease/KeyBoard/libs/external/wanakana"],function(e){"use strict";var RomajiToKana=function(){this.value="",this.startIndex=-1},t=RomajiToKana.prototype;return t.init=function(){this.value="",this.startIndex=-1},t.parseInput=function(t){var i=[],s=e.toKana(t,{passRomaji:!0}),n=e.toKatakana(s,{passRomaji:!0});return s.length>0&&i.push(s),n.length>0&&n!==s&&i.push(n),i},t.setValue=function(e){this.value=e,this.len=e.length},t.getValue=function(){return this.value},t.clearValue=function(){this.value=""},t.setStartIndex=function(e){e<0&&(e=0),this.startIndex=e},t.resetStartIndex=function(){this.startIndex=-1},t.getStartIndex=function(){return this.startIndex},t.addChar=function(e,t){var i=t-this.startIndex,s=this.value.slice(0,i),n=this.value.slice(i,this.value.length);i>=0&&i<=this.value.length+1&&(this.value=s+e+n)},t.getLen=function(){return"string"==typeof this.value?this.value.length:null},t.removeChar=function(e,t){var i=t-this.startIndex,s=this.value.slice(0,i),n=this.value.slice(i+1,this.value.length);i===this.value.length&&(s=this.value.slice(0,i-1)),i>=0&&i<=this.value.length&&(this.value=s+n)},t.dispose=function(){this.value=null,this.startIndex=null},new RomajiToKana}),define("widgets/brease/KeyBoard/libs/converter/converter_zh_chs",["system/widgets/KeyBoard/libs/external/dictionaries","brease/core/Types"],function(e,Types){"use strict";var t=function(){},i=t.prototype,s=[],n;i.init=function(){return e.load("zh-cn")},i.getCandidates=function(e){return s=[],e.length>0&&(n=new RegExp("^"+e+"$","i"),this.lookup(e).map(r,this)),s},i.lookup=function(t){return a(t).filter(this.testEntry,t).sort(function(t,i){return Types.parseValue(t.freq,"Integer",{default:e.MAX_FREQUENCY,min:e.MIN_FREQUENCY,max:e.MAX_FREQUENCY})-Types.parseValue(i.freq,"Integer",{default:e.MAX_FREQUENCY,min:e.MIN_FREQUENCY,max:e.MAX_FREQUENCY})}).map(this.extractData)},i.testEntry=function(e){if(e)return!0===n.test(e.com)},i.extractData=function(e){return e.can};function a(){return e.get("zh-cn")}function r(e){s.includes(e)||s.push(e)}return new t}),define("widgets/brease/KeyBoard/libs/converter/KanaToKanji",["widgets/brease/KeyBoard/libs/external/wanakana","widgets/brease/KeyBoard/libs/external/dictionaries/single_kanji"],function(e,t){"use strict";var KanaToKanji=function(){this.pathDict="widgets/brease/KeyBoard/libs/external/dictionaries/KanjiDic"},i=KanaToKanji.prototype;i.getCandidates=function(t){switch(this.candidateList=[],n(t)){case 0:this.lookup(t).map(s,this);break;case 1:this.lookup(e.toRomaji(t)).map(s,this);break;default:}return this.candidateList},i.lookup=function(i){for(var s=e.toKana(i,{passRomaji:!0}),n="",a=[],r=0;r<s.length;r+=1)e.isKana(s[r])&&(n+=s[r]);for(var o in t)0===o.indexOf(n)&&(a=a.concat(t[o].split("")));return a};function s(e){this.candidateList.push(e)}function n(t){return e.isRomaji(t)?0:e.isKatakana(t)||e.isHiragana(t)?1:void 0}return new KanaToKanji}),define("widgets/brease/KeyBoard/libs/PluginProto",["brease/core/Class"],function(e){"use strict";var t=e.extend(function t(){e.call(this)}),i=t.prototype;return i.init=function(e){this.keyboard=e},i.show=function(){},i.hide=function(){},i.onInput=function(){},i.onDelete=function(){},i.dispose=function(){},t}),define("widgets/brease/Label/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Label",parents:["*"],children:[],inheritance:["widgets.brease.Label","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAutoScroll:{method:"setAutoScroll",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},
SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/Label/Label.html",[],function(){return'<label id="WIDGETID" data-brease-widget="widgets/brease/Label">CONTENT</label>\r\n'}),define("widgets/brease/Label/Label",["brease/core/BaseWidget","brease/decorators/LanguageDependency","brease/decorators/VisibilityDependency","brease/enum/Enum","brease/core/Types","brease/helper/Scroller","brease/events/BreaseEvent","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,t,i,Enum,Types,Scroller,BreaseEvent,s){"use strict";var n={ellipsis:!1,wordWrap:!1,multiLine:!1,breakWord:!1,text:"",autoScroll:!1},a=e.extend(function Label(){e.apply(this,arguments)},n),r=a.prototype;r.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseLabel"),this.settings.arrow===Enum.Position.left&&this.addInitialClass("arrow-left"),l(this),this.scroller=null,this.settings.ellipsis=Types.parseValue(this.settings.ellipsis,"Boolean"),this.settings.multiLine=Types.parseValue(this.settings.multiLine,"Boolean"),this.settings.wordWrap=Types.parseValue(this.settings.wordWrap,"Boolean"),d(this),this.setText(this.settings.text),e.prototype.init.apply(this,arguments),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler"))},r._onStylePropertiesChanged=function(){this.refreshScroller()},r._initEditor=function(){var e=this;this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_onStylePropertiesChanged")),require(["widgets/brease/Label/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.isRotatable=function(){return t.isRotatable()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},r.wake=function(){e.prototype.wake.apply(this,arguments),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler"))},r.suspend=function(){document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler")),e.prototype.suspend.apply(this,arguments)},r._dispatchReady=function(){e.prototype._dispatchReady.call(this),this.addScroller()},r.themeChangeHandler=function(){this.refreshScroller()},r.langChangeHandler=function(e){void 0!==e&&void 0!==e.detail&&void 0!==e.detail.textkey&&e.detail.textkey!==this.settings.textkey||null!==this.settings.textkey&&this.updateText(brease.language.getTextByKey(this.settings.textkey))},r.addScroller=function(){!this.scroller&&!1===this.settings.ellipsis&&this.settings.autoScroll&&(this.scroller=o(this),brease.config.editMode&&(this.scroller.subsequentlyDisableTouch(),this.scroller.subsequentlyDisableMouse()),this.setVisibilityDependency(!0)),this.refreshScroller()},r.destroyScroller=function(){c(this),this.scroller&&(this.scroller.destroy(),this.scroller=null)},r.refreshScroller=function(){this.scroller&&this.scroller.refresh(),c(this)},r.setText=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.updateText(e),this.removeTextKey()):this.setTextKey(brease.language.parseKey(e)))},r.getText=function(){return this.settings.text},r.updateText=function(e){null!==e&&(this.settings.text=Types.parseValue(e,"String"),this.settings.multiLine?this.textEl.get(0).innerText=brease.language.unescapeText(this.settings.text):this.textEl.text(brease.language.unescapeText(this.settings.text))),this.refreshScroller()},r.setTextKey=function(e){if(void 0!==e)return this.settings.textkey=e,this.updateText(brease.language.getTextByKey(this.settings.textkey)),this.setLangDependency(!0),this.getText()},r.removeTextKey=function(){this.settings.textkey=null,this.setLangDependency(!1)},r.getTextKey=function(){return this.settings.textkey},r.setEllipsis=function(e){this.settings.ellipsis=Types.parseValue(e,"Boolean"),d(this),this.settings.ellipsis?this.destroyScroller():this.addScroller()},r.getEllipsis=function(){return this.settings.ellipsis},r.setWordWrap=function(e){this.settings.wordWrap=Types.parseValue(this.settings.wordWrap,"Boolean"),this.settings.wordWrap=e,d(this),this.refreshScroller()},r.getWordWrap=function(){return this.settings.wordWrap},r.setBreakWord=function(e){this.settings.breakWord=e,d(this),this.refreshScroller()},r.getBreakWord=function(){return this.settings.breakWord},r.setMultiLine=function(e){this.settings.multiLine=Types.parseValue(this.settings.multiLine,"Boolean"),this.settings.multiLine=e,d(this),this.updateText(this.settings.text)},r.getMultiLine=function(){return this.settings.multiLine},r.setAutoScroll=function(e){this.settings.autoScroll=e,e?this.addScroller():this.destroyScroller()},r.getAutoScroll=function(){return this.settings.autoScroll},r._visibleHandler=function(){this.isVisible()&&this.refreshScroller()},r.dispose=function(){document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("themeChangeHandler")),this.destroyScroller(),e.prototype.dispose.apply(this,arguments)};function o(e){var t={mouseWheel:!0,scrollX:!0,scrollY:!0};return Scroller.addScrollbars(e.elem,t)}function l(e){e.textEl=$("<span></span>"),e.elem.textContent?(e.settings.text=e.elem.textContent,e.el.contents().wrap(e.textEl)):e.el.html(e.textEl)}function d(e){!0===e.settings.ellipsis?e.el.addClass("ellipsis"):e.el.removeClass("ellipsis"),!0===e.settings.multiLine?(e.el.addClass("multiLine"),!0===e.settings.wordWrap?(e.el.addClass("wordWrap"),e.el.removeClass("multiLine")):e.el.removeClass("wordWrap"),!0===e.settings.breakWord?(e.el.addClass("breakWord"),e.el.removeClass("multiLine")):e.el.removeClass("breakWord")):(e.el.removeClass("breakWord"),e.el.removeClass("wordWrap"),e.el.removeClass("multiLine"))}function c(e){!1===e.settings.ellipsis&&e.settings.autoScroll&&e.scroller&&e.scroller.hasVerticalScroll?e.el.addClass("scrollable"):e.el.removeClass("scrollable")}return s.decorate(i.decorate(t.decorate(a,!1),!1),!1)}),define("widgets/brease/Line/designer/ClassExtension",[],function(){"use strict";return{extend:function(e){e.static.getInitialProperties=function(e,t){return{x1:e,y1:t,x2:e+100,y2:t}},e.extended=!0}}}),define("widgets/brease/Line/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo","widgets/brease/Line/designer/ClassExtension"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Line",parents:["*"],children:[],inheritance:["widgets.brease.Line","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setX1:{method:"setX1",parameter:{x1:{name:"x1",index:0,type:"Integer"}}},setX2:{method:"setX2",parameter:{x2:{name:"x2",index:0,type:"Integer"}}},setY1:{method:"setY1",parameter:{y1:{name:"y1",index:0,type:"Integer"}}},setY2:{method:"setY2",parameter:{y2:{name:"y2",index:0,type:"Integer"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/Line/Line.html",[],function(){return'<svg id="WIDGETID" data-brease-widget="widgets/brease/Line"></svg>\r\n'}),define("widgets/brease/Line/Line",["brease/core/BaseWidget","libs/d3/d3"],function(e,t){"use strict";var i={},s=e.extend(function Line(){e.apply(this,arguments)},i),n=s.prototype;n.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseLine"),this.el.css("position","absolute"),t.select("#"+this.el[0].id).append("line"),this.line=$(this.el.children()[0]),r(this),e.prototype.init.call(this),this._invalidate()},n._initEditor=function(){var e=this;require(["widgets/brease/Line/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.designer.getHandles=function(){return t.getHandles()}})},n.addClassNames=function(e){void 0!==this.el&&""!==e&&a(this.el,e),this.initialized=!0},n.setX1=function(e){this.settings.x1=e,r(this)},n.getX1=function(){return this.settings.x1},n.setX2=function(e){this.settings.x2=e,r(this)},n.getX2=function(){return this.settings.x2},n.setY1=function(e){this.settings.y1=e,r(this)},n.getY1=function(){return this.settings.y1},n.setY2=function(e){this.settings.y2=e,r(this)},n.getY2=function(){return this.settings.y2};function a(e,t){for(var i=0;i<t.length;i+=1)e.addClass(t[i])}function r(e){e.settings.width=Math.abs(e.settings.x2-e.settings.x1),e.settings.height=Math.abs(e.settings.y2-e.settings.y1),e.settings.left=Math.min(e.settings.x1,e.settings.x2),e.settings.top=Math.min(e.settings.y1,e.settings.y2),e.el.attr({width:Math.max(e.settings.width,1),height:Math.max(e.settings.height,1)}).css({left:e.settings.left+"px",top:e.settings.top+"px"}),e.settings.x1<=e.settings.x2?e.settings.y1<=e.settings.y2?e.line.attr({x1:0,x2:e.settings.width,y1:0,y2:e.settings.height}):e.line.attr({x1:0,x2:e.settings.width,y1:e.settings.height,y2:0}):e.settings.y1<=e.settings.y2?e.line.attr({x1:e.settings.width,x2:0,y1:0,y2:e.settings.height}):e.line.attr({x1:e.settings.width,x2:0,y1:e.settings.height,y2:0})}return s}),define("widgets/brease/LineChart/designer/ClassInfo",["widgets/brease/ChartWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.LineChart",parents:["*"],children:["widgets.brease.LineChartIndexAxis","widgets.brease.LineChartTimeAxis","widgets.brease.LineChartYAxis"],inheritance:["widgets.brease.LineChart","widgets.brease.ChartWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},ScrollDown:{method:"scrollDown"},ScrollLeft:{method:"scrollLeft"},ScrollRight:{method:"scrollRight"},ScrollUp:{method:"scrollUp"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setChartMargin:{method:"setChartMargin",parameter:{chartMargin:{name:"chartMargin",index:0,type:"PixelValCollection"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setInfiniteScroll:{method:"setInfiniteScroll",parameter:{infiniteScroll:{name:"infiniteScroll",index:0,type:"Boolean"}}},SetMaxZoomLevel:{method:"setMaxZoomLevel",parameter:{maxZoomLevel:{name:"maxZoomLevel",index:0,type:"UInteger"}}},SetMinZoomLevel:{method:"setMinZoomLevel",parameter:{minZoomLevel:{name:"minZoomLevel",index:0,type:"UInteger"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setShowGrid:{method:"setShowGrid",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetZoomType:{method:"setZoomType",parameter:{zoomType:{name:"zoomType",index:0,type:"brease.enum.ChartZoomType"}}},ShowTooltip:{method:"showTooltip"},ZoomIn:{method:"zoomIn"},ZoomOut:{method:"zoomOut"},ZoomReset:{method:"zoomReset"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/LineChart/LineChart.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/LineChart">CONTENT</div>\r\n'}),define("widgets/brease/LineChart/LineChart",["widgets/brease/ChartWidget/ChartWidget","widgets/brease/common/libs/DataAdapter","widgets/brease/common/libs/Renderer","brease/decorators/MeasurementSystemDependency"],function(e,DataAdapter,Renderer,t){"use strict";var i={zoomFactor:1.2,scrollFactor:.1},s=e.extend(function LineChart(){e.apply(this,arguments)},i),n=s.prototype;return n.init=function(){this.addInitialClass("breaseLineChart"),e.prototype.init.call(this)},n.setShowGrid=function(t){e.prototype.setShowGrid.call(this,t),this._redrawAll()},n.zoomIn=function(){this.renderer.zoomIn()},n.zoomOut=function(){this.renderer.zoomOut()},n.zoomReset=function(){this.renderer.zoomReset()},n.scrollLeft=function(){this.renderer.scrollLeft()},n.scrollRight=function(){this.renderer.scrollRight()},n.scrollUp=function(){this.renderer.scrollUp()},n.scrollDown=function(){this.renderer.scrollDown()},n.setMinZoomLevel=function(t){e.prototype.setMinZoomLevel.call(this,t),this.dataAdapter.updateZoomLevelLimits(),this.renderer.updateZoomLevelLimits()},n.setMaxZoomLevel=function(t){e.prototype.setMaxZoomLevel.call(this,t),this.dataAdapter.updateZoomLevelLimits(),this.renderer.updateZoomLevelLimits()},n.setZoomType=function(t){e.prototype.setZoomType.call(this,t),this.renderer.updateZoomType(t)},n._setDataAdapter=function(e){this.dataAdapter=new e(this)},n._setRenderer=function(e){this.renderer=new e(this)},n._chartItemsReadyHandler=function(){this._setDataAdapter(DataAdapter),this._setRenderer(Renderer),this.dataAdapter.updateScales(),this.renderer.updateAxis()},n._axisDirtyHandler=function(){this.dataAdapter.updateScales(),this.renderer.updateAxis()},n._cursorDirtyHandler=function(){this.dataAdapter.updateCursor(),this.renderer.updateCursor()},n._valueListsDirtyHandler=function(){this.dataAdapter.updateGraphData(),this.renderer.updateGraphs()},n._redrawAll=function(){this._axisIsDirty("x"),this._axisIsDirty("y"),this._valueListIsDirty(),this._cursorIsDirty()},n.measurementSystemChangeHandler=function(){var e=this,t=[];if(this.chartItems&&this.chartItems.yAxis)for(var i in this.chartItems.yAxis)t.push(this.chartItems.yAxis[i].measurementSystemChanged());t.length>0&&$.when.apply($,t).then(function t(){e._redrawAll()})},n.dispose=function(){this.dataAdapter=null,this.renderer&&this.renderer.dispose(),this.renderer=null,e.prototype.dispose.apply(this,arguments)},t.decorate(s,!0)}),define("widgets/brease/LineChartGraph/designer/ClassInfo",["widgets/brease/ChartYValueListWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.LineChartGraph",parents:["widgets.brease.LineChartYAxis"],children:[],inheritance:["widgets.brease.LineChartGraph","widgets.brease.ChartYValueListWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setInterpolationType:{method:"setInterpolationType",parameter:{interpolationType:{name:"interpolationType",index:0,type:"brease.enum.ChartInterpolationType"}}},setIntersectionPointSize:{method:"setIntersectionPointSize",parameter:{intersectionPointSize:{name:"intersectionPointSize",index:0,type:"PixelVal"}}},setMaxValue:{method:"setMaxValue",parameter:{value:{name:"value",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{value:{name:"value",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.ArrayNode"}}},setNumberOfSamples:{method:"setNumberOfSamples",parameter:{numberOfSamples:{name:"numberOfSamples",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"NumberArray1D"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setXAxisRefId:{method:"setXAxisRefId",parameter:{xAxisRefId:{name:"xAxisRefId",index:0,type:"String"}}}},properties:{cursorValue:{nodeRefId:"cursorNode"},value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/LineChartGraph/LineChartGraph.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/LineChartGraph">CONTENT</div>\r\n'}),define("widgets/brease/LineChartGraph/LineChartGraph",["widgets/brease/ChartYValueListWidget/ChartYValueListWidget","brease/datatype/Node","brease/datatype/ArrayNode","brease/core/Utils","widgets/brease/ChartWidget/libs/constants"],function(e,Node,ArrayNode,Utils,t){"use strict";var i={xAxisRefId:"",minValue:0,maxValue:100,cursorValue:0,interpolationType:"linear",intersectionPointSize:"10px"},s=e.extend(function LineChartGraph(){e.apply(this,arguments)},i),n=s.prototype;n.init=function(){this.addInitialClass("breaseLineChartGraph"),this.data={deferredValueChanged:void 0,value:[],node:new ArrayNode([]),arraySize:0},e.prototype.init.call(this)},n._chartItemsReadyHandler=function(){if(this.xAxisWidget=brease.callWidget(this.settings.xAxisRefId,"widget"),null===this.xAxisWidget){var e={name:t.ERROR_INVALID_PROPERTY_VALUE,arg1:"xAxisRefId",arg2:this.elem.id};return this.chartWidget.errorHandler(e),void 0}for(var i in this.xAxisWidget.cursors)this.xAxisWidget.cursors[i].graphWidgets[this.elem.id]=this},n.setValue=function(e){var t=this;$.when(t.allChartItemsInitializedDeferred).done(function(){null===e?e=t.data.value:e.length!==t.data.arraySize&&(t.data.arraySize=e.length,!1===t.isHidden&&t.xAxisWidget._registerGraphArraySize(t.elem.id,t.data.arraySize));for(var i=!1,s=0;s<e.length;s+=1)if(t.data.value[s]!==e[s]){i=!0;break}if(t.data.value=e,i)for(var n in t.xAxisWidget.cursors){var a=t.xAxisWidget.cursors[n],r=a._getActive();if(a._getActive()){a.cursorsDirtyFlag=!0,a.setValue(a.getValue()),a.cursorsDirtyFlag=!1,a._setActive(r),a._isDirty();break}}void 0!==t.data.deferredValueChanged&&"resolved"!==t.data.deferredValueChanged.state()?t.data.node.unit===t.axisWidget.currentUnit()&&t.data.deferredValueChanged.resolve():t._isDirty()})},n.getValue=function(){return this.data.value},n.setNode=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){t.data.node=ArrayNode.json2ArrayNode(e),t.setMinValue(t.data.node.minValue),t.setMaxValue(t.data.node.maxValue),t.setValue(t.data.node.value),void 0===t.settings.cursorNode?t.settings.cursorNode=new Node(t.getCursorValue(),t.data.node.getUnit(),t.getMinValue(),t.getMaxValue()):a.call(t)})},n.getNode=function(){if(void 0===this.axisWidget){var e=this.el.parents(".breaseChartYAxisWidget").attr("id");this._registerAxisWidget(brease.callWidget(e,"widget"))}return this.data.node.setUnit(this.axisWidget.currentUnit()),this.data.node},n.setMinValue=function(e){this.settings.minValue!==e&&(this.settings.minValue=e,void 0!==this.settings.cursorNode&&this.settings.cursorNode.setMinValue(e),this.axisWidget._isDirty())},n.getMinValue=function(){return this.settings.minValue},n.setMaxValue=function(e){this.settings.maxValue!==e&&(this.settings.maxValue=e,void 0!==this.settings.cursorNode&&this.settings.cursorNode.setMaxValue(e),this.axisWidget._isDirty())},n.getMaxValue=function(){return this.settings.maxValue},n.getCursorValue=function(){return this.settings.cursorValue},n.getCursorNode=function(){return this.settings.cursorNode?this.settings.cursorNode:new Node(this.getCursorValue())},n.setXAxisRefId=function(e){this.settings.xAxisRefId=e},n.getXAxisRefId=function(){return this.settings.xAxisRefId},n.setIntersectionPointSize=function(e){this.settings.intersectionPointSize=e},n.getIntersectionPointSize=function(){return this.settings.intersectionPointSize},n.updateUnit=function(){this.data.deferredValueChanged=$.Deferred();var e=brease.uiController.getSubscriptionsForElement(this.elem.id);return void 0!==e&&void 0!==e.node?this.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:this.axisWidget.currentUnit()}):this.data.deferredValueChanged.resolve(),this.data.deferredValueChanged.promise()},n._visibleHandler=function(t){var i=this;e.prototype._visibleHandler.apply(this,arguments),$.when(this.allChartItemsInitializedDeferred).done(function(){i.xAxisWidget&&(Object.keys(i.xAxisWidget.cursors).forEach(function(e){this[e]._isDirty()},i.xAxisWidget.cursors),!0===i.settings.visible?i.xAxisWidget._registerGraphArraySize(i.elem.id,i.data.arraySize):i.xAxisWidget._registerGraphArraySize(i.elem.id,2))})},n._coordinates=function(){var e=this.xAxisWidget._xPositions(),t=[],i=this.data.value.length;this.getNumberOfSamples()>=0&&this.getNumberOfSamples()<=i&&(i=this.settings.numberOfSamples);for(var s=0;s<i;s+=1)t.push({x:e[s],y:this.data.value[s]});return t},n._getIntersectionValue=function(e,t,i){var s=this.getIndexOfXCoordinate(e),n=this.getNumberOfSamples()<0?this.getValue().length:this.getNumberOfSamples();return s=s>n-1?n-1:s,s>=0&&!0===i?(t&&void 0!==this.data.value[s]&&this.data.value[s]!==this.getCursorValue()&&this.isVisible()&&(this._setCursorValue(this.data.value[s]),void 0!==this.settings.cursorNode?a.call(this):this.sendValueChange({cursorValue:this.getCursorValue()})),this.data.value[s]):null},n.getIndexOfXCoordinate=function(e){var t=-1;if(Utils.isNumeric(e.toString()))t=this.xAxisWidget._xPositions().indexOf(e);else{var i=this.xAxisWidget._xPositions().map(function(e){return Number(e)});t=i.indexOf(this._binarySearchOfClosestValue(Number(e),i))}return t},n._getYValueFromXCoordinate=function(e){var t=this.getIndexOfXCoordinate(e),i=this.getNumberOfSamples()<0?this.getValue().length:this.getNumberOfSamples();return t=t>i-1?i-1:t,t>=0&&void 0!==this.data.value[t]?this.data.value[t]:null},n._binarySearchOfClosestValue=function(e,t){var i=0,s=t.length-1,n=Math.round((0+s)/2);return 0===t.length?null:1===t.length?t[0]:2===t.length?this._getClosestPointBetweenTwo(e,t):3===t.length?e<t[n]?this._getClosestPointBetweenTwo(e,t.slice(0,n+1)):this._getClosestPointBetweenTwo(e,t.slice(n,s+1)):e<t[n]?this._binarySearchOfClosestValue(e,t.slice(0,n+1)):e>t[n]?this._binarySearchOfClosestValue(e,t.slice(n,s+1)):t[n]},n._getClosestPointBetweenTwo=function(e,t){return 2===t.length?e-t.reduce(function(e,t){return e+t},0)/2<0?t[0]:t[1]:null},n._setCursorValue=function(e){void 0!==e&&(this.settings.cursorValue=e)},n.dispose=function(){this.settings.cursorNode=void 0,e.prototype.dispose.apply(this,arguments)};function a(){var e=this.settings.cursorNode,t={Value:e.getValue(),Unit:e.getUnit()};e.setValue(this.getCursorValue()),e.setUnit(this.data.node.getUnit()),e.setMinValue(this.getMinValue()),e.setMaxValue(this.getMaxValue()),Object.keys(t).some(function(i){return t[i]!==e["get"+i]()})&&this.sendValueChange({cursorNode:this.getCursorNode()})}return s}),define("widgets/brease/LineChartTimeAxis/designer/ClassInfo",["widgets/brease/ChartXAxisWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.LineChartTimeAxis",parents:["widgets.brease.LineChart"],children:["widgets.brease.LineChartXAxisTimeCursor","widgets.brease.LineChartXAxisMsTimeCursor"],inheritance:["widgets.brease.LineChartTimeAxis","widgets.brease.ChartXAxisWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAxisLabel:{method:"setAxisLabel",parameter:{axisLabel:{name:"axisLabel",index:0,type:"String"}}},setAxisLabelDistance:{method:"setAxisLabelDistance",parameter:{axisLabelDistance:{name:"axisLabelDistance",index:0,type:"PixelVal"}}},setAxisPosition:{method:"setAxisPosition",parameter:{axisPosition:{name:"axisPosition",index:0,type:"brease.enum.VerticalAlign"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"}}},SetMaxValue:{method:"setMaxValue",parameter:{value:{name:"value",index:0,type:"DateTime"}}},SetMinValue:{method:"setMinValue",parameter:{value:{name:"value",index:0,type:"DateTime"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTickLabelDistance:{method:"setTickLabelDistance",parameter:{tickLabelDistance:{name:"tickLabelDistance",index:0,type:"PixelVal"}}},setTickLabelRotation:{method:"setTickLabelRotation",parameter:{tickLabelRotation:{name:"tickLabelRotation",index:0,type:"Rotation"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/LineChartTimeAxis/LineChartTimeAxis.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/LineChartTimeAxis">CONTENT</div>\r\n'}),define("widgets/brease/LineChartTimeAxis/LineChartTimeAxis",["widgets/brease/ChartXAxisWidget/ChartXAxisWidget","brease/decorators/LanguageDependency"],function(e,t){"use strict";var i={minValue:"1970-01-01T00:00:00.000Z",maxValue:"1970-01-01T00:01:00.000Z",cursorValue:"1970-01-01T00:00:00.000Z",format:"mm:ss",formatTextKey:void 0,labelTextkey:void 0},s=e.extend(function LineChartTimeAxis(){e.apply(this,arguments)},i),n=s.prototype;n.init=function(){this.addInitialClass("breaseLineChartTimeAxis"),e.prototype.init.call(this),this.data.minValue={value:new Date,timeZoneCorrectedValue:new Date,timeZoneOffset:0},this.data.maxValue={value:new Date,timeZoneCorrectedValue:new Date,timeZoneOffset:0},this.data.xPositionsMillisecondResolution=[],this.data.xPositionsSecondResolution=[],this.axisType="dateTime",a(this.data.minValue,this.settings.minValue),a(this.data.maxValue,this.settings.maxValue),!0!==brease.config.editMode&&this.el.height(0),this.setFormat(this.getFormat()),this.setAxisLabel(this.getAxisLabel())},n._chartItemsReadyHandler=function(){},n.setFormat=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){var i=!0;!1===brease.language.isKey(e)?(t.settings.format=e,t.settings.formatTextKey=void 0):i=t.setPropertyKey(brease.language.parseKey(e),"format"),brease.config.editMode?(t.editorGrid.configuration.tickFormat=t.settings.format,t.editorGrid.updateAxis()):i&&(t._isDirty(),t.chartWidget._valueListIsDirty(),t.chartWidget._cursorIsDirty())})},n.setPropertyKey=function(e,t){if(void 0!==e){this.settings[t+"TextKey"]=e,this.setLangDependency(!0);var i=brease.language.getTextByKey(this.settings[t+"TextKey"]);return"undefined key"!==i?(this.settings[t]=i,!0):(console.iatWarn(this.elem.id+": "+t+" textKey not found: "+e),!1)}return this.settings[t+"TextKey"]=void 0,console.iatWarn(this.elem.id+": The text key is not valid : "+e),!1},n.getFormat=function(){return this.settings.format},n.setMinValue=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){t.settings.minValue=e,a(t.data.minValue,e),t._generateXPositions(),t._isDirty(),t.chartWidget&&t.chartWidget._valueListIsDirty();for(var i in t.cursors){var s=t.cursors[i];s.setValue(s.getValue())}t.chartWidget&&t.chartWidget._cursorIsDirty()})},n.getMinValue=function(){return this.data.minValue.value.toISOString()},n.setMaxValue=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){t.settings.maxValue=e,a(t.data.maxValue,e),t._generateXPositions(),t._isDirty(),t.chartWidget&&t.chartWidget._valueListIsDirty();for(var i in t.cursors){var s=t.cursors[i];s.setValue(s.getValue())}t.chartWidget&&t.chartWidget._cursorIsDirty()})},n.getMaxValue=function(){return this.data.maxValue.value.toISOString()},n.getCursorValue=function(){return this.settings.cursorValue},n.setAxisLabel=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){var i=!0;!1===brease.language.isKey(e)?(t.settings.axisLabel=e,t.settings.axisLabelTextKey=void 0):i=t.setPropertyKey(brease.language.parseKey(e),"axisLabel"),brease.config.editMode?(t.editorGrid.configuration.axisLabel=t.settings.axisLabel,t.editorGrid.updateAxis()):i&&(t._isDirty(),t.chartWidget._valueListIsDirty())})},n.getAxisLabel=function(){return this.settings.axisLabel},n.currentFormat=function(){return this.getFormat()},n._registerGraphArraySize=function(){var t=this.data.maxArraySize;e.prototype._registerGraphArraySize.apply(this,arguments),t!==this.data.maxArraySize&&this._generateXPositions(),this._isDirty()},n._getMinValue=function(){return this.data.minValue.timeZoneCorrectedValue},n._getMaxValue=function(){return this.data.maxValue.timeZoneCorrectedValue},n._xPositions=function(e){return"secondsTime"===e?this.data.xPositionsSecondResolution:this.data.xPositionsMillisecondResolution},n._getAxisType=function(){return this.axisType},n._generateXPositions=function(){var e=this.data.maxValue.timeZoneCorrectedValue-this.data.minValue.timeZoneCorrectedValue,t,i=new Date(this._getMinValue()),s=r(i),n=Math.abs(s.getTime()-i.getTime()),a={value:i,neighbourhoodRadius:n};this.data.xPositionsMillisecondResolution=[new Date(this._getMinValue())],this.data.xPositionsSecondResolution=[a.value];for(var o=1;o<this.data.maxArraySize;o+=1)t=Math.round(o*e/(this.data.maxArraySize-1)),i=new Date(this._getMinValue().getTime()+t),this.data.xPositionsMillisecondResolution.push(i),s=r(i),s.getTime()-a.value.getTime()==0?(n=Math.abs(i.getTime()-a.value.getTime()),n<a.neighbourhoodRadius&&(a.neighbourhoodRadius=n,this.data.xPositionsSecondResolution.pop(),this.data.xPositionsSecondResolution.push(i))):(n=Math.abs(s.getTime()-i.getTime()),a.value=s,a.neighbourhoodRadius=n,this.data.xPositionsSecondResolution.push(i))},n.langChangeHandler=function(e){void 0!==e&&void 0!==e.detail&&void 0!==e.detail.textkey&&e.detail.textkey!==this.settings.formatTextKey&&e.detail.textkey!==this.settings.axisLabelTextKey||(void 0!==this.settings.formatTextKey&&this.setPropertyKey(this.settings.formatTextKey,"format"),void 0!==this.settings.axisLabelTextKey&&this.setPropertyKey(this.settings.axisLabelTextKey,"axisLabel"),void 0===this.settings.formatTextKey&&void 0===this.settings.axisLabelTextKey||(this._isDirty(),this.chartWidget._valueListIsDirty(),this.chartWidget._cursorIsDirty()))},n.dispose=function(){e.prototype.dispose.apply(this,arguments)};function a(e,t){e.value=new Date(t),e.timeZoneCorrectedValue=new Date(t),e.timeZoneOffset=e.value.getTimezoneOffset(),e.timeZoneCorrectedValue.setMinutes(e.timeZoneCorrectedValue.getMinutes()+e.timeZoneOffset)}function r(e){return new Date(1e3*Math.round(+e/1e3))}return t.decorate(s,!0)}),define("widgets/brease/LineChartXAxisTimeCursor/designer/ClassInfo",["widgets/brease/ChartXAxisCursorWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.LineChartXAxisTimeCursor",parents:["widgets.brease.LineChartTimeAxis"],children:[],
inheritance:["widgets.brease.LineChartXAxisTimeCursor","widgets.brease.ChartXAxisCursorWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"DateTime"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},StepLeft:{method:"stepLeft",parameter:{stepSize:{name:"stepSize",index:0,type:"UInteger"}}},StepRight:{method:"stepRight",parameter:{stepSize:{name:"stepSize",index:0,type:"UInteger"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/LineChartXAxisTimeCursor/LineChartXAxisTimeCursor.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/LineChartXAxisTimeCursor">CONTENT</div>'}),define("widgets/brease/LineChartXAxisTimeCursor/LineChartXAxisTimeCursor",["widgets/brease/ChartXAxisCursorWidget/ChartXAxisCursorWidget","widgets/brease/common/libs/wfUtils/UtilsEditableBinding"],function(e,UtilsEditableBinding){"use strict";var t={value:"1970-01-01T00:00:00.000Z"},i=e.extend(function LineChartXAxisTimeCursor(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){this.addInitialClass("breaseLineChartXAxisTimeCursor"),this.data={},this.data.xPosition={value:new Date,timeZoneCorrectedValue:new Date,timeZoneOffset:0},this.cursorType="secondsTime",!0!==brease.config.editMode&&this.el.height(0),n(this.data.xPosition,this.settings.value),e.prototype.init.call(this)},s.setValue=function(e){var t=this;void 0!==t.bindings&&void 0!==t.bindings.value&&void 0!==t.bindings.value.active&&(void 0===t.cursorsDirtyFlag||!1===t.cursorsDirtyFlag&&void 0===t.bindingFlag)&&(t.settings.value=t.value,t.data.xPosition.value=new Date(e),t.bindingFlag=!0),t.value=e,$.when(t.allChartItemsInitializedDeferred).done(function(){if(t.getVisible()&&t.axisWidget){var e,i={value:new Date,timeZoneCorrectedValue:new Date,timeZoneOffset:0},s=t.axisWidget._xPositions(t.cursorType).map(function(e){return e.getTime()});if(s.length>1){var r=s.slice(0,t._getMaxDrawnXSampleIndex(t._getMaxNumberOfSamples())+1);n(i,t.value),e=a(i.timeZoneCorrectedValue.getTime(),r),t.settings.value=l(e).toISOString(),n(t.data.xPosition,t.settings.value),d(t.data.xPosition.value)!==d(i.value)&&t.sendValueChange({value:c(t.getValue())}),t._getActive()||t.axisWidget._setActiveCursor(t.elem.id);for(var o in t.graphWidgets)if(s=t.axisWidget._xPositions(t.cursorType).map(function(e){return+e}),s.indexOf(+t.data.xPosition.timeZoneCorrectedValue)<=t._getMaxDrawnXSampleIndex(t.graphWidgets[o].getNumberOfSamples())||t._getMaxDrawnXSampleIndex(t.graphWidgets[o].getNumberOfSamples())<0){for(var h,u=0;u<t.chartWidget.dataAdapter.graphs.length;u+=1)if(t.chartWidget.dataAdapter.graphs[u].id===o){h=t.chartWidget.dataAdapter.graphs[u].intersectionPoints[t.elem.id].markerVisible;break}t.graphWidgets[o]._getIntersectionValue(t._getValue(),t._getActive(),h)}t._isDirty()}else t.settings.value=t.value,n(t.data.xPosition,t.settings.value)}else t.settings.value=t.value})},s.getValue=function(){return this.data.xPosition.value.toISOString()},s.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},s.stepLeft=function(e){this.getVisible()&&this.isEnabled()&&this.chartWidget.renderer.xCursorStepLeft(this.elem.id,e)},s.stepRight=function(e){this.getVisible()&&this.isEnabled()&&this.chartWidget.renderer.xCursorStepRight(this.elem.id,e)},s.dispose=function(){e.prototype.dispose.apply(this,arguments)},s._getValue=function(){return this.data.xPosition.timeZoneCorrectedValue},s._setValue=function(e){this.data.xPosition.timeZoneCorrectedValue=e,this.data.xPosition.value=new Date(e),this.data.xPosition.value.setMinutes(this.data.xPosition.value.getMinutes()-this.data.xPosition.timeZoneOffset),this._getActive()||this.axisWidget._setActiveCursor(this.elem.id);for(var t in this.graphWidgets){if(this.axisWidget._xPositions(this.cursorType).map(function(e){return+e}).indexOf(+e)<=this._getMaxDrawnXSampleIndex(this.graphWidgets[t].getNumberOfSamples())||this._getMaxDrawnXSampleIndex(this.graphWidgets[t].getNumberOfSamples())<0){for(var i,s=0;s<this.chartWidget.dataAdapter.graphs.length;s+=1)if(this.chartWidget.dataAdapter.graphs[s].id===t){i=this.chartWidget.dataAdapter.graphs[s].intersectionPoints[this.elem.id].markerVisible;break}this.graphWidgets[t]._getIntersectionValue(this._getValue(),this._getActive(),i)}}this._isDirty()},s._updateValue=function(e){this._setValue(e),this.sendValueChange({value:c(this.getValue())})},s._getMaxAvailableXPositionIndex=function(){return this.axisWidget._xPositions(this.cursorType).length-1};function n(e,t){t=/^DT#/gi.test(t)?t+"Z":t,e.value=new Date(t),e.timeZoneCorrectedValue=new Date(t),e.timeZoneOffset=e.value.getTimezoneOffset(),e.timeZoneCorrectedValue.setMinutes(e.timeZoneCorrectedValue.getMinutes()+e.timeZoneOffset)}function a(e,t){return r(e,t)}function r(e,t){var i=0,s=t.length-1,n=Math.round((0+s)/2);return 0===t.length?null:1===t.length?t[0]:2===t.length?o(e,t):3===t.length?e<t[n]?o(e,t.slice(0,n+1)):o(e,t.slice(n,s+1)):e<t[n]?r(e,t.slice(0,n+1)):e>t[n]?r(e,t.slice(n,s+1)):t[n]}function o(e,t){return 2===t.length?e-t.reduce(function(e,t){return e+t},0)/2<0?t[0]:t[1]:null}function l(e){var t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t}function d(e){return 1e3*Math.round(+e/1e3)}function c(e){return new Date(1e3*Math.round(+new Date(e)/1e3)).toISOString()}return i}),define("widgets/brease/LineChartYAxis/designer/ClassInfo",["widgets/brease/ChartYAxisWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.LineChartYAxis",parents:["widgets.brease.LineChart"],children:["widgets.brease.LineChartGraph"],inheritance:["widgets.brease.LineChartYAxis","widgets.brease.ChartYAxisWidget","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAxisLabel:{method:"setAxisLabel",parameter:{axisLabel:{name:"axisLabel",index:0,type:"String"}}},setAxisLabelDistance:{method:"setAxisLabelDistance",parameter:{axisLabelDistance:{name:"axisLabelDistance",index:0,type:"PixelVal"}}},setAxisPosition:{method:"setAxisPosition",parameter:{axisPosition:{name:"axisPosition",index:0,type:"brease.enum.HorizontalAlign"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTickLabelDistance:{method:"setTickLabelDistance",parameter:{tickLabelDistance:{name:"tickLabelDistance",index:0,type:"PixelVal"}}},setTickLabelRotation:{method:"setTickLabelRotation",parameter:{tickLabelRotation:{name:"tickLabelRotation",index:0,type:"Rotation"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/LineChartYAxis/LineChartYAxis.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/LineChartYAxis">CONTENT</div>\r\n'}),define("widgets/brease/LineChartYAxis/LineChartYAxis",["widgets/brease/ChartYAxisWidget/ChartYAxisWidget","brease/config/NumberFormat","brease/core/Utils","brease/decorators/LanguageDependency"],function(e,NumberFormat,Utils,t){"use strict";var i={format:{metric:{decimalPlaces:1,minimumIntegerDigits:1},imperial:{decimalPlaces:1,minimumIntegerDigits:1},"imperial-us":{decimalPlaces:1,minimumIntegerDigits:1}},unit:null},s=e.extend(function LineChartYAxis(){e.apply(this,arguments)},i),n=s.prototype;n.init=function(){this.addInitialClass("breaseLineChartYAxis"),this.data={currentUnit:a(this),currentUnitSymbol:""},e.prototype.init.call(this),this.setAxisLabel(this.getAxisLabel()),this.setUnit(this.getUnit()),r(this),this.setFormat(this.getFormat())},n._chartItemsReadyHandler=function(){},n.setUnit=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){var i,s=t;Utils.isObject(e)?s.settings.unit=e:s.settings.unit=""!==e&&null!==e?JSON.parse(e.replace(/'/g,'"')):s.settings.unit,i=s.measurementSystemChanged(),brease.config.editMode||$.when(i).then(function(){s._isDirty(),s.chartWidget._valueListIsDirty(),s.chartWidget._cursorIsDirty()})})},n.getUnit=function(){return this.settings.unit},n.setFormat=function(e){var t=this,i;$.when(this.allChartItemsInitializedDeferred).done(function(){t.settings.format=e,i=l(t),brease.config.editMode?(t.editorGrid.configuration.tickFormat=t.currentFormat(),t.editorGrid.updateAxis()):i&&(t._isDirty(),t.chartWidget._valueListIsDirty(),t.chartWidget._cursorIsDirty())})},n.getFormat=function(){return this.settings.format},n.setAxisLabel=function(e){var t=this;$.when(this.allChartItemsInitializedDeferred).done(function(){var i=!0;!1===brease.language.isKey(e)?(t.settings.axisLabel=e,t.settings.axisLabelTextKey=void 0):i=t.setPropertyKey(brease.language.parseKey(e),"axisLabel"),brease.config.editMode?(t.editorGrid.configuration.axisLabel=t.settings.axisLabel,t.editorGrid.updateAxis()):i&&(t._isDirty(),t.chartWidget._valueListIsDirty())})},n.getAxisLabel=function(){return this.settings.axisLabel},n.setPropertyKey=function(e,t){if(void 0!==e){this.settings[t+"TextKey"]=e,this.setLangDependency(!0);var i=brease.language.getTextByKey(this.settings[t+"TextKey"]);return"undefined key"!==i?(this.settings[t]=i,!0):(console.iatWarn(this.elem.id+": "+t+" textKey not found: "+e),!1)}return this.settings[t+"TextKey"]=void 0,console.iatWarn(this.elem.id+": The text key is not valid : "+e),!1},n.minimum=function(){var e=null,t;for(var i in this.axisItems)t=this.axisItems[i].getMinValue(),null===e?e=t:t<e&&(e=t);return e},n.maximum=function(){var e=null,t;for(var i in this.axisItems)t=this.axisItems[i].getMaxValue(),null===e?e=t:t>e&&(e=t);return e},n.currentUnit=function(){return this.data.currentUnit},n.currentUnitSymbol=function(){return this.data.currentUnitSymbol},n.currentFormat=function(){return o(this)},n.langChangeHandler=function(){this.settings.axisLabelTextKey&&this.setPropertyKey(this.settings.axisLabelTextKey,"axisLabel"),void 0!==this.settings.axisLabelTextKey&&(this._isDirty(),this.chartWidget._valueListIsDirty(),this.chartWidget._cursorIsDirty())},n.measurementSystemChanged=function(){var e=this,t=this.data.currentUnit,i=[],s=$.Deferred();if(this.data.currentUnit=""!==a(this)?a(this):t,this.data.currentUnit!==t){i.push(r(this));for(var n in this.axisItems)i.push(this.axisItems[n].updateUnit());$.when.apply($,i).then(function t(){l(e),s.resolve()})}else s.resolve();return s.promise()},n.dispose=function(){e.prototype.dispose.apply(this,arguments)};function a(e){return null!==e.settings.unit?e.settings.unit[brease.measurementSystem.getCurrentMeasurementSystem()]:""}function r(e){var t=$.Deferred();return brease.language.pipeAsyncUnitSymbol(e.data.currentUnit,function(i){e.data.currentUnitSymbol=void 0===i?"":i,t.resolve()}),t.promise()}function o(e){var t=e.getFormat();return Utils.isObject(t)?NumberFormat.getFormat(t,brease.measurementSystem.getCurrentMeasurementSystem()):e.settings.numberFormat}function l(e){var t=brease.measurementSystem.getCurrentMeasurementSystem(),i,s=e.getFormat(),n;if(void 0===s)return e.settings.numberFormat=NumberFormat.getFormat({},t),!1;if(Utils.isObject(s))return e.settings.numberFormat=NumberFormat.getFormat(s,t),!0;if("string"==typeof s)if(brease.language.isKey(s))try{return e.setLangDependency(!0),n=brease.language.parseKey(s),i=JSON.parse(brease.language.getTextByKey(n).replace(/'/g,'"')),e.settings.numberFormat=NumberFormat.getFormat(i,t),!0}catch(i){return console.iatWarn(e.elem.id+': Format String "'+s+'" is invalid!'),e.settings.numberFormat=NumberFormat.getFormat({},t),!1}else try{return i=""!==s?JSON.parse(s.replace(/'/g,'"')):{},e.settings.numberFormat=NumberFormat.getFormat(i,t),!0}catch(i){return console.iatWarn(e.elem.id+': Format String "'+s+'" is invalid!'),e.settings.numberFormat=NumberFormat.getFormat({},t),!1}}return t.decorate(s,!0)}),define("widgets/brease/MessageBox/designer/ClassInfo",["widgets/brease/Window/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.MessageBox",parents:["*"],children:[],inheritance:["widgets.brease.MessageBox","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setIcon:{method:"setIcon"},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{style:{name:"style",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/MessageBox/libs/Buttons",["brease/core/Utils"],function(Utils){"use strict";var e={};return Utils.defineProperty(e,"btnOk",{state:"OK",textkey:"BR/IAT/brease.common.ok"}),Utils.defineProperty(e,"btnYes",{state:"YES",textkey:"BR/IAT/brease.common.yes"}),Utils.defineProperty(e,"btnNo",{state:"NO",textkey:"BR/IAT/brease.common.no"}),Utils.defineProperty(e,"btnAbort",{state:"ABORT",textkey:"BR/IAT/brease.common.abort"}),Utils.defineProperty(e,"btnRetry",{state:"RETRY",textkey:"BR/IAT/brease.common.retry"}),Utils.defineProperty(e,"btnIgnore",{state:"IGNORE",textkey:"BR/IAT/brease.common.ignore"}),Utils.defineProperty(e,"btnCancel",{state:"CANCEL",textkey:"BR/IAT/brease.common.cancel"}),e}),define("widgets/brease/MessageBox/libs/ButtonManager",["brease/core/Class","brease/events/BreaseEvent","brease/enum/Enum","widgets/brease/MessageBox/libs/Buttons"],function(e,BreaseEvent,Enum,t){"use strict";var ButtonManager=e.extend(function(t,i){e.call(this),this.init(t,i)},null),i=ButtonManager.prototype;i.init=function(e,i){this.widget=e,this.footer=e.el.find(".messageBoxFooter"),this.btnCallback=i,this.arElem={};for(var s in t)this.arElem[s]={el:$("#"+e.elem.id+"_messageBox_"+s)},this.arElem[s].elem=this.arElem[s].el[0],this.arElem[s].textEl=this.arElem[s].el.find("span");this.setTexts(),brease.config.visu.keyboardOperation&&this._initKeyboardOperation()},i._initKeyboardOperation=function(){for(var e in t)this.arElem[e].elem.tabIndex=0,this.arElem[e].elem.classList.add("breaseFocusable")},i.addEventListeners=function(){this.footer.on(BreaseEvent.CLICK,".messageBoxButton",this._bind("btnClickHandler")),this.footer.on(BreaseEvent.MOUSE_DOWN,".messageBoxButton",this._bind("btnDownHandler")),brease.config.visu.keyboardOperation&&this.footer.on("keydown",".messageBoxButton",this._bind("keydownHandler"))},i.removeEventListeners=function(){this.footer.off(BreaseEvent.CLICK,".messageBoxButton",this._bind("btnClickHandler")),this.footer.off(BreaseEvent.MOUSE_DOWN,".messageBoxButton",this._bind("btnDownHandler")),brease.config.visu.keyboardOperation&&this.footer.off("keydown",".messageBoxButton",this._bind("keydownHandler"))},i.setTexts=function(){for(var e in t)this.arElem[e].textEl.text(brease.language.getTextByKey(t[e].textkey))},i.setButtons=function(e){var i;switch(e){case Enum.MessageBoxType.AbortRetryIgnore:i=Enum.MessageBoxState.ABORT|Enum.MessageBoxState.RETRY|Enum.MessageBoxState.IGNORE;break;case Enum.MessageBoxType.OK:i=Enum.MessageBoxState.OK;break;case Enum.MessageBoxType.OKCancel:i=Enum.MessageBoxState.OK|Enum.MessageBoxState.CANCEL;break;case Enum.MessageBoxType.RetryCancel:i=Enum.MessageBoxState.RETRY|Enum.MessageBoxState.CANCEL;break;case Enum.MessageBoxType.YesNo:i=Enum.MessageBoxState.YES|Enum.MessageBoxState.NO;break;case Enum.MessageBoxType.YesNoCancel:i=Enum.MessageBoxState.YES|Enum.MessageBoxState.NO|Enum.MessageBoxState.CANCEL;break}for(var s in t)this.arElem[s].el.showByFlag(i&Enum.MessageBoxState[t[s].state])},i.btnDownHandler=function(e){var t=e.currentTarget.getAttribute("data-key");t&&(this.arElem[t].el.addClass("active"),this.activeButton=t),brease.docEl.on(BreaseEvent.MOUSE_UP,this._bind("btnUpHandler"))},i.btnUpHandler=function(e){s(e),brease.docEl.off(BreaseEvent.MOUSE_UP,this._bind("btnUpHandler")),this.arElem[this.activeButton].el.removeClass("active"),this.activeButton=""},i.btnClickHandler=function(e){var i=e.currentTarget.getAttribute("data-key");i&&this.btnCallback.call(this.widget,Enum.MessageBoxState[t[i].state])},i.keydownHandler=function(e){if("Enter"===e.key){var t=e.target.getAttribute("data-key");t&&(this.arElem[t].el.addClass("active"),this.activeButton=t),brease.docEl.on("keyup",this._bind("keyupHandler"))}},i.keyupHandler=function(e){if("Enter"===e.key){brease.docEl.off("keyup",this._bind("keyupHandler")),this.arElem[this.activeButton].el.removeClass("active");var i=e.target.getAttribute("data-key");i===this.activeButton&&this.btnCallback.call(this.widget,Enum.MessageBoxState[t[i].state]),this.activeButton=""}};function s(e){e.originalEvent.preventDefault(),e.stopImmediatePropagation()}return ButtonManager}),define("text!widgets/brease/MessageBox/MessageBox.html",[],function(){return'<div id="{{ID}}" data-brease-widget="widgets/brease/MessageBox">\r\n\r\n    <header class="breaseMessageBoxHeader"><div></div></header>\r\n    <div class="contentBox breaseMessageBoxContentBox">\r\n        <div class="icon"></div>\r\n        <div class="content"></div>\r\n    </div>\r\n    <div class="messageBoxQuestion"></div>\r\n    <div class="messageBoxFooter">\r\n        <div id="{{ID}}_messageBox_btnOk" data-key="btnOk" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnYes" data-key="btnYes" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnNo" data-key="btnNo" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnAbort" data-key="btnAbort" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnRetry" data-key="btnRetry" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnIgnore" data-key="btnIgnore" class="messageBoxButton"><span class="up"></span></div>\r\n        <div id="{{ID}}_messageBox_btnCancel" data-key="btnCancel" class="messageBoxButton"><span class="up"></span></div>\r\n    </div>\r\n</div>\r\n'}),define("widgets/brease/MessageBox/MessageBox",["widgets/brease/Window/Window","widgets/brease/MessageBox/libs/ButtonManager","brease/enum/Enum","brease/events/BreaseEvent","brease/controller/PopUpManager","brease/core/Utils","text!widgets/brease/MessageBox/MessageBox.html"],function(e,ButtonManager,Enum,BreaseEvent,t,Utils){"use strict";var i={modal:!0,arrow:{show:!1},forceInteraction:!0,showCloseButton:!1,position:{horizontal:"center",vertical:"middle"},html:"widgets/brease/MessageBox/MessageBox.html",icon:Enum.MessageBoxIcon.NONE,stylePrefix:"system_brease_MessageBox",width:500},s=e.extend(function MessageBox(t,i,s,n){!0===n?e.call(this,null,null,!0,!0):(e.call(this,null,null,!0,!0),r(this))},i),n=s.prototype,a=0;function r(e){require(["text!"+e.settings.html],function(t){var i="MessageBox"+(a+=1);t=t.replace(/\{\{ID\}\}/g,i),e.deferredInit(document.body,t),e.readyHandler(),brease.uiController.parse(e.elem,!1,brease.settings.globalContent)})}n.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseMessageBox"),this.settings.windowType="MessageBox",e.prototype.init.call(this,!0),this.buttonManager=new ButtonManager(this,o)},n._setDimensions=function(){e.prototype._setDimensions.call(this),void 0!==this.settings.height&&this.el.find(".contentBox").css("height",this.settings.height-42-this.el.find(".messageBoxFooter").outerHeight())},n._getOffset=function(){return 20*(t.getNumberOfWindowsOfType(this.settings.windowType)-1)},n.show=function(t){return this.deferred=$.Deferred(),void 0!==this.settings.question&&brease.language.isKey(this.settings.question.text)&&(this.settings.question.textkey=brease.language.parseKey(this.settings.question.text)),e.prototype.show.call(this,t),this.buttonManager.setButtons(this.settings.type),this.buttonManager.addEventListeners(),this.setIcon(),this._setDimensions(),this.dispatchEvent(new CustomEvent(BreaseEvent.MESSAGE_BOX_OPENED,{detail:{id:this.elem.id},bubbles:!0})),this.deferred.promise()},n.hide=function(){this.buttonManager.removeEventListeners(),e.prototype.hide.call(this),this.dispatchEvent(new CustomEvent(BreaseEvent.MESSAGE_BOX_CLOSED,{detail:{id:this.elem.id},bubbles:!0}))},n.setStyle=function(t){Utils.removeClassByRegExp(this.elem,new RegExp("\\b"+this.settings.stylePrefix+"\\S+","g")),e.prototype.setStyle.apply(this,arguments)},n._setContent=function(){e.prototype._setContent.call(this),void 0!==this.settings.question?this.el.find(".messageBoxQuestion").html(this.settings.question.textkey?brease.language.getTextByKey(this.settings.question.textkey):this.settings.question.text).show():this.el.find(".messageBoxQuestion").html("").hide()},n.langChangeHandler=function(){e.prototype.langChangeHandler.apply(this,arguments),this.buttonManager.setTexts()},n.setIcon=function(){var e=this.settings.icon,t=this.el.find(".icon");switch(t.removeClass("asterisk error exclamation information question stop warning hand none"),e){case Enum.MessageBoxIcon.ASTERISK:t.addClass("asterisk");break;case Enum.MessageBoxIcon.ERROR:t.addClass("error");break;case Enum.MessageBoxIcon.EXCLAMATION:t.addClass("exclamation");break;case Enum.MessageBoxIcon.INFORMATION:t.addClass("information");break;case Enum.MessageBoxIcon.QUESTION:t.addClass("question");break;case Enum.MessageBoxIcon.STOP:t.addClass("stop");break;case Enum.MessageBoxIcon.WARNING:t.addClass("warning");break;case Enum.MessageBoxIcon.HAND:t.addClass("hand");break;default:t.addClass("none");break}};function o(e){this.deferred.resolve(e),this.hide()}return s}),define("widgets/brease/MomentaryPushButton/designer/ClassInfo",["widgets/brease/Button/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.MomentaryPushButton",parents:["*"],children:[],inheritance:["widgets.brease.MomentaryPushButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValueBool:{method:"getValueBool"},GetValueInteger:{method:"getValueInteger"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/MomentaryPushButton/MomentaryPushButton.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/MomentaryPushButton">CONTENT</div>\r\n'}),define("widgets/brease/MomentaryPushButton/MomentaryPushButton",["widgets/brease/Button/Button","brease/events/BreaseEvent","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/core/Utils"],function(e,BreaseEvent,UtilsEditableBinding,Utils){"use strict";var t={value:0},i=e.extend(function MomentaryPushButton(){e.apply(this,arguments)},t),s=i.prototype;i.setValue=1,i.resetValue=0,s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseMomentaryPushButton"),e.prototype.init.call(this)},s.getValue=function(){return this.settings.value},s.getValueInteger=function(){return this.getValue()},s.getValueBool=function(){return 1===this.getValue()},s.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},s._downHandler=function(t){this.isDisabled||brease.config.editMode||this.isActive||(this.settings.value=i.setValue,this.sendValueChange({value:i.setValue}),this.timer=window.setInterval(this._bind("_continuousSend"),200),e.prototype._downHandler.apply(this,arguments))},s._blurOnMoveHandler=function(){window.clearInterval(this.timer),this.settings.value=i.resetValue,this.sendValueChange({value:i.resetValue}),e.prototype._blurOnMoveHandler.apply(this,arguments)},s._upHandler=function(){e.prototype._upHandler.apply(this,arguments),this.isActive||(window.clearInterval(this.timer),this.settings.value=i.resetValue,this.sendValueChange({value:i.resetValue}))},s._continuousSend=function(){if(!Utils.isVisible(this.elem))return n(this),void 0;this.sendValueChange({value:i.setValue})},s.dispose=function(){n(this),e.prototype.dispose.apply(this,arguments)},s.onBeforeDispose=function(){n(this),e.prototype.onBeforeDispose.apply(this,arguments)},s.onBeforeSuspend=function(){n(this),e.prototype.onBeforeSuspend.apply(this,arguments)},s.updateVisibility=function(){e.prototype.updateVisibility.apply(this,arguments),this.isHidden&&n(this)},s._enableHandler=function(t){e.prototype._enableHandler.apply(this,arguments),t||n(this)};function n(e){window.clearInterval(e.timer),e.isActive&&(e.isActive=!1,e.el.removeClass("active"),void 0!==e.settings.mouseDownImage&&void 0!==e.settings.image&&e.setImage(e.settings.image,!0),void 0!==e.settings.mouseDownImage&&void 0===e.settings.image&&e.setImage("",!1),$(document).off(BreaseEvent.MOUSE_UP,e._bind("_upHandler")),e.settings.value=i.resetValue,brease.config.preLoadingState||e.sendValueChange({value:i.resetValue}))}return i}),define("widgets/brease/NavigationButton/designer/ClassInfo",["widgets/brease/ToggleButton/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.NavigationButton",parents:["*"],children:[],inheritance:["widgets.brease.NavigationButton","widgets.brease.ToggleButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},setIsToggle:{method:"setIsToggle",parameter:{isToggle:{name:"isToggle",index:0,type:"Boolean"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setPageId:{method:"setPageId",parameter:{pageId:{name:"pageId",index:0,type:"PageReference"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/NavigationButton/NavigationButton.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/NavigationButton">CONTENT</div>\r\n'}),
define("widgets/brease/NavigationButton/NavigationButton",["widgets/brease/ToggleButton/ToggleButton","brease/events/BreaseEvent","widgets/brease/common/DragDropProperties/libs/HideDraggablePropertiesEvents"],function(e,BreaseEvent){"use strict";var t={isToggle:!0},i=e.extend(function NavigationButton(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseNavigationButton"),e.prototype.init.call(this);var t=brease.pageController.getVisu4Page(this.settings.pageId),i=brease.pageController.getVisuById(t);if(void 0!==i){brease.pageController.getCurrentPage(i.containerId)===this.settings.pageId?this.toggle.call(this,e.values.checked,!0,!0):this.toggle.call(this,e.values.unchecked,!0,!0)}brease.appElem.addEventListener(BreaseEvent.PAGE_LOADED,this._bind("_pageLoadedHandler"))},s.setPageId=function(e){this.settings.pageId=e},s.getPageId=function(){return this.settings.pageId},s.setIsToggle=function(e){this.settings.isToggle=e},s.getIsToggle=function(){return this.settings.isToggle},s.toggle=function(t,i,s){if(!0===this.settings.isToggle&&(this.settings.value===e.values.unchecked||i&&s)&&e.prototype.toggle.apply(this,arguments),!0!==s&&(this.settings.value===e.values.checked||!1===this.settings.isToggle))try{n.call(this,this.settings.pageId)}catch(t){e.prototype.toggle.call(this,e.values.unchecked),console.iatWarn("Load page error",t)}},s._pageLoadedHandler=function(t){var i=brease.pageController.getVisuById(brease.pageController.getVisu4Page(this.settings.pageId));void 0!==i&&null!==this.el&&t.detail.containerId===i.containerId&&(t.detail.pageId===this.settings.pageId?this.toggle.call(this,e.values.checked,!0,!0):this.toggle.call(this,e.values.unchecked,!0,!0))},s.wake=function(){if(brease.appElem.addEventListener(BreaseEvent.PAGE_LOADED,this._bind("_pageLoadedHandler")),e.prototype.wake.apply(this,arguments),void 0!==this.elem.closest(".breaseDialogWindow")&&null!==this.elem.closest(".breaseDialogWindow")){brease.pageController.getCurrentPage("appContainer")===this.settings.pageId?this.toggle.call(this,e.values.checked,!0,!0):this.toggle.call(this,e.values.unchecked,!0,!0)}},s.suspend=function(){brease.appElem.removeEventListener(BreaseEvent.PAGE_LOADED,this._bind("_pageLoadedHandler")),e.prototype.suspend.apply(this,arguments)},s.dispose=function(){brease.appElem.removeEventListener(BreaseEvent.PAGE_LOADED,this._bind("_pageLoadedHandler")),e.prototype.dispose.apply(this,arguments)};function n(t){if(!brease.pageController.isPageChangeInProgress()){var i=brease.pageController.getVisuById(brease.pageController.getVisu4Page(t));if(void 0!==i){var s=document.getElementById(i.containerId),n=brease.pageController.loadPage(t,s);!1===n.success&&"PAGE_IS_CURRENT"!==n.code&&e.prototype.toggle.call(this,e.values.unchecked)}else e.prototype.toggle.call(this,e.values.unchecked)}}return i}),define("widgets/brease/NumericInput/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.NumericInput",parents:["*"],children:[],inheritance:["widgets.brease.NumericInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setKeyboard:{method:"setKeyboard",parameter:{keyboard:{name:"keyboard",index:0,type:"Boolean"}}},setLimitViolationPolicy:{method:"setLimitViolationPolicy",parameter:{limitViolationPolicy:{name:"limitViolationPolicy",index:0,type:"brease.enum.LimitViolationPolicy"}}},setMaxValue:{method:"setMaxValue",parameter:{maxValue:{name:"maxValue",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{minValue:{name:"minValue",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.Node"}}},setNumPadStyle:{method:"setNumPadStyle",parameter:{numPadStyle:{name:"numPadStyle",index:0,type:"String"}}},setNumpadPosition:{method:"setNumpadPosition",parameter:{numpadPosition:{name:"numpadPosition",index:0,type:"brease.enum.Position"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setReadonly:{method:"setReadonly",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},setUnitAlign:{method:"setUnitAlign",parameter:{unitAlign:{name:"unitAlign",index:0,type:"brease.enum.ImageAlign"}}},setUnitTextAlign:{method:"setUnitTextAlign",parameter:{unitTextAlign:{name:"unitTextAlign",index:0,type:"brease.enum.TextAlign"}}},setUnitWidth:{method:"setUnitWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setUseDigitGrouping:{method:"setUseDigitGrouping",parameter:{useDigitGrouping:{name:"useDigitGrouping",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},SubmitChange:{method:"submitChange"}},properties:{value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/NumericInput/libs/Config",["brease/enum/Enum"],function(Enum){"use strict";return{numpadPosition:Enum.Position.right,submitOnChange:!0,value:0,maxValue:100,minValue:0,format:{default:{decimalPlaces:1,minimumIntegerDigits:1}},useDigitGrouping:!0,unitAlign:Enum.ImageAlign.left,showUnit:!0,keyboard:!0,ellipsis:!1,limitViolationPolicy:Enum.LimitViolationPolicy.NO_SUBMIT,unit:null,node:null,numPadStyle:"default",unitWidth:"0",unitTextAlign:"center",tabIndex:0,useFocusWithin:!0}}),define("text!widgets/brease/NumericInput/NumericInput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/NumericInput"></div>\r\n'}),define("widgets/brease/NumericInput/NumericInput",["brease/core/BaseWidget","brease/decorators/LanguageDependency","brease/decorators/MeasurementSystemDependency","brease/enum/Enum","brease/core/Types","brease/datatype/Node","brease/controller/libs/KeyActions","brease/controller/KeyboardManager","brease/events/BreaseEvent","brease/config/NumberFormat","widgets/brease/NumericInput/libs/Config","brease/core/Utils","widgets/brease/common/libs/BoxLayout","widgets/brease/common/libs/wfUtils/UtilsObject","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents"],function(e,t,i,Enum,Types,Node,KeyActions,s,BreaseEvent,NumberFormat,Config,Utils,BoxLayout,UtilsObject,n){"use strict";var a="unit",r=Config,o=e.extend(function NumericInput(){e.apply(this,arguments)},r),l=o.prototype;l.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseNumericInput"),this.boxLayout=BoxLayout;var t=brease.user.getSeparators();this.measurementSystemChangePromise=null,this.unitChangePromise=null,this.nodeChangeResolve=null,this.numPadReadyResolve=null,this.isMouseDown=!1,this.settings.inputTabIndex=this._getUseKeyboardOperations()?-1:1,this.settings.regexp=new RegExp("^[-"+t.dsp+"]?\\d*(?:["+t.dsp+"]\\d*?)?$"),this.settings.unitSymbol="",this.settings.nodeObject=m(this.settings.node),this.settings.unitObject=UtilsObject.parseObject(this.settings.unit,R.call(this,this.settings.unit,"unit")),this.settings.formatObject=UtilsObject.createFormatObject(this.defaultSettings.format,this.settings.format,R.call(this,this.settings.format,"format")),this.settings.readonly=Types.parseValue(this.settings.readonly,"Boolean",{default:!1}),this._setNumpadSubmitAction(!1),c(this),h(this),w(this),A(this),D(this),e.prototype.init.call(this)},l.setNode=function(e){if(Utils.isObject(e)){this.settings.nodeObject?(this.settings.nodeObject.setValue(e.value),this.settings.nodeObject.setMinValue(e.minValue),this.settings.nodeObject.setMaxValue(e.maxValue),this.settings.nodeObject.setUnit(e.unit)):this.settings.nodeObject=m(e);var t=T(this);this.settings.nodeObject.unit&&t&&this.settings.nodeObject.unit!==t?this.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:t}):this.nodeChangeResolve&&this.nodeChangeResolve()}else this.settings.nodeObject=null;p(this)},l.getNode=function(){return this.settings.nodeObject?this.settings.nodeObject:new Node(this.getValue(),T(this),this.getMinValue(),this.getMaxValue())},l.setValue=function(e){"boolean"==typeof e&&(e=Number(e));var t=this.settings.nodeObject;t?t.setValue(e):this.settings.value=e,p(this)},l.getValue=function(){return this.settings.nodeObject?null!==this.settings.nodeObject.getValue()?this.settings.nodeObject.getValue():brease.settings.noValueString:this.settings.value},l.setMinValue=function(e){var t=this.settings.nodeObject;t?t.setMinValue(e):this.settings.minValue=e},l.getMinValue=function(){return this.settings.nodeObject?this.settings.nodeObject.getMinValue():this.settings.minValue},l.setMaxValue=function(e){var t=this.settings.nodeObject;t?t.setMaxValue(e):this.settings.maxValue=e},l.getMaxValue=function(){return this.settings.nodeObject?this.settings.nodeObject.getMaxValue():this.settings.maxValue},l.setEllipsis=function(e){this.settings.ellipsis=Types.parseValue(e,"Boolean",{default:!1}),y(this)},l.getEllipsis=function(){return this.settings.ellipsis},l.setFormat=function(e){e&&(this.settings.format=e,this.settings.formatObject=UtilsObject.createFormatObject(this.defaultSettings.format,e,R.call(this,e,"format")),p(this)),D(this)},l.getFormat=function(){return this.settings.format},l.setKeyboard=function(e){if(this.settings.keyboard=e,e){this._getUseKeyboardOperations()?u(this):g(this);var t=this;L(this).then(function(){t.numPadReadyResolve=null})}else k(this),u(this)},l.getKeyboard=function(){return this.settings.keyboard},l._getKeyboardOpen=function(){return this.internalData.keyboardOpen},l._setKeyboardOpen=function(e){this.internalData.keyboardOpen=e},l._getNumpadSubmitAction=function(){return this.internalData.numpadSubmitAction},l._setNumpadSubmitAction=function(e){this.internalData.numpadSubmitAction=e},l._getUseKeyboardOperations=function(){return brease.config.visu.keyboardOperation},l.setLimitViolationPolicy=function(e){this.settings.limitViolationPolicy=e},l.getLimitViolationPolicy=function(){return this.settings.limitViolationPolicy},l.setNumPadStyle=function(e){this.settings.numPadStyle=e},l.getNumPadStyle=function(){return this.settings.numPadStyle},l.setNumpadPosition=function(e){this.settings.numpadPosition=e},l.getNumpadPosition=function(){return this.settings.numpadPosition},l.setShowUnit=function(e){this.settings.showUnit=e,v(this)},l.getShowUnit=function(){return this.settings.showUnit},l.setSubmitOnChange=function(e){this.settings.submitOnChange=e},l.getSubmitOnChange=function(){return this.settings.submitOnChange},l.setUnit=function(e){this.settings.unit=e,this.settings.unitObject=UtilsObject.parseObject(e,R.call(this,this.settings.unit,"unit")),D(this);var t=this;return t.unitChangePromise=B(this),t.unitChangePromise.then(function(){t.unitChangePromise=null}),t.unitChangePromise},l.getUnit=function(){return this.settings.unit},l.setUnitAlign=function(e){this.settings.unitAlign=e,w(this),x(this)},l.getUnitAlign=function(){return this.settings.unitAlign},l.setUnitWidth=function(e){this.settings.unitWidth=e,x(this)},l.getUnitWidth=function(){return this.settings.unitWidth},l.setUseDigitGrouping=function(e){this.settings.useDigitGrouping=e,p(this)},l.getUseDigitGrouping=function(){return this.settings.useDigitGrouping},l.setReadonly=function(e){this.settings.readonly=e,e?(g(this),k(this)):this.setKeyboard(this.getKeyboard())},l.getReadonly=function(){return this.settings.readonly},l.setUnitTextAlign=function(e){this.settings.unitTextAlign=e,this.renderUnitSymbolAlign(e,this.boxLayout,this.unitBox)},l.getUnitTextAlign=function(){return this.settings.unitTextAlign},l.submitChange=function(){var e=this.settings.nodeObject?this.settings.nodeObject:new Node(this.getValue(),T(this),this.getMinValue(),this.getMaxValue());this.sendValueChange({value:this.getValue(),node:e}),this.createEvent("ValueChanged",{value:this.getValue()}).dispatch()};function d(e){e.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{detail:{value:e.getValue()}}))}l.setEditable=function(e,t){if(void 0!==t&&void 0!==t.refAttribute){var i=t.refAttribute;"value"!==i&&"node"!==i||(this.settings.editable=e,this._internalEnable())}},l._setWidth=function(t){e.prototype._setWidth.apply(this,arguments),"auto"===t?f(this):this.inputEl.css("width","")},l._enableHandler=function(t){!0===t?!1===this.getKeyboard()&&!1===this.getReadonly()&&this.inputEl.attr("tabindex",this.settings.inputTabIndex):((!1===this.getKeyboard()||this.getReadonly())&&this.inputEl.attr("tabindex",-1),this._hideNumPad()),e.prototype._enableHandler.apply(this,arguments)},l._visibleHandler=function(t){this.isVisible()||this._hideNumPad(),e.prototype._visibleHandler.apply(this,arguments)},l._clickHandler=function(t){this._handleFocus(t),e.prototype._clickHandler.call(this,t)},l._handleFocus=function(e){if(!this.isDisabled&&!this.getReadonly()&&!0!==brease.config.editMode){var t=Utils.getOriginalEvent(e);KeyActions.getActionForKey(t.key)===Enum.KeyAction.Accept?this._getNumpadSubmitAction()?this._setNumpadSubmitAction(!1):this._focusWithTab():!this.getKeyboard()||t instanceof KeyboardEvent?this._onFocusIn():(this._cancelNewValueOnEscape(),this._showNumPad(this))}},l.dispose=function(){k(this),g(this),this.inputEl.off(),this.inputEl.off("change",this._bind("_inputChangeHandler")),this.elem.removeEventListener(BreaseEvent.BEFORE_FOCUS_MOVE,this._bind("_onBeforeFocusMove")),this.elem.removeEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,this._bind("_onBeforeStateChange")),this.elem.removeEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,this._bind("_onBeforeStateChange")),e.prototype.dispose.apply(this,arguments)},l.langChangeHandler=function(e){A(this)},l.measurementSystemChangeHandler=function(){var e=this;e.measurementSystemChangePromise=B(this),e.measurementSystemChangePromise.then(function(){e.measurementSystemChangePromise=null})},l.isMeasurementSystemChangeDone=function(){return!this.measurementSystemChangePromise},l.isUnitChangeDone=function(){return!this.unitChangePromise},l.writeUnit=function(e){this.settings.unitSymbol=e,b(this)},l.showValue=function(){p(this)},l.showUnit=function(){A(this)},l.processMeasurementSystemUpdate=function(){this.measurementSystemChangeHandler()},l.resetValue=function(){this.setValue(this.settings.nodeObject.getValue())},l._focusWithTab=function(){this.el.hasClass("active")?this.elem.focus():this._onFocusIn()},l._onFocusIn=function(e){if(this.isDisabled)this.inputEl.blur();else{!this.elem.classList.contains("active")&&this._getUseKeyboardOperations()&&this.inputEl.val(""),this.focusInTime=Date.now();var t=this.inputEl[0];t.focus(),t.addEventListener("keypress",this._bind("_onKeyPress")),t.addEventListener("keyup",this._bind("_onKeyUp")),"auto"===this.settings.width&&t.addEventListener("keydown",this._bind("_onKeyDown")),this.el.addClass("active")}},l._onFocusOut=function(e){this.lastMouseDownIsTouch&&Date.now()-this.focusInTime<20?this._onFocusIn():this.isMouseDown||this._focusOut()},l._focusOut=function(){var e=brease.formatter.parseFloat(this.inputEl.val(),brease.user.getSeparators());"accept"!==brease.config.keyboardHandling.onEnd.action||this.internalData.enterOut?(e=I(this,e,this.getValue()),e=S(this,e),this.setValue(e),d(this),!0===this.getSubmitOnChange()&&this.elem.classList.contains("active")&&this.submitChange()):p(this),this.removeFocus(),this.internalData.enterOut=!1},l._onBeforeFocusMove=function(){this._getKeyboardOpen()&&this.numPad.hide()},l._onBeforeStateChange=function(e){!e.detail.value&&this.elem.classList.contains("active")&&(this._cancelNewValueOnEscape(),this.inputEl.blur())},l._onMouseDown=function(e){this.isMouseDown=!0,this.lastMouseDownIsTouch="touchstart"===e.originalEvent.type,$(window).on(BreaseEvent.MOUSE_UP,this._bind("_onMouseUp"))},l._onMouseUp=function(e){!W.call(this)&&!H.call(this)||0!==this.el.has(e.target).length||e.target===this.elem||Utils.getOriginalEvent(e)instanceof KeyboardEvent||this._onFocusIn(),$(window).off(BreaseEvent.MOUSE_UP,this._bind("_onMouseUp")),this.isMouseDown=!1},l._onKeyUp=function(e){var t=new RegExp("\\"+brease.user.getSeparators().gsp,"g"),i=this.inputEl.val().replace(t,"");this._validateKeyInputValue(i)||this.inputEl.val(this.oldValue)},l._onKeyDown=function(e){"Backspace"===e.key||"Delete"===e.key?f(this,-1):this._isPrintable(e.key)&&f(this,1)},l._validateKeyInputValue=function(e){return""===e||"-"===e||"+"===e||void 0===this.settings.regexp||!1!==this.settings.regexp.test(e)},l._onKeyPress=function(e){var t=this.inputEl.get(0);if(KeyActions.getActionForKey(e.key)===Enum.KeyAction.Accept&&!this._getUseKeyboardOperations())return this.inputEl.blur(),void 0;","!==e.key&&"."!==e.key||(e.preventDefault(),t.setRangeText(brease.user.getSeparators().dsp,t.selectionStart,t.selectionEnd,"end"));var i=this.inputEl.val();"number"==typeof i&&(this.oldValue=i)},l.removeFocus=function(){var e=this.inputEl[0];e.removeEventListener("keypress",this._bind("_onKeyPress")),e.removeEventListener("keyup",this._bind("_onKeyUp")),e.removeEventListener("keydown",this._bind("_onKeyDown")),this.el.removeClass("active")},l._handleFocusKeyDown=function(t){"accept"===brease.config.keyboardHandling.onEnd.action&&KeyActions.getActionForKey(t.key)===Enum.KeyAction.Accept&&this.elem.classList.contains("active")&&(this.internalData.enterOut=!0),e.prototype._handleFocusKeyDown.apply(this,arguments),KeyActions.getActionForKey(t.key)===Enum.KeyAction.Cancel?(this.elem.classList.contains("active")&&t.stopPropagation(),this._cancelNewValueOnEscape()):"any"===brease.config.keyboardHandling.onStart.action&&this._isPrintable(t.key)&&!this._getKeyboardOpen()&&this._handleFocus(t)},l._isPrintable=function(e){return 1===e.length},l._cancelNewValueOnEscape=function(){p(this),this.removeFocus(),this.elem.focus()},l._showNumPad=function(){P(this)&&(this._generateNumPadSettings(),O(this),this.numPad.show(this.numPadSettings,this.elem),this._setKeyboardOpen(!0),this.el.addClass("active"))},l._hideNumPad=function(){P(this)&&this.getKeyboard()&&this.el.hasClass("active")&&this.numPad.hide()},l._generateNumPadSettings=function(){this.numPadSettings={minValue:this.getMinValue(),maxValue:this.getMaxValue(),value:this.getValue(),useDigitGrouping:this.getUseDigitGrouping(),limitViolationPolicy:this.getLimitViolationPolicy(),position:{horizontal:this.getNumpadPosition(),vertical:this.getNumpadPosition()},pointOfOrigin:"element",arrow:{position:"left"===this.getNumpadPosition()?"right":"left"},header:this.settings.header,format:this.settings.formatObject,unit:this.settings.unitObject,contentId:this.settings.parentContentId,widgetId:this.elem.id,bindingAttributes:["value","node"]},this.settings.numPadStyle&&(this.numPadSettings.style=this.settings.numPadStyle)},l.numPadReadyHandler=function(e){"breaseNumPad"===e.target.id&&(document.body.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("numPadReadyHandler")),this.numPadReadyResolve&&this.numPadReadyResolve())},l._onNumPadClose=function(){N(this),this._setKeyboardOpen(!1),this.el.removeClass("active"),this._cancelNewValueOnEscape()},l._onNumPadSubmit=function(e){var t=S(this,e.detail.value);this.setValue(t),this._setNumpadSubmitAction(!0),d(this),this.getSubmitOnChange()&&this.submitChange()},l._inputChangeHandler=function(e){e.stopPropagation()},l._createInputEl=function(){var e={value:"",type:"text",autocomplete:"off",tabindex:!1===this.getKeyboard()&&!1===this.getReadonly()?this.settings.inputTabIndex:-1};(this.getKeyboard()&&!this._getUseKeyboardOperations()||this.getReadonly())&&(e.readonly="readonly");var t=$("<input/>").attr(e);return!0!==this.getKeyboard()&&t.addClass("keyboard"),t},l._createUnitEl=function(){return $("<span></span>").addClass("breaseNumericInput_unit")};function c(e){e.inputEl=e._createInputEl(),e.unitEl=e._createUnitEl(),e.inputBox=BoxLayout.createBox(),e.inputBox.classList.add("box-input"),e.unitBox=BoxLayout.createBox(),e.unitBox.classList.add("box-unit"),e.inputBox.appendChild(e.inputEl.get(0)),e.unitBox.appendChild(e.unitEl.get(0)),e.boxContainer=BoxLayout.createBoxContainer(),e.boxContainer.appendChild(e.inputBox),e.boxContainer.appendChild(e.unitBox),e.setShowUnit(e.getShowUnit()),e.setEllipsis(e.getEllipsis()),e.setKeyboard(e.getKeyboard()),e.elem.appendChild(e.boxContainer)}function h(e){e.inputEl.on("change",e._bind("_inputChangeHandler")),e._getUseKeyboardOperations()&&(e.elem.addEventListener(BreaseEvent.BEFORE_FOCUS_MOVE,e._bind("_onBeforeFocusMove")),e.elem.addEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,e._bind("_onBeforeStateChange")),e.elem.addEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,e._bind("_onBeforeStateChange")))}function u(e){e.inputEl.on("focusin",e._bind("_onFocusIn")),e.inputEl.on("focusout",e._bind("_onFocusOut")),e.el.on(BreaseEvent.MOUSE_DOWN,e._bind("_onMouseDown"))}function g(e){e.inputEl.off("focusin",e._bind("_onFocusIn")),e.inputEl.off("focusout",e._bind("_onFocusOut")),e.el.off(BreaseEvent.MOUSE_DOWN,e._bind("_onMouseDown"))}function m(e){return e?new Node(e.value,e.unit,e.minValue,e.maxValue,e.id):null}function p(e){var t=e.getValue(),i=_(e);void 0!==i.decimalPlaces&&Utils.isNumeric(t)?e.inputEl.val(brease.formatter.formatNumber(t,i,e.getUseDigitGrouping(),brease.user.getSeparators())):e.inputEl.val(brease.settings.noValueString),"auto"===e.settings.width&&f(e)}function f(e,t){t=t||0,e.inputEl.css("width",e.inputEl.val().length+t+"ch")}function b(e){brease.config.editMode&&!$.isEmptyObject(e.settings.unitObject)?e.unitEl.text(a):e.unitEl.text(e.settings.unitSymbol||""),x(e)}function v(e){!1===e.settings.showUnit?e.unitBox.style.display="none":e.unitBox.style.display="flex",x(e)}function y(e){e.settings.ellipsis?e.el.addClass("ellipsis"):e.el.removeClass("ellipsis")}function w(e){switch(e.el.removeClass("unitAlign-left"),e.el.removeClass("unitAlign-right"),e.el.removeClass("unitAlign-top"),e.el.removeClass("unitAlign-bottom"),e.settings.unitAlign){case Enum.ImageAlign.right:BoxLayout.setOrientation(e.boxContainer,Enum.Orientation.LTR),e.el.addClass("unitAlign-right");break;case Enum.ImageAlign.top:BoxLayout.setOrientation(e.boxContainer,Enum.Orientation.BTT),e.el.addClass("unitAlign-top");break;case Enum.ImageAlign.bottom:BoxLayout.setOrientation(e.boxContainer,Enum.Orientation.TTB),e.el.addClass("unitAlign-bottom");break;default:BoxLayout.setOrientation(e.boxContainer,Enum.Orientation.RTL),e.el.addClass("unitAlign-left");break}e.renderUnitSymbolAlign(e.settings.unitTextAlign,e.boxLayout,e.unitBox)}l.renderUnitSymbolAlign=function(e,t,i){switch(e){case Enum.TextAlign.left:t.setBoxAlign(i,"Left");break;case Enum.TextAlign.center:t.setBoxAlign(i,"Center");break;case Enum.TextAlign.right:t.setBoxAlign(i,"Right");break}};function x(e){var t=e.getUnitWidth();if(!C(e,t))return E(e),void 0;var i="",s="1 1 ",n=t;if(void 0!==t&&""!==t){if(isNaN(t)){if(t.endsWith("%")){var a=t.substring(0,t.length-1);if(!isNaN(a)){var r=100-parseFloat(a);r<0&&(r=0),i=r+"%"}}}else n=t+"px";"auto"!==e.settings.width||brease.config.editMode?s="0 0 "+n:(e.inputBox.style.flex=s,e.unitBox.style.minWidth=n)}e.inputBox.style.width=i,e.unitBox.style.flex=s}function E(e){e.inputBox.style.flex="",e.inputBox.style.width="",e.unitBox.style.flex="",e.unitBox.style.minWidth=""}function I(e,t,i){var s=e.getMinValue(),n=e.getMaxValue(),a=6;if(isNaN(t)&&(t=i),t>n||t<s)switch(e.getLimitViolationPolicy()){case Enum.LimitViolationPolicy.SET_TO_LIMIT:case Enum.LimitViolationPolicy.SET_TO_LIMIT_AND_SUBMIT:t>n&&(n=brease.formatter.roundToSignificant(n,6),t=brease.formatter.findPossibleFormattedValue(n,_(e).decimalPlaces,"max")),t<s&&(s=brease.formatter.roundToSignificant(s,6),t=brease.formatter.findPossibleFormattedValue(s,_(e).decimalPlaces,"min"));break;case Enum.LimitViolationPolicy.SUBMIT_ALL:break;default:t=i;break}return t}function C(e,t){return!(!1===e.getShowUnit()||!e.unitEl.text()||e.getUnitAlign()===Enum.ImageAlign.top||e.getUnitAlign()===Enum.ImageAlign.bottom||t<=0)}function _(e){var t=null,i=brease.measurementSystem.getCurrentMeasurementSystem();return t=e.settings.formatObject?NumberFormat.getFormat(e.settings.formatObject,i):NumberFormat.getFormat({},i),t}function S(e,t){var i=_(e),s=t;return Utils.isNumeric(t)&&(s=Utils.roundTo(t,i.decimalPlaces)),s}function T(e){var t=e.settings.unitObject;return t?t[brease.measurementSystem.getCurrentMeasurementSystem()]:null}function D(e){brease.language.isKey(e.getUnit())||brease.language.isKey(e.getFormat())||e.getInfoCustomizedUnit(e.getUnit())||Utils.isObject(e.settings.unit)?e.setLangDependency(!0):e.setLangDependency(!1)}function A(e){V(e).then(function(){b(e),p(e)})}function L(e){return e.numPad||(e.numPad=s.getNumPad()),new Promise(function(t,i){e.numPadReadyResolve=t,P(e)?e.numPadReadyResolve():document.body.addEventListener(BreaseEvent.WIDGET_READY,e._bind("numPadReadyHandler"))})}function P(e){return!(!e.numPad||e.numPad.state!==Enum.WidgetState.READY)}function O(e){e.numPad.addEventListener(BreaseEvent.CLOSED,e._bind("_onNumPadClose")),e.numPad.addEventListener(BreaseEvent.SUBMIT,e._bind("_onNumPadSubmit"))}function N(e){e.numPad.removeEventListener(BreaseEvent.CLOSED,e._bind("_onNumPadClose")),e.numPad.removeEventListener(BreaseEvent.SUBMIT,e._bind("_onNumPadSubmit"))}function k(e){e.numPad&&e.numPad.elem&&(N(e),e.numPad=null)}function R(e,t){return this.elem.id+": "+t+' string "'+e+'" is invalid!'}function B(e){var t=V(e),i=M(e),s=[t,i];return Promise.all(s).then(function(i){e.nodeChangeResolve=null,t=null,b(e),p(e)})}function M(e){return new Promise(function(t,i){e.nodeChangeResolve=t;var s=e.settings.nodeObject,n=T(e);s&&s.getUnit()&&n&&s.getUnit()!==n?(e.settings.nodeObject.unit=n,e.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:n})):t()})}function V(e){return new Promise(function(t,i){var s=T(e);s?brease.language.pipeAsyncUnitSymbol(s,function(i){e.settings.unitSymbol=i,t(i)}):(e.settings.unitSymbol="",t(""))})}l.getInfoCustomizedUnit=function(e){if(void 0===e||e==={})return!1;for(var t in e)return!("function"!=typeof e[t].includes||!e[t].includes("http://www.br-automation.com/units"))};function W(){return this._getUseKeyboardOperations()&&this.isFocusable()}function H(){return!this._getUseKeyboardOperations()&&!this.getKeyboard()&&this.isVisible()&&this.isEnabled()&&Utils.isVisible(this.elem)}return n.decorate(i.decorate(t.decorate(o,!1),!0),!1)}),define("widgets/brease/NumericOutput/designer/ClassInfo",["widgets/brease/NumericInput/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.NumericOutput",parents:["*"],children:[],inheritance:["widgets.brease.NumericOutput","widgets.brease.NumericInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setKeyboard:{method:"setKeyboard",parameter:{keyboard:{name:"keyboard",index:0,type:"Boolean"}}},setLimitViolationPolicy:{method:"setLimitViolationPolicy",parameter:{limitViolationPolicy:{name:"limitViolationPolicy",index:0,type:"brease.enum.LimitViolationPolicy"}}},setMaxValue:{method:"setMaxValue",parameter:{maxValue:{name:"maxValue",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{minValue:{name:"minValue",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.Node"}}},setNumPadStyle:{method:"setNumPadStyle",parameter:{numPadStyle:{name:"numPadStyle",index:0,type:"String"}}},setNumpadPosition:{method:"setNumpadPosition",parameter:{numpadPosition:{name:"numpadPosition",index:0,type:"brease.enum.Position"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setReadonly:{method:"setReadonly",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},setUnitAlign:{method:"setUnitAlign",parameter:{unitAlign:{name:"unitAlign",index:0,type:"brease.enum.ImageAlign"}}},setUnitTextAlign:{method:"setUnitTextAlign",parameter:{unitTextAlign:{name:"unitTextAlign",index:0,type:"brease.enum.TextAlign"}}},setUnitWidth:{method:"setUnitWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setUseDigitGrouping:{method:"setUseDigitGrouping",parameter:{useDigitGrouping:{name:"useDigitGrouping",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/NumericOutput/libs/config",["brease/enum/Enum"],function(Enum){"use strict";return{value:0,maxValue:100,minValue:0,format:{default:{decimalPlaces:1,minimumIntegerDigits:1}},useDigitGrouping:!1,unitAlign:Enum.ImageAlign.left,showUnit:!0,ellipsis:!1,unit:null,node:null,unitWidth:"0",unitTextAlign:"center",tabIndex:-1}}),define("text!widgets/brease/NumericOutput/NumericOutput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/NumericOutput"></div>\r\n'}),define("widgets/brease/NumericOutput/NumericOutput",["widgets/brease/NumericInput/NumericInput","brease/decorators/LanguageDependency","brease/decorators/MeasurementSystemDependency","widgets/brease/NumericOutput/libs/config"],function(e,t,i,Config){"use strict";var s=Config,n=e.extend(function NumericOutput(){e.apply(this,arguments)},s),a=n.prototype;return a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseNumericOutput"),this.settings.omitClass=!0,this.settings.readonly=!0,e.prototype.init.call(this)},a._createUnitEl=function(){return $("<span></span>").addClass("breaseNumericOutput_unit")},a._onFocusIn=function(e){!0===this.isDisabled?this.inputEl.blur():(this.focusInTime=Date.now(),
this.el.addClass("active"))},i.decorate(t.decorate(n,!1),!0)}),define("widgets/brease/NumPad/designer/ClassInfo",["system/widgets/NumPad/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.NumPad",parents:["*"],children:[],inheritance:["widgets.brease.NumPad","system.widgets.NumPad","widgets.brease.Window","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setStyle:{method:"setStyle",parameter:{style:{name:"style",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/NumPad/NumPad.html",[],function(){return'<div id="breaseNumPad" data-brease-widget="widgets/brease/NumPad">\r\n    <header class="numpadHeader">\r\n        <div></div>\r\n    </header>\r\n    <div class="numpadWrapper">\r\n        <div class="numpad">\r\n            <section class="breaseNumPadTop">\r\n                <div class="breaseNumpadSliderWrapper">\r\n                    <div class="minValueBox">\r\n                        <label>min</label>\r\n                        <div class="minValue">0</div>\r\n                    </div>\r\n                    <div class="breaseNumpadSlider"></div>\r\n                    <div class="maxValueBox">\r\n                        <label>max</label>\r\n                        <div class="maxValue">0</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="breaseNumpadNumericValueOutterWrapper">\r\n                    <div class="breaseNumpadNumericValueInnerWrapper">\r\n                        <div class="breaseNumpadNumericValue">0</div>\r\n                    </div>\r\n                    <div class="minValueBox">\r\n                        <label>min</label>\r\n                        <div class="minValue">0</div>\r\n                    </div>\r\n                    <div class="maxValueBox">\r\n                        <label>max</label>\r\n                        <div class="maxValue">0</div>\r\n                    </div>\r\n                </div>\r\n\r\n            </section>\r\n            <section class="breaseNumPadButtons">\r\n                <button data-action="value" data-value="7">7</button>\r\n                <button data-action="value" data-value="8">8</button>\r\n                <button data-action="value" data-value="9">9</button>\r\n                <button data-action="delete" class="breaseNumPadDelete"><div class="breaseNumPadDeleteIcon"></div></button>\r\n                <button data-action="value" data-value="4">4</button>\r\n                <button data-action="value" data-value="5">5</button>\r\n                <button data-action="value" data-value="6">6</button>\r\n                <button data-action="sign">+/-</button>\r\n                <button data-action="value" data-value="1">1</button>\r\n                <button data-action="value" data-value="2">2</button>\r\n                <button data-action="value" data-value="3">3</button>\r\n                <button data-action="enter" class="breaseNumPadEnter"><div class="breaseNumPadEnterIcon"></div></button>\r\n                <button data-action="value" data-value="0">0</button>\r\n                <button data-action="comma">.</button>\r\n\r\n                <div class="clearfix"></div>\r\n            </section>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("widgets/brease/OnlineChartHDA/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.OnlineChartHDA",parents:["*"],children:[],inheritance:["widgets.brease.OnlineChartHDA","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},Freeze:{method:"freeze"},GetStatus:{method:"getStatus"},ScrollDown:{method:"scrollDown"},ScrollLeft:{method:"scrollLeft"},ScrollRight:{method:"scrollRight"},ScrollUp:{method:"scrollUp"},ScrollXAxis:{method:"scrollXAxis",parameter:{xAxisId:{name:"xAxisId",index:0,type:"PropertyCollectionReference"},offset:{name:"offset",index:1,type:"Number"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},SetCursorStyle:{method:"setCursorStyle",parameter:{cursorId:{name:"cursorId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setGraph:{method:"setGraph",parameter:{path:{name:"path",index:0,type:"Object"},attribute:{name:"attribute",index:1,type:"Object"},value:{name:"value",index:2,type:"Object"}}},SetGraphStyle:{method:"setGraphStyle",parameter:{graphId:{name:"graphId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"StyleReference"}}},SetGraphVisible:{method:"setGraphVisible",parameter:{graphId:{name:"graphId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"Boolean"}}},setMaxTimeDeviation:{method:"setMaxTimeDeviation",parameter:{maxTimeDeviation:{name:"maxTimeDeviation",index:0,type:"UInteger"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUpdateBufferTime:{method:"setUpdateBufferTime",parameter:{updateBufferTime:{name:"updateBufferTime",index:0,type:"UInteger"}}},setUpdateChartTime:{method:"setUpdateChartTime",parameter:{updateChartTime:{name:"updateChartTime",index:0,type:"UInteger"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetXAxisStyle:{method:"setXAxisStyle",parameter:{xAxisId:{name:"xAxisId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"StyleReference"}}},SetXAxisTime:{method:"setXAxisTime",parameter:{xAxisId:{name:"xAxisId",index:0,type:"PropertyCollectionReference"},start:{name:"start",index:1,type:"DateTime"},end:{name:"end",index:2,type:"DateTime"}}},SetXAxisTimeSpan:{method:"setXAxisTimeSpan",parameter:{xAxisId:{name:"xAxisId",index:0,type:"PropertyCollectionReference"},timeSpan:{name:"timeSpan",index:1,type:"UNumber"}}},SetXAxisVisible:{method:"setXAxisVisible",parameter:{xAxisId:{name:"xAxisId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"Boolean"}}},setYAxis:{method:"setYAxis",parameter:{path:{name:"path",index:0,type:"Object"},attribute:{name:"attribute",index:1,type:"Object"},value:{name:"value",index:2,type:"Object"}}},SetYAxisStyle:{method:"setYAxisStyle",parameter:{yAxisId:{name:"yAxisId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"StyleReference"}}},SetYAxisVisible:{method:"setYAxisVisible",parameter:{yAxisId:{name:"yAxisId",index:0,type:"PropertyCollectionReference"},value:{name:"value",index:1,type:"Boolean"}}},SetZoomType:{method:"setZoomType",parameter:{zoomType:{name:"zoomType",index:0,type:"brease.enum.ChartZoomType"}}},ShowTooltip:{method:"showTooltip"},Unfreeze:{method:"unfreeze"},ZoomIn:{method:"zoomIn"},ZoomOut:{method:"zoomOut"},ZoomReset:{method:"zoomReset"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/OnlineChartHDA/libs/config/Config",[],function(){"use strict";return{updateBufferTime:2e3,updateChartTime:200,maxTimeDeviation:10,zoomType:"xy",visible:!0}}),define("widgets/brease/OnlineChartHDA/libs/DataAdapter",["brease/core/Class","brease/core/Utils","brease/services/libs/ServerCode"],function(e,Utils,ServerCode){"use strict";const t=2148139018;var DataAdapter=e.extend(function DataAdapter(t,i,s,n,a){e.call(this),this.graphs=t,this.timespan=i,this.readLatestHandler=function(){},this.errorHandler=n,this.msgOverlay=a,this.maxTimeDeviation=s,this.internal={readDeferreds:[],nodeChangePromises:[],firstReadDone:!1,deactivated:!1},this.serverInfo={}},null),i=DataAdapter.prototype;i.start=function(e,t){void 0!==e?(this.internal.bindings=e,void 0!==t&&(this.internal.interval=t),this.internal.interval>0&&(this.internal.readInterval=window.setInterval(this.readLatest.bind(this),this.internal.interval))):this.errorHandler.requiredBindingsMissing(this.errorHandler.widgetId)},i.stop=function(){window.clearInterval(this.internal.readInterval),this.internal.readInterval=null,this.internal.bindings=null},i.setTimespan=function(e,t){var i=$.Deferred();if("number"==typeof e){var s=new Date(t.getTime()-e);e>this.timespan?(this._pushReadDeferred(i),this.readPast(Utils.fileTimeFromDate(s),i)):i.resolve(),this.timespan=e}else{var n={startTime:Utils.fileTimeFromDate(e.start),endTime:Utils.fileTimeFromDate(e.end)};this._pushReadDeferred(i),this.readHistory(n,this._handleReadHistory.bind(this),i)}return i.promise()},i._pushReadDeferred=function(e){var t=this.internal.readDeferreds.length;this.internal.readDeferreds.push(e);var i=this;e.then(function(){i.internal.readDeferreds.splice(t,1)})},i.setMaxTimeDeviation=function(e){this.maxTimeDeviation=e},i.setReadLatestHandler=function(e){this.readLatestHandler=e},i.resetReadLatestHandler=function(){this.readLatestHandler=function(){}},i.readPast=function(e,t){var i={startTime:e,endTime:Utils.fileTimeFromDate(new Date(Date.now()+1e4))};for(var s in this.graphs)if(this.graphs[s].historicalData.length>1){var n=this.graphs[s].historicalData[1].time;i.endTime=Math.min(i.endTime,n)}this.readHistory(i,this._handlePast.bind(this),t)},i.readLatest=function(){var e=$.Deferred(),t=Utils.fileTimeFromDate(new Date(Date.now()+1e4));this.readForward(t,e)},i.readForward=function(e,t){var i={};for(var s in this.graphs)if(this.graphs[s].hasNodeId()){var n=this.graphs[s].getNode();if(i[n.serverAlias]||(i[n.serverAlias]={startTime:Utils.fileTimeFromDate(new Date(Date.now()-this.timespan)),endTime:e}),this.graphs[s].isContinued&&this.graphs[s].historicalData.length>0){var a=_.last(this.graphs[s].historicalData).time;i[n.serverAlias].startTime=Math.max(i[n.serverAlias].startTime,a)}}this.readHistory(i,this._handleLatest.bind(this),t)},i.readHistory=function e(t,i,n){var a=this,r=0,o={},l={};if(s(t)&&t.endTime<=t.startTime)return n.resolve([]),void 0;for(var d in this.graphs)if(this.graphs[d].hasNodeId()){var c=this.graphs[d].getNode();Array.isArray(o[c.serverAlias])||(o[c.serverAlias]=[]);var h={nodeId:c.nodeId,id:r},u=this.graphs[d].yAxis;u.hasUnit()&&(h.unit=u.getCurrentUnit()),o[c.serverAlias].push(h),l[d]=this.graphs[d],r+=1}var g=[];for(var m in o){this._updateServerInfo(m);var p=s(t)?t:t[m];g.push(brease.services.opcua.readNodeHistory(o[m],p,m))}$.when.apply($,g).then(function(){if(!a.internal.deactivated){var e;if(0===a.internal.nodeChangePromises.length&&(e=i(a._mergeResponses(o,arguments),l)),!a.internal.firstReadDone)for(var t in a.graphs)a.graphs[t].onNodeChange(a._nodeChangeHandler.bind(a));a.internal.firstReadDone=!0,n.resolve(e)}})};function s(e){return e.startTime&&"number"==typeof e.startTime}return i._updateServerInfo=function(e){if(!this._isServerInfoRequestPending(e)&&!this._isServerInfoIsGood(e)){this.serverInfo[e]=this.serverInfo[e]?this.serverInfo[e]:{};var t=[{nodeId:"NS0|Numeric|2258",attributeId:13}];this.serverInfo[e].readPromise=brease.services.opcua.read(t,e).then(this._handleReadTimeResponse.bind(this,e))}},i._isServerInfoIsGood=function(e){return void 0!==this.serverInfo[e]&&this.serverInfo[e].status.code===ServerCode.SUCCESS&&!this.serverInfo[e].hasTimeMismatch},i._isServerInfoRequestPending=function(e){return this.serverInfo[e]&&"pending"===this.serverInfo[e].readPromise.state()},i._handleReadTimeResponse=function(e,t){if(this.serverInfo[e]&&t&&t.status){if(this.serverInfo[e].status=t.status,t.status.code===ServerCode.SUCCESS&&t.results[0].status.code===ServerCode.SUCCESS){var i=new Date(t.results[0].value),s=new Date;this.serverInfo[e].offset=Math.abs(i-s),this.serverInfo[e].hasTimeMismatch=!1,Math.abs(this.serverInfo[e].offset)>this.maxTimeDeviation&&(this.serverInfo[e].timeMismatchReported||(this._showTimeMismatchError(i,s,this.serverInfo[e].offset),this.serverInfo[e].timeMismatchReported=!0),this.serverInfo[e].hasTimeMismatch=!0)}_.every(this.serverInfo,function(e){return!e.hasTimeMismatch})&&this.msgOverlay.clear()}},i._showTimeMismatchError=function(e,t,i){var s=brease.language.getTextByKey("IAT/Widgets/OnlineChartHDA/MESSAGE_ERROR_UTC_TIME_MISMATCH");s===brease.config.undefinedTextReturnValue&&(s="The server has a different UTC time than the client!<br>Server time: {1}<br>Client time: {2}<br>Deviation: ~{3}s"),s=s.replace("{1}",e.toISOString()).replace("{2}",t.toISOString()).replace("{3}",Math.round(i/1e3)),this.msgOverlay.create(s,!0)},i._mergeResponses=function e(t,i){var s={},n=0;for(var a in t){this.serverInfo[a].status=i[n].status;for(var r=0;r<t[a].length;r+=1)s.history||(s.history={}),i[n].status.code===ServerCode.SUCCESS?s.history[t[a][r].id]=i[n].history[r]:(s.history[t[a][r].id]={},s.history[t[a][r].id].status=i[n].status);n+=1}return s},i._handleReadHistory=function(e,t){var i=0,s=[];for(var n in t){var a=this.graphs[n];if(this.graphs[n].hasNodeId()){var r=e.history[i];if(a.hasError||r.status.code!==ServerCode.SUCCESS)s.push(null);else{var o=this._overwriteGraphData(a,r);o&&s.push(o)}i+=1}else s.push(null)}return s},i._overwriteGraphData=function(e,t){var i,s=0;null===t.value[0].value&&(s=1,this._removeDataBeforeTime(e.historicalData,t.value[0].time),i=Utils.fileTimeToDate(t.value[s].time));var n=_.last(t.value);null===n.value&&(t.value.pop(),n=_.last(t.value));for(var a=_.findIndex(e.historicalData,function(e){return e.time>=t.value[s].time}),r=a<0;s<t.value.length;a+=1,s+=1){var o={time:t.value[s].time,x:Utils.fileTimeToDate(t.value[s].time),y:t.value[s].value};r||!e.historicalData[a]?e.historicalData.push(o):e.historicalData[a].time<=n.time?e.historicalData[a]=o:e.historicalData.splice(a,0,o)}return i},i._removeDataBeforeTime=function(e,t){var i=_.findIndex(e,function(e){return e.time>=t});i>0&&e.splice(0,i)},i._handleLatest=function(e,t){var i=0;for(var s in t)this.graphs[s].hasNodeId()&&(e&&this._pushGraphData(this.graphs[s],e.history[i])&&(this.graphs[s].isContinued=!0),i+=1);this.readLatestHandler()},i._pushGraphData=function(e,t){var i=!1;if(e.hasError||!t)return!1;if(0!==t.status.code)2148139018===t.status.code&&this._startConversionErrorTimeout(e);else{this._resetConversionErrorTimeout(e);for(var s=_.last(e.historicalData),n=0;n<t.value.length;n+=1)s&&t.value[n].time<=s.time||null===t.value[n].value||e.historicalData.push({time:t.value[n].time,x:Utils.fileTimeToDate(t.value[n].time),y:t.value[n].value});i=!0}return i},i._handlePast=function(e,t){var i=0,s=[];for(var n in t){var a=this.graphs[n];if(a.hasNodeId()){var r=e.history[i];if(a.hasError||0!==r.status.code)s.push(null);else{var o=a.historicalData[0];null===r.value[0].value&&s.push(Utils.fileTimeToDate(r.value[1].time));for(var l=r.value.length-1;l>=0;l-=1)o&&r.value[l].time>=o.time||null===r.value[l].value||a.historicalData.unshift({time:r.value[l].time,x:Utils.fileTimeToDate(r.value[l].time),y:r.value[l].value})}i+=1}else s.push(null)}return s},i._nodeChangeHandler=function e(t){if(t.hasNodeId()){this.stop();var i=t.getNode(),s={nodeId:i.nodeId},n={startTime:Utils.fileTimeFromDate(new Date(Date.now()-this.timespan)),endTime:Utils.fileTimeFromDate(new Date(Date.now()+1e4))},a=t.yAxis;a.hasUnit()&&(s.unit=a.getCurrentUnit());var r=this;this.internal.nodeChangePromises.push(brease.services.opcua.readNodeHistory([s],n,i.serverAlias).then(function(e){r.internal.deactivated||0!==e.status.code||(t.historicalData=[],r._pushGraphData(t,e.history[0])&&(t.isContinued=!1),r.internal.nodeChangePromises.shift(),0===r.internal.nodeChangePromises.length&&r.start(r.internal.bindings))}))}},i._startConversionErrorTimeout=function(e){var t=this;null==e.conversionErrorTimeOut&&(e.conversionErrorTimeOut=window.setTimeout(function(){t.errorHandler.invalidPropertyValue(e.attributeToString("node"))},5e3))},i._resetConversionErrorTimeout=function(e){window.clearTimeout(e.conversionErrorTimeOut),e.conversionErrorTimeOut=null},i.wake=function(){this.internal.deactivated=!1},i.onBeforeSuspend=function(){this.internal.firstReadDone=!1,this.stop(),this.internal.deactivated=!0,this._rejectDeferreds(this.internal.readDeferreds),this.internal.readDeferreds=[],this.serverInfo={}},i._rejectDeferreds=function(e){var t=this;e.forEach(function(e){Array.isArray(e)?t._rejectDeferreds(e):e.reject()})},i.dispose=function(){this._rejectDeferreds(this.internal.readDeferreds),this.internal.readDeferreds=[],this.stop(),this.graphs=null,this.errorHandler=null,this.msgOverlay=null},DataAdapter}),define("widgets/brease/OnlineChartHDA/libs/EjChartCache",["brease/core/Class"],function(e){"use strict";var EjChartCache=e.extend(function EjChartCache(){e.call(this),this.textSizeCache={}},null),t=EjChartCache.prototype;return t.cacheTextSize=function(e,t,i){var s=e.toString().length;this.textSizeCache[t.fontFamily]||(this.textSizeCache[t.fontFamily]={fontFamily:t.fontFamily}),this.textSizeCache[t.fontFamily][t.size]||(this.textSizeCache[t.fontFamily][t.size]={fontSize:t.size}),this.textSizeCache[t.fontFamily][t.size][s]||(i.width=1.2*i.width,this.textSizeCache[t.fontFamily][t.size][s]={bounds:i})},t.getTextSize=function(e,t){if(null==e)return{width:0,height:0};var i=e.toString().length;return this.textSizeCache[t.fontFamily]&&this.textSizeCache[t.fontFamily][t.size]&&this.textSizeCache[t.fontFamily][t.size][i]?this.textSizeCache[t.fontFamily][t.size][i].bounds:void 0},t.dispose=function(){},EjChartCache}),define("widgets/brease/OnlineChartHDA/libs/MsgOverlay",["brease/core/Class","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var MsgOverlay=e.extend(function MsgOverlay(t){e.call(this),this.parent=t,this.parentReady=!1,this.parent.elem.addEventListener(BreaseEvent.WIDGET_READY,this._onParentReady.bind(this))},null),t=MsgOverlay.prototype;return t.create=function(e,t){this.$overlay||(this.$overlay=$("<div />",{class:"breaseOnlineChartHDAErrorOverlay"}),this.$msgBox=$("<div />",{class:"breaseOnlineChartHDAErrorOverlayMsg"}),this.$msg=$("<span />"),this.$overlay.hide(),this.$msgBox.hide(),this.$msgBox.append(this.$msg),t&&(this.$closeBtn=$('<div class="breaseOnlineChartHDAOverlayCloseBtn">x</div>'),this.$msgBox.prepend(this.$closeBtn)),this.parent.el.append([this.$overlay,this.$msgBox])),this.$msg.html(e),this.parentReady&&this._show()},t.clear=function(){this.$overlay&&(this.$closeBtn&&(this.$closeBtn.off(),this.$closeBtn.remove(),this.$closeBtn=null),this.$overlay.remove(),this.$msgBox.remove(),this.$overlay=null,this.$msgBox=null)},t._onParentReady=function(){this.$overlay&&this._show(),this.parentReady=!0},t._show=function(){if(this.$overlay.show(),this.$msgBox.show(),this.$closeBtn){var e=this;this.$closeBtn.off().on(BreaseEvent.CLICK,function(t){t.stopPropagation(),e.clear()})}},t.dispose=function(){this.clear()},MsgOverlay}),define("widgets/brease/OnlineChartHDA/libs/Renderer",["brease/core/Class","widgets/brease/common/libs/EjChart"],function(e,EjChart){"use strict";var Renderer=e.extend(function Renderer(t){e.call(this),this.redrawTime=t,this.modelChangeObservers=[],this.preRedrawObservers=[],this.onRedraw=null,this.setChartIsLoaded(!1),this.deactivated=!1,this.onChartLoaded=null,this.el=null,this.redrawInterval=null,this.throttledRedraw=_.throttle(this.redraw,50,{leading:!1}),this.model={series:[],axes:[],primaryYAxis:{majorGridLines:{visible:!1},visible:!1},zooming:{},chartArea:{border:{color:"transparent",opacity:1}},margin:{right:30},enableCanvasRendering:!0,load:this._bind("_onChartLoad"),axesLabelRendering:this._bind("_yAxisLabelFormatter")}},null),t=Renderer.prototype;return t.setTimeSpan=function(e){this.timeSpan=e},t.subscribeModelChange=function(e){this.modelChangeObservers.push(e)},t.unsubscribeModelChange=function(e){_.pull(this.modelChangeObservers,e)},t.subscribePreRedraw=function(e){this.preRedrawObservers.push(e)},t.unsubscribePreRedraw=function(e){_.pull(this.preRedrawObservers,e)},t.removeFromModel=function(e,t){this.model[e].splice(t,1),this._notifyModelChangeObservers("remove",e,t)},t.reorderModel=function(e,t,i){var s=this.model[e][i];this.model[e][i]=this.model[e][t],this.model[e][t]=s,this._notifyModelChangeObservers("reorder",e,t,i)},t.createChart=function(e,t){t?(this.model.primaryXAxis.range.min=t.min,this.model.primaryXAxis.range.max=t.max):brease.config.editMode||(this.model.primaryXAxis.range.min=new Date(Date.now()-this.timeSpan),this.model.primaryXAxis.range.max=new Date(Date.now())),this._notifyPreRedrawObservers(),this.el=e,this.canvasElemId=this.el.get(0).id+"_canvas",EjChart.init(this.el,this.model)},t._yAxisLabelFormatter=function(e){e.data.axis.custom&&(e.data.label.Text=brease.formatter.formatNumber(e.data.label.Text,e.data.axis.custom.numberFormat,void 0,brease.user.getSeparators()))},t.redraw=function e(t){this.getChartIsLoaded()&&!this.deactivated&&(t?(this.model.primaryXAxis.range.min=t.min,this.model.primaryXAxis.range.max=t.max,this._notifyPreRedrawObservers(!1)):this.redrawInterval&&(this.model.primaryXAxis.range.min=new Date(Date.now()-this.timeSpan),this.model.primaryXAxis.range.max=new Date(Date.now()),this._notifyPreRedrawObservers(!0)),this.el.ejChart("redraw"),this.onRedraw&&this.onRedraw())},t.requestRedraw=function(e){if(this.getChartIsLoaded())if(this.redrawInterval){var t=this.redrawTime-(Date.now()-this.model.primaryXAxis.range.max.getTime());t>200&&this.redraw(e)}else this.throttledRedraw(e)},t._notifyModelChangeObservers=function(e,t,i,s){this.modelChangeObservers.forEach(function(n){n(e,t,i,s)})},t._notifyPreRedrawObservers=function(e){var t=this;this.preRedrawObservers.forEach(function(i){e?i(t.model.primaryXAxis.range.min,t.model.primaryXAxis.range.max):i(new Date(0),t.model.primaryXAxis.range.max)})},t.stop=function e(){this.throttledRedraw.cancel(),window.clearInterval(this.redrawInterval),this.redrawInterval=null},t.start=function e(){var t=this;this.redrawInterval=setInterval(function(){t.redraw()},this.redrawTime)},t._onChartLoad=function e(t){this.model=t.model,this.setChartIsLoaded(!0),brease.config.editMode||this.start(),this.onChartLoaded&&this.onChartLoaded()},t.getChartIsLoaded=function(){return this.isLoaded},t.setChartIsLoaded=function(e){this.isLoaded=e},t.wake=function(){this.deactivated=!1},t.onBeforeSuspend=function(){this.deactivated=!0},t.dispose=function(){this.throttledRedraw.cancel(),this.stop(),this.el=null},Renderer}),define("widgets/brease/OnlineChartHDA/libs/StructProperties/Cursor",["brease/datatype/StructuredProperty","brease/core/Types","brease/core/Utils"],function(e,Types,Utils){"use strict";var t={visible:!0,style:"default"},Cursor=e.extend(function Cursor(t,i,s,renderer,n,a){e.call(this,t,s,n,a),this.renderer=renderer,this.elem=document.createElement("DIV"),this.elem.style.display="none",this.elem.id=t,this.onTrackballChangeHandler=null,this.stylePrefix=void 0!==i?i:"",this.internal={trackballs:[],labelHeight:null,show:!1,scaleFactor:1,isResized:!0,labelOffset:13,radius:8}},t),i=Cursor.prototype;return i.init=function(){this.renderer.model.crosshair={},this._createElems(),this.setStyle(this.settings.style),brease.config.editMode&&(this.renderer.onRedraw=this._bind("_createEditor"))},i._createElems=function(){for(var e=0;e<this.renderer.model.series.length;e++)this.internal.trackballs.push({$trackball:$('<div class="trackball" />').appendTo(this.elem),$label:$('<span class="trackballLabel" />').appendTo(this.elem),point:null})},i._createEditor=function(){if(this.settings.visible){if(this.internal.trackballs.length!==this.renderer.model.series.length){for(;this.elem.firstChild;)this.elem.removeChild(this.elem.firstChild);this.internal.trackballs=[],this._createElems()}var e=(this.renderer.model.primaryXAxis.Location.X1+this.renderer.model.primaryXAxis.Location.X2)/3,t=this._createTrackAxisToolTipArg(e);this._handleTrackAxisToolTip(t)}else this.elem.style.display="none"},i._createTrackAxisToolTipArg=function(e){return{model:this.renderer.model,data:{location:{x:e}}}},i.dispose=function(){window.removeEventListener("resize",this._bind("_resizeHandler")),this.elem.remove(),this.elem=null,e.prototype.dispose.apply(this,arguments)},i.setId=function(t){this.elem.id=t,e.prototype.setId.apply(this,arguments)},i.onTrackballChange=function(e){this.onTrackballChangeHandler=e},i.setStyle=function(e){var t=this.stylePrefix+"_Cursor_style_"+this.settings.style,i=this.stylePrefix+"_Cursor_style_"+e;this.settings.style=e,this.elem.classList.contains(t)&&this.elem.classList.remove(t),this.elem.classList.add(i),this.renderer.requestRedraw()},i.getStyle=function(){return this.settings.style},i.setVisible=function(e){this.settings.visible=Types.parseValue(e,"Boolean"),this.settings.visible?this.internal.show&&(this._show(),this.renderer.requestRedraw()):this.renderer.model.crosshair.visible&&(this._hide(),this.renderer.requestRedraw())},i._show=function(){this.internal.scaleFactor=Utils.getScaleFactor(this.elem.parentNode),window.addEventListener("resize",this._bind("_resizeHandler")),this.renderer.model.preRender=this._bind("_handlePreRender"),this.renderer.model.trackAxisToolTip=this._bind("_handleTrackAxisToolTip"),this.renderer.model.chartMouseMove=this._bind("_handleChartMouseMove"),this.renderer.model.crosshair.visible=!0},i._resizeHandler=function(){this.internal.isResized=!0},i._hide=function(){window.removeEventListener("resize",this._bind("_resizeHandler")),this.renderer.model.trackAxisToolTip=null,this.renderer.model.chartMouseMove=null,this.renderer.model.preRender=null,this.renderer.model.crosshair.visible=!1,this._notifyTrackballsHide(),this.elem.style.display="none"},i.getVisible=function(){return this.settings.visible},i.toString=function(){return"cursor["+this.name+"]"},i.attributeToString=function(e){return this.toString()+"."+e},i.show=function(){this.settings.visible&&(this._show(),this.internal.show=!0)},i.hide=function(){this.settings.visible&&(this._hide(),this.internal.show=!1)},i._notifyTrackballsHide=function(){if(this.onTrackballChangeHandler)for(var e=0;e<this.renderer.model.series.length;e++)this._changeTrackballPoint(e,null)},i._changeTrackballPoint=function(e,t){this.internal.trackballs[e].point!==t&&(this.internal.trackballs[e].point=t,this.onTrackballChangeHandler&&this.onTrackballChangeHandler(e,t))},i._handlePreRender=function(){this.elem.style.display="none"},i._handleChartMouseMove=function(e){var t=this._getScaleFactor(),i={x:e.data.location.x/t,y:e.data.location.y/t};this._isMouseInSeriesArea(i)||(this.elem.style.display="none",this._notifyTrackballsHide())},i._getScaleFactor=function(){return this.internal.isResized&&(this.internal.scaleFactor=Utils.getScaleFactor(this.elem.parentNode),0===this.internal.scaleFactor&&(this.internal.scaleFactor=1),this.internal.isResized=!1),this.internal.scaleFactor},i._isMouseInSeriesArea=function(e){return e.x>=this.renderer.model.primaryXAxis.Location.X1&&e.x<=this.renderer.model.primaryXAxis.Location.X2&&e.y>=this.renderer.model.primaryYAxis.Location.Y2&&e.y<=this.renderer.model.primaryYAxis.Location.Y1},i._handleTrackAxisToolTip=function(e){this.elem.parentNode.lastChild!==this.elem&&this.elem.parentNode.appendChild(this.elem);for(var t=e.data.location.x/this._getScaleFactor(),i=t-e.model.primaryXAxis.Location.X1,s=0;s<e.model.series.length;s++){var n=e.model.series[s];if("hidden"!==n.visibility){var a=this._findPointBeforeX(n,i);if(this._isPointInSeriesArea(a)){this.internal.trackballs[s].$trackball.css({"border-color":n.fill,left:t-this.internal.radius,top:a.location.Y+e.model.primaryYAxis.Location.Y2-this.internal.radius}).show();var r={"background-color":n.fill,left:t+this.internal.labelOffset,top:a.location.Y+e.model.primaryYAxis.Location.Y2-this.internal.radius};this.internal.trackballs[s].$label.text(a.y.toFixed(2)).css(r).show(),this.internal.trackballs[s].$label.top=r.top,this.internal.trackballs[s].$label.left=r.left,this.elem.style.display="block",this._changeTrackballPoint(s,a)}else this._hideTrackball(s)}else this._hideTrackball(s)}this._layoutLabels(),this._renderLabels()},i._findPointBeforeX=function(e,t){for(var i=0;i<e._visiblePoints.length;i++){var s=e._visiblePoints[i];if(s.location.X>t)return e._visiblePoints[i-1];if(s.location.X===t)return e._visiblePoints[i]}},i._isPointInSeriesArea=function(e){var t=this.renderer.model.primaryYAxis.Location.Y1-this.renderer.model.primaryYAxis.Location.Y2;return e&&e.location.Y>=0&&e.location.Y<=t},i._hideTrackball=function(e){this.internal.trackballs[e].$trackball.hide(),this.internal.trackballs[e].$label.hide(),this._changeTrackballPoint(e,null)},i._layoutLabels=function(){this.internal.labelHeight=_.first(this.internal.trackballs).$label.height(),this._fixVerticalEdgeCollisions();for(var e=0,t=[];e<10&&(t=this._getCollisions(t),t.length>0);)this._fixCollisions(t),e++;this._fixHorizontalEdgeCollisions()},i._fixVerticalEdgeCollisions=function(){for(var e=0;e<this.internal.trackballs.length;e++){var t=this.internal.trackballs[e].$label.top+this.internal.labelHeight,i=this._getEdgeCollisionCorrection(this.internal.trackballs[e].$label.top,t);i&&(this.internal.trackballs[e].$label.top+=i,this.internal.trackballs[e].$label.needsRedraw=!0)}},i._getEdgeCollisionCorrection=function(e,t){return e<=this.renderer.model.primaryYAxis.Location.Y2?this.renderer.model.primaryYAxis.Location.Y2-e:t>=this.renderer.model.primaryYAxis.Location.Y1?this.renderer.model.primaryYAxis.Location.Y1-t:void 0},i._fixHorizontalEdgeCollisions=function(){var e=this.internal.trackballs.reduce(function(e,t){return Math.max(e,t.$label.width())},0);if(_.first(this.internal.trackballs).$label.left+e>=this.renderer.model.primaryXAxis.Location.X2)for(var t=0;t<this.internal.trackballs.length;t++)this.internal.trackballs[t].$label.left-=e+this.internal.radius+2*this.internal.labelOffset,this.internal.trackballs[t].$label.needsRedraw=!0},i._getCollisions=function(){for(var e=[],t=0;t<this.internal.trackballs.length;t++)for(var i=t+1;i<this.internal.trackballs.length;i++)if(this._checkCollision(this.internal.trackballs[t].$label,this.internal.trackballs[i].$label)){var s=this,n=_.findIndex(e,function(e){return-1!==e.indexOf(s.internal.trackballs[t].$label)||-1!==e.indexOf(s.internal.trackballs[i].$label)});n>=0?-1===e[n].indexOf(this.internal.trackballs[i].$label)&&e[n].push(this.internal.trackballs[i].$label):e.push([this.internal.trackballs[t].$label,this.internal.trackballs[i].$label])}return e},i._checkCollision=function(e,t){return this.internal.labelHeight-Math.abs(e.top-t.top)>=0},i._fixCollisions=function(e){for(var t=0;t<e.length;t++){var i=_.sortBy(e[t],[function(e){return e.top}]),s=(_.last(i).top-_.first(i).top+this.internal.labelHeight)/2+_.first(i).top,n=2,a=i.length*(this.internal.labelHeight+2)-2,r=s-a/2,o=r+a,l=this._getEdgeCollisionCorrection(r,o);l&&(r+=l);for(var d=0;d<i.length;d++)i[d].top=r+(this.internal.labelHeight*d+2*d),i[d].needsRedraw=!0}},i._renderLabels=function(){for(var e=0;e<this.internal.trackballs.length;e++)this.internal.trackballs[e].$label.needsRedraw&&(this.internal.trackballs[e].$label.css({
top:this.internal.trackballs[e].$label.top,left:this.internal.trackballs[e].$label.left}),this.internal.trackballs[e].$label.needsRedraw=!1)},Cursor}),define("widgets/brease/OnlineChartHDA/libs/StyleElemsUtils",[],function(){"use strict";var StyleElemsUtils={};return StyleElemsUtils.createStyleElements=function(e){e.dummyElems={},e.dummyElems._chartColor=document.createElement("div"),e.dummyElems._chartColor.className="chartColor",e.dummyElems._disabledChartColor=document.createElement("div"),e.dummyElems._disabledChartColor.className="disabledChartColor";for(var t in e.dummyElems)e.elem.appendChild(e.dummyElems[t])},StyleElemsUtils.updateStyleProperties=function(e,t){return e.chartBackColor=getComputedStyle(t.getElementsByClassName("chartColor")[0]).getPropertyValue("background-color"),e.chartColor=getComputedStyle(t.getElementsByClassName("chartColor")[0]).color,e.disabledChartColor=getComputedStyle(t.getElementsByClassName("disabledChartColor")[0]).color,e},StyleElemsUtils.createXAxisStyleElems=function(e){e.dummyElems={},e.dummyElems._gridXAxisColor=document.createElement("div"),e.dummyElems._gridXAxisColor.className="gridXAxisColor",e.dummyElems._xAxisTextColor=document.createElement("div"),e.dummyElems._xAxisTextColor.className="xAxisTextColor",e.dummyElems._disabledxAxisTextColor=document.createElement("div"),e.dummyElems._disabledxAxisTextColor.className="disabledxAxisTextColor",e.dummyElems._xAxisTickColor=document.createElement("div"),e.dummyElems._xAxisTickColor.className="xAxisTickColor",e.dummyElems._xAxisFontName=document.createElement("div"),e.dummyElems._xAxisFontName.className="xAxisFontName",e.dummyElems._xAxisFontSize=document.createElement("div"),e.dummyElems._xAxisFontSize.className="xAxisFontSize",e.dummyElems._xAxisTickLabelRotation=document.createElement("div"),e.dummyElems._xAxisTickLabelRotation.className="xAxisTickLabelRotation";for(var t in e.dummyElems)e.elem.appendChild(e.dummyElems[t])},StyleElemsUtils.updateXAxisStyleElems=function(e,t){e.settings.gridColor=getComputedStyle(t.getElementsByClassName("gridXAxisColor")[0]).color,e.settings.textColor=getComputedStyle(t.getElementsByClassName("xAxisTextColor")[0]).color,e.settings.disabledTextColor=getComputedStyle(t.getElementsByClassName("disabledxAxisTextColor")[0]).color,e.settings.color=getComputedStyle(t.getElementsByClassName("xAxisTickColor")[0]).color,e.settings.fontName=getComputedStyle(t.getElementsByClassName("xAxisFontName")[0]).fontFamily,e.settings.fontSize=getComputedStyle(t.getElementsByClassName("xAxisFontSize")[0]).fontSize,e.settings.tickLabelRotation=this.getElemRotation(t.getElementsByClassName("xAxisTickLabelRotation")[0])},StyleElemsUtils.getElemRotation=function(e){var t=getComputedStyle(e,null),i=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")||"FAIL";if("none"===i)return 0;var s=i.split("(")[1].split(")")[0].split(",");return Math.round(Math.atan2(s[1],s[0])*(180/Math.PI))},StyleElemsUtils.createYAxisStyleElems=function(e){e.dummyElems={},e.dummyElems._textColor=document.createElement("div"),e.dummyElems._textColor.className="yAxisTextColor",e.dummyElems._disabledTextColor=document.createElement("div"),e.dummyElems._disabledTextColor.className="disabledyAxisTextColor",e.dummyElems._fontSize=document.createElement("div"),e.dummyElems._fontSize.className="yAxisFontSize",e.dummyElems._fontName=document.createElement("div"),e.dummyElems._fontName.className="yAxisFontName",e.dummyElems._yAxisColor=document.createElement("div"),e.dummyElems._yAxisColor.className="yAxisColor",e.dummyElems._gridYAxisColor=document.createElement("div"),e.dummyElems._gridYAxisColor.className="gridYAxisColor",e.dummyElems._titleTextColor=document.createElement("div"),e.dummyElems._titleTextColor.className="titleTextColor",e.dummyElems._titleFontSize=document.createElement("div"),e.dummyElems._titleFontSize.className="titleFontSize",e.dummyElems._titleFontName=document.createElement("div"),e.dummyElems._titleFontName.className="titleFontName";for(var t in e.dummyElems)e.elem.appendChild(e.dummyElems[t])},StyleElemsUtils.updateYAxisStyleElems=function(e,t){e.settings.textColor=getComputedStyle(t.getElementsByClassName("yAxisTextColor")[0]).color,e.settings.disabledTextColor=getComputedStyle(t.getElementsByClassName("disabledyAxisTextColor")[0]).color,e.settings.fontSize=getComputedStyle(t.getElementsByClassName("yAxisFontSize")[0]).fontSize,e.settings.fontName=getComputedStyle(t.getElementsByClassName("yAxisFontName")[0]).fontFamily,e.settings.color=getComputedStyle(t.getElementsByClassName("yAxisColor")[0]).color,e.settings.gridColor=getComputedStyle(t.getElementsByClassName("gridYAxisColor")[0]).color,e.settings.titleTextColor=getComputedStyle(t.getElementsByClassName("titleTextColor")[0]).color,e.settings.titleFontName=getComputedStyle(t.getElementsByClassName("titleFontName")[0]).fontFamily,e.settings.titleFontSize=getComputedStyle(t.getElementsByClassName("titleFontSize")[0]).fontSize},StyleElemsUtils.createGraphStyleElems=function(e){e.dummyElems={},e.dummyElems._lineColor=document.createElement("div"),e.dummyElems._lineColor.className="lineColor",e.dummyElems._disabledLineColor=document.createElement("div"),e.dummyElems._disabledLineColor.className="disabledLineColor",e.dummyElems._lineWidth=document.createElement("div"),e.dummyElems._lineWidth.className="lineWidth";for(var t in e.dummyElems)e.elem.appendChild(e.dummyElems[t])},StyleElemsUtils.updateGraphStyleElems=function(e,t){e.settings.lineColor=getComputedStyle(t.getElementsByClassName("lineColor")[0]).color,e.settings.disabledLineColor=getComputedStyle(t.getElementsByClassName("disabledLineColor")[0]).color,e.settings.lineWidth=getComputedStyle(t.getElementsByClassName("lineWidth")[0]).width},StyleElemsUtils}),define("widgets/brease/OnlineChartHDA/libs/StructProperties/Graph",["brease/datatype/StructuredProperty","brease/core/Types","brease/core/Utils","widgets/brease/OnlineChartHDA/libs/StyleElemsUtils"],function(e,Types,Utils,StyleElemsUtils){"use strict";var t={visible:!0,enable:!0,type:"stepLine",style:"default"},Graph=e.extend(function Graph(t,i,s,renderer,n,a){e.call(this,t,s,n,a),this.renderer=renderer,this.elem=document.createElement("DIV"),this.elem.id=t,this.stylePrefix=void 0!==i?i:"",this.hasError=!1,this.isContinued=!1,this.historicalData=[],this.onlineData=[],this.onlineFreezeData=[],this.yAxis=null,this._onNodeChangeHandlers=[],this.isFreezed=!1,this._onNodeUnitChangeHandler=function(){}},t),i=Graph.prototype;return i.init=function(e){this.index=this.renderer.model.series.length,this.renderer.model.series.push({yAxisName:this.settings.yAxisReference,visibleOnLegend:"hidden",points:[]}),this._updatePointsHandler=this.updatePoints.bind(this),this.renderer.subscribePreRedraw(this._updatePointsHandler);var t=this;this.renderer.subscribeModelChange(function(e,i,s,n){"series"===i&&("remove"===e&&s<t.index&&(t.index-=1),"reorder"===e&&(s===t.index?t.index=n:n===t.index&&(t.index=s)))}),StyleElemsUtils.createGraphStyleElems(this),this.setStyle(this.settings.style),this.setVisible(this.settings.visible),this.setType(this.settings.type);for(var i in e)if(e[i].name===this.settings.yAxisReference){this.yAxis=e[i];break}if(null===this.yAxis)throw this.hasError=!0,new Error(this.attributeToString("yAxisReference"));this.yAxis.onUnitChange(this._axisUnitChangeHandler.bind(this))},i.dispose=function(){this.elem.remove(),this.elem=null,this.renderer.removeFromModel("series",this.index),this.renderer.unsubscribePreRedraw(this._updatePointsHandler),e.prototype.dispose.apply(this,arguments)},i.setIndex=function(e){e!==this.index&&this.renderer.reorderModel("series",this.index,e)},i.setId=function(t){this.elem.id=t,e.prototype.setId.apply(this,arguments)},i.setYAxisReference=function(e){this.settings.yAxisReference=e},i.getYAxisReference=function(){return this.settings.yAxisReference},i.setType=function(e){this.settings.type=e,this.renderer.model.series[this.index].type=e},i.getType=function(){return this.settings.type},i.setStyle=function(e){var t=this.stylePrefix+"_Graph_style_"+this.settings.style;this.elem.classList.contains(t)&&this.elem.classList.remove(t),t=this.stylePrefix+"_Graph_style_"+e,this.settings.style=e,this.elem.classList.add(t),this.updateStyleProperties(),this.renderer.requestRedraw()},i.updateStyleProperties=function(){StyleElemsUtils.updateGraphStyleElems(this,this.elem),this.renderer.model.series[this.index].width=parseInt(this.settings.lineWidth,10),this.setEnable(this.settings.enable)},i.getStyle=function(){return this.settings.style},i.setNode=function(e){if(Utils.isObject(e)){var t=this.getNode();if(this.settings.node=e,t.nodeId!==e.nodeId){this.historicalData=[],this.onlineData=[];var i=this;i._onNodeChangeHandlers.forEach(function(e){e(i)})}null!==this.settings.node.value?(t.minValue!==e.minValue&&this.yAxis.setMin(this.settings.node.minValue,this.getId()),t.maxValue!==e.maxValue&&this.yAxis.setMax(this.settings.node.maxValue,this.getId()),(!this.yAxis.hasUnit()||e.unit===this.yAxis.getCurrentUnit())&&e.time>0&&this._pushOnlineData()):(this.historicalData.length=0,this.onlineData.length=0,this.onlineFreezeData.length=0,this.renderer.model.series[this.index].points.length=0)}},i._pushOnlineData=function(){var e={time:this.settings.node.time,x:Utils.fileTimeToDate(this.settings.node.time),y:this.settings.node.value};this.isFreezed?this.onlineFreezeData.push(e):this.onlineData.push(e)},i.getNode=function(){return this.settings.node||(this.settings.node={value:null,minValue:null,maxValue:null,unit:this.yAxis.getCurrentUnit()?this.yAxis.getCurrentUnit():null}),this.settings.node},i.hasNodeId=function(){return"object"==typeof this.settings.node&&"string"==typeof this.settings.node.nodeId},i.setCursorValue=function(e){},i.getCursorValue=function(){return null},i.setCursorNode=function(e){},i.getCursorNode=function(){return{value:null,minValue:null,maxValue:null,unit:this.yAxis.getCurrentUnit()?this.yAxis.getCurrentUnit():null}},i.setEnable=function(e){this.settings.enable=Types.parseValue(e,"Boolean"),this.settings.enable?this.renderer.model.series[this.index].fill=this.settings.lineColor:this.renderer.model.series[this.index].fill=this.settings.disabledLineColor},i.getEnable=function(){return this.settings.enable},i.setVisible=function(e){this.settings.visible=Types.parseValue(e,"Boolean"),this.settings.visible?this.renderer.model.series[this.index].visibility="visible":this.renderer.model.series[this.index].visibility="hidden",this.renderer.requestRedraw()},i.getVisible=function(){return this.settings.visible},i.updatePoints=function(e,t){if(!this.hasError){var i=Utils.fileTimeFromDate(e);this._updateHistoricalPoints(i),this._updateOnlinePoints(i),this.renderer.model.series[this.index].points=this.historicalData.concat(this.onlineData);var s=_.last(this.renderer.model.series[this.index].points);s&&s.x.getTime()<t.getTime()&&this.renderer.model.series[this.index].points.push({time:Utils.fileTimeFromDate(t),x:t,y:s.y})}},i._updateHistoricalPoints=function(e){var t=_.findIndex(this.historicalData,function(t){return t.time>=e});t>=0?this.historicalData.splice(0,t-1):this.historicalData.length>0&&(this.historicalData=[_.last(this.historicalData)])},i._updateOnlinePoints=function(e){var t=e;this.historicalData.length>0&&(t=_.last(this.historicalData).time);var i=_.findIndex(this.onlineData,function(e){return e.time>t});i>=0?(0===this.historicalData.length&&(i-=1),this.onlineData.splice(0,i)):0===this.historicalData.length&&this.onlineData.length>0?this.onlineData=[_.last(this.onlineData)]:this.onlineData=[]},i.setPointsRange=function(e){var t=_.findIndex(this.historicalData,function(t){return t.x>=e.start})-1,i=_.findLastIndex(this.historicalData,function(t){return t.x<=e.end});i>=0?(t=t<0?0:t,this.historicalData=this.historicalData.slice(t,i+2)):this.historicalData.length=0},i.onNodeChange=function(e){this._onNodeChangeHandlers.push(e)},i.onNodeUnitChange=function(e){this._onNodeUnitChangeHandler=e},i.toString=function(){return"graph["+this.name+"]"},i.attributeToString=function(e){return this.toString()+"."+e},i._axisUnitChangeHandler=function(e){this.historicalData=[],this.onlineData=[],this.settings.node.unit=e,this._onNodeUnitChangeHandler(this);var t=this;this._onNodeChangeHandlers.forEach(function(e){e(t)})},i.freeze=function(){this.renderer.model.series[this.index].type=t.type,this.isFreezed=!0},i.unfreeze=function(){this.renderer.model.series[this.index].type=this.settings.type,this.isFreezed=!1,this.onlineData=this.onlineData.concat(this.onlineFreezeData),this.onlineFreezeData=[]},Graph}),define("widgets/brease/OnlineChartHDA/libs/StructProperties/XAxis",["brease/datatype/StructuredProperty","brease/core/Types","brease/enum/Enum","widgets/brease/OnlineChartHDA/libs/StyleElemsUtils"],function(e,Types,Enum,StyleElemsUtils){"use strict";var t={visible:!0,enable:!0,timeSpan:60,numberOfTicks:5,timeFormat:"hh:mm:ss",position:"bottom",style:"default"},XAxis=e.extend(function XAxis(t,i,s,renderer,n,a){e.call(this,t,s,n,a),this.renderer=renderer,this.elem=document.createElement("DIV"),this.elem.id=t,this.stylePrefix=void 0!==i?i:"",this.internal={timeSpan:1e3*this.settings.timeSpan}},t),i=XAxis.prototype;return i.init=function(){this.renderer.model.primaryXAxis={range:{},valueType:"DateTime",intervalType:"seconds",majorGridLines:{},majorTickLines:{},axisLine:{},font:{},crosshairLabel:{visible:!0}},StyleElemsUtils.createXAxisStyleElems(this),this.setStyle(this.settings.style),this.setVisible(this.settings.visible),this.setPosition(this.settings.position),this.setTimeFormat(this.settings.timeFormat),this.setTimeSpan(this.settings.timeSpan),this.onTimeSpanChange(function(){}),this.onTimeChange(function(){})},i.setId=function(t){this.elem.id=t,e.prototype.setId.apply(this,arguments)},i.setStyle=function(e){var t=this.stylePrefix+"_XAxis_style_"+this.settings.style;this.elem.classList.contains(t)&&this.elem.classList.remove(t),t=this.stylePrefix+"_XAxis_style_"+e,this.settings.style=e,this.elem.classList.add(t),this.updateStyleProperties(),this.renderer.requestRedraw()},i.updateStyleProperties=function(){StyleElemsUtils.updateXAxisStyleElems(this,this.elem),this.renderer.model.primaryXAxis.majorGridLines.color=this.settings.gridColor,this.renderer.model.primaryXAxis.majorTickLines.color=this.settings.color,this.renderer.model.primaryXAxis.axisLine.color=this.settings.color,this.renderer.model.primaryXAxis.font.size=this.settings.fontSize,this.renderer.model.primaryXAxis.font.fontFamily=this.settings.fontName,this.renderer.model.primaryXAxis.labelRotation=this.settings.tickLabelRotation,this.setEnable(this.settings.enable)},i.getStyle=function(){return this.settings.style},i.setEnable=function(e){this.settings.enable=Types.parseValue(e,"Boolean"),this.settings.enable?this.renderer.model.primaryXAxis.font.color=this.settings.textColor:this.renderer.model.primaryXAxis.font.color=this.settings.disabledTextColor},i.getEnable=function(){return this.settings.enable},i.setVisible=function(e){this.settings.visible=Types.parseValue(e,"Boolean"),this.renderer.model.primaryXAxis.visible=this.settings.visible,this.renderer.model.primaryXAxis.majorGridLines.visible=this.settings.visible,this.renderer.requestRedraw()},i.getVisible=function(){return this.settings.visible},i.setPosition=function(e){this.settings.position=e,this.renderer.model.primaryXAxis.opposedPosition=this.settings.position===Enum.VerticalAlign.top},i.getPosition=function(){return this.settings.position},i.setTimeFormat=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.timeFormat=e,this.renderer.model.primaryXAxis.labelFormat=this.settings.timeFormat):this.setTimeFormatKey(brease.language.parseKey(e)),this.renderer.requestRedraw())},i.setTimeFormatKey=function(e){if(void 0!==e){this.internal.timeFormatKey=e;var t=brease.language.getTextByKey(this.internal.timeFormatKey);"undefined key"!==t?this.setTimeFormat(t):console.iatWarn(this.elem.id+": Format textKey not found: "+e)}else this.internal.timeFormatKey=void 0,console.iatInfo(this.elem.id+": The text key is not valid : "+e)},i.getTimeFormat=function(){return this.settings.timeFormat},i.setNumberOfTicks=function(e,t){t=void 0===t||t,this.settings.numberOfTicks=Math.max(0,parseInt(e,10)),this.updateRangeInterval(this.settings.timeSpan),t&&this.renderer.requestRedraw()},i.updateRangeInterval=function(e){this.renderer.model.primaryXAxis.range.interval=Math.trunc(e/this.settings.numberOfTicks),this.renderer.model.primaryXAxis.range.interval<1?this.renderer.model.primaryXAxis.range.interval=1:this.renderer.model.primaryXAxis.range.interval===1/0&&(this.renderer.model.primaryXAxis.range.interval=this.settings.timeSpan+1)},i.getNumberOfTicks=function(){return this.settings.numberOfTicks},i.setTimeSpan=function(e){e<1&&(e=1);var t=e!==this.settings.timeSpan,i=this.settings.timeSpan;if(this.settings.timeSpan=e,this.internal.timeSpan=1e3*this.settings.timeSpan,this.setNumberOfTicks(this.settings.numberOfTicks,!1),this.renderer.setTimeSpan(this.internal.timeSpan),t){var s=this.onTimeSpanChangeHandler(e,i);if(s&&"pending"===s.state()){var n=this;s.fail(function(){n.settings.timeSpan=i,n.internal.timeSpan=1e3*n.settings.timeSpan,n.setNumberOfTicks(n.settings.numberOfTicks,!1),n.renderer.setTimeSpan(n.internal.timeSpan)})}return s}},i.getTimeSpan=function(){return this.settings.timeSpan},i.getTimeSpanMs=function(){return this.internal.timeSpan},i.setTime=function(e,t){return this.settings.time={start:e,end:t},this.updateRangeInterval((t.getTime()-e.getTime())/1e3),this.onTimeChangeHandler(this.settings.time)},i.getTime=function(){return this.settings.time},i.onTimeSpanChange=function(e){this.onTimeSpanChangeHandler=e},i.onTimeChange=function(e){this.onTimeChangeHandler=e},i.cultureChangeHandler=function(){this.internal.timeFormatKey&&this.setTimeFormatKey(this.internal.timeFormatKey)},i.toString=function(){return"xAxis["+this.name+"]"},i.attributeToString=function(e){return this.toString()+"."+e},XAxis}),define("widgets/brease/OnlineChartHDA/libs/StructProperties/YAxis",["brease/datatype/StructuredProperty","brease/brease","brease/core/Types","brease/config/NumberFormat","brease/enum/Enum","brease/core/Utils","widgets/brease/OnlineChartHDA/libs/StyleElemsUtils"],function(e,brease,Types,NumberFormat,Enum,Utils,StyleElemsUtils){"use strict";var t={position:Enum.HorizontalAlign.left,title:"",showUnit:!0,rangeMode:Enum.RangeMode.autoscale,min:0,max:100,visible:!0,enable:!0,unit:{},format:{metric:{decimalPlaces:1,minimumIntegerDigits:1},imperial:{decimalPlaces:1,minimumIntegerDigits:1},"imperial-us":{decimalPlaces:1,minimumIntegerDigits:1}},style:"default"},YAxis=e.extend(function YAxis(t,i,s,renderer,n,a,r){e.call(this,t,s,a,r),this.renderer=renderer,this.elem=document.createElement("DIV"),this.elem.id=t,this.msgOverlay=n,this.internal={previousUnitCode:"",sourceRanges:{},lastRange:null},this.stylePrefix=void 0!==i?i:"",this._onUnitChangeHandlers=[]},t),i=YAxis.prototype;return i.init=function(){this.index=this.renderer.model.axes.length,this.renderer.model.axes.push({name:this.name,orientation:"vertical",custom:{},font:{},title:{font:{},titleRotation:"rotateminus90"},majorTickLines:{},majorGridLines:{},axisLine:{}});var e=this;this.renderer.subscribeModelChange(function(t,i,s,n){"axes"===i&&("remove"===t&&s<e.index&&(e.index-=1),"reorder"===t&&(s===e.index?e.index=n:n===e.index&&(e.index=s)))}),StyleElemsUtils.createYAxisStyleElems(this),this.setStyle(this.settings.style),this.setPosition(this.settings.position),this.setUnit(this.settings.unit),this.setTitle(this.settings.title),this.setVisible(this.settings.visible),this.setRangeMode(this.settings.rangeMode)},i.dispose=function(){this.elem.remove(),this.elem=null,this.renderer.removeFromModel("axes",this.index),e.prototype.dispose.apply(this,arguments)},i.setIndex=function(e){e!==this.index&&this.renderer.reorderModel("axes",this.index,e)},i.setId=function(t){this.elem.id=t,e.prototype.setId.apply(this,arguments)},i.setStyle=function(e){var t=this.stylePrefix+"_YAxis_style_"+this.settings.style;this.elem.classList.contains(t)&&this.elem.classList.remove(t),t=this.stylePrefix+"_YAxis_style_"+e,this.settings.style=e,this.elem.classList.add(t),this.updateStyleProperties(),this.setEnable(this.settings.enable),this.renderer.requestRedraw()},i.updateStyleProperties=function(){StyleElemsUtils.updateYAxisStyleElems(this,this.elem),this.renderer.model.axes[this.index].font.size=this.settings.fontSize,this.renderer.model.axes[this.index].font.fontFamily=this.settings.fontName,this.renderer.model.axes[this.index].title.font.color=this.settings.titleTextColor,this.renderer.model.axes[this.index].title.font.size=this.settings.titleFontSize,this.renderer.model.axes[this.index].title.font.fontFamily=this.settings.titleFontName,this.renderer.model.axes[this.index].majorTickLines.color=this.settings.color,this.renderer.model.axes[this.index].majorGridLines.color=this.settings.gridColor,this.renderer.model.axes[this.index].axisLine.color=this.settings.color,this.setEnable(this.settings.enable)},i.getStyle=function(){return this.settings.style},i.setEnable=function(e){this.settings.enable=Types.parseValue(e,"Boolean"),this.settings.enable?this.renderer.model.axes[this.index].font.color=this.settings.textColor:this.renderer.model.axes[this.index].font.color=this.settings.disabledTextColor},i.getEnable=function(){return this.settings.enable},i.setVisible=function(e){this.settings.visible=Types.parseValue(e,"Boolean"),this.renderer.model.axes[this.index].visible=this.settings.visible,this.renderer.model.axes[this.index].majorGridLines.visible=this.settings.visible,this.renderer.requestRedraw()},i.getVisible=function(){return this.settings.visible},i.setPosition=function(e){this.settings.position=e,this.renderer.model.axes[this.index].opposedPosition=this.settings.position!==Enum.HorizontalAlign.left},i.getPosition=function(){return this.settings.position},i.setRangeMode=function(e){if(brease.config.editMode)return this.settings.rangeMode=Enum.RangeMode.autoscale,void 0;this.settings.rangeMode=e,this.settings.rangeMode!==Enum.RangeMode.autoscale&&(Utils.isObject(this.renderer.model.axes[this.index].range)||(this.renderer.model.axes[this.index].range={}),this.setMin(this.settings.min),this.setMax(this.settings.max))},i.getRangeMode=function(){return this.settings.rangeMode},i.setMin=function(e,t){if(t){if(this.settings.rangeMode===Enum.RangeMode.fromSource){if(null===e)return;Utils.isObject(this.internal.sourceRanges[t])||(this.internal.sourceRanges[t]={}),this.internal.sourceRanges[t].min=e,this.renderer.model.axes[this.index].range.min=e;for(var i in this.internal.sourceRanges){var s=this.internal.sourceRanges[i].min;s<this.renderer.model.axes[this.index].range.min&&(this.renderer.model.axes[this.index].range.min=s)}this._handleMinGreaterOrEqualMax()}}else if(this.settings.rangeMode===Enum.RangeMode.fromConfiguration){var n=void 0===this.renderer.model.axes[this.index].range.min;this.settings.min=e,this.renderer.model.axes[this.index].range.min=this.settings.min,this._handleMinGreaterOrEqualMax(),n||this.renderer.requestRedraw()}},i._handleMinGreaterOrEqualMax=function(){null!==this.internal.lastRange?this._gtEq(this.internal.lastRange.min,this.renderer.model.axes[this.index].range.max)||this._gtEq(this.renderer.model.axes[this.index].range.min,this.internal.lastRange.max)?(this.renderer.model.axes[this.index].range.min=null,this.renderer.model.axes[this.index].range.max=null):null===this.renderer.model.axes[this.index].range.min?(this.renderer.model.axes[this.index].range.min=this.internal.lastRange.min,this.internal.lastRange=null,this.msgOverlay.clear()):null===this.renderer.model.axes[this.index].range.max&&(this.renderer.model.axes[this.index].range.max=this.internal.lastRange.max,this.internal.lastRange=null,this.msgOverlay.clear()):this._gtEq(this.renderer.model.axes[this.index].range.min,this.renderer.model.axes[this.index].range.max)&&(this.internal.lastRange=Utils.deepCopy(this.renderer.model.axes[this.index].range),this.renderer.model.axes[this.index].range.min=null,this.renderer.model.axes[this.index].range.max=null,this.msgOverlay.create('Range min of axis "'+this.name+'" greater or equal than max ('+this.internal.lastRange.max+")"))},i._gtEq=function(e,t){return typeof e==typeof t&&e>=t},i.getMin=function(){return this.settings.min},i.setMax=function(e,t){if(t){if(this.settings.rangeMode===Enum.RangeMode.fromSource){if(null===e)return;Utils.isObject(this.internal.sourceRanges[t])||(this.internal.sourceRanges[t]={}),this.internal.sourceRanges[t].max=e,this.renderer.model.axes[this.index].range.max=e;for(var i in this.internal.sourceRanges){var s=this.internal.sourceRanges[i].max;s>this.renderer.model.axes[this.index].range.max&&(this.renderer.model.axes[this.index].range.max=s)}this._handleMinGreaterOrEqualMax()}}else if(this.settings.rangeMode===Enum.RangeMode.fromConfiguration){var n=void 0===this.renderer.model.axes[this.index].range.max;this.settings.max=e,this.renderer.model.axes[this.index].range.max=this.settings.max,this._handleMinGreaterOrEqualMax(),n||this.renderer.requestRedraw()}},i.getMax=function(){return this.settings.max},i.setTitle=function(e){this.settings.title=e;var t="";if(this.settings.showUnit&&this.hasUnit()&&(t=brease.config.editMode?"unit":this.internal.unitSymbol),this.renderer.model.axes[this.index].title.text=this.settings.title,brease.language.isKey(this.settings.title)){var i=brease.language.parseKey(this.settings.title),s=brease.language.getTextByKey(i);"undefined key"!==s?this.renderer.model.axes[this.index].title.text=s:console.iatWarn(this.getId()+": Format textKey not found: "+this.settings.title)}""!==t&&(this.renderer.model.axes[this.index].title.text+=" ["+t+"]")},i.getTitle=function(){return this.settings.title},i.setUnit=function(e){this.settings.unit="string"==typeof e?JSON.parse(e.replace(/'/g,'"')):e,this._updateUnit()},i.getUnit=function(){return this.settings.unit},i.getCurrentUnit=function(){return this.settings.unit[this.internal.mms]},i.setFormat=function(e){this.settings.format=e,this._updateFormat(),this.renderer.requestRedraw()},i.getFormat=function(){return this.settings.format},i.setShowUnit=function(e){this.settings.showUnit=e},i.getShowUnit=function(){return this.settings.showUnit},i.hasUnit=function(){return!_.isEmpty(this.settings.unit)},i.measurementSystemChangeHandler=function(){this._updateUnit(),this._updateFormat()},i.cultureChangeHandler=function(){this.setTitle(this.settings.title),this._updateFormat()},i._updateUnit=function(){if(this.internal.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.hasUnit()){var e=this.getCurrentUnit();if(this.internal.previousUnitCode!==e){var t=this;brease.language.pipeAsyncUnitSymbol(e,function(e){t.internal.unitSymbol=e,t.setTitle(t.settings.title)}),this._onUnitChangeHandlers.forEach(function(t){t(e)})}this.internal.previousUnitCode=e}},i.onUnitChange=function(e){this._onUnitChangeHandlers.push(e)},i.toString=function(){return"yAxis["+this.name+"]"},i.attributeToString=function(e){return this.toString()+"."+e},i._updateFormat=function(){if(void 0!==this.settings.format){var e;if(Utils.isObject(this.settings.format))this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat(this.settings.format,this.internal.mms);else if("string"==typeof this.settings.format)if(brease.language.isKey(this.settings.format))try{var t=brease.language.parseKey(this.settings.format);e=JSON.parse(brease.language.getTextByKey(t).replace(/'/g,'"')),this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat(e,this.internal.mms)}catch(e){console.iatWarn(this.getId()+': Format String "'+this.settings.format+'" is invalid!'),this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat({},this.internal.mms)}else try{e=JSON.parse(this.settings.format.replace(/'/g,'"')),this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat(e,this.internal.mms)}catch(e){console.iatWarn(this.getId()+': Format String "'+this.settings.format+'" is invalid!'),this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat({},this.internal.mms)}}else this.renderer.model.axes[this.index].custom.numberFormat=NumberFormat.getFormat({},this.internal.mms);this.renderer.model.axes[this.index].custom.separators=brease.user.getSeparators()},YAxis}),define("text!widgets/brease/OnlineChartHDA/OnlineChartHDA.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/prototype/OnlineChartHDA"></div>\r\n'}),define("widgets/brease/OnlineChartHDA/OnlineChartHDA",["brease/core/BaseWidget","brease/core/Utils","brease/enum/Enum","brease/events/BreaseEvent","widgets/brease/common/ErrorHandling/libs/CommissioningErrorHandler","widgets/brease/OnlineChartHDA/libs/config/Config","widgets/brease/OnlineChartHDA/libs/StructProperties/XAxis","widgets/brease/OnlineChartHDA/libs/StructProperties/YAxis","widgets/brease/OnlineChartHDA/libs/StructProperties/Graph","widgets/brease/OnlineChartHDA/libs/StructProperties/Cursor","widgets/brease/OnlineChartHDA/libs/MsgOverlay","widgets/brease/OnlineChartHDA/libs/Renderer","widgets/brease/OnlineChartHDA/libs/DataAdapter","widgets/brease/OnlineChartHDA/libs/StyleElemsUtils","brease/decorators/DragAndDropCapability","brease/decorators/MeasurementSystemDependency","brease/decorators/CultureDependency","widgets/brease/common/libs/BreaseResizeObserver","brease/decorators/ContentActivatedDependency","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,Utils,Enum,BreaseEvent,t,Config,XAxis,YAxis,Graph,Cursor,MsgOverlay,Renderer,DataAdapter,StyleElemsUtils,i,MeasurementSystemDependency,CultureDependency,BreaseResizeObserver,s){"use strict";var n=e.extend(function OnlineChartHDA(){e.apply(this,arguments)},Config),a=n.prototype;return a.init=function i(){this.renderer=new Renderer(this.settings.updateChartTime),this.errorHandler=new t(this),this.msgOverlay=new MsgOverlay({elem:this.elem,el:this.el}),!0!==this.settings.omitClass&&this.addInitialClass("breaseOnlineChartHDA");var s=brease.config.editMode?this.renderer._bind("redraw"):this._bind("_redraw");this.observer=new BreaseResizeObserver(this.elem,s),e.prototype.init.call(this,!0),this.internal={isFrozen:!1,freezeTime:null,themeChangedWhileSuspended:!1,styleProperties:{},zoomType:"xy"===this.settings.zoomType?"x,y":this.settings.zoomType,busyId:Utils.uniqueID(this.elem.id+"_BusyIndi"),isResized:!0,preLoadDivisor:4},this.busyWrapper=$('<div class="breaseBusyWrapper visible" />'),this.el.append(this.busyWrapper),this._createBusyIndicator(),this._initStructuredProperties(),StyleElemsUtils.createStyleElements(this),this.unfreeze(),this._updateStyleProperties(),window.document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("_themeChangedHandler")),brease.config.editMode?(this._createChartEditor(),this._hideBusyWrapper(),this._onStylePropertiesChanged(),this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_onStylePropertiesChanged")),this.observer.init()):this._initRuntime()},a._createBusyIndicator=function(){this.elem.addEventListener(BreaseEvent.WIDGET_READY,this._bind("_onWidgetReady")),brease.uiController.createWidgets(this.busyWrapper.get(0),[{className:"widgets.brease.BusyIndicator",id:this.internal.busyId,options:{}}],!0,this.settings.parentContentId)},a._onWidgetReady=function(e){this.internal.busyId===e.target.id&&(this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_onWidgetReady")),this._dispatchReady())},a._initStructuredProperties=function(){this._initXAxis(),this.setCultureDependency(!0),this.yAxis={};for(var e in this.settings.yAxis)this._addYAxis(e,this.settings.yAxis[e]);this.graph={}
;for(var t in this.settings.graph)this._addGraph(t,this.settings.graph[t]);this._initCursor()},a._initXAxis=function(){var e=Object.keys(this.settings.xAxis)[0];this.xAxis=new XAxis(e,this.settings.stylePrefix,this.settings.xAxis[e],this.renderer,this.elem.id,"xAxis"),this.elem.appendChild(this.xAxis.elem),this.xAxis.init(),this.xAxis.onTimeSpanChange(this._timeSpanChangeHandler.bind(this)),this.xAxis.onTimeChange(this._timeChangeHandler.bind(this))},a._initCursor=function(){var e=Object.keys(this.settings.cursor)[0];this.cursor=new Cursor(e,this.settings.stylePrefix,this.settings.cursor[e],this.renderer,this.elem.id,"cursor"),this.elem.appendChild(this.cursor.elem),this.cursor.init(),this.cursor.onTrackballChange(this._bind("_cursorTrackballChangeHandler"))},a.contentActivatedHandler=function(){this.observer.initialized?this.observer.wake():this.observer.init()},a._cursorTrackballChangeHandler=function(e,t){var i=_.find(this.graph,["index",e]),s=i.getCursorNode();s.value=null!==t?t.y:null;var n={};n[i.attributeToString("cursorNode")]=s,n[i.attributeToString("cursorValue")]=s.value,this.sendValueChange(n)},a._graphUnitChangedHandler=function(e){this.sendNodeChange({attribute:e.attributeToString("node"),nodeAttribute:"unit",value:e.getNode().unit})},a._themeChangedHandler=function(){this.state===Enum.WidgetState.INITIALIZED||this.state===Enum.WidgetState.READY?(this._updateAllStyleProperties(),this.renderer.requestRedraw(),this.internal.themeChangedWhileSuspended=!1):this.internal.themeChangedWhileSuspended=!0},a._onStylePropertiesChanged=function(){this._updateAllStyleProperties(),this.renderer.redraw()},a._createChartEditor=function e(){var t={min:new Date(Date.now()-this.xAxis.getTimeSpanMs()),max:new Date},i=0;for(var s in this.graph)this.graph[s].historicalData=this._createChartEditorPoints(t.min,this.xAxis.getTimeSpanMs(),i),i+=1;this.renderer.createChart(this.el,t)},a._createChartEditorPoints=function(e,t,i){for(var s=[],n=50,a=0;a<50;++a){var r=t/50*a,o=new Date(e.getTime()+r);s.push({x:o,time:Utils.fileTimeFromDate(o),y:Math.sin(.1*a+i)*(i+1)})}return s},a._initRuntime=function(){var e=this;this.dataAdapter||(this.dataAdapter=new DataAdapter(this.graph,this.xAxis.getTimeSpanMs(),1e3*this.settings.maxTimeDeviation,this.errorHandler,this.msgOverlay)),brease.config.preLoadingState?this.settings.initRuntimeAfterPreCache=!0:(this._bindUXEvents(),this.measurementSystemChangeHandler(),this.dataAdapter.setReadLatestHandler(function(){e.renderer.createChart(e.el),e._hideBusyWrapper(),e.dataAdapter.resetReadLatestHandler()}),this.settings.initRuntimeAfterPreCache?this.dataAdapter.setTimespan(this.xAxis.getTimeSpanMs(),new Date(Date.now()+2e3)):this._readHistoryOnGraphNodeInit(),this.dataAdapter.start(this.bindings,this.settings.updateBufferTime),this.settings.initRuntimeAfterPreCache=!1)},a._bindUXEvents=function(){this.el.on("touchstart",this._bind("_onTouchStart")),this.el.on("mousedown",this._bind("_onMouseDown")),this.el.on("mousewheel DOMMouseScroll",this._bind("_onMouseWheel")),window.addEventListener("resize",this._bind("_resizeHandler"))},a._resizeHandler=function(){this.internal.isResized=!0},a._initialValueHandling=function(){if(e.prototype._initialValueHandling.apply(this,arguments),this.bindings){var t=0,i=[];for(var s in this.bindings)-1!==s.indexOf(".node")&&(i[t]=s,t+=1);0===i.length?this.errorHandler.requiredBindingNodesMissing():i.length!==Object.values(this.settings.graph).length&&console.log("node(s) are missing for the graph(s)")}else this.errorHandler.requiredBindingsMissing()},a._readHistoryOnGraphNodeInit=function(){var e=this,t=Object.keys(this.graph);for(var i in this.graph)this.graph[i].onNodeChange(function(i){_.pull(t,i.getId()),0===t.length&&e.dataAdapter.readLatest()})},a._timeSpanChangeHandler=function(e,t){if(!brease.config.preLoadingState){if(!brease.config.editMode){var i=1e3*e,s=this.internal.isFrozen?this.internal.freezeTime:Date.now(),n=this.dataAdapter.setTimespan(i,new Date(s));if("pending"===n.state()){var a=this,r=window.setTimeout(this._showBusyWrapper.bind(this),200);n.done(function(){a._redrawNewRange(),clearTimeout(r),a._hideBusyWrapper()}).fail(function(){a._hideBusyWrapper(),clearTimeout(r),a.dataAdapter.setTimespan(1e3*t,new Date(s))})}else this._redrawNewRange();return n}this._createChartEditor()}},a._redrawNewRange=function(){if(this.internal.isFrozen){var e={min:new Date(this.internal.freezeTime-this.xAxis.getTimeSpanMs()),max:new Date(this.internal.freezeTime)};this.renderer.requestRedraw(e)}else this.renderer.requestRedraw()},a._showBusyWrapper=function(){this.busyWrapper.addClass("visible")},a._hideBusyWrapper=function(){this.busyWrapper.removeClass("visible")},a._timeChangeHandler=function(e){if(!brease.config.preLoadingState){var t=this.dataAdapter.setTimespan(this._extendTimeSpan(e)),i=$.Deferred(),s={min:e.start,max:e.end},n=this,a=window.setTimeout(this._showBusyWrapper.bind(this),200);return t.done(function(e){var t=!1;if(e.length===Object.keys(n.graph).length){_.compact(e);var r=_.min(e);r>s.min&&(s.min=r,t=!0)}n.zoomReset(),n.xAxis.updateRangeInterval((s.max-s.min)/1e3),n.renderer.requestRedraw(s),clearTimeout(a),n._hideBusyWrapper(),i.resolve(t,s)}).fail(function(){clearTimeout(a),n._hideBusyWrapper(),i.reject()}),i}},a._extendTimeSpan=function(e){var t=this.renderer.model.primaryXAxis.range.max.getTime()-this.renderer.model.primaryXAxis.range.min.getTime(),i=t/this.internal.preLoadDivisor,s={start:new Date(e.start.getTime()-i),end:new Date(e.end.getTime()+i)};return this.internal.dataTimeSpanExtended=s,s},a.setGraph=function(e,t,i){if(!this.graph[e])return this.reportPropertyNotExist(e),void 0;this.graph[e][Utils.setter(t)](i)},a.getGraph=function(e,t){return this.graph[e]?this.graph[e][Utils.getter(t)]():(this.reportPropertyNotExist(e),null)},a.reportPropertyNotExist=function(e){var t=e.split("_").pop();this.errorHandler.invalidPropertyValue(t),this.msgOverlay.create("Binded property "+t+" does not exist")},a.addGraph=function(e,t){this._addGraph(e,t),this._createChartEditor()},a._addGraph=function(e,t){this.settings.graph[e]||(this.settings.graph[e]=t),this.graph[e]=new Graph(e,this.settings.stylePrefix,this.settings.graph[e],this.renderer,this.elem.id,"graph"),this.elem.appendChild(this.graph[e].elem);try{this.graph[e].init(this.yAxis)}catch(e){this.errorHandler.invalidPropertyValue(e.message)}this.graph[e].onNodeUnitChange(this._graphUnitChangedHandler.bind(this,this.graph[e]))},a.renameGraph=function(e,t){this._renameStructProp("graph",e,t)},a._renameStructProp=function(e,t,i){this[e][t].setId(i),this[e][i]=this[e][t],delete this[e][t],this.settings[e][i]=this.settings[e][t],delete this.settings[e][t]},a.deleteGraph=function(e){this._deleteStructProp("graph",e)},a._deleteStructProp=function(e,t){this[e][t].dispose(),delete this[e][t],delete this.settings[e][t],this.renderer.redraw()},a.orderGraph=function(e){this._orderStructProp("graph",e)},a._orderStructProp=function(e,t){for(var i=0;i<t.length;++i){var s=t[i];this[e][s].setIndex(i)}this.renderer.redraw()},a.setYAxis=function(e,t,i){if(!this.yAxis[e])return this.reportPropertyNotExist(e),void 0;this.yAxis[e][Utils.setter(t)](i)},a.getYAxis=function(e,t){return this.yAxis[e]?this.yAxis[e][Utils.getter(t)]():(this.reportPropertyNotExist(e),null)},a.addYAxis=function(e,t){this._addYAxis(e,t),this.renderer.redraw()},a._addYAxis=function(e,t){this.settings.yAxis[e]||(this.settings.yAxis[e]=t),this.yAxis[e]=new YAxis(e,this.settings.stylePrefix,this.settings.yAxis[e],this.renderer,this.msgOverlay,this.elem.id,"yAxis"),this.elem.appendChild(this.yAxis[e].elem),this.yAxis[e].init()},a.renameYAxis=function(e,t){this._renameStructProp("yAxis",e,t)},a.deleteYAxis=function(e){this._deleteStructProp("yAxis",e)},a.orderYAxis=function(e){this._orderStructProp("yAxis",e)},a.setXAxis=function(e,t,i){this.xAxis[Utils.setter(t)](i)},a.getXAxis=function(e,t){return this.xAxis[Utils.getter(t)]()},a.renameXAxis=function(e,t){this.xAxis.setId(t),this.settings.xAxis[t]=this.settings.xAxis[e],delete this.settings.xAxis[e]},a.setCursor=function(e,t,i){this.cursor[Utils.setter(t)](i)},a.getCursor=function(e,t){return this.cursor[Utils.getter(t)]()},a.renameCursor=function(e,t){this.cursor.setId(t),this.settings.cursor[t]=this.settings.cursor[e],delete this.settings.cursor[e]},a.setUpdateBufferTime=function e(t){this.settings.updateBufferTime=t},a.setUpdateChartTime=function e(t){this.settings.updateChartTime=t},a.setMaxTimeDeviation=function e(t){this.settings.maxTimeDeviation=1e3*t,this.dataAdapter&&this.dataAdapter.setMaxTimeDeviation(this.settings.maxTimeDeviation)},a.setZoomType=function e(t){this.settings.zoomType=t,"xy"!==t&&"none"!==t&&"x"!==t&&"y"!==t||(this.internal.zoomType="xy"===t?"x,y":t,this.internal.isFrozen&&(this.renderer.model.zooming.enable=!0,"none"===this.settings.zoomType&&(this.zoomReset(),this.renderer.model.zooming.enable=!1)),this.renderer.model.zooming.type=this.settings.zoomType)},a._enableHandler=function(t){e.prototype._enableHandler.apply(this,arguments);for(var i in this.graph)this.graph[i].setEnable(t);for(var s in this.yAxis)this.yAxis[s].setEnable(t);this.xAxis.setEnable(t),t?(this.renderer.model.chartArea.background=this.internal.styleProperties.chartColor,this.internal.isFrozen&&this._enableChartInteraction()):(this.renderer.model.chartArea.background=this.internal.styleProperties.disabledChartColor,this._disableChartInteraction()),this.renderer.requestRedraw()},a._visibleHandler=function(){this.el.is(":visible")&&this.internal&&(this._updateAllStyleProperties(),this.renderer.redraw())},a._setWidth=function t(i){e.prototype._setWidth.call(this,i),brease.config.editMode&&this._createChartEditor()},a._setHeight=function t(i){e.prototype._setHeight.call(this,i),brease.config.editMode&&this._createChartEditor()},a.setStyle=function(t){e.prototype.setStyle.apply(this,arguments),this._updateStyleProperties(),this.renderer.requestRedraw()},a.getUpdateBufferTime=function e(){return this.settings.updateBufferTime},a.getUpdateChartTime=function e(){return this.settings.updateChartTime},a.getMaxTimeDeviation=function e(){return this.settings.maxTimeDeviation},a.getZoomType=function e(){return this.settings.zoomType},a.getTrackballTooltipMode=function e(){return this.settings.trackballTooltipMode},a.getStatus=function e(){return!this.internal.isFrozen},a.cultureChangeHandler=function(e){if(void 0!==e){this.xAxis.cultureChangeHandler();for(var t in this.settings.yAxis)this.yAxis[t].cultureChangeHandler();this.renderer.requestRedraw()}},a.measurementSystemChangeHandler=function(){for(var e in this.settings.yAxis)this.yAxis[e].measurementSystemChangeHandler(this)},a._updateStyleProperties=function(){this.internal.styleProperties=StyleElemsUtils.updateStyleProperties(this.internal.styleProperties,this.elem),this.renderer.model.chartArea.background=this.internal.styleProperties.chartColor,this.renderer.model.background=this.internal.styleProperties.chartBackColor,this._enableHandler(!this.isDisabled)},a._updateAllStyleProperties=function(){this._updateStyleProperties(),this.xAxis.updateStyleProperties();for(var e in this.yAxis)this.yAxis[e].updateStyleProperties();for(var t in this.graph)this.graph[t].updateStyleProperties()},a.freeze=function(){if(!this.internal.isFrozen){if(this.renderer.onChartLoaded=null,!this.renderer.getChartIsLoaded())return this.renderer.onChartLoaded=this.freeze.bind(this),void 0;this.dataAdapter.stop(),this.renderer.stop(),this.internal.freezeTime=Date.now();var e=this,t={start:new Date(this.internal.freezeTime-this.xAxis.getTimeSpanMs()),end:new Date(this.internal.freezeTime)};this.dataAdapter.setTimespan(this._extendTimeSpan(t)).done(function(){e.internal.isFrozen=e.getStatus(),e._enableChartInteraction();for(var i in e.graph)e.graph[i].freeze();e.el.removeClass("unfreeze"),e.renderer.redraw({min:t.start,max:t.end})})}},a._enableChartInteraction=function(){this.renderer.model.zooming.enable="none"!==this.settings.zoomType&&this.isEnabled(),this.renderer.model.zooming.enablePinching=this.isEnabled(),this.renderer.model.zooming.enableMouseWheel=this.isEnabled(),this.isEnabled()&&(this.cursor.show(),this.renderer.model.zooming.toolbarItems=["reset","pan","zoom"],this.renderer.model.zooming.enableDeferredZoom=!1)},a.unfreeze=function(){if(this._disableChartInteraction(),this.zoomReset(),this.el.addClass("unfreeze"),this.internal.isFrozen&&this.renderer.getChartIsLoaded()){this.internal.isFrozen=this.getStatus();for(var e in this.graph)this.graph[e].unfreeze();this.xAxis.setNumberOfTicks(this.xAxis.settings.numberOfTicks,!1),this.dataAdapter.readLatest(),this.dataAdapter.start(this.bindings),this.renderer.start()}},a._disableChartInteraction=function(){this._removeToolbar(),this.renderer.model.zooming.enable=!1,this.renderer.model.zooming.toolbarItems=[""],this.renderer.model.zooming.enableMouseWheel=!1,this.renderer.model.zooming.enablePinching=!1,this.cursor.hide()},a._removeToolbar=function(){this._removeToolbarItem("ZoomBtn"),this._removeToolbarItem("PanBtn"),this._removeToolbarItem("ResetZoom")},a._removeToolbarItem=function(e){var t=document.getElementById(this.elem.id+"_canvas_"+e);t&&t.parentNode.removeChild(t)},a.zoomIn=function(){if(this.internal.isFrozen){var e=this.renderer.model.primaryXAxis.zoomFactor,t=this.renderer.model.primaryYAxis.zoomFactor,i=this.renderer.model.primaryXAxis.zoomPosition,s=this.renderer.model.primaryYAxis.zoomPosition,n=.8,a=.002;if(!0!==this.internal.eventZoomed&&"none"!==this.internal.zoomType){var r=i+.5*e,o=s+.5*t;this._positionZoomCalculate(r,o,.5,.5,.8)}switch(this.internal.eventZoomed=!1,this.internal.zoomType){case"x,y":this.renderer.model.primaryXAxis.zoomFactor=.8*e,this.renderer.model.primaryYAxis.zoomFactor=.8*t,this._calculateZoomFactorYAxis(this.renderer.model.primaryYAxis.zoomFactor);break;case"x":this.renderer.model.primaryXAxis.zoomFactor=.8*e;break;case"y":this.renderer.model.primaryYAxis.zoomFactor=.8*t,this._calculateZoomFactorYAxis(this.renderer.model.primaryYAxis.zoomFactor);break}this.renderer.model.primaryXAxis.zoomFactor<.002&&(this.renderer.model.primaryXAxis.zoomFactor=.002),this.renderer.model.primaryYAxis.zoomFactor<.002&&(this.renderer.model.primaryYAxis.zoomFactor=.002,this._calculateZoomFactorYAxis(.002)),this.renderer.redraw()}},a.zoomOut=function(){if(this.internal.isFrozen){var e=this.renderer.model.primaryXAxis.zoomFactor,t=this.renderer.model.primaryYAxis.zoomFactor,i=this.renderer.model.primaryXAxis.zoomPosition,s=this.renderer.model.primaryYAxis.zoomPosition,n=1.2;if(!0!==this.internal.eventZoomed&&"none"!==this.internal.zoomType){var a=i+.5*e,r=s+.5*t;this._positionZoomCalculate(a,r,.5,.5,1.2)}switch(this.internal.eventZoomed=!1,this.internal.zoomType){case"x,y":this.renderer.model.primaryXAxis.zoomFactor=1.2*this.renderer.model.primaryXAxis.zoomFactor,this.renderer.model.primaryYAxis.zoomFactor=1.2*this.renderer.model.primaryYAxis.zoomFactor,this._calculateZoomFactorYAxis(this.renderer.model.primaryYAxis.zoomFactor);break;case"x":this.renderer.model.primaryXAxis.zoomFactor=1.2*this.renderer.model.primaryXAxis.zoomFactor;break;case"y":this.renderer.model.primaryYAxis.zoomFactor=1.2*this.renderer.model.primaryYAxis.zoomFactor,this._calculateZoomFactorYAxis(this.renderer.model.primaryYAxis.zoomFactor);break}this.renderer.model.primaryXAxis.zoomFactor>1&&(this.renderer.model.primaryXAxis.zoomFactor=1),this.renderer.model.primaryYAxis.zoomFactor>1&&(this.renderer.model.primaryYAxis.zoomFactor=1,this._calculateZoomFactorYAxis(1)),1===this.renderer.model.primaryYAxis.zoomFactor&&1===this.renderer.model.primaryXAxis.zoomFactor&&this.zoomReset(),this.renderer.redraw()}},a.zoomReset=function(){var e=document.getElementById(this.elem.id+"_canvas_ResetZoom");if(e){var t=new Event("click");e.dispatchEvent(t)}else this.isZoomed()&&(this.renderer.model.primaryXAxis.zoomFactor=1,this.renderer.model.primaryYAxis.zoomFactor=1,this.renderer.model.primaryXAxis.zoomPosition=0,this.renderer.model.primaryYAxis.zoomPosition=0,this._calculateZoomFactorYAxis(1),this._calculateZoomPositionYAxis(0),this.internal.isFrozen&&this.renderer.redraw())},a.isZoomed=function(){return 1!==this.renderer.model.primaryXAxis.zoomFactor||1!==this.renderer.model.primaryYAxis.zoomFactor},a.scrollRight=function(){var e=.25;this.internal.isFrozen&&this.renderer.model.primaryXAxis.visibleRange.max<this.renderer.model.primaryXAxis.actualRange.max&&(this.renderer.model.primaryXAxis.zoomPosition=this.renderer.model.primaryXAxis.zoomPosition+.25*this.renderer.model.primaryXAxis.zoomFactor,this.renderer.requestRedraw())},a.scrollLeft=function(){var e=.25;this.internal.isFrozen&&this.renderer.model.primaryXAxis.visibleRange.min>this.renderer.model.primaryXAxis.actualRange.min&&(this.renderer.model.primaryXAxis.zoomPosition=this.renderer.model.primaryXAxis.zoomPosition-.25*this.renderer.model.primaryXAxis.zoomFactor,this.renderer.requestRedraw())},a.scrollUp=function(){var e=.25;this.internal.isFrozen&&this.renderer.model.primaryYAxis.visibleRange.max<this.renderer.model.primaryYAxis.actualRange.max&&(this.renderer.model.primaryYAxis.zoomPosition=this.renderer.model.primaryYAxis.zoomPosition+.25*this.renderer.model.primaryYAxis.zoomFactor,this._calculateZoomPositionYAxis(this.renderer.model.primaryYAxis.zoomPosition),this.renderer.requestRedraw())},a.scrollDown=function(){var e=.25;this.internal.isFrozen&&this.renderer.model.primaryYAxis.visibleRange.min>this.renderer.model.primaryYAxis.actualRange.min&&(this.renderer.model.primaryYAxis.zoomPosition=this.renderer.model.primaryYAxis.zoomPosition-.25*this.renderer.model.primaryYAxis.zoomFactor,this._calculateZoomPositionYAxis(this.renderer.model.primaryYAxis.zoomPosition),this.renderer.requestRedraw())},a.setGraphVisible=function(e,t){var i=_.find(this.graph,["name",e]);if(!i)return null;this._changeStructProp(i,"visible",t)},a._changeStructProp=function(e,t,i){var s=e[Utils.setter(t)](i),n={};return n[e.attributeToString(t)]=e[Utils.getter(t)](),this.sendValueChange(n),s},a.setGraphStyle=function(e,t){var i=_.find(this.graph,["name",e]);if(!i)return null;this._changeStructProp(i,"style",t)},a.setYAxisVisible=function(e,t){var i=_.find(this.yAxis,["name",e]);if(!i)return null;this._changeStructProp(i,"visible",t)},a.setYAxisStyle=function(e,t){var i=_.find(this.yAxis,["name",e]);if(!i)return null;this._changeStructProp(i,"style",t)},a.setXAxisVisible=function(e,t){if(this.xAxis.name!==e)return null;this._changeStructProp(this.xAxis,"visible",t)},a.setXAxisStyle=function(e,t){if(this.xAxis.name!==e)return null;this._changeStructProp(this.xAxis,"style",t)},a.setXAxisTimeSpan=function(e,t){if(this.xAxis.name!==e)return null;var i=this._changeStructProp(this.xAxis,"timeSpan",t);return i?this._createActionPromise(i):void 0},a._createActionPromise=function(e,t){var i=$.Deferred();return e.done(function(){t?i.resolve(!0,t.apply(null,arguments)):i.resolve(!0)}).fail(function(){i.resolve(!1)}),i.promise()},a.setXAxisTime=function(e,t,i){t=new Date(t),i=new Date(i);var s=0;if(this.xAxis.name===e&&this.internal.isFrozen){if(this.internal.freezeTime<i.getTime()&&(i=new Date(this.internal.freezeTime),s=2),!(t<i))return-1;var n=this.xAxis.setTime(t,i);if(n)return this._createSetTimeActionPromise(n,s)}return null},a._createSetTimeActionPromise=function(e,t){return this._createActionPromise(e,function(e){return e&&(t+=1),t})},a.scrollXAxis=function(e,t){if(this.xAxis.name===e&&this.internal.isFrozen){var i=new Date(this.renderer.model.primaryXAxis.range.min.getTime()+1e3*t),s=new Date(this.renderer.model.primaryXAxis.range.max.getTime()+1e3*t);if(this.internal.freezeTime<s.getTime())return 2;var n=this.xAxis.setTime(i,s),a=this;if(n)return this._createActionPromise(n,function(e,t){if(e){var s=t.min.getTime()-i.getTime();return t.max=new Date(t.max.getTime()+s),t.max.getTime()>a.internal.freezeTime&&(t.max=new Date(a.internal.freezeTime)),a.xAxis.updateRangeInterval((t.max-t.min)/1e3),a.renderer.requestRedraw(t),1}return 0})}return null},a.setCursorStyle=function(e,t){if(this.cursor.name!==e)return null;this._changeStructProp(this.cursor,"style",t)},a.wheelZoom=function(e){if(e.preventDefault(),void 0!==this.renderer&&this.internal.isFrozen&&"none"!==this.internal.zoomType){var t=this._zoomProperties(e);if(e.layerX>t.width+t.x||e.layerX<t.x||e.layerY>t.height+t.y||e.layerY<t.y)return;this.internal.eventZoomed=!0,e.deltaY>0?(this._positionZoomCalculate(t.previousXPosition,t.previousYPosition,t.mouseXPosition,t.mouseYPosition,1.2),this.zoomOut()):(this._positionZoomCalculate(t.previousXPosition,t.previousYPosition,t.mouseXPosition,t.mouseYPosition,.8),this.zoomIn())}},a.dblClickZoom=function(e){if(void 0!==this.renderer&&this.internal.isFrozen&&"none"!==this.internal.zoomType){var t=this._zoomProperties(e);if(e.layerX>t.width+t.x||e.layerX<t.x||e.layerY>t.height+t.y||e.layerY<t.y)return;this.internal.eventZoomed=!0,this._positionZoomCalculate(t.previousXPosition,t.previousYPosition,t.mouseXPosition,t.mouseYPosition,.8),this.zoomIn()}},a._calculateZoomFactorYAxis=function(e){for(var t=0;t<this.renderer.model.axes.length;t+=1)this.renderer.model.axes[t].zoomFactor=e},a._calculateZoomPositionYAxis=function(e){for(var t=0;t<this.renderer.model.axes.length;t+=1)this.renderer.model.axes[t].zoomPosition=e},a._zoomProperties=function(e){var t={width:this.renderer.model.m_AreaBounds.Width,height:this.renderer.model.m_AreaBounds.Height,x:this.renderer.model.m_AreaBounds.X,y:this.renderer.model.m_AreaBounds.Y};return t.mouseXPosition=(e.layerX-t.x)/t.width,t.mouseYPosition=1-(e.layerY-t.y)/t.height,t.previousXPosition=this.renderer.model.primaryXAxis.zoomPosition+this.renderer.model.primaryXAxis.zoomFactor*t.mouseXPosition,t.previousYPosition=this.renderer.model.primaryYAxis.zoomPosition+this.renderer.model.primaryYAxis.zoomFactor*t.mouseYPosition,t},a._positionZoomCalculate=function(e,t,i,s,n){var a=.002;"x,y"!==this.internal.zoomType&&"x"!==this.internal.zoomType||(this.renderer.model.primaryXAxis.zoomFactor*n>.002?this.renderer.model.primaryXAxis.zoomPosition=e-this.renderer.model.primaryXAxis.zoomFactor*n*i:this.renderer.model.primaryXAxis.zoomPosition=e-.002*i),"x,y"!==this.internal.zoomType&&"y"!==this.internal.zoomType||(this.renderer.model.primaryYAxis.zoomFactor*n>.002?(this.renderer.model.primaryYAxis.zoomPosition=t-this.renderer.model.primaryYAxis.zoomFactor*n*s,this._calculateZoomPositionYAxis(this.renderer.model.primaryYAxis.zoomPosition)):(this.renderer.model.primaryYAxis.zoomPosition=t-.002*s,this._calculateZoomPositionYAxis(this.renderer.model.primaryYAxis.zoomPosition))),this.renderer.model.primaryXAxis.zoomPosition<0&&(this.renderer.model.primaryXAxis.zoomPosition=0),this.renderer.model.primaryYAxis.zoomPosition<0&&(this.renderer.model.primaryYAxis.zoomPosition=0,this._calculateZoomPositionYAxis(this.renderer.model.primaryYAxis.zoomPosition))},a._onMouseDown=function(e){if(this.renderer.model.zooming.enable){var t=this._clientPosToChartPos(e);this._isChartPosOnChartArea(t)&&e.stopPropagation()}},a._clientPosToChartPos=function(e){var t=document.getElementById(this.renderer.canvasElemId).getBoundingClientRect(),i=this._getScaleFactor(this.elem);return{x:(e.clientX-t.x)/i,y:(e.clientY-t.y)/i}},a._isChartPosOnChartArea=function(e){var t=e.x<this.renderer.model.m_AreaBounds.Width+this.renderer.model.m_AreaBounds.X&&e.x>this.renderer.model.m_AreaBounds.X,i=e.y<this.renderer.model.m_AreaBounds.Height+this.renderer.model.m_AreaBounds.Y&&e.y>this.renderer.model.m_AreaBounds.Y;return t&&i},a._onMouseWheel=function(e){this.renderer.model.zooming.enable&&e.stopPropagation()},a._getScaleFactor=function(){return this.internal.isResized&&(this.internal.scaleFactor=Utils.getScaleFactor(this.elem.parentNode),0===this.internal.scaleFactor&&(this.internal.scaleFactor=1),this.internal.isResized=!1),this.internal.scaleFactor},a._onTouchStart=function(e){if(this.internal.isFrozen&&this.isEnabled()){var t=this._clientPosToChartPos(e.originalEvent.touches[0]);if(this._isChartPosOnChartArea(t)&&e.stopPropagation(),!this._isChartPosOnXAxis(t)||1!==e.originalEvent.touches.length||this.isZoomed())return;e.stopPropagation(),this.elem.addEventListener("touchmove",this._bind("_onTouchMove")),this.elem.addEventListener("touchend",this._bind("_onTouchEnd")),this.internal.lastTouchX=t.x-this.renderer.model.m_AreaBounds.X}},a._isChartPosOnXAxis=function(e){var t=e.x<this.renderer.model.m_AreaBounds.Width+this.renderer.model.m_AreaBounds.X&&e.x>this.renderer.model.m_AreaBounds.X,i=e.y>this.renderer.model.m_AreaBounds.Height+this.renderer.model.m_AreaBounds.Y&&e.y<this.renderer.model.svgHeight;return this.renderer.model.primaryXAxis.opposedPosition&&(i=e.y<this.renderer.model.m_AreaBounds.Y),t&&i},a._onTouchMove=function(e){if(1===e.touches.length){var t=this._clientPosToChartPos(e.touches[0]);if(this._isChartPosOnXAxis(t)){var i=t.x-this.renderer.model.m_AreaBounds.X,s=this.internal.lastTouchX-i,n=s/this.renderer.model.m_AreaBounds.Width,a=this.renderer.model.primaryXAxis.range.max.getTime()-this.renderer.model.primaryXAxis.range.min.getTime(),r=a*n,o=this.renderer.model.primaryXAxis.range.min.getTime()+r,l=this.renderer.model.primaryXAxis.range.max.getTime()+r,d={min:new Date(o),max:new Date(l)},c=a/this.internal.preLoadDivisor;if(this.internal.freezeTime>=d.max.getTime()){if(o-this.internal.dataTimeSpanExtended.start.getTime()<c){var h=new Date(this.internal.dataTimeSpanExtended.start.getTime()-c);this.internal.preLoadPromise=this.dataAdapter.setTimespan({start:h,end:this.internal.dataTimeSpanExtended.start}),this.internal.dataTimeSpanExtended.start=h,this.internal.dataTimeSpanExtended.end=new Date(l+c),this._setGraphsPointRange(this.internal.dataTimeSpanExtended)}else if(this.internal.dataTimeSpanExtended.end.getTime()-l<c){var u=new Date(this.internal.dataTimeSpanExtended.end.getTime()+c);this.internal.preLoadPromise=this.dataAdapter.setTimespan({start:this.internal.dataTimeSpanExtended.end,end:u}),this.internal.dataTimeSpanExtended.end=u,this.internal.dataTimeSpanExtended.start=new Date(o-c),this._setGraphsPointRange(this.internal.dataTimeSpanExtended)}this.renderer.redraw(d)}this.internal.lastTouchX=i}}},a._setGraphsPointRange=function(e){for(var t in this.graph)this.graph[t].setPointsRange(e)},a._onTouchEnd=function(e){if(this.elem.removeEventListener("touchmove",this._bind("_onTouchMove")),this.elem.removeEventListener("touchend",this._bind("_onTouchEnd")),this.internal.preLoadPromise){var t=this;this.internal.preLoadPromise.done(function(){t.renderer.redraw(t.renderer.model.primaryXAxis.range)})}},a._redraw=function(){this.isVisible()&&this.renderer.redraw()},a.dispose=function(){window.document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("_themeChangedHandler")),this.elem.removeEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_onStylePropertiesChanged")),window.removeEventListener("resize",this._bind("_resizeHandler")),this.dataAdapter&&(this.dataAdapter.dispose(),this.dataAdapter=null),this.renderer.dispose(),this.renderer=null,this.errorHandler.dispose(),this.errorHandler=null,this.msgOverlay.dispose(),this.msgOverlay=null,this.busyWrapper=null,this.observer.dispose(),this.observer=void 0,this.elem.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("_onWidgetReady")),e.prototype.dispose.apply(this,arguments)},a.onBeforeSuspend=function(){brease.config.editMode||(this.renderer.stop(),this.renderer.onBeforeSuspend(),this.dataAdapter.onBeforeSuspend()),e.prototype.onBeforeSuspend.apply(this,arguments)},a.suspend=function(){this.observer.suspend(),e.prototype.suspend.apply(this,arguments)},a.wake=function(){this.renderer.wake(),this.dataAdapter.wake(),this.internal.themeChangedWhileSuspended&&this._themeChangedHandler(),this.settings.initRuntimeAfterPreCache?this._initRuntime():this.internal.isFrozen||(this.dataAdapter.start(this.bindings),void 0!==this.renderer&&this.renderer.start()),this._updateStyleProperties(),e.prototype.wake.apply(this,arguments)},s.decorate(i.decorate(MeasurementSystemDependency.decorate(CultureDependency.decorate(n,!0),!0),!1),!0)}),define("widgets/brease/TextInput/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TextInput",parents:["*"],children:[],inheritance:["widgets.brease.TextInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setData:{method:"setData",parameter:{data:{name:"data",index:0,type:"Object"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setKeyboard:{method:"setKeyboard",parameter:{keyboard:{name:"keyboard",index:0,type:"Boolean"}}},setMaxLength:{method:"setMaxLength",parameter:{maxLength:{name:"maxLength",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPlaceholder:{method:"setPlaceholder",parameter:{placeholder:{name:"placeholder",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},SubmitChange:{method:"submitChange"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/Password/designer/ClassInfo",["widgets/brease/TextInput/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Password",parents:["*"],children:[],inheritance:["widgets.brease.Password","widgets.brease.TextInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValue:{method:"getValue"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setData:{method:"setData",parameter:{data:{name:"data",index:0,type:"Object"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setKeyboard:{method:"setKeyboard",parameter:{keyboard:{name:"keyboard",index:0,type:"Boolean"}}},setMaxLength:{method:"setMaxLength",parameter:{maxLength:{name:"maxLength",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setPlaceholder:{method:"setPlaceholder",parameter:{placeholder:{name:"placeholder",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},SubmitChange:{method:"submitChange"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),
define("text!widgets/brease/Password/Password.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Password"></div>\r\n'}),define("widgets/brease/TextInput/TextInput",["brease/core/BaseWidget","brease/decorators/LanguageDependency","brease/controller/KeyboardManager","brease/events/BreaseEvent","brease/controller/libs/KeyActions","brease/core/Utils","brease/enum/Enum","brease/core/Types","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/libs/BreaseTextMetrics","widgets/brease/common/DragDropProperties/libs/DraggablePropertiesEvents","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,t,i,BreaseEvent,KeyActions,Utils,Enum,Types,UtilsEditableBinding,s,BreaseTextMetrics){"use strict";var n={submitOnChange:!0,keyboard:!0,tabIndex:0,inputTabIndex:1,ellipsis:!1,value:"",maxLength:-1,placeholder:"",placeholderTextKey:"",inputRestriction:"",inputRestrictionRegEx:null,inputRestrictionTextKey:"",useFocusWithin:!0},a=e.extend(function TextInput(){e.apply(this,arguments)},n),r=a.prototype;r.init=function(t){!0!==this.settings.omitClass&&this.addInitialClass("breaseTextInput"),this.settings.maxLength<0&&(this.settings.maxLength=void 0),this.createKeyBoard(),this.input=u.call(this,t),m(this),this.setPlaceholder(this.settings.placeholder),void 0!==this.settings.value&&this.setValue(this.settings.value),this.setKeyboard(this.settings.keyboard),this.setInputRestriction(this.settings.inputRestriction),this.keyBoard.state===Enum.WidgetState.READY?(e.prototype.init.call(this),this._enableHandler(this.getEnable()),g(this)):document.body.addEventListener(BreaseEvent.WIDGET_READY,this._bind("keyBoard_readyHandler")),document.body.addEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("_onThemeChanged"))},r._initEditor=function(){this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind("_onStylePropertiesChanged")),this.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))},r.createKeyBoard=function(){this.keyBoard=i.getKeyboard()},r.keyBoard_readyHandler=function(t){"breaseKeyBoard"===t.target.id&&(document.body.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("keyBoard_readyHandler")),e.prototype.init.call(this,!0),this._enableHandler(this.getEnable()),this._dispatchReady(),g(this))},r._setWidth=function(t){e.prototype._setWidth.apply(this,arguments),"auto"===t?g(this):this.input.css({width:"","max-width":""})},r.setValue=function(e){this.settings.value=this.spsValue=e,this.showValue()},r.setData=function(e){_.isObject(e)&&(void 0!==e.maxLength&&(this.settings.maxLength=e.maxLength),void 0!==e.value&&(this.settings.value=this.spsValue=e.value)),this.showValue()},r.showValue=function(){this.input.val(this.settings.value),g(this)},r.getValue=function(){return this.settings.value},r.resetValue=function(){this.setValue(this.spsValue)},r.removeFocus=function(){document.removeEventListener("keypress",this._bind("_onKeyPress")),this.el.removeClass("active")},r.submitChange=function(){this.spsValue=this.input.val(),this.sendValueChange({value:this.spsValue}),this.createEvent("ValueChanged",{value:this.getValue()}).dispatch()},r.setMaxLength=function(e){this.settings.maxLength=e},r.getMaxLength=function(){return this.settings.maxLength},r.setEllipsis=function(e){this.settings.ellipsis=e,m(this)},r.getEllipsis=function(){return this.settings.ellipsis},r.setPlaceholder=function(e){!1===brease.language.isKey(e)?(this.settings.placeholderTextKey="",this.settings.placeholder=e):(this.settings.placeholderTextKey=e,this.settings.placeholder=brease.language.getTextByKey(brease.language.parseKey(e))),p(this),g(this)},r.getPlaceholder=function(){return this.settings.placeholder},r.setSubmitOnChange=function(e){this.settings.submitOnChange=e},r.getSubmitOnChange=function(){return this.settings.submitOnChange},r.setInputRestriction=function(e){!1===brease.language.isKey(e)?this.settings.inputRestrictionTextKey="":(this.settings.inputRestrictionTextKey=e,e=brease.language.getTextByKey(brease.language.parseKey(e))),void 0!==e&&""!==e?(this.settings.inputRestriction=e,this.settings.inputRestrictionRegEx=new RegExp(this.settings.inputRestriction)):(this.settings.inputRestriction="",this.settings.inputRestrictionRegEx=null)},r.getInputRestriction=function(){return this.settings.inputRestriction},r.getKeyboard=function(){return this.settings.keyboard},r.setKeyboard=function(e){var t=e!==this.settings.keyboard;this.settings.keyboard=e,this._initKeyboardEvents(!1);var i=-1;this.settings.keyboard&&!this._getUseKeyboardOperations()?(this.input.attr("readonly","readonly"),this.input.removeClass("keyboard")):(this._initKeyboardEvents(!0),this.input.addClass("keyboard"),this.input[0].removeAttribute("readonly"),this.isEnabled()&&!this._getUseKeyboardOperations()&&(i=this.settings.inputTabIndex)),this.input[0].tabIndex=i,t&&this._enableHandler(this.getEnable())},r._initKeyboardEvents=function(e){var t=e?"on":"off";this.input[t]("focusout",this._bind("_onFocusOut"))[t]("focusin",this._bind("_onFocusIn"))[t]("input",this._bind("_onInput")),this.el[t](BreaseEvent.MOUSE_DOWN,this._bind("_mouseDownHandler"))},r._setKeyboardOpen=function(e){this.internalData.keyboardOpen=e},r._getKeyboardOpen=function(){return this.internalData.keyboardOpen},r._getUseKeyboardOperations=function(){return brease.config.visu.keyboardOperation},r.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},r.suspend=function(){document.body.removeEventListener(BreaseEvent.WIDGET_READY,this._bind("keyBoard_readyHandler")),document.body.removeEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("_onThemeChanged")),e.prototype.suspend.apply(this,arguments)},r.wake=function(){g(this),i.isCurrentKeyboard(this.keyBoard)||this.changeKeyBoard(),document.body.addEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("_onThemeChanged")),e.prototype.wake.apply(this,arguments)},r.dispose=function(){d.call(this),document.body.removeEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),this.elem.removeEventListener(BreaseEvent.BEFORE_FOCUS_MOVE,this._bind("_onBeforeFocusMove")),this.elem.removeEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,this._bind("_onBeforeStateChange")),this.elem.removeEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,this._bind("_onBeforeStateChange")),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("_onThemeChanged")),this.keyBoard&&(this.keyBoard=null),this.input.off(),e.prototype.dispose.apply(this,arguments)},r._initEventHandler=function(){this._getUseKeyboardOperations()&&(this.elem.addEventListener(BreaseEvent.BEFORE_FOCUS_MOVE,this._bind("_onBeforeFocusMove")),this.elem.addEventListener(BreaseEvent.BEFORE_ENABLE_CHANGE,this._bind("_onBeforeStateChange")),this.elem.addEventListener(BreaseEvent.BEFORE_VISIBLE_CHANGE,this._bind("_onBeforeStateChange"))),this.el.on(BreaseEvent.CLICK,this._bind("_clickHandler"))},r._mouseDownHandler=function(e){this.isMouseDown=!0,this.lastMouseDownIsTouch="touchstart"===e.originalEvent.type,$(window).on(BreaseEvent.MOUSE_UP,this._bind("_windowMouseUpHandler"))},r._windowMouseUpHandler=function(e){0!==this.el.has(e.target).length||e.target===this.elem||Utils.getOriginalEvent(e)instanceof KeyboardEvent||this._onFocusIn(),$(window).off(BreaseEvent.MOUSE_UP,this._bind("_windowMouseUpHandler")),this.isMouseDown=!1},r._clickHandler=function(t){this._handleFocus(t),e.prototype._clickHandler.call(this,t)},r._handleFocus=function(e){if(!this.isDisabled&&!0!==brease.config.editMode){var t=Utils.getOriginalEvent(e);KeyActions.getActionForKey(t.key)===Enum.KeyAction.Accept?this._focusWithTab():!this.getKeyboard()||t instanceof KeyboardEvent?this._onFocusIn():(o.call(this,this.settings.value),this.el.addClass("active"))}},r._enableHandler=function(t){this.el.off("click",this._bind("_preventClickHandler")),this.el.off("touchstart",this._bind("_preventClickHandler")),!0===t?this.getKeyboard()?(this.el.on("click",this._bind("_preventClickHandler")),this.el.on("touchstart",this._bind("_preventClickHandler"))):this._getUseKeyboardOperations()||this.input.attr("tabindex",this.settings.inputTabIndex):(this.getKeyboard()||this.input.attr("tabindex",-1),l(this)),e.prototype._enableHandler.apply(this,arguments)},r._visibleHandler=function(){this.isVisible()||l(this),e.prototype._visibleHandler.apply(this,arguments)},r._preventClickHandler=function(e){this._handleEvent(e)},r._onBeforeFocusMove=function(){l(this)},r._onBeforeStateChange=function(e){!e.detail.value&&this.elem.classList.contains("active")&&(this._cancelNewValueOnEscape(),this.input.blur())},r._onThemeChanged=function(){g(this)},r._onStylePropertiesChanged=function(){g(this)};function o(e){c.call(this),this._setKeyboardOpen(!0),this.keyBoard.show({text:e,restrict:this.settings.inputRestriction,maxLength:this.settings.maxLength,type:this.settings.type,header:this.settings.header,contentId:this.settings.parentContentId,widgetId:this.elem.id,bindingAttributes:["value"]},this.elem)}function l(e){e._getKeyboardOpen()&&e.keyBoard.hide()}r.changeKeyBoard=function(e){d.call(this),this.createKeyBoard(),this.el.hasClass("active")&&!0===this.settings.keyboard&&o.call(this,e.detail.currentValue)},r._focusWithTab=function(){this.el.hasClass("active")?this.elem.focus():this._onFocusIn()},r._onFocusIn=function(){!0===this.isDisabled?this.input.blur():(!this.elem.classList.contains("active")&&this._getUseKeyboardOperations()&&this.input[0].select(),this.focusInTime=Date.now(),this.input[0].focus(),this.input[0].addEventListener("keypress",this._bind("_onKeyPress")),this.el.addClass("active"))},r._onFocusOut=function(){this.lastMouseDownIsTouch&&Date.now()-this.focusInTime<20?this._onFocusIn():this.isMouseDown||this._focusOut()},r._focusOut=function(){"accept"!==brease.config.keyboardHandling.onEnd.action||this.internalData.enterOut?(h.call(this,this.input.val()),!0===this.getSubmitOnChange()&&this.elem.classList.contains("active")&&this.submitChange()):this.showValue(),this.removeFocus(),this.internalData.enterOut=!1},r._onKeyPress=function(e){if(KeyActions.getActionForKey(e.key)===Enum.KeyAction.Accept&&!this._getUseKeyboardOperations())return this.input.blur(),void 0;this._validateInput(e.key)||e.preventDefault()},r._onInput=function(){g(this)},r._handleFocusKeyDown=function(t){"accept"===brease.config.keyboardHandling.onEnd.action&&KeyActions.getActionForKey(t.key)===Enum.KeyAction.Accept&&this.elem.classList.contains("active")&&(this.internalData.enterOut=!0),e.prototype._handleFocusKeyDown.apply(this,arguments),KeyActions.getActionForKey(t.key)===Enum.KeyAction.Cancel?(this.elem.classList.contains("active")&&t.stopPropagation(),this._cancelNewValueOnEscape()):"any"===brease.config.keyboardHandling.onStart.action&&this._isPrintable(t.key)&&!this._getKeyboardOpen()&&this._handleFocus(t)},r._isPrintable=function(e){return 1===e.length},r._cancelNewValueOnEscape=function(){this.showValue(),this.removeFocus(),this.elem.focus()},r._inputChangeHandler=function(e){e.stopPropagation()},r._onKeyBoardClose=function(){d.call(this),this._setKeyboardOpen(!1),this.el.removeClass("active"),this.elem.focus()},r._onKeyBoardSubmit=function(e){h.call(this,e.detail),this.settings.submitOnChange&&this.submitChange()},r.langChangeHandler=function(){void 0!==this.settings.placeholderTextKey&&""!==this.settings.placeholderTextKey&&this.setPlaceholder(this.settings.placeholderTextKey),void 0!==this.settings.inputRestrictionTextKey&&""!==this.settings.inputRestrictionTextKey&&this.setInputRestriction(this.settings.inputRestrictionTextKey)},r._validateInput=function(e){return void 0===this.settings.inputRestrictionRegEx||null===this.settings.inputRestrictionRegEx||!1!==this.settings.inputRestrictionRegEx.test(e)},r.setStyle=function(){e.prototype.setStyle.apply(this,arguments),g(this)};function d(){this.keyBoard&&(this.keyBoard.removeEventListener(BreaseEvent.CLOSED,this._bind("_onKeyBoardClose")),this.keyBoard.removeEventListener(BreaseEvent.SUBMIT,this._bind("_onKeyBoardSubmit")))}function c(){this.keyBoard&&(this.keyBoard.addEventListener(BreaseEvent.CLOSED,this._bind("_onKeyBoardClose")),this.keyBoard.addEventListener(BreaseEvent.SUBMIT,this._bind("_onKeyBoardSubmit")))}function h(e){this.settings.value=e,this.showValue(),this.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{detail:{value:this.settings.value}}))}function u(e){this.settings.type=void 0!==e?e:Enum.InputType.text;var t={type:this.settings.type};return _.isNumber(this.settings.maxLength)&&(t.maxlength=this.settings.maxLength),$("<input>").attr(t).on("change",this._bind("_inputChangeHandler")).appendTo(this.el)}function g(e){if("auto"===e.settings.width){var t=e.input.val(),i=""===t?e.settings.placeholder:t;e.input.css({width:f(i,e.input.css("font"))+"px","max-width":"100%"})}}function m(e){void 0!==e.settings.ellipsis&&(e.settings.ellipsis=Types.parseValue(e.settings.ellipsis,"Boolean")),!0===e.settings.ellipsis?e.el.addClass("ellipsis"):e.el.removeClass("ellipsis")}function p(e){var t=e.input.get(0);void 0!==e.settings.placeholder&&""!==e.settings.placeholder?t.setAttribute("placeholder",e.settings.placeholder):t.removeAttribute("placeholder")}function f(e,t){return Math.ceil(BreaseTextMetrics.measureText(e,t).width)}return s.decorate(t.decorate(a,!0),!1)}),define("widgets/brease/Password/Password",["widgets/brease/TextInput/TextInput","brease/enum/Enum"],function(e,Enum){"use strict";var t={},i=e.extend(function Password(){e.apply(this,arguments)},t);return i.prototype.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breasePassword"),e.prototype.init.call(this,Enum.InputType.password)},i}),define("widgets/brease/PDFViewer/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.PDFViewer",parents:["*"],children:[],inheritance:["widgets.brease.PDFViewer","brease.core.BaseWidget"],actions:{ClearSrc:{method:"clearSrc"},Focus:{method:"focus"},GoToPage:{method:"goToPage",parameter:{value:{name:"value",index:0,type:"UInteger"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setDocumentZoom:{method:"setDocumentZoom",parameter:{documentZoom:{name:"documentZoom",index:0,type:"String"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setNamedDest:{method:"setNamedDest",parameter:{namedDest:{name:"namedDest",index:0,type:"String"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setShowToolbar:{method:"setShowToolbar",parameter:{showToolbar:{name:"showToolbar",index:0,type:"Boolean"}}},SetSrc:{method:"setSrc",parameter:{value:{name:"value",index:0,type:"String"}}},setStartPage:{method:"setStartPage",parameter:{startPage:{name:"startPage",index:0,type:"UNumber"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUsePlugin:{method:"setUsePlugin",parameter:{usePlugin:{name:"usePlugin",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/PDFViewer/PDFViewer.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/PDFViewer"></div>\r\n'}),define("widgets/brease/PDFViewer/PDFViewer",["brease/core/BaseWidget","brease/events/BreaseEvent","widgets/brease/PDFViewer/libs/external/pdfobject/pdfobject","brease/config","brease/controller/PopUpManager","brease/decorators/LanguageDependency","brease/controller/KeyboardManager","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,t,config,i,s,n,a){"use strict";var r={usePlugin:!0,startPage:0,documentZoom:"auto",namedDest:"",showToolbar:!1},o=e.extend(function PDFViewer(){e.apply(this,arguments)},r),l=o.prototype;l.init=function(){this.pdfOpenParams={page:"",nameddest:"",zoom:"",toolbar:""},this.inlineOpenParams=void 0,this.pdfUrlOptions=void 0,this.url=void 0,this.deferred=new $.Deferred,this.numPad=n.getNumPad(),this.jsViewerPath="widgets/brease/PDFViewer/libs/external/pdfjs/web/viewer_br.html",!0!==this.settings.omitClass&&this.addInitialClass("breasePDFViewer"),e.prototype.init.call(this),h(this),brease.config.editMode?I(this):(this.el.on(BreaseEvent.WIDGET_READY,this._bind("_checkWidgetReady")),g(this),this.isFullscreen=!1)},l.load=function(e){var t=this;this.settings.src=e,brease.config.preLoadingState?this.settings.reloadAfterPrecache=!0:t.isVisible()&&m(t)},l.getSrc=function(){return this.settings.src},l.setSrc=function(e,t){!0!==t&&(this.settings.srckey=null),!0===brease.language.isKey(e)?this.setSrcKey(brease.language.parseKey(e)):this.load(e)},l.clearSrc=function(){var e;this.settings.src="",this.settings.usePlugin?this.pdfFrame&&(e=this.pdfFrame.attr("src").replace(/(\?file=)(.*)/g,"?file="),document.getElementById(this.pdfFrame.attr("id")).src=e):this.pdfObject&&(this.pdfObject.data="")},l.setStartPage=function(e){this.settings.startPage=e},l.getStartPage=function(){return this.settings.startPage},l.setDocumentZoom=function(e){this.settings.documentZoom=e},l.getDocumentZoom=function(){return this.settings.documentZoom},l.setNamedDest=function(e){this.settings.namedDest=e},l.getNamedDest=function(){return this.settings.namedDest},l.setShowToolbar=function(e){this.settings.showToolbar=e},l.getShowToolbar=function(){return this.settings.showToolbar},l.setUsePlugin=function(e){this.settings.usePlugin=e},l.getUsePlugin=function(){return this.settings.usePlugin},l.goToPage=function(e){var t=Number(e);Number.isInteger(t)&&t>=0&&(this.settings.goToPage=t,this.isVisible()&&m(this))},l.setSrcKey=function(e){void 0!==e&&(this.settings.srckey=e,this.setLangDependency(!0),this.langChangeHandler())},l.langChangeHandler=function(){void 0!==this.settings.srckey&&this.load(brease.language.getTextByKey(this.settings.srckey))},l._onNumPadSubmit=function(e){this.numPad.removeEventListener(BreaseEvent.SUBMIT,this._bind("_onNumPadSubmit")),this.goToPage(e.detail.value)},l.suspend=function(){u(this),d(this),this.settings.goToPage=void 0,this.isFullscreen&&x(this),c.call(this),e.prototype.suspend.apply(this,arguments)},l.wake=function(){this.settings.reloadAfterPrecache&&(this.settings.reloadAfterPrecache=!1,this.load(this.settings.src)),h(this),e.prototype.wake.apply(this,arguments)},l._numPadHandler=function(e){var t=e.detail.widgetId,i,s,n,a={};this.el&&this.elem&&this.elem.id===t&&(i=parseInt(e.detail.value),s=parseInt(e.detail.minValue),n=parseInt(e.detail.maxValue),a={minValue:s,maxValue:n,value:i,pointOfOrigin:"element",format:{default:{decimalPlaces:0,minimumIntegerDigits:1}}},this.numPad.addEventListener(BreaseEvent.SUBMIT,this._bind("_onNumPadSubmit")),this.numPad.show(a,this.elem),this.elem.setAttribute("data-numpad-shown",""))},l._checkWidgetReady=function(){this.deferred.resolve()},l._visibleHandler=function(){var e=this;$.when(e.deferred).done(function(){e.isVisible()&&e.load(e.settings.src)})},l._fullScreenHandler=function(e){var t=e.detail.widgetId;this.elem&&this.elem.id===t&&x(this)},l.dispose=function(){this.pdfFrame&&(this.pdfFrame.get(0).src="",this.el.append(this.pdfFrame)),this.pdfFrame=null,d(this),c.call(this),this.numPad=null,u(this),this.settings.goToPage=void 0,e.prototype.dispose.apply(this,arguments)},l._clickHandler=function(){};function d(e){e.numPad&&e.numPad.elem&&e.numPad.removeEventListener(BreaseEvent.SUBMIT,e._bind("_onNumPadSubmit"))}function c(){this.elem.hasAttribute("data-numpad-shown")&&(this.numPad.hide(),this.elem.removeAttribute("data-numpad-shown"))}function h(e){document.addEventListener("openNumPad.PDFViewer",e._bind("_numPadHandler")),document.addEventListener("requestFullscreen.PDFViewer",e._bind("_fullScreenHandler"))}function u(e){document.removeEventListener("openNumPad.PDFViewer",e._bind("_numPadHandler")),document.removeEventListener("requestFullscreen.PDFViewer",e._bind("_fullScreenHandler"))}function g(e){void 0!==e.settings.src&&(!1===brease.language.isKey(e.settings.src)?e.setSrc(e.settings.src):e.setSrcKey(brease.language.parseKey(e.settings.src)))}function m(e){var t;!0!==brease.config.editMode&&(void 0!==e.settings.src?(e.inlineOpenParams=w(e.settings.src),!1===e.settings.usePlugin?(t=void 0!==e.inlineOpenParams?y(e.settings.src,!0):y(e.settings.src,!1),p(e),void 0!==e.settings.goToPage&&(e.pdfOpenParams.page=e.settings.goToPage),e.pdfObject=b(e,t),!1===e.pdfObject&&e.el.html('<p style="width:80%; padding:2%;text-align:center;font-weight:bold;margin:auto;display:block;border:1px solid red;">no plugin available to display pdf documents</p>').css({"background-color":"#ffffff",width:e.settings.width+"px",height:e.settings.height+"px"})):(void 0===e.pdfFrame&&v(e),t=y(e.settings.src,!1),void 0!==e.inlineOpenParams?(void 0!==e.settings.goToPage&&(t=!0===/page=/.test(t)?t.replace(/page=\w*/,"page="+e.settings.goToPage):t.replace(/#/,"#page="+e.settings.goToPage+"&")),e.pdfFrame.attr("src",e.jsViewerPath+"?file="+t+"&widgetId="+e.elem.id)):(f(e),void 0!==e.settings.goToPage&&(e.pdfUrlOptions=e.pdfUrlOptions.replace(/page=\w*/,"page="+e.settings.goToPage)),e.pdfFrame.attr("src",e.jsViewerPath+"?file="+t+"&widgetId="+e.elem.id+e.pdfUrlOptions)))):!0===config.warn&&console.iatWarn('No PDF source given at widget PDFViewer[id="'+e.elem.id+'"]'))}function p(e){var t=e.settings,i=e.pdfOpenParams,s=e.inlineOpenParams;void 0!==s?(i.page=void 0===s.page?"":s.page,i.zoom=void 0===s.zoom?"":s.zoom,i.nameddest=void 0===s.nameddest?"":s.nameddest,i.toolbar=parseInt(s.toolbar,10),isNaN(i.toolbar)?i.toolbar=!0===t.showToolbar?1:0:i.toolbar=Math.max(0,Math.min(i.toolbar,1))):(i.page=void 0===t.startPage||0===t.startPage?"":t.startPage,i.zoom=void 0===t.documentZoom||"auto"===t.documentZoom?"":t.documentZoom,i.nameddest=void 0===t.namedDest?"":t.namedDest,i.toolbar=!0===t.showToolbar?1:0)}function f(e){var t=e.settings,i="";i=""===t.namedDest||void 0===t.namedDest||void 0!==t.goToPage?""===t.startPage||void 0===t.startPage||0===t.startPage?"#page=":"#page="+t.startPage:"#page=&nameddest="+t.namedDest,i=""===t.documentZoom||void 0===t.documentZoom?i+"&zoom=":i+"&zoom="+t.documentZoom,i=!0===t.showToolbar?i+"&toolbar=1":i+"&toolbar=0",e.pdfUrlOptions=i+"&pagemode=none"}function b(e,i){var s="100%";return new t({url:i,width:"100%",height:"100%",pdfOpenParams:e.pdfOpenParams}).embed(e.elem.id)}function v(e){var t=e.jsViewerPath;e.pdfFrame=$('<iframe id="PDFViewerFrame_'+e.elem.id+'" src="'+t+"?file=&widgetId="+e.elem.id+e.pdfUrlOptions+'" style="display: block;border:none; margin:0; padding:0;width:100%;height:100%"></iframe>'),e.el.text("").append(e.pdfFrame)}function y(e,t){var i,s={};if(e=decodeURI(e),"/"!==e.substring(0,1)&&"http"!==e.substring(0,4)){e=$("base").attr("href")+e}return t&&(e=e.replace(/#(.*)/,"")),e}function w(e){var t=[],i,s;if(!0===/#/.test(e)){for(i="",t=e.match(/#(.*)/).pop().split(/&/),s=0;s<=t.length-1;s+=1)i+=t[s].replace(/(.*?)=(.*)/,'{"$1":"$2"}');i=i.replace(/}{/g,","),i=JSON.parse(i)}return i}function x(e){if(!1===e.isFullscreen){var t=i.getHighestZindex();brease.bodyEl.addClass("fullscreenPDFViewer"),e.pdfFrame.css({"z-index":t+1,position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"}).appendTo(document.body),e.isFullscreen=!0}else brease.bodyEl.removeClass("fullscreenPDFViewer"),e.pdfFrame.css({"z-index":0,position:"relative",top:"0px",left:"0px",width:E(e.settings.width),height:E(e.settings.height)}).appendTo(e.el),e.isFullscreen=!1}function E(e){return e+="",-1!==e.indexOf("%")?e:e+"px"}function I(e){e.el.addClass("iatd-outline"),e.el.css("background-image",'url("widgets/brease/PDFViewer/assets/PDF.svg")')}return a.decorate(s.decorate(o,!1),!1)}),define("widgets/brease/PushButton/designer/ClassInfo",["widgets/brease/Button/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.PushButton",parents:["*"],children:[],inheritance:["widgets.brease.PushButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/PushButton/PushButton.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/PushButton">CONTENT</div>\r\n'}),define("widgets/brease/PushButton/PushButton",["widgets/brease/Button/Button","widgets/brease/common/libs/wfUtils/UtilsEditableBinding"],function(e,UtilsEditableBinding){"use strict";var t={},i=e.extend(function PushButton(){e.apply(this,arguments)},t),s=i.prototype;return i.sendValue=1,s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breasePushButton"),e.prototype.init.call(this)},s.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["value"])},s._onButtonClick=function(e){this.sendValueChange({value:i.sendValue})},i}),define("widgets/brease/RadialGauge/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.RadialGauge",parents:["*"],children:[],inheritance:["widgets.brease.RadialGauge","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setMajorTicks:{method:"setMajorTicks",parameter:{majorTicks:{name:"majorTicks",index:0,type:"UInteger"}}},setMaxValue:{method:"setMaxValue",parameter:{maxValue:{name:"maxValue",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{minValue:{name:"minValue",index:0,type:"Number"}}},setMinorTicks:{method:"setMinorTicks",parameter:{minorTicks:{name:"minorTicks",index:0,type:"UInteger"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.Node"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setRange:{method:"setRange",parameter:{range:{name:"range",index:0,type:"UNumber"}}},setScaleArea0:{method:"setScaleArea0",parameter:{scaleArea0:{name:"scaleArea0",index:0,type:"Number"}}},setScaleArea0Node:{method:"setScaleArea0Node",parameter:{scaleArea0Node:{name:"scaleArea0Node",index:0,type:"brease.datatype.Node"}}},setScaleArea1:{method:"setScaleArea1",parameter:{scaleArea1:{name:"scaleArea1",index:0,type:"Number"}}},setScaleArea1Node:{method:"setScaleArea1Node",parameter:{scaleArea1Node:{name:"scaleArea1Node",index:0,type:"brease.datatype.Node"}}},setScaleArea2:{method:"setScaleArea2",parameter:{scaleArea2:{name:"scaleArea2",index:0,type:"Number"}}},setScaleArea2Node:{method:"setScaleArea2Node",parameter:{scaleArea2Node:{name:"scaleArea2Node",index:0,type:"brease.datatype.Node"}}},setScaleArea3:{method:"setScaleArea3",parameter:{scaleArea3:{name:"scaleArea3",index:0,type:"Number"}}},setScaleArea3Node:{method:"setScaleArea3Node",parameter:{scaleArea3Node:{name:"scaleArea3Node",index:0,type:"brease.datatype.Node"}}},setScaleArea4:{method:"setScaleArea4",parameter:{scaleArea4:{name:"scaleArea4",index:0,type:"Number"}}},setScaleArea4Node:{method:"setScaleArea4Node",parameter:{scaleArea4Node:{name:"scaleArea4Node",index:0,type:"brease.datatype.Node"}}},setScaleArea5:{method:"setScaleArea5",parameter:{scaleArea5:{name:"scaleArea5",index:0,type:"Number"}}},setScaleArea5Node:{method:"setScaleArea5Node",parameter:{scaleArea5Node:{name:"scaleArea5Node",index:0,type:"brease.datatype.Node"}}},setScaleAreaInPercent:{method:"setScaleAreaInPercent",parameter:{scaleAreaInPercent:{name:"scaleAreaInPercent",index:0,type:"Boolean"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},setStartAngle:{method:"setStartAngle",parameter:{startAngle:{name:"startAngle",index:0,type:"Number"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setTransitionTime:{method:"setTransitionTime",parameter:{transitionTime:{name:"transitionTime",index:0,type:"UInteger"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{scaleArea0:{nodeRefId:"scaleArea0Node"},scaleArea1:{nodeRefId:"scaleArea1Node"},
scaleArea2:{nodeRefId:"scaleArea2Node"},scaleArea3:{nodeRefId:"scaleArea3Node"},scaleArea4:{nodeRefId:"scaleArea4Node"},scaleArea5:{nodeRefId:"scaleArea5Node"},value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/RadialGauge/libs/Config",[],function(){"use strict";return{value:0,format:{default:{decimalPlaces:1,minimumIntegerDigits:1}},showUnit:!1,minValue:0,maxValue:100,majorTicks:5,minorTicks:1,startAngle:225,scaleArea0:0,scaleArea1:20,scaleArea2:40,scaleArea3:60,scaleArea4:80,scaleArea5:100,height:200,width:200,scaleAreaInPercent:!0,range:270,transitionTime:500}}),define("widgets/brease/RadialGauge/libs/Renderer",["brease/core/Class","libs/d3/d3","brease/core/Types","widgets/brease/common/libs/redux/utils/UtilsSize"],function(e,t,Types,UtilsSize){"use strict";var i=5,Renderer=e.extend(function Renderer(t){e.call(this),this.widget=t,this.settings=t.settings,this.data=t.data,this.initialize()},null),s=Renderer.prototype;s.initialize=function(){l(this),this._setSize(),this.backgroundShape=$("<div/>").addClass("backShape").css("width",this._getSize()+"px").css("height",this._getSize()+"px").css("border-radius","50%"),this.widget.el.append(this.backgroundShape),this.svgContainer=t.select("#"+this.widget.elem.id).append("svg").attr("width",this._getSize()).attr("height",this._getSize()).attr("class","gaugeContainer"),this.textContainer=t.select("#"+this.widget.elem.id).append("svg").attr("width",this._getSize()).attr("height",this._getSize()).attr("class","textContainer"),this.updateScaleAreas(),this.calcMajorTick(),this.calcMinorTick(),this.calcPointer(),this.drawText()},s._setSize=function(){this.widgetWidth=UtilsSize.getWidth(this.widget.settings.width,this.widget.elem),this.widgetHeight=UtilsSize.getHeight(this.widget.settings.height,this.widget.elem),this.settings.size=Math.min(parseInt(this.widgetWidth,10),parseInt(this.widgetHeight,10))},s._getSize=function(){return this.settings.size},s.updateScaleAreas=function(){var e=!0===this.settings.scaleAreaInPercent?100:Types.parseValue(this.data.node.getMaxValue(),"Number",{default:this.settings.maxValue}),t=!0===this.settings.scaleAreaInPercent?0:Types.parseValue(this.data.node.getMinValue(),"Number",{default:this.settings.minValue});this.scaleData=[];for(var i=0;i<5;++i)this.scaleData.push({startAngle:Types.parseValue(this.widget.data.arrScaleAreaNode[i].value,"Number",{min:t,max:e,default:20*i}),endAngle:Types.parseValue(this.widget.data.arrScaleAreaNode[i+1].value,"Number",{min:t,max:e,default:20*i+20}),pieClass:"area"+(i+1)});a(this)},s.calcMajorTick=function(){this.settings.majorTickAngle=[],this.settings.majorTickPosX=[],this.settings.majorTickPosY=[],this.settings.numberPosX=[],this.settings.numberPosY=[];var e=360,t=[],i=[],s=[],n=[],a=(this.settings.outerRadius-this.settings.innerRadius)/1.25;if(this.settings.majorTickAngle[0]=this.settings.startAngle,this.settings.majorTicks>0){this.settings.majorTickAngle[1]=this.settings.startAngle+this.settings.range/this.settings.majorTicks;for(var o=2;o<this.settings.majorTicks+1;o+=1)this.settings.majorTickAngle[o]=this.settings.majorTickAngle[o-1]+this.settings.range/this.settings.majorTicks}for(var l=0;l<this.settings.majorTicks+1;l+=1)this.settings.majorTickAngle[l]>=360&&(this.settings.majorTickAngle[l]-=360),this.settings.majorTickAngle[l]>=0&&this.settings.majorTickAngle[l]<90?(t[l]=Math.sin(this.settings.majorTickAngle[l]*Math.PI/180)*this.settings.innerRadius,i[l]=Math.cos(this.settings.majorTickAngle[l]*Math.PI/180)*this.settings.innerRadius,this.settings.majorTickPosX[l]=this.settings.radius+t[l],this.settings.majorTickPosY[l]=this.settings.radius-i[l],s[l]=Math.sin(this.settings.majorTickAngle[l]*Math.PI/180)*(this.settings.outerRadius+a),n[l]=Math.cos(this.settings.majorTickAngle[l]*Math.PI/180)*(this.settings.outerRadius+a),this.settings.numberPosX[l]=this.settings.radius+s[l],this.settings.numberPosY[l]=this.settings.radius-n[l]):this.settings.majorTickAngle[l]>=90&&this.settings.majorTickAngle[l]<180?(t[l]=Math.cos((this.settings.majorTickAngle[l]-90)*Math.PI/180)*this.settings.innerRadius,i[l]=Math.sin((this.settings.majorTickAngle[l]-90)*Math.PI/180)*this.settings.innerRadius,this.settings.majorTickPosX[l]=this.settings.radius+t[l],this.settings.majorTickPosY[l]=this.settings.radius+i[l],s[l]=Math.cos((this.settings.majorTickAngle[l]-90)*Math.PI/180)*(this.settings.outerRadius+a),n[l]=Math.sin((this.settings.majorTickAngle[l]-90)*Math.PI/180)*(this.settings.outerRadius+a),this.settings.numberPosX[l]=this.settings.radius+s[l],this.settings.numberPosY[l]=this.settings.radius+n[l]):this.settings.majorTickAngle[l]>=180&&this.settings.majorTickAngle[l]<270?(t[l]=Math.sin((this.settings.majorTickAngle[l]-180)*Math.PI/180)*this.settings.innerRadius,i[l]=Math.cos((this.settings.majorTickAngle[l]-180)*Math.PI/180)*this.settings.innerRadius,this.settings.majorTickPosX[l]=this.settings.radius-t[l],this.settings.majorTickPosY[l]=this.settings.radius+i[l],s[l]=Math.sin((this.settings.majorTickAngle[l]-180)*Math.PI/180)*(this.settings.outerRadius+a),n[l]=Math.cos((this.settings.majorTickAngle[l]-180)*Math.PI/180)*(this.settings.outerRadius+a),this.settings.numberPosX[l]=this.settings.radius-s[l],this.settings.numberPosY[l]=this.settings.radius+n[l]):this.settings.majorTickAngle[l]>=270&&this.settings.majorTickAngle[l]<360&&(t[l]=Math.cos((this.settings.majorTickAngle[l]-270)*Math.PI/180)*this.settings.innerRadius,i[l]=Math.sin((this.settings.majorTickAngle[l]-270)*Math.PI/180)*this.settings.innerRadius,this.settings.majorTickPosX[l]=this.settings.radius-t[l],this.settings.majorTickPosY[l]=this.settings.radius-i[l],s[l]=Math.cos((this.settings.majorTickAngle[l]-270)*Math.PI/180)*(this.settings.outerRadius+a),n[l]=Math.sin((this.settings.majorTickAngle[l]-270)*Math.PI/180)*(this.settings.outerRadius+a),this.settings.numberPosX[l]=this.settings.radius-s[l],this.settings.numberPosY[l]=this.settings.radius-n[l]);r(this)},s.calcMinorTick=function(){if(this.settings.majorTicks>0){this.settings.totalMinorTicks=this.settings.minorTicks*this.settings.majorTicks+this.settings.majorTicks,this.settings.minorTickAngle=[],this.settings.minorPosX=[],this.settings.minorPosY=[];var e=360,t=this.settings.range/this.settings.totalMinorTicks,i=[],s=[];if(this.settings.minorTicks>0){this.settings.minorTickAngle[0]=this.settings.startAngle+t;for(var n=1;n<this.settings.totalMinorTicks;n+=1)this.settings.minorTickAngle[n]=this.settings.startAngle+t*(n+1);for(var a=0;a<this.settings.totalMinorTicks;a+=1)this.settings.minorTickAngle[a]>=360&&(this.settings.minorTickAngle[a]-=360),this.settings.minorTickAngle[a]>=0&&this.settings.minorTickAngle[a]<90?(i[a]=Math.sin(this.settings.minorTickAngle[a]*Math.PI/180)*this.settings.innerRadius,s[a]=Math.cos(this.settings.minorTickAngle[a]*Math.PI/180)*this.settings.innerRadius,this.settings.minorPosX[a]=this.settings.radius+i[a],this.settings.minorPosY[a]=this.settings.radius-s[a]):this.settings.minorTickAngle[a]>=90&&this.settings.minorTickAngle[a]<180?(i[a]=Math.cos((this.settings.minorTickAngle[a]-90)*Math.PI/180)*this.settings.innerRadius,s[a]=Math.sin((this.settings.minorTickAngle[a]-90)*Math.PI/180)*this.settings.innerRadius,this.settings.minorPosX[a]=this.settings.radius+i[a],this.settings.minorPosY[a]=this.settings.radius+s[a]):this.settings.minorTickAngle[a]>=180&&this.settings.minorTickAngle[a]<270?(i[a]=Math.sin((this.settings.minorTickAngle[a]-180)*Math.PI/180)*this.settings.innerRadius,s[a]=Math.cos((this.settings.minorTickAngle[a]-180)*Math.PI/180)*this.settings.innerRadius,this.settings.minorPosX[a]=this.settings.radius-i[a],this.settings.minorPosY[a]=this.settings.radius+s[a]):this.settings.minorTickAngle[a]>=270&&this.settings.minorTickAngle[a]<360&&(i[a]=Math.cos((this.settings.minorTickAngle[a]-270)*Math.PI/180)*this.settings.innerRadius,s[a]=Math.sin((this.settings.minorTickAngle[a]-270)*Math.PI/180)*this.settings.innerRadius,this.settings.minorPosX[a]=this.settings.radius-i[a],this.settings.minorPosY[a]=this.settings.radius-s[a]);o(this)}}},s.calcPointer=function(){var e=.04,t=.75;this.settings.knobRadius=.04*this._getSize()*.5,this.needleData=[{M1:"M"+this.settings.radius+","+(this.settings.radius-this.settings.innerRadius)+" ",L1:"L"+(this.settings.radius-.75*this.settings.knobRadius)+","+this.settings.radius+" ",L2:"L"+(this.settings.radius+.75*this.settings.knobRadius)+","+this.settings.radius+" ",M2:"L"+this.settings.radius+","+(this.settings.radius-this.settings.innerRadius)+" Z"}],this.drawPointer()},s.drawPointer=function(){this.groupToRotate=this.svgContainer.append("g").attr("class","groupToRotate"),this.groupPointer=this.groupToRotate.append("g").attr("class","groupPointer"),this.pointerNeedle=this.groupPointer.selectAll("path").data(this.needleData).enter().append("path").attr("class","needle").attr("d",function(e){return e.M1+e.L1+e.L2+e.M2}),this.pointerKnob=this.groupPointer.append("circle").attr("cx",this.settings.radius).attr("cy",this.settings.radius).attr("r",this.settings.knobRadius).attr("class","knob"),this.updateNeedle()},s.updateNeedle=function(){this.groupToRotate.attr("transform","rotate("+this.settings.startAngle+" "+this.settings.radius+","+this.settings.radius+")"),this.settings.minMaxScale=t.scale.linear().domain([this.data.node.minValue,this.data.node.maxValue]).range([0,this.settings.range]),this.data.node.value>this.data.node.maxValue?(this.settings.oldPosition=this.settings.actPosition,this.settings.actPosition=this.settings.range):this.data.node.value<this.data.node.minValue?(this.settings.oldPosition=this.settings.actPosition,this.settings.actPosition=0):(this.settings.oldPosition=this.settings.actPosition,this.settings.actPosition=this.settings.minMaxScale(this.data.node.value)),this.groupPointer.transition().duration(this.widget.settings.transitionTime).attrTween("transform",_.bind(function(){return void 0!==this.settings.oldPosition?t.interpolateString("rotate("+this.settings.oldPosition+" "+this.settings.radius+","+this.settings.radius+")","rotate("+this.settings.actPosition+" "+this.settings.radius+","+this.settings.radius+")"):t.interpolateString("rotate(0 "+this.settings.radius+","+this.settings.radius+")","rotate("+this.settings.actPosition+" "+this.settings.radius+","+this.settings.radius+")")},this))},s.writeNumbers=function(){var e;e=this.settings.majorTicks>0?(this.data.node.maxValue-this.data.node.minValue)/this.settings.majorTicks:0;for(var t=0;t<this.settings.majorTicks+1;t+=1)void 0!==this.settings.numberFormat&&this.majorNumbers[t].text(brease.formatter.formatNumber(this.data.node.minValue+t*e,this.settings.numberFormat,this.settings.useDigitGrouping,this.settings.separators))},s.drawText=function(){var e=this._getSize(),t=.5*(360-this.settings.range),i=(this.settings.startAngle+this.settings.range)%360+t;this.groupText=this.textContainer.append("g").attr("class","groupText"),this.textElement=this.groupText.append("text").attr("x","50%").attr("y","20%"),this.unitElement=this.groupText.append("text").attr("x","50%").attr("y","27%"),this.textContainer.style("transform",n.call(this)+" rotate("+i+"deg)"),this.groupText.attr("transform","rotate("+-1*i+", "+.5*e+", "+.2*e+")")},s.redraw=function(){this.widget.el.find(".groupMajorTicks").remove(),this.widget.el.find(".groupMinorTicks").remove(),this.widget.el.find(".groupNumbers").remove(),this.widget.el.find(".groupScaleAreas").remove(),this.widget.el.find(".groupToRotate").remove(),this.widget.el.find(".textContainer").children().remove(),this._setSize(),this._resizeContainers(),this.backgroundShape.css({"border-radius":"50%",transform:n.call(this)}),this.svgContainer.style("transform",n.call(this)),this.updateScaleAreas(),this.calcMajorTick(),this.calcMinorTick(),this.calcPointer(),this.writeNumbers(),this.drawText(),this.widget.writeUnit(this.widget.settings.unitSymbol),this.textElement.text(this.widget.settings.text)},s._resizeContainers=function(){this.backgroundShape.css("width",this._getSize()).css("height",this._getSize()),this.svgContainer.attr("width",this._getSize()).attr("height",this._getSize()),this.textContainer.attr("width",this._getSize()).attr("height",this._getSize())};function n(){return"translate("+.5*(this.widgetWidth-this._getSize())+"px, "+.5*(this.widgetHeight-this._getSize())+"px)"}function a(renderer){var e,i=.7,s=.55,n=renderer.settings.range*Math.PI/180;renderer.settings.radius=parseInt(.5*renderer._getSize(),10),renderer.settings.innerRadius=.55*renderer.settings.radius,renderer.settings.outerRadius=.7*renderer.settings.radius,void 0!==renderer.arc&&renderer.widget.el.find(".groupScaleAreas").remove(),e=renderer.settings.scaleAreaInPercent?t.scale.linear().domain([0,100]).range([0,n]):t.scale.linear().domain([renderer.data.node.minValue,renderer.data.node.maxValue]).range([0,n]),renderer.arc=t.svg.arc().innerRadius(renderer.settings.innerRadius).outerRadius(renderer.settings.outerRadius).startAngle(function(t){return e(t.startAngle)}).endAngle(function(t){return e(t.endAngle)}),renderer.groupScaleAreas=renderer.svgContainer.insert("g",":first-child").attr("class","groupScaleAreas"),renderer.groupScaleAreas.selectAll("path").data(renderer.scaleData).enter().append("path").attr("d",renderer.arc).attr("class",function(e){return e.pieClass}).attr("transform","translate("+renderer.settings.radius+","+.5*renderer._getSize()+") rotate("+renderer.settings.startAngle+")")}function r(renderer){var e=[],t=renderer.settings.outerRadius-renderer.settings.innerRadius;renderer.majorNumbers=[],renderer.groupMajorTicks=renderer.svgContainer.append("g").attr("class","groupMajorTicks"),renderer.groupMajorNumbers=renderer.svgContainer.append("g").attr("class","groupNumbers");for(var i=0;i<renderer.settings.majorTicks+1;i+=1)e[i]=renderer.groupMajorTicks.append("line").attr("class","majorTick").attr("id","major"+i).attr("x1",renderer.settings.majorTickPosX[i]).attr("x2",renderer.settings.majorTickPosX[i]+t).attr("y1",renderer.settings.majorTickPosY[i]).attr("y2",renderer.settings.majorTickPosY[i]),renderer.widget.el.find("#major"+i).css({transform:"rotate("+(renderer.settings.majorTickAngle[i]-90)+"deg)"}),renderer.majorNumbers[i]=renderer.groupMajorNumbers.append("text").attr("x",renderer.settings.numberPosX[i]).attr("y",renderer.settings.numberPosY[i])}function o(renderer){var e=[],t=.5*(renderer.settings.outerRadius-renderer.settings.innerRadius);renderer.groupMinorTicks=renderer.svgContainer.append("g").attr("class","groupMinorTicks");for(var i=0;i<renderer.settings.totalMinorTicks;i+=1)e[i]=renderer.groupMinorTicks.append("line").attr("class","minorTick").attr("id","minor"+i).attr("x1",renderer.settings.minorPosX[i]).attr("x2",renderer.settings.minorPosX[i]+t).attr("y1",renderer.settings.minorPosY[i]).attr("y2",renderer.settings.minorPosY[i]),renderer.widget.el.find("#minor"+i).css({transform:"rotate("+(renderer.settings.minorTickAngle[i]-90)+"deg)"})}function l(e){e.settings.majorTicks=parseInt(e.settings.majorTicks,10),e.settings.minorTicks=parseInt(e.settings.minorTicks,10),e.settings.startAngle=Number(e.settings.startAngle),e.settings.scaleArea0=Number(e.settings.scaleArea0),e.settings.scaleArea1=Number(e.settings.scaleArea1),e.settings.scaleArea2=Number(e.settings.scaleArea2),e.settings.scaleArea3=Number(e.settings.scaleArea3),e.settings.scaleArea4=Number(e.settings.scaleArea4),e.settings.scaleArea5=Number(e.settings.scaleArea5)}return Renderer}),define("text!widgets/brease/RadialGauge/RadialGauge.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/RadialGauge"></div>\r\n'}),define("widgets/brease/RadialGauge/RadialGauge",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/decorators/LanguageDependency","brease/decorators/MeasurementSystemDependency","brease/datatype/Node","brease/config/NumberFormat","brease/core/Utils","brease/core/Types","widgets/brease/RadialGauge/libs/Config","widgets/brease/RadialGauge/libs/Renderer","widgets/brease/common/libs/wfUtils/UtilsObject","brease/decorators/DragAndDropCapability","widgets/brease/common/libs/BreaseResizeObserver","brease/decorators/ContentActivatedDependency","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,t,i,Node,NumberFormat,Utils,Types,Config,Renderer,UtilsObject,s,BreaseResizeObserver,n){"use strict";var a=Config,r=e.extend(function RadialGauge(){e.apply(this,arguments)},a),o=r.prototype;o.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseRadialGauge"),this.data={node:new Node(this.settings.value,null,this.settings.minValue,this.settings.maxValue),arrScaleAreaNode:[new Node(this.settings.scaleArea0),new Node(this.settings.scaleArea1),new Node(this.settings.scaleArea2),new Node(this.settings.scaleArea3),new Node(this.settings.scaleArea4),new Node(this.settings.scaleArea5)]},this.unitChangePromise=null,this.nodeChangeResolve=null,this.scaleNodeChangeResolve=null,this.scaleAreasNodeChangeResolve=[],v(this),this.settings.startAngle=this.settings.startAngle%360,this.settings.range=this.settings.range%360,this.renderer=new Renderer(this),u(this),this.observer=new BreaseResizeObserver(this.elem,this._bind("redrawView")),e.prototype.init.call(this),this.addListeners()},o._initEditor=function(){var e=this;require(["widgets/brease/common/libs/EditorHandlesSquare"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.designer.isSquare=function(){return!0},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0})),e.observer.init()}),this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,this._bind(this._editorStyleChanged))},o.contentActivatedHandler=function(){this.observer.initialized?this.observer.wake():this.observer.init()},o.setFormat=function(e){this.settings.format=e,g(this)},o.getFormat=function(){return this.settings.format},o.setMinValue=function(e){Utils.isNumeric(e)&&(this.data.node.setMinValue(e),this.renderer.writeNumbers(),this.renderer.updateNeedle(),this.renderer.updateScaleAreas())},o.getMinValue=function(){return this.data.node.minValue},o.setMaxValue=function(e){Utils.isNumeric(e)&&(this.data.node.setMaxValue(e),this.renderer.writeNumbers(),this.renderer.updateNeedle(),this.renderer.updateScaleAreas())},o.getMaxValue=function(){return this.data.node.maxValue},o.setMajorTicks=function(e){this.settings.majorTicks=parseInt(e,10),this.el.find(".groupMajorTicks").remove(),this.el.find(".groupMinorTicks").remove(),this.el.find(".groupNumbers").remove(),this.renderer.calcMajorTick(),this.renderer.calcMinorTick(),this.renderer.writeNumbers()},o.getMajorTicks=function(){return this.settings.majorTicks},o.setMinorTicks=function(e){this.settings.minorTicks=parseInt(e,10),this.el.find(".groupMinorTicks").remove(),this.renderer.calcMinorTick()},o.getMinorTicks=function(){return this.settings.minorTicks},o.setStartAngle=function(e){this.settings.startAngle=Types.parseValue(e,"Number",{min:0})%360,this.el.find(".groupMajorTicks").remove(),this.el.find(".groupMinorTicks").remove(),this.el.find(".groupNumbers").remove(),this.el.find(".groupText").remove(),this.renderer.updateScaleAreas(),this.renderer.calcMajorTick(),this.renderer.calcMinorTick(),this.renderer.updateNeedle(),this.renderer.drawText(),this.renderer.writeNumbers(),this.setText(this.settings.text)},o.getStartAngle=function(){return this.settings.startAngle},o.setNode=function(e){void 0!==e.minValue&&this.data.node.minValue!==e.minValue&&this.data.node.setMinValue(e.minValue),void 0!==e.maxValue&&this.data.node.maxValue!==e.maxValue&&this.data.node.setMaxValue(e.maxValue),void 0!==e.value&&this.data.node.setValue(e.value),this.nodeChangeResolve?this.nodeChangeResolve():(this.renderer.writeNumbers(),this.renderer.updateNeedle(),this.renderer.updateScaleAreas())},o.getNode=function(){return this.data.node},o.setValue=function(e){void 0!==e&&this.data.node.setValue(e),this.nodeChangeResolve?this.nodeChangeResolve():this.renderer.updateNeedle()},o.getValue=function(){return this.data.node.value},o._setScaleArea=function(e,t){this.data.arrScaleAreaNode[e].setValue(Types.parseValue(t,"Number")),this.scaleNodeChangeResolve&&this.scaleAreasNodeChangeResolve[e]?this.scaleAreasNodeChangeResolve[e]():this.renderer.updateScaleAreas()},o._setScaleAreaUnit=function(e){this.data.arrScaleAreaNode[e].unit=this.settings.unit[brease.measurementSystem.getCurrentMeasurementSystem()]},o.setScaleArea0=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(0,t)},o.getScaleArea0=function(){return this.data.arrScaleAreaNode[0].getValue()},o.setScaleArea0Node=function(e){this.setScaleArea0(e.value),this._setScaleAreaUnit(0)},o.getScaleArea0Node=function(){return this.data.arrScaleAreaNode[0]},o.setScaleArea1=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(1,t)},o.getScaleArea1=function(){return this.data.arrScaleAreaNode[1].getValue()},o.setScaleArea1Node=function(e){this.setScaleArea1(e.value),this._setScaleAreaUnit(1)},o.getScaleArea1Node=function(){return this.data.arrScaleAreaNode[1]},o.setScaleArea2=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(2,t)},o.getScaleArea2=function(){return this.data.arrScaleAreaNode[2].getValue()},o.setScaleArea2Node=function(e){this.setScaleArea2(e.value),this._setScaleAreaUnit(2)},o.getScaleArea2Node=function(){return this.data.arrScaleAreaNode[2]},o.setScaleArea3=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(3,t)},o.getScaleArea3=function(){return this.data.arrScaleAreaNode[3].getValue()},o.setScaleArea3Node=function(e){this.setScaleArea3(e.value),this._setScaleAreaUnit(3)},o.getScaleArea3Node=function(){return this.data.arrScaleAreaNode[3]},o.setScaleArea4=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(4,t)},o.getScaleArea4=function(){return this.data.arrScaleAreaNode[4].getValue()},o.setScaleArea4Node=function(e){this.setScaleArea4(e.value),this._setScaleAreaUnit(4)},o.getScaleArea4Node=function(){return this.data.arrScaleAreaNode[4]},o.setScaleArea5=function(e){var t=Types.parseValue(e,"Number");void 0!==e&&this._setScaleArea(5,t)},o.getScaleArea5=function(){return this.data.arrScaleAreaNode[5].getValue()},o.setScaleArea5Node=function(e){this.setScaleArea5(e.value),this._setScaleAreaUnit(5)},o.getScaleArea5Node=function(){return this.data.arrScaleAreaNode[5]},o.setText=function(e){this.settings.text=e,this.renderer.textElement.text(e)},o.getText=function(){return this.settings.text},o.setTextKey=function(e){void 0!==e&&(this.settings.textkey=e,this.setLangDependency(!0))},o.getTextKey=function(){return this.settings.textkey},o.setShowUnit=function(e){this.settings.showUnit=e,this.showUnit()},o.getShowUnit=function(){return this.settings.showUnit},o.setUnit=function(e){brease.language.isKey(e)?(this.setLangDependency(!0),this.settings.unitTextKey=brease.language.parseKey(e)):this.settings.unitTextKey=void 0,Utils.isObject(e)?this.settings.unit=e:brease.language.isKey(e)?this.settings.unit=Utils.parsePseudoJSON(brease.language.getTextByKey(this.settings.unitTextKey),y.call(this,e,"unit")):this.settings.unit=Utils.parsePseudoJSON(e,y.call(this,e,"unit")),void 0===e&&(this.settings.unit=void 0),this.processMeasurementSystemUpdate()},o.getUnit=function(){return this.settings.unit},o.setScaleAreaInPercent=function(e){this.settings.scaleAreaInPercent=e,this.renderer.updateScaleAreas()},o.getScaleAreaInPercent=function(){return this.settings.scaleAreaInPercent},o.setRange=function(e){this.settings.range=Types.parseValue(e,"Number",{min:0,max:360})%360,this.el.find(".groupMajorTicks").remove(),this.el.find(".groupMinorTicks").remove(),this.el.find(".groupNumbers").remove(),this.el.find(".groupText").remove(),this.renderer.updateScaleAreas(),this.renderer.calcMajorTick(),this.renderer.calcMinorTick(),this.renderer.updateNeedle(),this.renderer.drawText(),this.renderer.writeNumbers(),this.setText(this.settings.text)},o.getRange=function(){return this.settings.range},o.setTransitionTime=function(e){this.settings.transitionTime=e},o.getTransitionTime=function(){return this.settings.transitionTime},o.showUnit=function(){brease.language.pipeAsyncUnitSymbol(this.data.node.unit,this._bind("writeUnit"))},o.writeUnit=function(e){!0===brease.config.editMode?this.settings.unitSymbol="unit":this.settings.unitSymbol=e,!0===this.settings.showUnit||"true"===this.settings.showUnit?this.renderer.unitElement.text(this.settings.unitSymbol):this.renderer.unitElement.text("")},o.wake=function(){this.addListeners(),e.prototype.wake.apply(this,arguments)},o.suspend=function(){this.observer.suspend(),this.removeListeners(),e.prototype.suspend.apply(this,arguments)},o.dispose=function(){this.observer.dispose(),this.observer=void 0,this.removeListeners(),this.renderer.dispose(),e.prototype.dispose.apply(this,arguments)},o.redrawView=function(){this.renderer&&this.isVisible()&&this.renderer.redraw()};function l(e){e.detail.contentId===this.getParentContentId()&&this.redrawView()}o.addListeners=function(){(isNaN(this.settings.height)||isNaN(this.settings.width))&&brease.bodyEl.on(BreaseEvent.FRAGMENT_SHOW,this._bind(l)),document.body.addEventListener(BreaseEvent.THEME_CHANGED,this._bind("redrawView"))},o.removeListeners=function(){brease.bodyEl.off(BreaseEvent.FRAGMENT_SHOW,this._bind(l)),document.body.removeEventListener(BreaseEvent.THEME_CHANGED,this._bind("redrawView"))},o.langChangeHandler=function(){null!==this.data.node.unit&&!0===this.settings.showUnit&&this.showUnit(),this.settings.textkey&&this.setText(brease.language.getTextByKey(this.settings.textkey))},o.processMeasurementSystemUpdate=function(){var e=this,t=brease.uiController.getSubscriptionsForElement(this.elem.id),i=d(e),s=c(e,t),n=h(e,t);p(e),g(this);var a=[i,s,n];Promise.all(a).then(function(){e.unitChangePromise=null,e.nodeChangeResolve=null,e.scaleChangeResolve=null,e.scaleAreasNodeChangeResolve=[],i=null,m(e),e.renderer.writeNumbers(),e.renderer.updateNeedle(),e.renderer.updateScaleAreas()})};function d(e){return new Promise(function(t){var i=f(e);e.unitChangePromise=t,i?brease.language.pipeAsyncUnitSymbol(i,function(i){e.settings.unitSymbol=i,t(i)}):(e.settings.unitSymbol="",t(""))})}function c(e,t){return new Promise(function(i){e.nodeChangeResolve=i;var s=e.data.node,n=f(e);void 0!==t&&void 0!==t.node&&n&&s.getUnit()!==n?(e.data.node.setUnit(n),e.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:n})):i()})}function h(e,t){return new Promise(function(i){e.scaleNodeChangeResolve=i;var s=e.data.arrScaleAreaNode,n=f(e),a=[];a=s.map(function(i,s){var a="scaleArea"+s;return new Promise(function(r){e.scaleAreasNodeChangeResolve[s]=r,void 0!==t&&void 0!==t[a+"Node"]&&n&&i.getUnit()!==n?(i.setUnit(n),e.sendNodeChange({attribute:a+"Node",nodeAttribute:"unit",value:n})):r()})}),Promise.all(a).then(function(){i()})})}o.measurementSystemChangeHandler=function(){this.processMeasurementSystemUpdate()},o._editorStyleChanged=function(){this.renderer&&this.renderer.redraw()},o._redrawInEditor=function(e,t){void 0!==e&&this._setHeight(e),void 0!==t&&this._setWidth(t),this.renderer&&this.renderer.redraw()},o._visibleHandler=function(){e.prototype._visibleHandler.apply(this,arguments),this.redrawView()};function u(e){e.settings.separators=brease.user.getSeparators(),e.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),g(e),p(e),b(e)}function g(e){brease.language.isKey(e.settings.format)&&e.setLangDependency(!0);var t=UtilsObject.createFormatObject(e.defaultSettings.format,e.settings.format,y.call(e,e.settings.format,"format"));e.settings.numberFormat=NumberFormat.getFormat(t,e.settings.mms),e.settings.separators=brease.user.getSeparators(),e.renderer.writeNumbers()}function m(e){e.writeUnit(e.settings.unitSymbol)}function p(e){if(e.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),Utils.isObject(e.settings.unit)){e.data.node.unit=e.settings.unit[brease.measurementSystem.getCurrentMeasurementSystem()],e.showUnit(),e.setLangDependency(!0);for(var t=0;t<e.data.arrScaleAreaNode.length;t++)e._setScaleAreaUnit(t)}}function f(e){var t=e.settings.unit;return t?t[brease.measurementSystem.getCurrentMeasurementSystem()]:null}function b(e){void 0!==e.settings.text&&(!1===brease.language.isKey(e.settings.text)?e.setText(e.settings.text):(e.setTextKey(brease.language.parseKey(e.settings.text)),e.setText(brease.language.getTextByKey(e.settings.textkey))))}function v(e){void 0!==e.settings.height&&void 0!==e.settings.width||(e.settings.height=parseInt(e.el.css("height"),10),e.settings.width=parseInt(e.el.css("height"),10),e.settings.left=parseInt(e.el.css("height"),10),e.settings.top=parseInt(e.el.css("height"),10))}function y(e,t){return this.elem.id+": "+t+' string "'+e+'" is invalid!'}return n.decorate(s.decorate(i.decorate(t.decorate(r,!1),!0),!1),!0)}),define("text!widgets/brease/Rectangle/Rectangle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Rectangle"></div>\r\n'}),define("widgets/brease/TabControl/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TabControl",parents:["*"],children:["widgets.brease.TabItem"],inheritance:["widgets.brease.TabControl","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetSelectedIndex:{method:"getSelectedIndex"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetSelectedIndex:{method:"setSelectedIndex",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTabPosition:{method:"setTabPosition",parameter:{tabPosition:{name:"tabPosition",index:0,type:"brease.enum.TabPosition"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TabControl/TabControl.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets.brease.TabControl">CONTENT</div>\r\n'}),define("widgets/brease/TabControl/TabControl",["brease/core/ContainerWidget","brease/events/BreaseEvent","brease/enum/Enum","brease/core/Utils","brease/core/ClassUtils","brease/controller/libs/LogCode","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,BreaseEvent,Enum,Utils,ClassUtils,LogCode,UtilsEditableBinding,t){"use strict";var i=brease.uiController,s={selectedIndex:0,oldIndex:0,tabPosition:Enum.TabPosition.top},n=e.extend(function TabControl(){e.apply(this,arguments)},s),a=n.prototype;a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTabControl"),e.prototype.init.call(this),this.$tabItemContainer=this.getContainer().addClass("tabItemContainer"),h(this),o(this)},a.setSelectedIndex=function(e){this.settings.selectedIndex=e,this.showHideContents(e)},a.getSelectedIndex=function(){return this.settings.selectedIndex},a.setTabPosition=function(e){this.settings.tabPosition=e,h(this)},a.getTabPosition=function(){return this.settings.tabPosition},
a.setEditable=function(e,t){UtilsEditableBinding.handleEditable(e,t,this,["selectedIndex","selectedValue"])},a._selectionChangedHandler=function(e){var t=this,i=t.container.children(),s=document.getElementById(e.detail.widgetId),n;if(null!==s)for(n=0;n<i.length;n+=1)if($.containsOrEquals(i[n],s)){t._tabClickHandler(i[n].id);break}},a._tabClickHandler=function(e){if(!0!==this.isDisabled||!1!==brease.config.editMode){var t=this.contents.map(function(e){return e.id}).indexOf(e);this.settings.oldIndex===t||-1===t||(this.setSelectedIndex(t),this.submitChange())}},a.showHideContents=function(e){if(0!==this.contents.length){for(var t=0;t<this.contents.length;t+=1)t===e?brease.callWidget(this.contents[t].id,"show"):brease.callWidget(this.contents[t].id,"hide");this.settings.oldIndex=e}},a.submitChange=function(){this.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{detail:{selectedIndex:this.settings.selectedIndex}})),this.sendValueChange({selectedIndex:this.getSelectedIndex()}),this.createEvent("SelectedIndexChanged",{value:this.getSelectedIndex()}).dispatch()},a.widgetAddedHandler=function(e){var t=document.getElementById(e.detail.widgetId);e.stopPropagation(),t.classList.contains("breaseTabItemContainer")&&!t.parentElement.classList.contains("tabItemContainer")&&this.$tabItemContainer.append(t),t.classList.contains("breaseTabItemContainer")&&(this.tabBar.remove(),o(this))},a.widgetRemovedHandler=function(e){var t=e.detail.widgetId,i=this,s,n;this.contents=$.grep(this.contents,function(e){if(s=$(e),n=s.attr("id"),n===t&&n.length===t.length)return i.tabBar.children().each(function(e,i){var s=$(i);s.attr("id")===t+"_breaseTabItemTab"&&s.remove()}),!0},!0)},a.dispose=function(){if(this.el.off(),$.each(this.contents,function(e,t){$(t).off()}),e.prototype.dispose.call(this),brease.config.editMode){document.getElementsByClassName("iatd-content")[0].removeEventListener("selectionchanged",this._bind("_selectionChangedHandler"))}},a._initEditor=function(){this.settings.height=this.el.height(),this.settings.width=this.el.width(),r(this),document.getElementsByClassName("iatd-content")[0].addEventListener("selectionchanged",this._bind("_selectionChangedHandler")),this.elem.classList.add("iatd-outline")};function r(e){var t={"data-action":"createWidget","data-action-config":'{"type" : "widgets/brease/TabItem", "parentRefId": "'+e.el.attr("id")+'" }'},i=$("<div>");i.addClass("iatd-action").attr(t),i.css({top:0,right:0,position:"absolute",zIndex:500}),e.elControlAdd=i.appendTo(e.el)}function o(e){var t=[];e.$tabItemContainer.children("[data-brease-widget]").each(function(){var e=this,s=$.Deferred();t.push(s),i.getWidgetState(e.id)>=Enum.WidgetState.INITIALIZED?s.resolve():e.addEventListener(BreaseEvent.WIDGET_INITIALIZED,function(e){s.resolve()})}),$.when.apply($,t).done(function(){l(e)})}function l(e){var t=$('<div class="tabbar container iatd-droppable"/>');t.css("flex-grow",0),e.contents=[],e.$tabItemContainer.children("[data-brease-widget]").each(function(){var i=this,s=brease.callWidget(i.id,"widget");ClassUtils.isDerivedFrom(s,"widgets.brease.TabItem")?c(e,s,t):d(e,s)}),e.tabBar=t,e.el.append(e.tabBar),e.setSelectedIndex(e.settings.selectedIndex),brease.config.editMode&&!0!==e.initialization&&(e.elControlAdd=e.elControlAdd.insertAfter(e.container),e.initialization=!0)}function d(e,t){t.dispose();var i=ClassUtils.path2ClassName(t.settings.className),s=ClassUtils.path2ClassName(e.settings.className);if(console.warn('widget of type "'+i+'" not allowed as child in widget "'+e.elem.id+'" ('+s+")"),!brease.config.editMode){var n=LogCode.getConfig(LogCode.CLIENT_INVALID_WIDGET_LOCATION),a=e.settings.parentContentId,r=[i,Utils.getWidgetId(a,e.elem.id),s,a];brease.services.logger.log(n.code,Enum.EventLoggerCustomer.BUR,n.verboseLevel,n.severity,r)}}function c(e,t,i){var s=t.getTabElement();brease.config.editMode&&s.on(BreaseEvent.EDIT.CLICK,function(){e._tabClickHandler(t.elem.id)}),t.setParentId(e.elem.id),i.append(s),e.contents.push(t.elem)}function h(e){var t;switch(e.settings.tabPosition){case Enum.TabPosition.left:t="tabs-left";break;case Enum.TabPosition.right:t="tabs-right";break;case Enum.TabPosition.top:t="tabs-top";break;case Enum.TabPosition.bottom:t="tabs-bottom";break}e.el.removeClass("tabs-left tabs-right tabs-top tabs-bottom").addClass(t)}return t.decorate(n,!1)}),define("widgets/brease/TabItem/designer/ClassExtension",[],function(){"use strict";return{extend:function(e){e.static.getInitialProperties=function(e,t){return{left:0}},e.extended=!0}}}),define("widgets/brease/TabItem/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo","widgets/brease/TabItem/designer/ClassExtension"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TabItem",parents:["widgets.brease.TabControl"],children:["*"],inheritance:["widgets.brease.TabItem","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},RemoveImage:{method:"removeImage"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},setLeft:{method:"setLeft",parameter:{left:{name:"left",index:0,type:"Integer"}}},setMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TabItem/TabItem.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets.brease.TabItem"></div>'}),define("widgets/brease/TabItem/TabItem",["brease/core/ContainerWidget","brease/decorators/LanguageDependency","brease/enum/Enum","brease/core/Types","brease/events/BreaseEvent","widgets/brease/common/libs/wfUtils/UtilsImage","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,t,Enum,Types,BreaseEvent,UtilsImage,i){"use strict";var s={imageAlign:Enum.ImageAlign.left,textAlign:Enum.TextAlign.center,ellipsis:!1,wordWrap:!1,multiLine:!1,height:30,width:100,useSVGStyling:!0},n=e.extend(function TabItem(){e.apply(this,arguments)},s),a=n.prototype;a.init=function(){!0!==this.settings.omitClass&&this.el.addClass("breaseTabItemContainer"),this._createTab(),this._eventHandling(),!1===this.settings.visible&&!0!==brease.config.editMode&&this._setVisible(),e.prototype.init.call(this),this.setStyle(this.settings.style)},a.setStyle=function(e){this.tab[0].classList.remove(this.settings.stylePrefix+"_style_"+this.settings.style),this.settings.style=e,this.tab[0].classList.add(this.settings.stylePrefix+"_style_"+this.settings.style)},a._setWidth=function(e){this.settings.width=e,this.tab[0].style.width=this.settings.width+"px"},a._setHeight=function(e){this.settings.height=e,this.tab[0].style.height=this.settings.height+"px"},a.getTabElement=function(){return this.tab},a.setLeft=function(e){this.settings.left=e,this.tab[0].style.left=this.settings.left+"px"},a.show=function(){this.tab[0].classList.add("active"),this._setVisible(),this.containerVisibility=!0,this.updateChildrenVisibility(),this._imageHandling(),this.elem.dispatchEvent(new CustomEvent(BreaseEvent.VISIBILITY_CHANGED,{bubbles:!1,detail:{visible:!this.isHidden}}))},a.hide=function(){this.tab[0].classList.remove("active"),this._setVisible(),this.containerVisibility=!1,this.updateChildrenVisibility(),this._imageHandling()},a._eventHandling=function(){this.tab.on(BreaseEvent.CLICK,this._bind("_clickHandler")),this.tab.on(BreaseEvent.MOUSE_DOWN,this._bind("_downHandler")),this.tab.on(BreaseEvent.MOUSE_UP,this._bind("_upHandler"))},a._downHandler=function(e){},a._upHandler=function(e){},a._createTab=function(){var e=this.elem.id+"_breaseTabItemTab";this.tab=$("<div id='"+e+"'class='tabItem breaseTabItem' data-brease-container="+this.elem.id+" />").width(this.settings.width).height(this.settings.height),this._appendImgEl(),this._multiLineWordWrapEllipsis(),void 0!==this.settings.text&&(!1===brease.language.isKey(this.settings.text)?this.setText(this.settings.text):this.setTextKey(brease.language.parseKey(this.settings.text))),void 0!==this.settings.image&&this.setImage(this.settings.image),void 0!==this.settings.left&&(this.tab[0].style.left=this.settings.left+"px")},a.suspend=function(){this.tab.off(BreaseEvent.CLICK,this._bind("_clickHandler")),e.prototype.suspend.apply(this,arguments)},a.wake=function(){this.tab.on(BreaseEvent.CLICK,this._bind("_clickHandler")),e.prototype.wake.apply(this,arguments)},a.setParentId=function(e){this.settings.parentId=e},a._clickHandler=function(t){void 0!==this.settings.parentId&&t.currentTarget.id===this.tab[0].id&&brease.callWidget(this.settings.parentId,"_tabClickHandler",this.elem.id),e.prototype._clickHandler.call(this,t,{origin:this.elem.id})},a.updateVisibility=function(t){e.prototype.updateVisibility.apply(this,arguments),t||this._setVisible()},a.langChangeHandler=function(e){if(this.settings.textkey&&(void 0===e||void 0===e.detail||void 0===e.detail.textkey||e.detail.textkey===this.settings.textkey)){var t=brease.language.getTextByKey(this.settings.textkey);t===brease.language.TEXTKEYPREFIX+this.settings.textkey?(this.settings.text=t,r.call(this,t)):this.setText(t,!0)}},a.setText=function(e,t){this.settings.text=e,!1===brease.language.isKey(this.settings.text)?(!0!==t&&this.removeTextKey(),r.call(this,e)):this.setTextKey(brease.language.parseKey(this.settings.text))},a.getText=function(){return this.settings.text},a.setTextKey=function(e){void 0!==e&&(this.settings.textkey=e,this.setLangDependency(!0),this.langChangeHandler())},a.removeTextKey=function(){this.settings.textkey=null,this.setLangDependency(!1)},a.removeText=function(){this.setText(""),this._setClasses()},a.getTextKey=function(){return this.settings.textkey},a.setImage=function(e,t){this.settings.image=e,this._imageHandling(),this._setClasses()},a.getImage=function(){return this.settings.image},a.removeImage=function(){this._hideImages(),this.settings.image=void 0,this._setClasses()},a.setMouseDownImage=function(e){this.settings.mouseDownImage=e,this._imageHandling(),this._setClasses()},a.getMouseDownImage=function(){return this.settings.mouseDownImage},a.setImageAlign=function(e){this.settings.imageAlign=e,e===Enum.ImageAlign.left||e===Enum.ImageAlign.top?this.tab.append(this.textEl):e!==Enum.ImageAlign.right&&e!==Enum.ImageAlign.bottom||this.tab.prepend(this.textEl),this._setClasses()},a.getImageAlign=function(){return this.settings.imageAlign},a.setEllipsis=function(e){this.settings.ellipsis=e,this._multiLineWordWrapEllipsis()},a.getEllipsis=function(){return this.settings.ellipsis},a.setWordWrap=function(e){this.settings.wordWrap=e,this._multiLineWordWrapEllipsis()},a.getWordWrap=function(){return this.settings.wordWrap},a.setMultiLine=function(e){this.settings.multiLine=e,this._multiLineWordWrapEllipsis()},a.getMultiLine=function(){return this.settings.multiLine},a.setUseSVGStyling=function(e){this.settings.useSVGStyling=Types.parseValue(e,"Boolean",{default:!0}),this.setImage(this.settings.image,!1)},a.getUseSVGStyling=function(){return this.settings.useSVGStyling},a.dispose=function(){this.tab.off(),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_upHandler")),e.prototype.dispose.call(this)},a._appendTextEl=function(){this.textEl=$("<span></span>"),!this.imgEl||this.settings.imageAlign!==Enum.ImageAlign.right&&this.settings.ImageAlign!==Enum.ImageAlign.bottom?this.tab[0].appendChild(this.textEl[0]):this.tab[0].insertBefore(this.textEl[0],this.tab[0].firstChild)},a._appendImgEl=function(){this.imgEl=$("<img/>"),this.svgEl=$("<svg/>"),!this.textEl||this.settings.imageAlign!==Enum.ImageAlign.left&&this.settings.imageAlign!==Enum.ImageAlign.top?(this.tab[0].appendChild(this.imgEl[0]),this.tab[0].appendChild(this.svgEl[0])):(this.tab[0].insertBefore(this.imgEl[0],this.tab[0].firstChild),this.tab[0].insertBefore(this.svgEl[0],this.tab[0].firstChild)),this.imgEl[0].style.display="none",this.svgEl[0].style.display="none"},a._setVisible=function(){!1===this.isHidden?(this.tab[0].classList.remove("remove"),this.tab[0].classList.contains("active")?this.elem.classList.remove("remove"):this.elem.classList.add("remove")):(this.tab[0].classList.add("remove"),this.elem.classList.add("remove"))},a._multiLineWordWrapEllipsis=function(){this.settings.multiLine=Types.parseValue(this.settings.multiLine,"Boolean"),this.settings.wordWrap=Types.parseValue(this.settings.wordWrap,"Boolean"),this.settings.ellipsis=Types.parseValue(this.settings.ellipsis,"Boolean"),!0===this.settings.multiLine?!0===this.settings.wordWrap?(this.tab[0].classList.add("wordWrap"),this.tab[0].classList.remove("multiLine")):(this.tab[0].classList.add("multiLine"),this.tab[0].classList.remove("wordWrap")):(this.tab[0].classList.remove("multiLine"),this.tab[0].classList.remove("wordWrap")),!0===this.settings.ellipsis?this.tab[0].classList.add("ellipsis"):this.tab[0].classList.remove("ellipsis")},a._setClasses=function(){var e;if(void 0!==this.imgEl&&void 0!==this.textEl&&""!==this.settings.text){switch(this.tab[0].classList.remove("image-left","image-right","image-top","image-bottom"),this.settings.imageAlign){case Enum.ImageAlign.left:e="image-left";break;case Enum.ImageAlign.right:e="image-right";break;case Enum.ImageAlign.top:e="image-top";break;case Enum.ImageAlign.bottom:e="image-bottom";break}this.tab[0].classList.add(e)}else this.tab[0].classList.remove("image-left","image-right","image-top","image-bottom")},a._imageHandling=function(){this.tab[0].classList.contains("active")?void 0!==this.settings.mouseDownImage&&""!==this.settings.mouseDownImage?this._imageSet(this.settings.mouseDownImage):void 0!==this.settings.mouseDownImage&&""!==this.settings.mouseDownImage||void 0===this.settings.image||""===this.settings.image?this._hideImages():this._imageSet(this.settings.image):void 0!==this.settings.image&&""!==this.settings.image?this._imageSet(this.settings.image):this._hideImages()},a._imageSet=function(e){var t=this;UtilsImage.isStylable(e)&&this.settings.useSVGStyling?(this.imgEl[0].style.display="none",UtilsImage.getInlineSvg(e).then(function(e){t.svgEl.replaceWith(e),t.svgEl=e,t.svgEl[0].style.display="block"})):(this.imgEl[0].style.display="block",this.svgEl[0].style.display="none",this.imgEl.attr("src",e))},a._hideImages=function(){this.svgEl[0].style.display="none",this.imgEl[0].style.display="none"},a._initEditor=function(){var e=this;e.isRotatable=function(){return!1},e.isResizable=function(){return!1},require(["widgets/brease/TabItem/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return e.el}})};function r(e){void 0===this.textEl&&this._appendTextEl(),this.textEl.text(e),this._setClasses()}return i.decorate(t.decorate(n,!1),!1)}),define("widgets/brease/Table/designer/ClassInfo",["brease/core/designer/ContainerWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.Table",parents:["*"],children:["widgets.brease.TableItem","widgets.brease.TableItemImageList","widgets.brease.TableItemDateTime"],inheritance:["widgets.brease.Table","brease.core.ContainerWidget","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},OpenConfiguration:{method:"openConfiguration",parameter:{type:{name:"type",index:0,type:"TableConfigurationType"}}},ScrollPageDown:{method:"scrollPageDown"},ScrollPageLeft:{method:"scrollPageLeft"},ScrollPageRight:{method:"scrollPageRight"},ScrollPageUp:{method:"scrollPageUp"},ScrollStepDown:{method:"scrollStepDown"},ScrollStepLeft:{method:"scrollStepLeft"},ScrollStepRight:{method:"scrollStepRight"},ScrollStepUp:{method:"scrollStepUp"},ScrollToHorizontal:{method:"scrollToHorizontal",parameter:{value:{name:"value",index:0,type:"UInteger"}}},ScrollToVertical:{method:"scrollToVertical",parameter:{value:{name:"value",index:0,type:"UInteger"}}},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBusyIndicatorDelay:{method:"setBusyIndicatorDelay",parameter:{busyIndicatorDelay:{name:"busyIndicatorDelay",index:0,type:"Integer"}}},setColumnData:{method:"setColumnData",parameter:{data:{name:"data",index:0,type:"Object"},columnIndex:{name:"columnIndex",index:1,type:"Integer"}}},SetColumnVisibility:{method:"setColumnVisibility",parameter:{index:{name:"index",index:0,type:"Integer"},visible:{name:"visible",index:1,type:"Boolean"}}},setColumnWidth:{method:"setColumnWidth",parameter:{columnWidth:{name:"columnWidth",index:0,type:"Size"}}},setDataOrientation:{method:"setDataOrientation",parameter:{dataOrientation:{name:"dataOrientation",index:0,type:"brease.enum.Direction"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFilterConfiguration:{method:"setFilterConfiguration",parameter:{filterConfiguration:{name:"filterConfiguration",index:0,type:"String"}}},setHeaderSize:{method:"setHeaderSize",parameter:{headerSize:{name:"headerSize",index:0,type:"UInteger"}}},setHorizontalScroll:{method:"setHorizontalScroll",parameter:{position:{name:"position",index:0,type:"Integer"},origin:{name:"origin",index:1,type:"String"}}},setInitRefreshRate:{method:"setInitRefreshRate",parameter:{initRefreshRate:{name:"initRefreshRate",index:0,type:"Integer"}}},setMaxHeight:{method:"setMaxHeight",parameter:{maxHeight:{name:"maxHeight",index:0,type:"Integer"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setOffsetColumn:{method:"setOffsetColumn",parameter:{offsetColumn:{name:"offsetColumn",index:0,type:"Integer"}}},setOffsetRow:{method:"setOffsetRow",parameter:{offsetRow:{name:"offsetRow",index:0,type:"Integer"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setRefreshRate:{method:"setRefreshRate",parameter:{refreshRate:{name:"refreshRate",index:0,type:"Integer"}}},setRowData:{method:"setRowData",parameter:{data:{name:"data",index:0,type:"Object"},rowIndex:{name:"rowIndex",index:1,type:"Integer"}}},setRowHeight:{method:"setRowHeight",parameter:{rowHeight:{name:"rowHeight",index:0,type:"Size"}}},SetRowVisibility:{method:"setRowVisibility",parameter:{index:{name:"index",index:0,type:"Integer"},visible:{name:"visible",index:1,type:"Boolean"}}},setScrollLinkXRefId:{method:"setScrollLinkXRefId",parameter:{scrollLinkXRefId:{name:"scrollLinkXRefId",index:0,type:"String"}}},setScrollLinkYRefId:{method:"setScrollLinkYRefId",parameter:{scrollLinkYRefId:{name:"scrollLinkYRefId",index:0,type:"String"}}},SetSelectedColumn:{method:"setSelectedColumn",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetSelectedRow:{method:"setSelectedRow",parameter:{value:{name:"value",index:0,type:"Integer"}}},setSelection:{method:"setSelection",parameter:{selection:{name:"selection",index:0,type:"Boolean"}}},setShowHeader:{method:"setShowHeader",parameter:{showHeader:{name:"showHeader",index:0,type:"Boolean"}}},setShowScrollbars:{method:"setShowScrollbars",parameter:{showScrollbars:{name:"showScrollbars",index:0,type:"Boolean"}}},setShowSortingButton:{method:"setShowSortingButton",parameter:{showSortingButton:{name:"showSortingButton",index:0,type:"Boolean"}}},setStopRefreshAtScroll:{method:"setStopRefreshAtScroll",parameter:{stopRefreshAtScroll:{name:"stopRefreshAtScroll",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setTableConfiguration:{method:"setTableConfiguration",parameter:{tableConfiguration:{name:"tableConfiguration",index:0,type:"String"}}},setTableData:{method:"setTableData",parameter:{init:{name:"init",index:0,type:"Object"}}},setUseTableStyling:{method:"setUseTableStyling",parameter:{useTableStyling:{name:"useTableStyling",index:0,type:"Boolean"}}},setVerticalScroll:{method:"setVerticalScroll",parameter:{position:{name:"position",index:0,type:"Integer"},origin:{name:"origin",index:1,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/Table/libs/Config",["brease/enum/Enum"],function(Enum){"use strict";return{editorFirst:!0,refreshRate:600,initRefreshRate:0,stopRefreshAtScroll:!1,width:400,height:300,maxHeight:0,headerSize:0,rowHeight:30,columnWidth:100,dataOrientation:Enum.Direction.vertical,order:"",permOrder:"",offsetRow:0,offsetColumn:0,selectedRow:0,selectedColumn:0,ellipsis:!1,multiLine:!1,wordWrap:!1,selection:!0,tableItemIds:[],itemVisibility:[],itemFinalVisibility:[],itemRowHeights:[],itemColumnWidths:[],itemStyling:[],itemConfigs:[],itemEnableStates:[],itemFinalEnableState:[],hiddenColumns:[],headerTexts:[],useTableStyling:!0,showSortingButton:!1,visibilityConfiguration:void 0,rendererOptions:{errorMode:"throw",selectableItem:"row",scroller:{scrollY:!0,scrollX:!0,bounce:!1,momentum:!0,scrollDuration:100,pagingItemTolerance:.2,scrollbars:"custom"},selectionCallbackFn:"_selectionCallback",scrollCallbackFn:"_scrollCallback",drawCallbackFn:"_drawCallback",rendererReadyCallbackFn:"_rendererReadyCallback",tableReadyCallbackFn:"_tableReadyCallback",headerClickCallbackFn:"_headerClickCallback"},editor:{first:!0,added:0,editorItemOrder:[]},standalone:!0,showScrollbars:!0,showHeader:!0,tableItemLengths:[],tableItemTypes:[],scrollLinkYRefId:"",scrollLinkXRefId:"",tableConfiguration:"[]",filterConfiguration:"",filter:[],cellVisibility:[],cellDisability:[],busyIndicatorDelay:0}}),define("widgets/brease/Table/libs/ConfigBuilder",[],function(){"use strict";function ConfigBuilder(e){this.widget=e}var e=ConfigBuilder.prototype;e.parseFilter=function(e,i){if(void 0===e||""===e||null===e)return[];var n=this._parseJSON(e.replace(/'/g,'"'),"filter",i);if(void 0===n||0===n.length)return[];var a={},r=[],o;for(o=0;o<n.length;o+=1)a.opVal=s(n[o].conditionType),a.data=n[o].columnPosition,a.comp=n[o].value,a.logVal=t(n[o].logicalOperator),a.logical=n[o].logicalOperator,r.push($.extend(!0,{},a));return r[o-1].logical="",r},e.serializeFilter=function(e){if(void 0===e||""===e)return[];for(var t={},s=[],a=0;a<e.length;a+=1)t.logicalOperator=i(e[a].logVal),t.value=e[a].comp,t.conditionType=n(e[a].opVal),t.columnPosition=e[a].data,s.push($.extend(!0,{},t));return JSON.stringify(s)},e._parseJSON=function(e,t,i){try{return JSON.parse(e)}catch(s){console.warn("The json for the",t,"configuration in the",i,"is invalid"),this.widget._createLogEntry(e,t+"Configuration")}};function t(e){var t;switch(e){case"and":t=0;break;case"or":t=1;break}return t}function i(e){var t;switch(e){case 0:t="and";break;case 1:t="or";break}return t}function s(e){var t;switch(e){case"<>":t=0;break;case"==":t=1;break;case"<":t=2;break;case"<=":t=3;break;case">":t=4;break;case">=":t=5;break;case"Contains":t=6;break;case"Does not contain":t=7;break}return t}function n(e){var t;switch(e){case 0:t="<>";break;case 1:t="==";break;case 2:t="<";break;case 3:t="<=";break;case 4:t=">";break;case 5:t=">=";break;case 6:t="Contains";break;case 7:t="Does not contain";break}return t}return ConfigBuilder}),define("widgets/brease/Table/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{title:"Configuration dialogue for Table",filter:{title:"Filtering",col:"Column",op:"Operator",val:"Value",and:"and",or:"or",act:"Active",inact:"Inactive",actack:"Active Acknowledged",inactack:"Inactive Acknowledged"},tabconf:{title:"Configuration",dir:"Direction",to:"To",from:"From",impose:"Impose",vis:"Visble",enab:"Enabled",inv:"Invisble",dis:"Disabled",row:"Rows",col:"Columns",za:"Z to A",old:"Oldest first",new:"Newest first"}},de:{title:"Konfigurationsdialog für Table",filter:{title:"Filterung",col:"Spalte",op:"Operator",val:"Wert",and:"und",or:"oder",act:"Aktiv",inact:"Inaktiv",actack:"Aktiv & Bestätigen",inactack:"Inaktiv & Bestätigen"},sort:{title:"Sortierung",col:"Spalte",sort:"Sortieren",by:"nach",first:"Zuerst",inc:"aufsteigend",dec:"absteigend",then:"dann",az:"A bis Z",za:"Z bis A",old:"Den ältesten zuerst",new:"Den neusten zuerst"}}}}return new DialogueTexts}),define("widgets/brease/Table/libs/ConfigSettings",["brease/core/Class","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/Table/libs/DialogueTexts"],function(e,Utils,BreaseEvent,t,Texts){"use strict";var i=e.extend(function ConfigSettings(t,i,s){this.lang=s,this.dialog=t,this.widget=i,this.currRow=0,e.call(this)},null),s=i.prototype;return s.initialize=function(){return this.config={},this.config.rows=[],this.config.children={delete_this_row:0,dir:1,enable:2,visible:3,add_next_row:4,rect_separator:5,from:6,to:7,left:{delete_this_row:50,dir:100,add_next_row:10,from:220,to:275,visible:380,disabled:480}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:12,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:100},this.config.loc.rowHeight=this.config.loc.widgetHeight+3*this.config.loc.widgetOffset,this._initializeEmptyDialogConfig(),void 0===this.widget.settings.tableConfiguration.specRows&&void 0===this.widget.settings.tableConfiguration.specColumns||this._differentitateBetweenStoredTypes(),this.config},s._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+(e-1)*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrTop=function(e){return 60+e*this.config.loc.rowHeight+this.config.loc.offset},s._getOneRowOffset=function(e){return e+this.config.loc.rowHeight},s._addRow=function(){for(var e=this._createRow(this.currRow,0,{}),t=0;t<e.length;t+=1)t===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(e[t]);$("#"+e[this.config.children.dir].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+e[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+e[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.push({widgets:e}),this.currRow+=1},s._insertRow=function(e){var t=this._createRow(e,0,{});this._moveRow(e,!1);for(var i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===e||this.dialog.addWidget(t[i]);$("#"+t[this.config.children.dir].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+t[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+t[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.splice(e,0,{widgets:t}),this.currRow+=1},s._updateRowHandler=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.dir);void 0!==t&&(this._reColourNewObject(t),$("#"+this.config.rows[t].widgets[this.config.children.dir].id).off(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[t].widgets[this.config.children.dir].id).on("SelectedIndexChanged",this._bind("_updateRow")))},s._updateRow=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.dir);if(void 0!==t){var i=this._getCurrTop(t);this.config.rows[t].widgets[this.config.children.to]&&(this.dialog.removeWidget(this.config.rows[t].widgets[this.config.children.to]),this.dialog.removeWidget(this.config.rows[t].widgets[this.config.children.from]),this.config.rows[t].widgets.pop(),this.config.rows[t].widgets.pop());for(var s=this._addRange(i,{},e.detail.selectedValue),n=0;n<s.length;n+=1)this.dialog.addWidget(s[n]);this.config.rows[t].widgets=this.config.rows[t].widgets.concat(s)}},s._addRowHandler=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.add_next_row);t===this.currRow?this._addRow():this._insertRow(t)},s._removeRow=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.delete_this_row);if(this.config.rows[t].widgets[this.config.children.delete_this_row].id===e.delegateTarget.id){e.stopPropagation(),$("#"+this.config.rows[t].widgets[this.config.children.delete_this_row].id).off(BreaseEvent.CLICK,this._bind("_removeRow")),$("#"+this.config.rows[t].widgets[this.config.children.dir].id).off("SelectedIndexChanged",this._bind("_updateRow")),$("#"+this.config.rows[t].widgets[this.config.children.add_next_row].id).off(BreaseEvent.CLICK,this._bind("_addRowHandler"));for(var i=0;i<this.config.rows[t].widgets.length-1;i+=1)this.dialog.removeWidget(this.config.rows[t].widgets[i+1]);var s=this;setTimeout(function(){s.dialog.removeWidget(s.config.rows[t].widgets[s.config.children.delete_this_row]),s.config.rows.splice(t,1),s.currRow-=1},0),this._moveRow(t,!0,!0)}},s._moveRow=function(e,t,i){for(var s=e+(void 0!==i||!0===i?1:0),n=s;n<this.config.rows.length;n+=1)for(var a=0;a<this.config.rows[n].widgets.length;a+=1)t?$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))-this.config.loc.rowHeight):$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))+this.config.loc.rowHeight)},s._widgetCollectStateBeforeClosing=function(e){for(var t={},i=[],s=[],n=0;n<this.currRow;n+=1){var a=brease.callWidget(this.config.rows[n].widgets[this.config.children.dir].id,"getSelectedValue"),r=brease.callWidget(this.config.rows[n].widgets[this.config.children.from].id,"getSelectedValue"),o=brease.callWidget(this.config.rows[n].widgets[this.config.children.to].id,"getSelectedValue"),l=0===brease.callWidget(this.config.rows[n].widgets[this.config.children.visible].id,"getSelectedValue"),d=0!==brease.callWidget(this.config.rows[n].widgets[this.config.children.enable].id,"getSelectedValue"),c={};"index"===o?c.index=r-1:(c.from=r-1,c.to=o-1),c.visible=l,c.disable=d,0===a?i.push(c):s.push(c)}return i.length>0&&(t.specRows=i),s.length>0&&(t.specColumns=s),
void 0===this.config?this.widget.settings.tableConfiguration:t},s._reColourFirstLineSeparator=function(){$("#"+this.config.startWidgets[0].id).css("border-width","0px 0px 2px 0px").css("background-color","rgba(0,0,0,0")},s._reColourNewObject=function(e){$("#"+this.config.rows[e].widgets[this.config.children.rect_separator].id).css("border-width","0px 0px 2px 0px").css("background-color","rgba(0,0,0,0")},s._getCurrentRow=function(e,t){if(e.includes("button_add_0"))return 0;for(var i=0;i<this.config.rows.length;i+=1)if(e===this.config.rows[i].widgets[t].id)return this.config.children.add_next_row===t?i+1:i},s._createRow=function(e,t,i){var s=this._getCurrSeparatorTop(e),n=this._getCurrTop(e),a=[],r=Utils.uniqueID(),o={};i.length>0&&void 0!==i[e]&&(o=i[e]),a.push(this._getImage("Button_Delete_"+r,"widgets/brease/Table/assets/Delete.svg",this.config.children.left.delete_this_row,n)),a.push(this._getDropDown("Dropdown_Row_"+r,[{value:0,text:Texts[this.lang].tabconf.row},{value:1,text:Texts[this.lang].tabconf.col}],this.config.children.left.dir,n,100,t)),a.push(this._getDropDown("Dropdown_Disable_"+r,[{value:0,text:Texts[this.lang].tabconf.enab},{value:1,text:Texts[this.lang].tabconf.dis}],this.config.children.left.disabled,n,100,o.disable?1:0)),a.push(this._getDropDown("Dropdown_Visible_"+r,[{value:0,text:Texts[this.lang].tabconf.vis},{value:1,text:Texts[this.lang].tabconf.inv}],this.config.children.left.visible,n,100,o.visible?0:1));var l=n+this.config.loc.rowHeight;return a.push(this._getImage("Button_Add_"+r,"widgets/brease/Table/assets/Add.svg",this.config.children.left.add_next_row,l)),a.push(this._getRect("Rect_Separator_"+r,this.config.children.left.rect_separator,s,600)),a=a.concat(this._addRange(n,o,t)),a},s._differentitateBetweenStoredTypes=function(){void 0!==this.widget.settings.tableConfiguration.specRows&&this._initializeStoredDialogConfig(this.widget.settings.tableConfiguration.specRows,0),void 0!==this.widget.settings.tableConfiguration.specColumns&&this._initializeStoredDialogConfig(this.widget.settings.tableConfiguration.specColumns,1)},s._initializeStoredDialogConfig=function(e,t){for(var i=0;i<e.length;i+=1){for(var s=this._createRow(i,t,e),n=0;n<s.length;n+=1)n===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(s[n]);this.config.rows.push({widgets:s}),this.currRow+=1,$("#"+this.config.rows[i].widgets[this.config.children.dir].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[i].widgets[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+this.config.rows[i].widgets[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow"))}},s._initializeEmptyDialogConfig=function(){this.config.startWidgets=[],this.config.startWidgets.push(this._getRect("tabconf_rect_header",0,50+this.config.loc.offset,600)),this.config.startWidgets.push(this._getLabel("tabconf_label_dir",Texts[this.lang].tabconf.dir,100,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getLabel("tabconf_label_to",Texts[this.lang].tabconf.from,this.config.children.left.from,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getLabel("tabconf_label_from",Texts[this.lang].tabconf.to,this.config.children.left.to,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getLabel("tabconf_label_impose",Texts[this.lang].tabconf.impose,this.config.children.left.visible,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getImage("tabconf_button_add_0","widgets/brease/Table/assets/Add.svg",10,60+this.config.loc.offset));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);$("#"+this.config.startWidgets[5].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler"))},s._addRange=function(e,t,i){var s=Utils.uniqueID(),n=[];return n.push(this._getRange("Dropdown_From_"+s,this.config.children.left.from,e,50,t,i,"from")),n.push(this._getRange("Dropdown_To_"+s,this.config.children.left.to,e,80,t,i,"to")),n},s._getRange=function(e,t,i,s,n,a,r){var o,l,d=[];"to"===r&&(d.push({value:"index",text:"index"}),l="index"),void 0!==n.index&&"to"!==r?l=n.index:void 0!==n.to&&"to"===r?l=n.to:void 0!==n.from&&"from"===r?l=n.from:"from"===r&&(l=0);for(var c=0===a?this.widget.settings.originTableData.length:this.widget.settings.originTableData[0].length,h=0;h<c;h+=1)d.push({value:h,text:h.toString()});return o=this._getDropDown(e,d,t,i,s,l+1),o},s._getDropDown=function(e,i,s,n,a,r,o){void 0===r&&(r=0),void 0===o&&(o="right");var l=new t;return l.name=e,l.type="widgets/brease/DropDownBox",l.x=s,l.y=n,l.width=a,l.height=30,l.options={dataProvider:i,selectedValue:r,listPosition:o,fitHeight2Items:!1},l.result={method:"getSelectedValue"},l},s._getLabel=function(e,i,s,n,a){var r=new t;return r.name=e,r.type="widgets/brease/Label",r.x=s,r.y=n,r.width=a,r.height="30px",r.options={text:i},r},s._getNumericInput=function(e,i,s,n,a,r){void 0===r&&(r=0);var o=new t;return o.name=e,o.type="widgets/brease/NumericInput",o.x=i,o.y=s,o.width=n,o.height="30px",o.options={value:r,useDigitGrouping:this.widget.settings.itemConfigs[a].inputConfig.useDigitGrouping,format:this.widget.settings.itemConfigs[a].inputConfig.format,showUnits:this.widget.settings.itemConfigs[a].inputConfig.showUnits,limitViolationPolicy:this.widget.settings.itemConfigs[a].inputConfig.limitViolationPolicy},o},s._getImage=function(e,i,s,n){var a=new t;return a.name=e,a.type="widgets/brease/Image",a.x=s,a.y=n,a.width="30px",a.height="30px",a.options={image:i},a},s._getRect=function(e,i,s,n){var a=new t;return a.name=e,a.type="widgets/brease/Rectangle",a.x=i,a.y=s,a.width=n,a.height="2px",a.options={borderWidth:"0px 0px 1px 0px"},a},i}),define("widgets/brease/Table/libs/FilterSettings",["brease/core/Class","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/GenericDialog/libs/models/dialogWidgetModel","widgets/brease/Table/libs/DialogueTexts"],function(e,Utils,BreaseEvent,t,Texts){"use strict";var i=e.extend(function FilterSettings(t,i,s){this.lang=s,this.dialog=t,this.widget=i,this.currRow=0,e.call(this)},null),s=i.prototype;return s.initialize=function(){return this.config={},this.config.rows=[],this.config.children={delete_this_row:0,column_picker:1,operator:2,add_next_row:3,logic_op_next_row:4,rect_separator:5,comp_value:6,left:{delete_this_row:50,column_picker:100,operator:270,add_next_row:10,logic_op_next_row:5,rect_separator:70,comp_value:375}},this.config.loc={offset:0,widgetHeight:30,widgetOffset:12,logicalOperatorHeight:20,currSeparatorTopOffset:110,filterlogicalTopOffset:100},this.config.loc.rowHeight=this.config.loc.widgetHeight+3*this.config.loc.widgetOffset,this._initializeEmptyDialogConfig(),0!==this.widget.settings.filter.length&&this._initializeStoredDialogConfig(),this.config},s._getCurrSeparatorTop=function(e){return this.config.loc.currSeparatorTopOffset+e*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrFilterLogicalTop=function(e){return this.config.loc.filterlogicalTopOffset+(e-1)*this.config.loc.rowHeight+this.config.loc.offset},s._getCurrTop=function(e){return 60+e*this.config.loc.rowHeight+this.config.loc.offset},s._getOneRowOffset=function(e){return e+this.config.loc.rowHeight},s._addRow=function(){for(var e=this._createRow(this.currRow),t=0;t<e.length;t+=1)t===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(e[t]);$("#"+e[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+e[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+e[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.push({widgets:e}),this.currRow+=1},s._insertRow=function(e){var t=this._createRow(e);0===e&&this.dialog.addWidget(this.config.rows[e].widgets[this.config.children.logic_op_next_row]),this._moveRow(e,!1);for(var i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===e||this.dialog.addWidget(t[i]);$("#"+t[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+t[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+t[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow")),this.config.rows.splice(e,0,{widgets:t}),this.currRow+=1},s._updateRowHandler=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.column_picker);void 0!==t&&(this._reColourNewObject(t),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).on("SelectedIndexChanged",this._bind("_updateRow")))},s._updateRow=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.column_picker);if(void 0!==t){var i=this._getCurrTop(t);this.config.rows[t].widgets[this.config.children.comp_value]&&(this.dialog.removeWidget(this.config.rows[t].widgets[this.config.children.comp_value]),this.config.rows[t].widgets.pop());var s=[];s.push(this._getValueColumn(e.detail.selectedValue,this.config.children.left.comp_value,i,220));for(var n=0;n<s.length;n+=1)this.dialog.addWidget(s[n]);var a=[];a=this.widget.settings.itemConfigs[e.detail.selectedIndex].type.includes("date")||this.widget.settings.itemConfigs[e.detail.selectedIndex].type.includes("number")?[{value:0,text:"<>"},{value:1,text:"=="},{value:2,text:"<"},{value:3,text:"<="},{value:4,text:">"},{value:5,text:">="}]:[{value:0,text:"<>"},{value:1,text:"=="},{value:2,text:"<"},{value:3,text:"<="},{value:4,text:">"},{value:5,text:">="},{value:6,text:"Contains"},{value:7,text:"Does not contain"}],brease.callWidget(this.config.rows[t].widgets[this.config.children.operator].id,"setDataProvider",a),this.config.rows[t].widgets=this.config.rows[t].widgets.concat(s)}},s._addRowHandler=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.add_next_row);t===this.currRow?this._addRow():this._insertRow(t)},s._removeRow=function(e){var t=this._getCurrentRow(e.delegateTarget.id,this.config.children.delete_this_row);if(this.config.rows[t].widgets[this.config.children.delete_this_row].id===e.delegateTarget.id){e.stopPropagation(),$("#"+this.config.rows[t].widgets[this.config.children.delete_this_row].id).off(BreaseEvent.CLICK,this._bind("_removeRow")),$("#"+this.config.rows[t].widgets[this.config.children.column_picker].id).off("SelectedIndexChanged",this._bind("_updateRow")),$("#"+this.config.rows[t].widgets[this.config.children.add_next_row].id).off(BreaseEvent.CLICK,this._bind("_addRowHandler"));for(var i=0;i<this.config.rows[t].widgets.length-1;i+=1)this.dialog.removeWidget(this.config.rows[t].widgets[i+1]);var s=this;setTimeout(function(){s.dialog.removeWidget(s.config.rows[t].widgets[s.config.children.delete_this_row]),s.config.rows.splice(t,1),s.currRow-=1},0),0===t&&void 0!==this.config.rows[t+1]&&this.dialog.removeWidget(this.config.rows[t+1].widgets[this.config.children.logic_op_next_row]),this._moveRow(t,!0,!0)}},s._moveRow=function(e,t,i){for(var s=e+(void 0!==i||!0===i?1:0),n=s;n<this.config.rows.length;n+=1)for(var a=0;a<this.config.rows[n].widgets.length;a+=1)t?$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))-this.config.loc.rowHeight):$("#"+this.config.rows[n].widgets[a].id).css("top",parseInt($("#"+this.config.rows[n].widgets[a].id).css("top"))+this.config.loc.rowHeight)},s._widgetCollectStateBeforeClosing=function(){for(var e=[],t=0;t<this.currRow;t+=1){var i={logical:"",logVal:2,data:"",op:"",opVal:0,comp:""};if(t<this.currRow-1){var s=this.getSelectedItemFromDataProvider(this.config.rows[t+1].widgets[this.config.children.logic_op_next_row].id);i.logical=s.text,i.logVal=parseInt(s.value)}i.data=parseInt(brease.callWidget(this.config.rows[t].widgets[this.config.children.column_picker].id,"getSelectedValue"));var n=this.getSelectedItemFromDataProvider(this.config.rows[t].widgets[this.config.children.operator].id);i.op=n.text,i.opVal=parseInt(n.value);var a=0;9===this.config.rows[t].widgets.length&&(a=1),i.comp=brease.callWidget(this.config.rows[t].widgets[this.config.children.comp_value-a].id,"getValue"),e.push(i)}return void 0===this.config?this.widget.settings.filter:e},s.getSelectedItemFromDataProvider=function(e){var t,i=brease.callWidget(e,"getDataProvider"),s=brease.callWidget(e,"getSelectedIndex");return i&&s>-1&&(t=i[s]),t},s._reColourFirstLineSeparator=function(){$("#"+this.config.startWidgets[0].id).css("border-width","0px 0px 2px 0px")},s._reColourNewObject=function(e){$("#"+this.config.rows[e].widgets[this.config.children.rect_separator].id).css("border-width","0px 0px 2px 0px")},s._getCurrentRow=function(e,t){if(e.includes("button_add_0"))return 0;for(var i=0;i<this.config.rows.length;i+=1)if(e===this.config.rows[i].widgets[t].id)return this.config.children.add_next_row===t?i+1:i},s._createRow=function(e){var t=this._getCurrSeparatorTop(e),i=this._getCurrFilterLogicalTop(e),s=this._getCurrTop(e),n=[],a=Utils.uniqueID(),r={};this.widget.settings.filter.length>0&&void 0!==this.widget.settings.filter[e]&&(r=this.widget.settings.filter[e]),n.push(this._getImage("Button_Delete_"+a,"widgets/brease/Table/assets/Delete.svg",this.config.children.left.delete_this_row,s)),n.push(this._getDropDownColumn("Dropdown_ColumnPicker_"+a,this.config.children.left.column_picker,s,150,r.data)),n.push(this._getDropDownOperator("Dropdown_Operator_"+a,this.config.children.left.operator,s,85,this.widget.settings.itemConfigs[0].type,r.opVal));var o=s+this.config.loc.rowHeight;n.push(this._getImage("Button_Add_"+a,"widgets/brease/Table/assets/Add.svg",this.config.children.left.add_next_row,o));var l;l=0===e||_.isEmpty(r)?0:this.widget.settings.filter[e-1].logVal,n.push(this._getDropDown("Dropdown_Logical_Filter_"+a,[{value:"0",text:Texts[this.lang].filter.and},{value:"1",text:Texts[this.lang].filter.or}],this.config.children.left.logic_op_next_row,i,60,this.config.loc.logicalOperatorHeight,l)),n.push(this._getRect("Rect_Separator_"+a,this.config.children.left.rect_separator,t,600));var d;return d=void 0!==r.data?r.data:0,n.push(this._getValueColumn(d,this.config.children.left.comp_value,s,220,r.comp)),n},s._initializeStoredDialogConfig=function(){for(var e=0;e<this.widget.settings.filter.length;e+=1){for(var t=this._createRow(e),i=0;i<t.length;i+=1)i===this.config.children.logic_op_next_row&&0===this.currRow||this.dialog.addWidget(t[i]);this.config.rows.push({widgets:t}),this.currRow+=1,$("#"+this.config.rows[e].widgets[this.config.children.column_picker].id).on(BreaseEvent.WIDGET_READY,this._bind("_updateRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.add_next_row].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler")),$("#"+this.config.rows[e].widgets[this.config.children.delete_this_row].id).on(BreaseEvent.CLICK,this._bind("_removeRow"))}},s._initializeEmptyDialogConfig=function(){this.config.startWidgets=[],this.dialog.el.on(BreaseEvent.WIDGET_READY,this._bind("_addCorrectStyle")),this.config.startWidgets.push(this._getRect("filter_rect_header",0,50+this.config.loc.offset,600)),this.config.startWidgets.push(this._getLabel("filter_label_column",Texts[this.lang].filter.col,100,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getLabel("filter_label_operator",Texts[this.lang].filter.op,270,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getLabel("filter_label_value",Texts[this.lang].filter.val,375,20+this.config.loc.offset,100)),this.config.startWidgets.push(this._getImage("filter_button_add_0","widgets/brease/Table/assets/Add.svg",10,60+this.config.loc.offset));for(var e=0;e<this.config.startWidgets.length;e+=1)this.dialog.addWidget(this.config.startWidgets[e]);$("#"+this.config.startWidgets[4].id).on(BreaseEvent.CLICK,this._bind("_addRowHandler"))},s._addCorrectStyle=function(e){var t=e.target.dataset.breaseWidget.split("/")[2],i;e.target.id.includes("filter_label")?(i="widgets_brease_"+t+"_style_tableConfigurationDialogHeaderStyle",e.target.classList.add(i)):(i="widgets_brease_"+t+"_style_tableConfigurationDialogStyle",e.target.classList.add(i))},s.removeEventListeners=function(){this.dialog.el.off(BreaseEvent.WIDGET_READY,this._bind("_addCorrectStyle"))},s._getValueColumn=function(e,t,i,s,n){var a,r=Utils.uniqueID("Value_"+this.currRow);return"date"===this.widget.settings.itemConfigs[e].type?a=this._getDateTimeInput("DateTimeInput_"+r,t,i,s,n,e):"string"===this.widget.settings.itemConfigs[e].type?a=this._getTextInput("TextInput_"+r,t,i,s,n):"number"===this.widget.settings.itemConfigs[e].type||"nodeNumber"===this.widget.settings.itemConfigs[e].type?a=this._getNumericInput("NumericInput_"+r,t,i,s,e,n):(a=this._getTextInput("TextInput_"+r,t,i,s,"not supported"),a.options.enable=!1),a},s._getDropDownColumn=function(e,i,s,n,a){void 0===a&&(a=0);var r=new t;r.name=e,r.type="widgets/brease/DropDownBox",r.x=i,r.y=s,r.width=n,r.height=30,r.options={dataProvider:[],selectedIndex:parseInt(a),listPosition:"right",fitHeight2Items:!1};for(var o=0;o<this.widget.settings.tableItemIds.length;o+=1)r.options.dataProvider.push({value:o.toString(),text:this.widget.settings.headerTexts[o]});return r.result={method:"getSelectedValue"},r},s._getDropDownOperator=function(e,i,s,n,a,r){void 0===r&&(r=0);var o=new t;return o.name=e,o.type="widgets/brease/DropDownBox",o.x=i,o.y=s,o.width=n,o.height=30,o.options={dataProvider:[{value:0,text:"<>"},{value:1,text:"=="},{value:2,text:"<"},{value:3,text:"<="},{value:4,text:">"},{value:5,text:">="}],selectedIndex:parseInt(r),listPosition:"right",fitHeight2Items:!1},"date"===a&&"number"===a||o.options.dataProvider.push({value:6,text:"Contains"},{value:7,text:"Does not contain"}),o.result={method:"getSelectedValue"},o},s._getDropDown=function(e,i,s,n,a,r,o,l){void 0===r&&(r=30),void 0===o&&(o=0),void 0===l&&(l="right");var d=new t;return d.name=e,d.type="widgets/brease/DropDownBox",d.x=s,d.y=n,d.width=a,d.height=r,d.options={dataProvider:i,selectedIndex:parseInt(o),listPosition:l,fitHeight2Items:!1},d.result={method:"getSelectedValue"},d},s._getDateTimeInput=function(e,i,s,n,a,r){var o=new t;if(o.name=e,o.type="widgets/brease/DateTimeInput",o.x=i,o.y=s,o.width=n,o.height="30px",o.options={format:this.widget.settings.itemConfigs[r].inputConfig.format},void 0!==a)o.options.value=new Date(a).toISOString();else{var l=new Date,d=l.getFullYear().toString(),c=l.getMonth(),h=l.getDate().toString(),u=l.getHours(),g=l.getMinutes(),m=l.getSeconds();c=(c<9?"0":"")+(c+1).toString(),h=(h<10?"0":"")+h.toString(),u=(u<10?"0":"")+u.toString(),g=(g<10?"0":"")+g.toString(),m=(m<10?"0":"")+m.toString(),o.options.value=d+"-"+c+"-"+h+"T"+u+":"+g+":"+m+".000Z"}return o},s._getLabel=function(e,i,s,n,a){var r=new t;return r.name=e,r.type="widgets/brease/Label",r.x=s,r.y=n,r.width=a,r.height="30px",r.options={text:i},r},s._getTextInput=function(e,i,s,n,a){var r=new t;return r.name=e,r.type="widgets/brease/TextInput",r.x=i,r.y=s,r.width=n,r.height="30px",void 0!==a&&(r.options.value=a),r},s._getNumericInput=function(e,i,s,n,a,r){void 0===r&&(r=0);var o=new t;o.name=e,o.type="widgets/brease/NumericInput",o.x=i,o.y=s,o.width=n,o.height="30px";var l=this.widget.settings.tableItemIds&&this.widget.settings.tableItemIds[a]?this.widget.settings.tableItemIds[a]:"",d=brease.callWidget(l,"getMinValue"),c=brease.callWidget(l,"getMaxValue");return o.options={value:r,useDigitGrouping:this.widget.settings.itemConfigs[a].inputConfig.useDigitGrouping,format:this.widget.settings.itemConfigs[a].inputConfig.format,showUnits:this.widget.settings.itemConfigs[a].inputConfig.showUnits,limitViolationPolicy:this.widget.settings.itemConfigs[a].inputConfig.limitViolationPolicy,maxValue:null!==c?c:100,minValue:null!==d?d:0,unit:this.widget.settings.itemConfigs[a].inputConfig.unit},o},s._getImage=function(e,i,s,n){var a=new t;return a.name=e,a.type="widgets/brease/Image",a.x=s,a.y=n,a.width="30px",a.height="30px",a.options={image:i},a},s._getRect=function(e,i,s,n){var a=new t;return a.name=e,a.type="widgets/brease/Rectangle",a.x=i,a.y=s,a.width=n,a.height="2px",a.options={borderWidth:"0px 0px 1px 0px"},a},i}),define("widgets/brease/Table/libs/Dialogue",["brease/core/Class","brease/events/BreaseEvent","widgets/brease/GenericDialog/GenericDialog","widgets/brease/GenericDialog/libs/config","widgets/brease/Table/libs/FilterSettings","widgets/brease/Table/libs/DialogueTexts","widgets/brease/Label/Label","widgets/brease/CheckBox/CheckBox","widgets/brease/DateTimeInput/DateTimeInput","widgets/brease/Image/Image","widgets/brease/Rectangle/Rectangle","widgets/brease/DropDownBox/DropDownBox","widgets/brease/NumericInput/NumericInput"],function(e,BreaseEvent,GenericDialog,t,i,Texts){"use strict";var s=e.extend(function Dialogue(t){this.dialog=new GenericDialog(t.elem),e.apply(this),this.widget=t},null),n=s.prototype;n.initializeFilter=function(e){return this.filter=new i(this.dialog,this.widget,e),this._initializeEmptyDialogConfig(Texts[e].title),this.config},n.openFilter=function(){this.lang=a(),this.dialog.show(this.initializeFilter(this.lang),this.widget.elem),this.passedFirst=!1;var e=this;this.dialog.isReady().then(function(){$("#"+e.dialog.elem.id).on(BreaseEvent.WIDGET_READY,e._bind("_widgetAddedToFilter")).on("window_closing",e._bind("_collectFilterBeforeClosing"))})},n._initializeEmptyDialogConfig=function(e){this.config=new t,this.config.forceInteraction=!0,this.config.contentWidth=600,this.config.contentHeight=480,this.config.header.text=e,this.config.buttons.ok=!0,this.config.buttons.cancel=!0},n._widgetAddedToFilter=function(){$("#"+this.dialog.elem.id).off(BreaseEvent.WIDGET_READY,this._bind("_widgetAddedToFilter")).addClass("system_brease_TableConfigurationDialog_style_default"),this.filter.initialize(),this.filter._reColourFirstLineSeparator()},n._collectFilterBeforeClosing=function(e){brease.uiController.parentWidgetId(e.target)===this.dialog.elem.id&&(this.filter.removeEventListeners(),"ok"===this.dialog.getDialogResult()&&(this.widget.settings.filter=this.filter._widgetCollectStateBeforeClosing(),this.widget.renderer.updateTableSize(),this.widget.submitFilterConfiguration()))},n._addRowHandler=function(e){this.filter._addRowHandler(e)};function a(){var e=brease.language.getCurrentLanguage();return"de"!==e&&(e="en"),e}return n.dispose=function(){this.dialog.dispose(),e.prototype.dispose.call(this)},s}),define("widgets/brease/Table/libs/EditorBehavior",["brease/core/Class","widgets/brease/Table/libs/EditorHandles","brease/enum/Enum"],function(e,EditorHandles,Enum){"use strict";var t={},i=e.extend(function EditorBehavior(t){e.apply(this,arguments),this.widget=t},t),s=i.prototype;s.initialize=function(e){e=e||500,this.throttledFunc=_.throttle(this.reinitialize,e),n(this)},s.reinitialize=function(){this.widget.renderer.updateEditor()},s.childrenInitializedEditor=function(){},s.childrenUpdated=function(){this.headerChildren&&(this.widget.settings.dataOrientation===Enum.Direction.vertical?this._updateColumnWidth():this._updateRowHeight()),this.throttledFunc()},s.childrenAdded=function(){void 0===this.headerChildren?(this.headerChildren=this.widget.container.find(".breaseWidget[data-brease-widget]").detach(),this.headerContainer=$('<div class="headerContainer" style="position:absolute;left:0px;right:0px;height:100%;width:100%;display:flex"></div>'),this.widget.settings.dataOrientation===Enum.Direction.vertical?this.headerContainer.css("flex-direction","row"):this.headerContainer.css("flex-direction","column"),this.widget.container.prepend(this.headerContainer),this.widget.container.children(".headerContainer").append(this.headerChildren)):(this.headerChildren=this.widget.container.find(".breaseWidget[data-brease-widget]").detach(),this.widget.container.children(".headerContainer").append(this.headerChildren)),this.childrenUpdated()},s.childrenRemoved=function(e){this.headerChildren.splice(e,1),this.childrenUpdated()},s.dispose=function(){this.throttledFunc&&this.throttledFunc.cancel()},s._updateColumnWidth=function(){this.headerContainer.height(this.widget.settings.headerBarSize).css("flex-direction","row");var e=this.headerChildren,t=this.widget.settings.headerBarSize,i=this.widget.settings.itemColumnWidths,s=0,n=parseInt(this.widget.settings.columnWidth);this.headerChildren.each(function(a,r){var o;o=0===i.length?brease.callWidget(r.id,"getColumnWidth"):i[a],o=o>0?o:n,s+=o,$(e[a]).width(o).height(t)}),this.headerContainer.width(s)},s._updateRowHeight=function(){this.headerContainer.width(this.widget.settings.headerBarSize).css("flex-direction","column");var e=this.headerChildren,t=this.widget.settings.headerBarSize,i=this.widget.settings.itemRowHeights,s=0,n=parseInt(this.widget.settings.rowHeight);this.widget.container.find("tr").each(function(a,r){if(e.length!==a){var o;o=0===i.length?brease.callWidget(r.id,"getRowHeight"):i[a],o=o>0?o:n,s+=o,$(e[a]).height(o).width(t)}}),this.headerContainer.height(s)};function n(e){e.editMode={},e.editMode.itemDefs=[],e.widget.el.find("[data-brease-widget]").each(function(){var t=$.Deferred();e.editMode.itemDefs.push(t)}),$.when.apply($,e.editMode.itemDefs).done(function(){e.childrenInitializedEditor()}),e.widget.el.addClass("iat-container-widget");var t=new EditorHandles(e.widget);e.widget.getHandles=function(){return t.getHandles()},e.widget.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()}}return i}),define("widgets/brease/Table/libs/InputHandler",["brease/core/Class","brease/core/Utils","brease/enum/Enum","brease/events/BreaseEvent","brease/core/Types","brease/controller/KeyboardManager"],function(e,Utils,Enum,BreaseEvent,Types,t){"use strict";var InputHandler=e.extend(function InputHandler(e,renderer){this.widget=e,this.settings=e.settings,this.renderer=renderer,this.initialize()},null),i=InputHandler.prototype;i.initialize=function(){e.call(this),this.keyBoard||(this.keyBoard=t.getKeyboard()),this.numPad||(this.numPad=t.getNumPad()),this.internalData=this.internalData||{},this.numberSeparators=brease.user.getSeparators(),this.inputsReady=!1,this.initializeInputs()},i.initializeInputs=function(){this.keyBoardInitState=new $.Deferred,this.numPadInitState=new $.Deferred;var e=this;$.when(this.keyBoardInitState.promise(),this.numPadInitState.promise()).then(function(){document.body.removeEventListener(BreaseEvent.WIDGET_READY,_.bind(e._inputReadyHandler,e)),e.renderer.tableBodyEl[0].dispatchEvent(new CustomEvent("inputHandlerReady")),e.inputsReady=!0,document.body.addEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,e._bind("changeKeyBoard"))}),this.keyBoard.state===Enum.WidgetState.READY&&this.keyBoardInitState.resolve(),this.numPad.state===Enum.WidgetState.READY&&this.numPadInitState.resolve(),"resolved"===this.numPadInitState.state()&&"resolved"===this.keyBoardInitState.state()||document.body.addEventListener(BreaseEvent.WIDGET_READY,_.bind(e._inputReadyHandler,this))},i._inputReadyHandler=function(e){"breaseNumPad"===e.target.id&&null!==this.numPadInitState&&this.numPadInitState.resolve(),"breaseKeyBoard"===e.target.id&&null!==this.keyBoardInitState&&this.keyBoardInitState.resolve()},i.requestCellInput=function(e){if(!this.widget.isDisabled){var t=this.renderer.table.cell(e).index();if(this.renderer.settings.dataOrientation===Enum.Direction.vertical?(this.itemIndex=this.widget.model.getActualItem(t.column),this.activeIndex=this.widget.renderer.getPerpendicularItem(t.row)):this.renderer.settings.dataOrientation===Enum.Direction.horizontal&&(this.itemIndex=this.widget.model.getActualItem(t.row),this.activeIndex=this.widget.renderer.getPerpendicularItem(t.column)),!0!==brease.callWidget(this.widget.settings.tableItemIds[this.itemIndex],"isEnabled"))return!1;this.internalData.itemOpened=this.widget.settings.tableItemIds[this.itemIndex],this.activeCellEl=$(e),this.activeCellEl.addClass("activeInput"),"number"===e.getAttribute("type")?(this.numPad.addEventListener(BreaseEvent.CLOSED,this._bind("_onNumPadClose")),this.numPad.addEventListener(BreaseEvent.SUBMIT,this._bind("_onNumPadSubmit")),this._generateNumPadSettings(brease.formatter.parseFloat(e.innerText,this.numberSeparators)),this.numPad.show(this.numPadSettings,e)):"string"===e.getAttribute("type")&&(a.call(this),this._generateKeyBoardSettings(e.innerHTML),this.keyBoard.show(this.keyBoardSettings,e))}},i._generateNumPadSettings=function(e){this.numPadSettings={minValue:brease.callWidget(this.settings.tableItemIds[this.itemIndex],"getMinValue"),maxValue:brease.callWidget(this.settings.tableItemIds[this.itemIndex],"getMaxValue"),value:e,format:this.settings.itemConfigs[this.itemIndex].inputConfig.format,unit:this.settings.itemConfigs[this.itemIndex].inputConfig.unit,useDigitGrouping:this.settings.itemConfigs[this.itemIndex].inputConfig.useDigitGrouping,limitViolationPolicy:this.settings.itemConfigs[this.itemIndex].inputConfig.limitViolationPolicy,pointOfOrigin:"application",arrow:{show:!1},contentId:this.widget.settings.parentContentId,widgetId:this.settings.tableItemIds[this.itemIndex],bindingAttributes:["value"]},this.settings.itemConfigs[this.itemIndex].inputConfig.inputStyle&&(this.numPadSettings.style=this.settings.itemConfigs[this.itemIndex].inputConfig.inputStyle)},i._generateKeyBoardSettings=function(e){this.keyBoardSettings={text:e,restrict:"",maxLength:this.settings.itemConfigs[this.itemIndex].inputConfig.maxLength,type:Enum.InputType.text,pointOfOrigin:"application",arrow:{show:!1},contentId:this.widget.settings.parentContentId,widgetId:this.settings.tableItemIds[this.itemIndex],bindingAttributes:["stringValue"]},this.settings.itemConfigs[this.itemIndex].inputConfig.inputStyle&&(this.keyBoardSettings.style=this.settings.itemConfigs[this.itemIndex].inputConfig.inputStyle)},i._onNumPadClose=function(){s.call(this),this.internalData.itemOpened=void 0,this.activeCellEl&&(this.activeCellEl.removeClass("activeInput"),this.activeCellEl=null)},i._onNumPadSubmit=function(e){var t=brease.callWidget(this.settings.tableItemIds[this.itemIndex],"getNumberFormat"),i=Utils.roundTo(e.detail.value,t.decimalPlaces),n=brease.formatter.formatNumber(i,t,this.numPadSettings.useDigitGrouping,this.numberSeparators);this.activeCellEl.removeClass("activeInput"),this._submitData(n,i,"Number"),s.call(this)},i._onKeyBoardClose=function(){n.call(this),this.internalData.itemOpened=void 0,this.activeCellEl&&(this.activeCellEl.removeClass("activeInput"),this.activeCellEl=null)},i._onKeyBoardSubmit=function(e){this._submitData(e.detail,e.detail,"String")},i._submitData=function(e,t,i){this.renderer.updateCell(null,null,e,this.activeCellEl[0]),this.widget.model.setValue(this.itemIndex,this.activeIndex,e);var s=brease.callWidget(this.settings.tableItemIds[this.itemIndex],"Number"===i?"getValue":"getStringValue");s[this.activeIndex]=t,this.widget.submitUserInput(this.itemIndex,s)},i.closeInputWidgets=function(e){(void 0!==e&&this.internalData.itemOpened===e||void 0===e&&void 0!==this.internalData.itemOpened)&&(this.keyBoard.hide(),this.numPad.hide())},i.changeKeyBoard=function(e){n.call(this,!1),this.keyBoard=t.getKeyboard(),this.activeCellEl&&(a.call(this,!1),this.keyBoardSettings.text=e.detail.currentValue,this.keyBoard.show(this.keyBoardSettings,this.activeCellEl[0]))},i.dispose=function(){this.itemIndex=null,this.activeIndex=null,this.numberSeparators=null,this.numPadSettings=null,this.keyBoardSettings=null,s.call(this),n.call(this),this.activeCellEl=null,document.body.removeEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),document.body.removeEventListener(BreaseEvent.WIDGET_READY,_.bind(this._inputReadyHandler,this)),this.keyBoardInitState=null,this.numPadInitState=null,this.keyBoard&&(this.keyBoard=null),this.numPad&&(this.numPad=null),e.prototype.dispose.apply(this,arguments)},
i.suspend=function(){document.body.removeEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard"))},i.wake=function(){document.body.addEventListener(BreaseEvent.SYSTEM_KEYBOARD_CHANGED,this._bind("changeKeyBoard")),t.isCurrentKeyboard(this.keyBoard)||this.changeKeyBoard()};function s(){this.numPad&&this.numPad.elem&&(this.numPad.removeEventListener(BreaseEvent.CLOSED,this._bind("_onNumPadClose")),this.numPad.removeEventListener(BreaseEvent.SUBMIT,this._bind("_onNumPadSubmit")))}function n(){this.keyBoard&&(this.keyBoard.removeEventListener(BreaseEvent.CLOSED,this._bind("_onKeyBoardClose")),this.keyBoard.removeEventListener(BreaseEvent.SUBMIT,this._bind("_onKeyBoardSubmit")))}function a(){this.keyBoard&&(this.keyBoard.addEventListener(BreaseEvent.CLOSED,this._bind("_onKeyBoardClose")),this.keyBoard.addEventListener(BreaseEvent.SUBMIT,this._bind("_onKeyBoardSubmit")))}return InputHandler}),define("widgets/brease/Table/libs/Model",["brease/core/Class","widgets/brease/common/libs/external/jquery.dataTables","brease/enum/Enum","brease/core/Types","widgets/brease/common/libs/wfUtils/UtilsImage"],function(e,t,Enum,Types,UtilsImage){"use strict";var Model=e.extend(function Model(t){e.call(this),this.widget=t,this.settings=t.settings,this.resetData()},null),i=Model.prototype;return i.getIsDatasetEmpty=function(){return 0===this.originalData.length||!!this.originalData[0].empty},i.getIsProcessedDatasetEmpty=function(){return 0===this.processedData.length||!!this.processedData[0].empty},i.getNumberOfRowsAvailable=function(){return this.processedData.length},i.resetData=function(){this.displayedColumns=0,this.datareset=!0,this.processedData=this.settings.standalone?[{empty:!0}]:_.fill(new Array(this.settings.itemFinalVisibility.length),[]),this.originalData=this.settings.standalone?[{empty:!0}]:_.fill(new Array(this.settings.itemFinalVisibility.length),[])},i.shortenData=function(){for(var e=0;e<this.originalData.length;e+=1)this.originalData[e].splice(10)},i.setData=function(e){this.datareset=!1,e=$.extend(!0,[],e),this._processDataset(e)},i.getData=function(){return this.processedData},i.removeData=function(e){this.originalData.splice(e,1)},i.getOriginalData=function(){return this.settings.dataOrientation===Enum.Direction.vertical?this.originalData:_.zip.apply(_,this.originalData)},i.getActualItemsInTable=function(){return this.actualItemsInTheTable},i.getColumnsInHorzTable=function(){return this.processedData[this.processedData.length-1]},i.findIndexOfActualItem=function(e){return this.actualItemsInTheTable.indexOf(e)},i.getActualItem=function(e,t){var i=-1;return i=this.actualItemsInTheTable?this.actualItemsInTheTable[e]:t?this.processedData[e][this.processedData[e].length-1]:e,i},i.isLastItem=function(e){return e===this.actualItemsInTheTable.length-1},i.getNumberOfItems=function(){return this.actualItemsInTheTable.length-1},i.setDataItem=function(e,t){this.datareset=!1,e=$.extend(!0,[],e),this._processOneItem(e,t)},i.setValue=function(e,t,i){this.originalData[e][t]=i},i.getOriginalItemData=function(e){return this.originalData[e]},i.getTableDataBoundaries=function(){var e=this.settings.dataOrientation===Enum.Direction.vertical,t=this.getData(),i=t[0]?t[0].length:0;return{rows:e?t.length:this.settings.tableItemIds.length,columns:e?this.settings.tableItemIds.length:i}},i._processOneItem=function(e,t){for(var i=0,s=0;s<e.length;s+=1)"widgets/brease/TableItem"===this.settings.tableItemTypes[t]&&(e[s]=this._removeHTMLTags(e[s]),e[s]=this._breakLine(e[s]));this.originalData[t]=$.extend(!0,[],e),this.originalData.map(function(e,t){i=i<e.length?e.length:i}),this._evenOutItemsWhenOneUpdated(i)},i._evenOutItemsWhenOneUpdated=function(e){for(var t=0;t<this.originalData.length;t+=1)if(this.originalData[t]&&this.originalData[t].length<e){var i=_.fill(new Array(e-this.originalData[t].length),"");this.originalData[t]=this.originalData[t].concat(i)}},i._processDataset=function(e){for(var t=this.settings,i=0,s=0;s<e.length;s+=1){for(var n=0;n<e[s].length;n+=1)"widgets/brease/TableItem"===t.tableItemTypes[s]&&(e[s][n]=this._removeHTMLTags(e[s][n])),e[s][n]=this._breakLine(e[s][n]);this.settings.tableItemLengths[s]=e[s].length,e[s].length>i&&(i=e[s].length)}this.originalData=e,this._evenOutAllItems(i)},i._evenOutAllItems=function(e){for(var t=0;t<this.originalData.length;t+=1)if(this.originalData[t].length<e){var i=_.fill(new Array(e-this.originalData[t].length),"");this.originalData[t]=this.originalData[t].concat(i)}},i._addOGBoundaries=function(e){if(!(e[0].empty||!this.settings.standalone&&this.datareset)){e.map(function(e,t){e.push(t)});var t=[];return e[0].map(function(e,i){t.push(i)}),e.push(t),e}},i.sliceDataAccordingToTableConfig=function(e){if(!this.originalData.includes(void 0)){var t=_.cloneDeep(this.originalData),i="specColumns",s=this.settings.dataOrientation,n;t=this._addOGBoundaries(t),t&&(s===Enum.Direction.vertical&&(t=_.zip.apply(_,t),i="specRows",n=t.splice(-1)),e&&this._sliceDataFromDataset(t,e,i,s),t=this._repopulateDataset(t,n,s),this._removeTrackers(t))}},i._sliceDataFromDataset=function(e,t,i,s){return t[i]=_.orderBy(t[i],["index","from"],["desc","desc"]),t[i].forEach(function(t){if(!1===t.visible||"false"===t.visible){var i,n;void 0!==t.index&&(i=t.index,n=1),void 0!==t.to&&void 0!==t.from&&(i=t.from,n=t.to-t.from+1),void 0!==t.to&&void 0===t.from&&(n=t.to,i=0),void 0===t.to&&void 0!==t.from&&(n=e.length-1,i=t.from),s===Enum.Direction.vertical?e.splice(i,n):e.map(function(e){e.splice(i,n)})}}),e},i._repopulateDataset=function(e,t,i){var s=this.settings.itemFinalVisibility,n=0;if(i===Enum.Direction.vertical)for(e.push(t[0]),n=s.length-1;n>=0;n-=1)s[n]||e.map(function(e){e.splice(n,1)});else for(n=s.length-1;n>=0;n-=1)s[n]||e.splice(n,1);return e},i._removeTrackers=function(e){if(void 0!==e){var t=[];this.settings.dataOrientation===Enum.Direction.horizontal?e.forEach(function(e){t.push(e.pop())}):t=e.pop(),this.actualItemsInTheTable=t,this.processedData=e}},i._breakLine=function(e){return this.settings.multiLine&&e.length>0&&"string"==typeof e?e.replace(/\\n/g,"<br />"):e},i._removeHTMLTags=function(e){return"string"==typeof e&&(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;")),e},i.sortDataHorizontally=function(e,t){void 0!==t?(this.unsortedData=$.extend(!0,[],this.processedData),this.processedData=_.zip.apply(_,this.processedData),this.processedData.sort(function(i,s){return i[e]===s[e]?0:isNaN(i[e])||isNaN(s[e])?"asc"===t?i[e]<s[e]?-1:1:i[e]>s[e]?-1:1:"asc"===t?i[e]-s[e]:s[e]-i[e]}),this.processedData=_.zip.apply(_,this.processedData)):(this.processedData=$.extend(!0,[],this.unsortedData),this.unsortedData=[])},i.getActualRowIndex=function(e){for(var t,i=-1,s=0;s<this.processedData.length;s+=1)t=this.processedData[s],t[t.length-1]===e&&(i=s);return i},Model}),define("widgets/brease/Table/libs/ScrollHandler",["brease/core/Class","brease/enum/Enum","brease/helper/Scroller"],function(e,Enum,Scroller){"use strict";var ScrollHandler=e.extend(function ScrollHandler(t,renderer,i){e.call(this),this.widget=t,this.settings=t.settings,this.renderer=renderer,this.options=i,this.dataChangedOnScroll=!1},null),t=ScrollHandler.prototype;t.initializeScroller=function(e,t){!0!==e||t?!1!==e||t?(r(this),this._addBodyScroller(),brease.config.editMode&&o(this)):this._addBodyScroller():r(this)},t.removeScroller=function(){this._removeScroller()},t.isScrollActive=function(){return this.scrollActive&&this.settings.stopRefreshAtScroll&&(this.dataChangedOnScroll=!0),this.scrollActive};function i(e,t){var i=this.widget.model.getTableDataBoundaries();return e<=i.columns-1&&t<=i.rows-1}function s(e){var t=$(e);return t.hasClass("hidden")||t.parent().hasClass("hidden")}function n(e,t){return this.renderer.table.cell(-1===t?0:t,-1===e?0:e).node()}t.scrollToIndex=function(e,t){if(!this.scrollActive){this.scrollActive=!0,a(this);var r=0,o=0,l=this.renderer.tableBodyEl.height(),d=this.renderer.tableBodyEl.width(),c=this.renderer.tableBodyEl.parent().height(),h=this.renderer.tableBodyEl.parent().width();if(i.call(this,t,e)){var u=n.call(this,t,e);if(s(u))return this.scrollActive=!1,void 0;e>-1&&t>-1?(r=-u.offsetLeft,o=-u.offsetTop):e>-1&&-1===t?(r=this.scrollerBody.x,o=-u.offsetTop):-1===e&&t>-1&&(r=-u.offsetLeft,o=this.scrollerBody.y),d<h?r=0:Math.abs(r)>Math.abs(d-h)&&(r=-(d-h)),l<c?o=0:Math.abs(o)>Math.abs(l-c)&&(o=-(l-c)),this.scrollerBody.scrollTo(r,o,this.options.scroller.scrollDuration)}else this.scrollActive=!1}},t.scrollItemLeft=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=parseInt(this.renderer.tableBodyEl.css("right")),t=this._getFirstItemInView(e);if(void 0!==t&&void 0!==t[0]){var i=t[0].getBoundingClientRect();this.renderer.tableBodyEl[0].contains(t[0])&&(i.left+this.options.scroller.pagingItemTolerance*i.width<this.viewPortProperties.left?this.scrollerBody.scrollBy(this.viewPortProperties.left-i.left,0,this.options.scroller.scrollDuration):i.left===this.viewPortProperties.left?this.scrollerBody.scrollBy(t.prev("td:not(.hidden)").outerWidth(),0,this.options.scroller.scrollDuration):this.scrollerBody.scrollBy(t.prev("td:not(.hidden)").outerWidth()+(this.viewPortProperties.left-i.left),0,this.options.scroller.scrollDuration))}else this.scrollActive=!1}},t.scrollItemRight=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=this.renderer.tableBodyEl.parent().width(),t=parseInt(this.renderer.tableBodyEl.css("right")),i=e+t,s=this._getFirstItemInView(i);if(void 0!==s&&void 0!==s[0]){var n=s[0].getBoundingClientRect();this.renderer.tableBodyEl[0].contains(s[0])&&(n.right-this.options.scroller.pagingItemTolerance*n.width>this.viewPortProperties.right?this.scrollerBody.scrollBy(-(n.right-this.viewPortProperties.right),0,this.options.scroller.scrollDuration):n.right===this.viewPortProperties.right?this.scrollerBody.scrollBy(-s.next("td:not(.hidden)").outerWidth(),0,this.options.scroller.scrollDuration):this.scrollerBody.scrollBy(-(s.next("td:not(.hidden)").outerWidth()+(n.right-this.viewPortProperties.right)),0,this.options.scroller.scrollDuration))}else this.scrollActive=!1}},t.scrollItemUp=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=parseInt(this.renderer.tableBodyEl.css("bottom")),t=this._getFirstItemInView(e);if(void 0!==t&&void 0!==t[0]){var i=t[0].getBoundingClientRect();this.renderer.tableBodyEl[0].contains(t[0])&&(i.top+this.options.scroller.pagingItemTolerance*i.height<this.viewPortProperties.top?this.scrollerBody.scrollBy(0,this.viewPortProperties.top-i.top,this.options.scroller.scrollDuration):i.top===this.viewPortProperties.top?this.scrollerBody.scrollBy(0,t.prev("tr:not(.hidden)").outerHeight(),this.options.scroller.scrollDuration):this.scrollerBody.scrollBy(0,t.prev("tr:not(.hidden)").outerHeight()+(this.viewPortProperties.top-i.top),this.options.scroller.scrollDuration))}else this.scrollActive=!1}},t.scrollItemDown=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=this.renderer.tableBodyEl.parent().height(),t=parseInt(this.renderer.tableBodyEl.css("bottom")),i=e+t,s=this._getFirstItemInView(i);if(void 0!==s&&void 0!==s[0]){var n=s[0].getBoundingClientRect();this.renderer.tableBodyEl[0].contains(s[0])&&(n.bottom-this.options.scroller.pagingItemTolerance*n.height>this.viewPortProperties.bottom?this.scrollerBody.scrollBy(0,-(n.bottom-this.viewPortProperties.bottom),this.options.scroller.scrollDuration):n.bottom===this.viewPortProperties.bottom?this.scrollerBody.scrollBy(0,-s.next("tr:not(.hidden)").outerHeight(),this.options.scroller.scrollDuration):this.scrollerBody.scrollBy(0,-(s.next("tr:not(.hidden)").outerHeight()+(n.bottom-this.viewPortProperties.bottom)),this.options.scroller.scrollDuration))}else this.scrollActive=!1}},t.scrollPageRight=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=this.renderer.tableBodyEl.parent().width(),t=parseInt(this.renderer.tableBodyEl.css("right")),i=e+t,s=this._getFirstItemInView(i),n;if(void 0!==s&&void 0!==s[0]){var r=s[0].getBoundingClientRect();if(this.renderer.tableBodyEl[0].contains(s[0])){if(r.right-this.options.scroller.pagingItemTolerance*r.width>this.viewPortProperties.right)n=-(s[0].offsetLeft- -1*this.scrollerBody.x);else{if(void 0===s.next("td:not(.hidden)")[0])return this.scrollActive=!1,void 0;n=-(s.next("td:not(.hidden)")[0].offsetLeft- -1*this.scrollerBody.x)}this.renderer.tableBodyEl.width()-this.renderer.tableBodyEl.parent().width()<-(this.scrollerBody.x+n)&&(n=-(this.renderer.tableBodyEl.width()-(-this.scrollerBody.x+this.renderer.tableBodyEl.parent().width()))),this.scrollerBody.scrollBy(n,0,this.options.scroller.scrollDuration)}}else this.scrollActive=!1}},t.scrollPageLeft=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=parseInt(this.renderer.tableBodyEl.css("right")),t=this._getFirstItemInView(e),i;if(void 0!==t&&void 0!==t[0]){var s=t[0].getBoundingClientRect();if(this.renderer.tableBodyEl[0].contains(t[0])){if(s.left+this.options.scroller.pagingItemTolerance*s.width<this.viewPortProperties.left)i=-1*this.scrollerBody.x-t[0].offsetLeft+this.renderer.tableBodyEl.parent().width()-t.outerWidth();else{if(void 0===t.prev("td:not(.hidden)")[0])return this.scrollActive=!1,void 0;i=-1*this.scrollerBody.x-t.prev("td:not(.hidden)")[0].offsetLeft+this.renderer.tableBodyEl.parent().width()-t.prev("td").outerWidth()}-1*this.scrollerBody.x-i<0&&(i=-this.scrollerBody.x),this.scrollerBody.scrollBy(i,0,this.options.scroller.scrollDuration)}}else this.scrollActive=!1}},t.scrollPageUp=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=parseInt(this.renderer.tableBodyEl.css("bottom")),t=this._getFirstItemInView(e),i;if(void 0!==t&&void 0!==t[0]){var s=t[0].getBoundingClientRect();if(this.renderer.tableBodyEl[0].contains(t[0])){if(s.top+this.options.scroller.pagingItemTolerance*s.height<this.viewPortProperties.top)i=-1*this.scrollerBody.y-t[0].offsetTop+this.renderer.tableBodyEl.parent().height()-t.outerHeight();else{if(void 0===t.prev("tr:not(.hidden)")[0])return this.scrollActive=!1,void 0;i=-1*this.scrollerBody.y-t.prev("tr:not(.hidden)")[0].offsetTop+this.renderer.tableBodyEl.parent().height()-t.prev("tr").outerHeight()}-1*this.scrollerBody.y-i<0&&(i=-this.scrollerBody.y),this.scrollerBody.scrollBy(0,i,this.options.scroller.scrollDuration)}}else this.scrollActive=!1}},t.scrollPageDown=function(){if(!this.scrollActive){this.scrollActive=!0,a(this);var e=this.renderer.tableBodyEl.parent().height(),t=parseInt(this.renderer.tableBodyEl.css("bottom")),i=e+t,s=this._getFirstItemInView(i),n;if(void 0!==s&&void 0!==s[0]){var r=s[0].getBoundingClientRect();if(this.renderer.tableBodyEl[0].contains(s[0])){if(r.bottom-this.options.scroller.pagingItemTolerance*r.height>this.viewPortProperties.bottom)n=-(s[0].offsetTop- -1*this.scrollerBody.y);else{if(void 0===s.next("tr:not(.hidden)")[0])return this.scrollActive=!1,void 0;n=-(s.next("tr:not(.hidden)")[0].offsetTop- -1*this.scrollerBody.y)}this.renderer.tableBodyEl.height()-this.renderer.tableBodyEl.parent().height()<-(this.scrollerBody.y+n)&&(n=-(this.renderer.tableBodyEl.height()-(-this.scrollerBody.y+this.renderer.tableBodyEl.parent().height()))),this.scrollerBody.scrollBy(0,n,this.options.scroller.scrollDuration)}}else this.scrollActive=!1}},t.calcScrollItemOffset=function(){if(!this.scrollActive){a(this);var e=$(document.elementFromPoint(this.viewPortProperties.left+1,this.viewPortProperties.top+1)).closest("td");if(void 0!==e[0]){var t=e[0].getBoundingClientRect(),i,s;return this.renderer.tableBodyEl[0].contains(e[0])&&(i=t.left+this.options.scroller.pagingItemTolerance*t.width<this.viewPortProperties.left?this.renderer.table.column(e.next("td").length>0?e.next("td"):e).index():this.renderer.table.column(e).index(),s=t.top+this.options.scroller.pagingItemTolerance*t.height<this.viewPortProperties.top?this.renderer.table.row(e.parents("tr").next("tr").length>0?e.parents("tr").next("tr"):e).index():this.renderer.table.row(e).index()),this.renderer.widget[this.options.scrollCallbackFn]({row:s,column:i}),void 0}this.renderer.widget[this.options.scrollCallbackFn]({row:0,column:0})}},t.scrollTo=function(e,t,i){if(void 0!==this.scrollerBody)switch(t){case"X":i?(this.scrollerBody.scrollTo(e.x,this.scrollerBody.y,0),this.scrollerHead.scrollTo(e.x,this.scrollerHead.y,0)):this.scrollerBody.scrollTo(e.x,this.scrollerBody.y,0),brease.config.editMode&&this.scrollerEditHead.scrollTo(e.x,this.scrollerEditHead.y,0);break;case"Y":i?(this.scrollerBody.scrollTo(this.scrollerBody.x,e.y,0),this.scrollerHead.scrollTo(this.scrollerHead.x,e.y,0)):this.scrollerBody.scrollTo(this.scrollerBody.x,e.y,0),brease.config.editMode&&this.scrollerEditHead.scrollTo(this.scrollerEditHead.y,e.y,0);break;default:break}},t._refreshScroller=function(){var renderer=this;this.scrollerBody&&(window.clearTimeout(this.refreshTimeOutBody),this.refreshTimeOutBody=window.setTimeout(function(){null!==renderer.scrollerBody&&(renderer.scrollerBody.refresh(),renderer.calcScrollItemOffset())},100)),this.scrollerHead&&(window.clearTimeout(this.refreshTimeOutHead),this.refreshTimeOutHead=window.setTimeout(function(){null!==renderer.scrollerHead&&(renderer.scrollerHead.refresh(),brease.config.editMode&&renderer._refreshEditorScroller())},100)),this.scrollerEditHead&&(this.refreshTimeOutHeadEdit=window.setTimeout(function(){null!==renderer.scrollerEditHead},100))},t._refreshEditorScroller=function(){this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead&&(this.settings.dataOrientation===Enum.Direction.vertical?(this.scrollerHead.scrollTo(this.scrollerBody.x,0,0),this.widget.el.find(".headerContainer").css("left",this.scrollerBody.x)):(this.scrollerHead.scrollTo(0,this.scrollerBody.y,0),brease.config.editMode&&this.widget.el.find(".headerContainer").css("top",this.scrollerBody.y)))},t._getFirstItemInView=function(e){for(var t=0,i=0,s;i<e;){if(this.settings.dataOrientation===Enum.Direction.vertical){if(s=this.renderer.tableBodyEl.find("tr:eq("+t+")"),i+=s.height(),t>this.widget.model.getData().length)break}else if(s=this.renderer.tableBodyEl.find("td:eq("+t+")"),i+=s.width(),t>this.widget.model.getData().length)break;t+=1}return s},t._addBodyScroller=function(){var e=this,t=e.widget.settings.maxHeight>e.widget.settings.height?Math.max(Math.min(e.widget.container.find(".dataTable").outerHeight()+e.widget.settings.headerBarSize,e.widget.settings.maxHeight),e.widget.settings.height):e.widget.settings.height;t-=e.settings.dataOrientation===Enum.Direction.vertical&&e.settings.showHeader?e.renderer.settings.headerBarSize:0,e.settings.borderWidth&&(t-=2*parseInt(e.settings.borderWidth)),e.renderer.tableBodyEl.parent().height(t),e.scrollerBody=Scroller.addScrollbars(e.renderer.tableBodyEl.parent()[0],{probeType:3,mouseWheel:!0,tap:!0,click:!1,useTransition:!1,useTransform:!1,scrollY:l(e.options.scroller.scrollY),scrollX:l(e.options.scroller.scrollX),bounce:l(e.options.scroller.bounce),momentum:l(e.options.scroller.momentum),scrollbars:l(e.options.scroller.scrollbars)}),e.settings.dataOrientation===Enum.Direction.vertical?e.scrollerBody.on("scroll",_.bind(u,e)):e.settings.dataOrientation===Enum.Direction.horizontal&&e.scrollerBody.on("scroll",_.bind(g,e)),e.scrollerBody.on("scrollStart",_.bind(d,e)),e.scrollerBody.on("scrollEnd",_.bind(c,e)),e.settings.enable||e.scrollerBody.disable()},t._removeScroller=function(){var e=this;e.scrollerBody&&(e.scrollerBody.off("scroll",_.bind(u,e)),e.scrollerBody.off("scroll",_.bind(g,e)),e.scrollerBody.off("scrollStart",_.bind(d,e)),e.scrollerBody.off("scrollEnd",_.bind(c,e)),window.clearTimeout(e.scrollOffsetTimeOut),e.scrollerBody.destroy(),e.scrollerBody=null,window.clearTimeout(e.refreshTimeOutBody),e.refreshTimeOutBody=null),e.scrollerHead&&(e.scrollerHead.destroy(),e.scrollerHead=null,window.clearTimeout(e.refreshTimeOutHead),e.refreshTimeOutHead=null),brease.config.editMode&&e.scrollerEditHead&&(e.scrollerEditHead.destroy(),e.scrollerEditHead=null,window.clearTimeout(e.refreshTimeOutHeadEdit),e.refreshTimeOutHeadEdit=null)},t.dispose=function(){this._removeScroller(),e.prototype.dispose.apply(this,arguments)};function a(e){e.viewPortProperties=e.renderer.tableBodyEl.parent()[0].getBoundingClientRect()}function r(e){e.scrollerHead=Scroller.addScrollbars(e.renderer.tableHeaderEl.parent()[0],{probeType:3,disableMouse:!1,disableTouch:!1,disablePointer:!0,scrollbars:!1,mouseWheel:!0,tap:!1,click:!1,useTransition:!1,useTransform:!1,scrollY:l(e.options.scroller.scrollY),scrollX:l(e.options.scroller.scrollX),bounce:l(e.options.scroller.bounce),momentum:l(e.options.scroller.momentum)}),e.scrollerHead.on("scrollStart",_.bind(d,e)),e.scrollerHead.on("scrollEnd",_.bind(h,e)),e.settings.dataOrientation===Enum.Direction.vertical?e.scrollerHead.on("scroll",_.bind(m,e)):e.settings.dataOrientation===Enum.Direction.horizontal&&e.scrollerHead.on("scroll",_.bind(p,e))}function o(e){var t=e.widget.el.find(".headerContainer")[0];t&&t.childElementCount>0&&(e.scrollerEditHead=Scroller.addScrollbars(t,{disableMouse:!1,disableTouch:!1,disablePointer:!0,scrollbars:!1,mouseWheel:!0,tap:!1,click:!1,useTransition:!1,useTransform:!1,scrollY:l(e.options.scroller.scrollY),scrollX:l(e.options.scroller.scrollX),bounce:l(e.options.scroller.bounce),momentum:l(e.options.scroller.momentum)}))}function l(e){return JSON.parse(JSON.stringify(e))}function d(){this.scrollActive=!0}function c(){this.scrollActive=!1;var renderer=this;this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead&&(this.settings.dataOrientation===Enum.Direction.vertical?(this.scrollerHead.scrollTo(this.scrollerBody.x,0,0),brease.config.editMode&&this.widget.el.find(".headerContainer").css("left",this.scrollerBody.x)):(this.scrollerHead.scrollTo(0,this.scrollerBody.y,0),brease.config.editMode&&this.widget.el.find(".headerContainer").css("top",this.scrollerBody.y)),window.clearTimeout(this.scrollOffsetTimeOut),this.dataChangedOnScroll&&(this.renderer.updateTableDataOnly(),this.dataChangedOnScroll=!1),this.scrollOffsetTimeOut=window.setTimeout(function(){renderer.calcScrollItemOffset()},100))}function h(){this.scrollActive=!1;var renderer=this;this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead&&(this.settings.dataOrientation===Enum.Direction.vertical?this.scrollerBody.scrollTo(this.scrollerHead.x,0,0):this.scrollerBody.scrollTo(0,this.scrollerHead.y,0),window.clearTimeout(this.scrollOffsetTimeOut),this.scrollOffsetTimeOut=window.setTimeout(function(){renderer.calcScrollItemOffset()},100))}function u(){if(this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead){var e=new CustomEvent("ScrollXY",{detail:{x:this.scrollerBody.x,y:this.scrollerBody.y}});this.widget.elem.dispatchEvent(e),this.scrollerHead.scrollTo(this.scrollerBody.x,0,0)}}function g(){if(this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead){var e=new CustomEvent("ScrollXY",{detail:{x:this.scrollerBody.x,y:this.scrollerBody.y}});this.widget.elem.dispatchEvent(e),this.scrollerHead.scrollTo(0,this.scrollerBody.y,0)}}function m(){this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead&&this.scrollerBody.scrollTo(this.scrollerHead.x,0,0)}function p(){this.renderer.tableReady&&this.scrollerBody&&this.scrollerHead&&this.scrollerBody.scrollTo(0,this.scrollerHead.y,0)}return ScrollHandler}),define("widgets/brease/Table/libs/Renderer",["brease/core/Class","brease/enum/Enum","brease/events/BreaseEvent","widgets/brease/Table/libs/InputHandler","widgets/brease/Table/libs/ScrollHandler","widgets/brease/common/libs/wfUtils/UtilsImage","widgets/brease/common/libs/external/jquery.dataTables"],function(e,Enum,BreaseEvent,InputHandler,ScrollHandler,UtilsImage){"use strict";var Renderer=e.extend(function Renderer(t,i){e.call(this),this.widget=t,this.settings=t.settings,this.options=i,this.displayedColumns=0,this.internal={filterSet:!1,filterOutOfBoundsReported:!1},this.initialize()},null),t=Renderer.prototype;t.initialize=function(){$.fn.dataTable.ext.classes.sTable="dataTable",$.fn.dataTable.ext.sErrMode=console.warn,this.debounceUpdateTableSize=_.throttle(this.updateTableSizeDebounced.bind(this),this.settings.initRefreshRate),this.debounceUpdateTableDataOnly=_.throttle(this.updateTableDataOnlyDebounced.bind(this),this.settings.refreshRate),o(this),this.busy=!1,this.initScrollHandler(),brease.config.editMode||(this.inputHandler=new InputHandler(this.widget,this))},t.initScrollHandler=function(){this.scrollHandler=new ScrollHandler(this.widget,this,this.options)},t.updateEditor=function(){void 0!==this.tableHeaderEl&&this.tableHeaderEl.parent().remove(),n(this),a(this),this.scrollHandler.initializeScroller(!0,!0),this.refreshScroller(),this.updateTable()},t.setInitData=function(){void 0!==this.tableHeaderEl&&(this.tableHeaderEl.parent().remove(),this.scrollHandler.removeScroller()),n(this),a(this),this.scrollHandler.initializeScroller(!0,!1),this.refreshScroller()},t.updateTable=function(){i(this.widget),this.setRendererBusy(),void 0===this.table?this._buildTable(!1):this.updateTableSize()},t.updateTableSize=function(){this.debounceUpdateTableSize()},t.updateTableSizeDebounced=function(){void 0!==this.table&&(p(this),o(this),this._buildTable(!0))};function i(e){e._setTableVisibleUpdated(!1),e._setTableEnableUpdated(!1)}t.updateTableDataOnly=function(){this.debounceUpdateTableDataOnly()},t.updateTableDataOnlyDebounced=function(){this.scrollHandler.isScrollActive()&&this.settings.stopRefreshAtScroll||(this.widget.model.sliceDataAccordingToTableConfig(this.widget.settings.tableConfiguration),this._updateTableDataOnly())},t._updateTableDataOnly=function(){if(this.table){if(this.table.rows().remove(),this.settings.dataOrientation===Enum.Direction.horizontal&&""!==this.settings.permOrder){var e=this.widget.model.findIndexOfActualItem(this.settings.permOrder[0]);e>-1&&this.widget.model.sortDataHorizontally(e,this.settings.permOrder[1])}this.table.rows.add(this.widget.model.getData()),this.table.draw(!1),this.settings.maxHeight&&b(this.widget),"vertical"===this.settings.dataOrientation?this.selectItem("row",this.settings.selectedRow,!0):this.selectItem("column",this.settings.selectedColumn,!0)}},t.updateRow=function(e,t){this.setRendererBusy();var renderer=this;t=this.widget.model.findIndexOfActualItem(t),-1!==t&&($.each(this.table.row(t).nodes().toJQuery().children(),function(i,s){var n=e[i];n=renderer._prepareString(t,n),s.innerHTML=n}),h.call(this))},t.updateColumn=function(e,t){this.setRendererBusy();var renderer=this;t=this.widget.model.findIndexOfActualItem(t),-1!==t&&($.each(this.table.cells(null,t).nodes().toArray(),function(i,s){var n=e[i];n=renderer._prepareString(t,n),s.innerHTML=n}),h.call(this))},t.updateCell=function(e,t,i,s){this.setRendererBusy();var n=this.table.cell(s);n[0].length>0&&n.data(i),"number"==typeof e&&"number"==typeof t&&(s=this.table.cell(e,t).node()),void 0!==s&&-1===s.className.indexOf("hidden")&&(i=this._prepareString(t,i),s.innerHTML=i),h.call(this)},t.getUpdatedData=function(e){return this.settings.dataOrientation===Enum.Direction.vertical?this.table.column(e).data().toArray():this.table.row(e).data()},t._prepareString=function(e,t){return null===e&&(e=this.inputHandler.itemIndex),"widgets/brease/TableItem"===this.widget.settings.tableItemTypes[e]&&(t.includes("<br>")?(t=t.replace(/<(?!br>)/g,"&lt;"),t=t.split("").reverse().join(""),t=t.replace(/>(?!rb<)/g,";tg&"),t=t.split("").reverse().join("")):(t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"))),this.settings.multiLine&&(t=t.replace(/\\n/g,"<br>")),t},t._mouseUpHandler=function(){$(".mousedown").removeClass("mousedown"),$(document).off(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler"))},t._mouseDownHandler=function(e){if(!brease.config.editMode){var t,i,s,n,a=this._extrapolateCorrectCellIndex(e);n=a[0],t=a[1],n&&(i=n.column,s=n.row,this.widget.settings.dataOrientation===Enum.Direction.vertical?(i=this.widget.model.getActualItem(i),s=this.getPerpendicularItem(s)):(i=this.getPerpendicularItem(i),s=this.widget.model.getActualItem(s)),this._updateSelectedItem(this.options.selectableItem,t,"mousedown"),$(document).on(BreaseEvent.MOUSE_UP,this._bind("_mouseUpHandler")))}},t._itemSelectHandler=function(e){if(!brease.config.editMode){var t,i,s,n,a,r=this._extrapolateCorrectCellIndex(e);if(a=r[0],t=r[1],a){if(s=a.column,n=a.row,this.widget.settings.dataOrientation===Enum.Direction.vertical?(s=this.widget.model.getActualItem(s),n=this.getPerpendicularItem(n)):(s=this.getPerpendicularItem(s),n=this.widget.model.getActualItem(n)),this.widget.isDisabled)return this.widget._forwardClickEvent(e,this.widget.settings.dataOrientation===Enum.Direction.vertical?s:n),void 0;this.settings.selection&&(this._updatePreviouslySelectedItem(this.options.selectableItem),i=this._updateSelectedItem(this.options.selectableItem,t,"selected"));var o={event:e,type:this.options.selectableItem,rowIndex:n,columnIndex:s};this.widget.settings.dataOrientation===Enum.Direction.vertical?(o.tableRow=a.row,o.tableColumn=a.column,this.previouslySelectedItemNbr=a.row):(o.tableRow=n,o.tableColumn=s,this.previouslySelectedItemNbr=a.column),this.widget[this.options.selectionCallbackFn](o);this.widget.createEvent("SelectedRowChanged",{itemSelected:i}).dispatch()}}},t._extrapolateCorrectCellIndex=function(e){var t,i;return"TD"!==e.target.tagName?(t=$(e.target).parent(),i=t[0]._DT_CellIndex):(t=e.target,i=t._DT_CellIndex),[i,t]},t._updatePreviouslySelectedItem=function(e){var t=this.table[e](this.previouslySelectedItemNbr).nodes(),i=0,s=[];for("row"===e&&t[0]?(t[0].classList.remove("selected"),s=t[0].children):"column"===e&&t[0]&&(s=t),i=0;i<s.length;i+=1)s[i].classList.remove("selected")},t._updateSelectedItem=function(e,t,i){var s=this.table[e](t).nodes(),n=0,a=[];for("row"===e&&s[0]?(s[0].classList.add(i),a=s[0].children):"column"===e&&s[0]&&(a=s),n=0;n<a.length;n+=1)a[n].classList.add(i);return s},t.selectItem=function(e,t){var i,s="row"===e;t=this.convertPerpendicularItemToTableIndex(t),this.previouslySelectedItemNbr!==t&&(this._updatePreviouslySelectedItem(e),this.previouslySelectedItemNbr=t,this.settings.selection&&t>-1&&(i=this.table[e](t).nodes(),Array.prototype.forEach.call(i,function(e){void 0!==e&&(e.classList.add("selected"),s&&Array.prototype.forEach.call(e.children,function(e){e.classList.add("selected")}))})))},t.updateHeaderItems=function(){if(this.widget.model.getTableDataBoundaries(this.displayedColumns)&&this.widget.elem){var e=this.widget.elem.getElementsByTagName("table")[0],t=this.widget.elem.getElementsByTagName("colgroup")[0];this._removeColGroup(t),this._addColGroup(e);for(var i=0;i<this.settings.itemFinalVisibility.length;i+=1){var s=this.tableHeaderEl.children()[i];this._updateHeaderItem(s,this.settings.itemFinalVisibility[i],i)}void 0===this.table&&(this.table=this.tableBodyEl.DataTable()),this.refreshScroller()}},t._updateHeaderItem=function(e,t,i){t?this._helperRemoveClass("hidden",e):this._helperHandleClass("hidden",e),t&&!this.settings.itemFinalEnableState[i]?this._helperHandleClass("disabled",e):this._helperRemoveClass("disabled",e),t&&this._applyIndStyle(i,e)},t._helperHandleClass=function(e,t){t&&t.classList.add(e)},t._helperRemoveClass=function(e,t){t&&t.classList.remove(e)},t._applyIndStyle=function(e,t){if(!this.settings.useTableStyling){var i=this.settings.tableItemTypes[e].split("/");t.classList.add(i[0]+"_"+i[1]+"_"+i[2]+"_style_"+this.settings.itemStyling[e]),t.classList.add("override")}},t._getColumnWidth=function(e){var t=this.settings.dataOrientation===Enum.Direction.vertical&&void 0!==this.settings.itemColumnWidths[e]&&0!==this.settings.itemColumnWidths[e]?this.settings.itemColumnWidths[e]:this.settings.columnWidth;return parseInt(t,10)},t._removeColGroup=function(e){void 0!==e&&e.parentNode.removeChild(e)},t._addColGroup=function(e){for(var t=document.createElement("colgroup"),i=0,s=this.widget.model.getTableDataBoundaries(this.displayedColumns).columns,n=0;n<s;n+=1)if(this.settings.dataOrientation!==Enum.Direction.vertical||this.settings.itemFinalVisibility[n]){
var a=document.createElement("col");a.width=this._getColumnWidth(n)+"px",a.setAttribute("br-index",n),t.appendChild(a),i+=this._getColumnWidth(n)}this.widget.el.find("table").width(i),e.insertBefore(t,e.firstChild)},t.updateTexts=function(){this.setRendererBusy();var renderer=this;$.each(this.tableHeaderEl.children(),function(e,t){$(t).children("span").text(renderer.settings.headerTexts[e]),$(t).children("span").html(renderer.widget.model._breakLine($(t).children("span").html()))}),h.call(this)},t.getColumnClasses=function(e){for(var t=[],i=0;i<=e;i+=1){var s=this.widget.model.getActualItem(i);if(void 0!==s){var n=this.widget.model.findIndexOfActualItem(s),a=this.getTableItemEnableState(s)+" "+this.getIndividualItemClass(s)+" "+this.getOverrideClass();a=a.trim(),t.push({className:a,targets:n})}}return t},t.getHorzColumnClasses=function(){var e=[],t=this.widget.model.getColumnsInHorzTable();this.displayedColumns=0;for(var i=0;i<t.length;i+=1){var s="";this.getTableConfigClassesColumn(t[i]).forEach(function(e){0!==e.length&&(s+=e)}),e.push({className:s,targets:i}),""===s&&(this.displayedColumns+=1)}return e},t.getTableItemEnableState=function(e){return this.widget.settings.itemFinalEnableState[e]&&!this.widget.isDisabled?"":"disabled"},t.getTableConfigClassesColumn=function(e){var t=this.settings.tableConfiguration.specColumns;return this.getTableConfigClasses(t,e)},t.getTableConfigClassesRows=function(e){var t=this.settings.tableConfiguration.specRows;return this.getTableConfigClasses(t,e)},t.getIndividualItemClass=function(e){if(!this.settings.useTableStyling&&this.settings.tableItemTypes[e]){var t=this.settings.tableItemTypes[e].split("/");return t[0]+"_"+t[1]+"_"+t[2]+"_style_"+this.settings.itemStyling[e]}return""},t.getOverrideClass=function(){return this.settings.useTableStyling?"":"override"},t.getTableConfigClasses=function(e,t){var i=[];if(e){var s=e.find(function(e){if(e.index===t)return e}),n=e.find(function(e){if(e.from<=t&&t<=e.to||e.from<=t&&void 0===e.to||void 0===e.from&&t<=e.to)return e});(s&&s.disable||n&&n.disable)&&i.push("disabled")}return i},t.getRowClass=function(e){if(!this.settings.useTableStyling)return e%2==0?"odd":"even"},t._defineItemsThatAreEnabled=function(e,t){this.settings.itemFinalEnableState=_.fill(new Array(this.settings.itemEnableStates.length),!0);var i=this;e&&e[t]&&e[t].forEach(function(e){i.settings.itemFinalEnableState=i._evaluateConfPosition(e,i.settings.itemFinalEnableState,!0===e.disable||"true"===e.disable)});for(var s=0;s<this.settings.itemFinalEnableState.length;s+=1)this.settings.itemFinalEnableState[s]=this.settings.itemEnableStates[s]&&this.settings.itemFinalEnableState[s]},t._defineItemsThatAreVisible=function(e,t){this.settings.itemFinalVisibility=_.fill(new Array(this.settings.itemVisibility.length),!0);var i=this;e&&e[t]&&e[t].forEach(function(e){i.settings.itemFinalVisibility=i._evaluateConfPosition(e,i.settings.itemFinalVisibility,!1===e.visible||"false"===e.visible)}),this.displayedColumns=0;for(var s=0;s<this.settings.itemFinalVisibility.length;s+=1)this.settings.itemFinalVisibility[s]=this.settings.itemVisibility[s]&&this.settings.itemFinalVisibility[s],this.displayedColumns+=this.settings.itemFinalVisibility[s]?1:0},t._evaluateConfPosition=function(e,t,i){if(i&&(void 0!==e.index&&e.index<t.length&&(t[e.index]=!1),void 0!==e.from||void 0!==e.to)){e.from=void 0!==e.from?e.from:0,e.to=void 0!==e.to?e.to:t.length;for(var s=e.from;s<=e.to;s+=1)s>=t.length||(t[s]=!1)}return t},t._updateColumnsOrRows=function(){if(this.settings.dataOrientation===Enum.Direction.vertical)s(this.widget,this.settings.rowHeight);else{var e=this;$.each(this.settings.itemRowHeights,function(t,i){e.settings.tableItemTypes[t].includes("ImageList")&&(t=e.widget.model.findIndexOfActualItem(t),s(e.widget,i,t))})}},t.updateColumnWidths=function(){for(var e=this.tableHeaderEl?this.tableHeaderEl.children():[],t=0,i=0,n=0;n<this.settings.tableItemIds.length;n+=1)t=this.settings.dataOrientation===Enum.Direction.horizontal&&0!==this.settings.headerSize?this.settings.headerBarSize:this._getColumnWidth(n),this.settings.tableItemTypes[n].includes("ImageList")&&s(this.widget,this.settings.rowHeight),e[n]&&$(e[n]).outerWidth(t),i+=t;if(this.settings.dataOrientation===Enum.Direction.horizontal){var a=this.widget.el.find(".headerContainer"),r=this.settings.dataOrientation===Enum.Direction.horizontal?t:i;a.width(r),a.children().width(r)}},t.updateRowHeights=function(e){this.setRendererBusy();var t=this.tableBodyEl.find("tr"),i=this.tableHeaderEl?this.tableHeaderEl.children():[],renderer=this;this.settings.dataOrientation===Enum.Direction.horizontal?$.each(renderer.settings.itemRowHeights,function(e,n){var a=renderer.widget.model.findIndexOfActualItem(e);-1!==a&&(0!==n&&void 0!==n||(n=renderer.settings.rowHeight),$(t[e]).height(n),i[e]&&$(i[e]).outerHeight(n),renderer.settings.tableItemTypes[a].includes("ImageList")&&s(renderer.widget,n,a))}):this.settings.dataOrientation===Enum.Direction.vertical&&t.height(this.settings.rowHeight),e||(this.refreshScroller(),h.call(this))},t.updateTableOrder=function(e){if(this.table){var t=this.widget.getInternalOrderState(e),i;this._updateImages(e,t),void 0===t?(i=this.widget.model.getNumberOfItems(),t="asc"):i=this.widget.model.findIndexOfActualItem(e),this.settings.order=[i,t],this.settings.permOrder=[e,t],this.settings.dataOrientation===Enum.Direction.horizontal&&this.widget.model.sortDataHorizontally(i,t),this.table.order(this.settings.order),this.widget.model.getIsProcessedDatasetEmpty()||this._updateTableDataOnly()}},t.updateOrder=function(){if(this.settings.permOrder){var e=this.widget.model.findIndexOfActualItem(this.settings.permOrder[0]);-1===e||this.settings.dataOrientation===Enum.Direction.horizontal?this.settings.order="":this.settings.order=[e,this.settings.permOrder[1]]}},t._updateImages=function(e,t){if(this.settings.showSortingButton)for(var i=0;i<this.settings.tableItemIds.length;i+=1){var s="",n;i===e?(n="asc"===t?"selected":"unselected",s="desc"===t?"selected":"unselected"):(s="unselected",n="unselected"),this.tableHeaderEl.find("svg > g > path:eq("+2*i+")").removeClass("selected").removeClass("unselected").addClass(s),this.tableHeaderEl.find("svg > g > path:eq("+(2*i+1)+")").removeClass("selected").removeClass("unselected").addClass(n)}},t.processStyleChange=function(){var renderer=this;this.styleChangeProcess=_.defer(function(){renderer.updateRowHeights()})},t._inputReadyHandler=function(){this.tableBodyEl.off("inputHandlerReady",_.bind(this._inputReadyHandler,this)),this.addEventListeners()},t._cellClickHandler=function(e){this.tableReady&&("true"!==e.target.getAttribute("input")||$(e.target).hasClass("disabled")||this.inputHandler.requestCellInput(e.target))},t._headerClickHandler=function(e){var t;this.tableHeaderEl.children().each(function(i,s){return $.contains(s,e.target)?(t=i,!1):s===e.target?(t=i,!1):void 0}),this.settings.showSortingButton&&this.updateTableOrder(t),this.widget[this.options.headerClickCallbackFn](e,t)},t.setRowState=function(e,t){var i=$(this.table.row(e).node()),s=this.widget.model.getActualItem(e),n=brease.callWidget(this.settings.tableItemIds[s],"getItemConfig");i.children().toggleClass("disabled",!t).attr("input",n.input),i.prev().children().toggleClass("nextItemDisabled",!t),!0===t&&!0===n.input&&i.children().each(function(e,t){n.inputConfig.validDataLength>e?$(t).attr("input",!0):$(t).attr("input",!1)}),this.tableHeaderEl.children().eq(e).toggleClass("disabled",!t),this.tableHeaderEl.children().eq(e).prev().toggleClass("nextItemDisabled",!t)},t.setColumnState=function(e,t){var i=$(this.table.column(e).nodes()),s=this.widget.model.getActualItem(e),n=brease.callWidget(this.settings.tableItemIds[s],"getItemConfig");i.toggleClass("disabled",!t).attr("input",n.input),e>0&&$(this.table.column(e-1).nodes()).toggleClass("nextItemDisabled",!t),!0===t&&!0===n.input&&i.each(function(e,t){n.inputConfig.validDataLength>e?$(t).attr("input",!0):$(t).attr("input",!1)}),this.tableHeaderEl.children().eq(e).toggleClass("disabled",!t),this.tableHeaderEl.children().eq(e).prev().toggleClass("nextItemDisabled",!t)},t.enable=function(){this.scrollHandler.scrollerBody&&this.table&&this.scrollHandler.scrollerBody.enable(),this.updateTable()},t.disable=function(){this.scrollHandler.scrollerBody&&this.table&&this.scrollHandler.scrollerBody.disable(),this.updateTable()},t.setVisible=function(e){e?(this.updateTable(),b(this.widget),this.refreshScroller()):i(this.widget)},t.setRendererBusy=function(){brease.config.editMode||(this.busy=!0)},t.refreshScroller=function(){this.scrollHandler._refreshScroller()},t.setRendererReady=function(){this.busy=!1,this.widget._hideBusyIndicator()},t._itemResizeHandler=function(e){var t=0,i;if(this.settings.dataOrientation===Enum.Direction.vertical){for(var s=0;s<this.settings.tableItemIds.length;s+=1)this.settings.tableItemIds[s]===e.detail.id&&(this.settings.itemColumnWidths[s]=e.detail.newSize,i=s),t+=parseInt(this.settings.itemColumnWidths[s]);this.widget.el.find(".headerContainer").width(t)}else{for(var n=0;n<this.settings.tableItemIds.length;n+=1)this.settings.tableItemIds[n]===e.detail.id&&(this.settings.itemRowHeights[n]=e.detail.newSize,i=n),t+=parseInt(this.settings.itemRowHeights[n]);this.widget.el.find(".headerContainer").height(t)}f(this,i,e.detail.newSize,t),this.scrollHandler._refreshEditorScroller(!0)},t.resetFilterReportFlag=function(){this.internal.filterOutOfBoundsReported=!0},t.setFilter=function(){var e=this;this.internal.filterSet||($.fn.dataTable.ext.search.push(function(t,i,s,n){var a=$(t.nTable).closest(".breaseTable")[0];if(!a||a.id!==e.widget.elem.id||0===e.widget.model.getData().length||0===e.widget.settings.itemConfigs.length)return!0;for(var r=0===e.widget.settings.filter.length,o=!0,l=0;l<e.widget.settings.filter.length;l+=1){var d=e.widget.settings.filter[l],c,h,u=e.widget.settings.itemConfigs[d.data];if(!u)return e.internal.filterOutOfBoundsReported||(e.internal.filterOutOfBoundsReported=!0,e.widget._createLogEntry("accessing data outside of the Table's scope @ item position "+d.data,"filterConfiguration")),!0;if(!u)return!0;var g=e.widget.model.getData()[s],m=g[g.length-1],p;c=d.comp,"date"===u.type?(c=e._fixTimestamp(c.split("Z")[0],u.inputConfig.format),h=brease.callWidget(e.widget.settings.tableItemIds[d.data],"getValue")[m],"string"==typeof h&&(h=e._fixTimestamp(h.split("Z")[0],u.inputConfig.format))):(p=e.widget.model.getOriginalData(),d.data<p.length&&(h=p[d.data][m]));var f=e._getFilterStatement(h,d.opVal,c);1===d.logVal||""===d.logical?(r=r||o&&f,o=!0):0===d.logVal&&(o=o&&f)}return r}),this.internal.filterSet=!0,this.internal.filterPos=$.fn.dataTable.ext.search.length-1)},t._getFilterStatement=function(e,t,i){var s;if(isNaN(+e)||(e=+e),isNaN(+i)||(i=+i),"not supported"===i)return!0;switch(e instanceof Date&&(e=e.getTime(),i=i.getTime()),t){case 0:s=e!=i;break;case 1:s=e==i;break;case 2:s=e<i;break;case 3:s=e<=i;break;case 4:s=e>i;break;case 5:s=e>=i;break;case 6:s="string"==typeof e&&-1!==e.indexOf(i);break;case 7:s="string"==typeof e&&-1===e.indexOf(i);break;default:s=!0}return s},t._fixTimestamp=function(e,t){var i=new Date(e);return-1!==t.indexOf("f")?i=i:-1!==t.indexOf("s")?i.setMilliseconds(0):-1!==t.indexOf("m")?(i.setMilliseconds(0),i.setSeconds(0)):-1!==t.indexOf("H")||-1!==t.indexOf("h")?(i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(0)):-1!==t.indexOf("d")?(i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(0),i.setHours(0)):-1!==t.indexOf("M")?(i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(0),i.setHours(0),i.setDate(0)):-1!==t.indexOf("y")&&(i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(0),i.setHours(0),i.setDate(0),i.setMonth(0)),i},t.getPerpendicularItem=function(e){if(this.table){if(this.settings.dataOrientation===Enum.Direction.vertical){var t=this.table.row(e).data();return t[t.length-1]}return this.table.rows(this.table.rows().count()-1).data().toArray()[0][e]}},t.convertPerpendicularItemToTableIndex=function(e){if(this.table)return this.settings.dataOrientation===Enum.Direction.vertical?this.widget.model.getActualRowIndex(e):this.table.rows(this.table.rows().count()-1).data().toArray()[0].indexOf(e)},t.removeEventListeners=function(){brease.config.editMode&&this.widget.elem.removeEventListener("ItemSizeChanged",this._bind("_itemResizeHandler")),this.tableBodyEl.off(BreaseEvent.CLICK,_.bind(this._cellClickHandler,this)),!1!==this.settings.selection&&this.tableBodyEl.off(BreaseEvent.MOUSE_DOWN,_.bind(this._mouseDownHandler,this))},t.addEventListeners=function(){this.tableBodyEl.on(BreaseEvent.CLICK,_.bind(this._cellClickHandler,this)),!1!==this.settings.selection&&this.tableBodyEl.on(BreaseEvent.MOUSE_DOWN,_.bind(this._mouseDownHandler,this))},t.closeInputWidgets=function(e){this.inputHandler&&this.inputHandler.closeInputWidgets(e)},t.dispose=function(){$.fn.dataTable.ext.search.splice(this.internal.filterPos,1,function(){return!0}),this.internal.filterPos=-1,p(this),this.removeEventListeners(),window.clearTimeout(this.styleChangeProcess),this.tableReady=null,this.scrollHandler&&this.scrollHandler.dispose(),this.inputHandler&&this.inputHandler.dispose(),e.prototype.dispose.apply(this,arguments)},t.suspend=function(){this.inputHandler.suspend(),this._removeResizeObserver(),this.removeEventListeners()},t.wake=function(){this.inputHandler.wake(),this.addEventListeners(),this._addResizeObserver(this.tableBodyEl.get(0))};function s(e,t,i){void 0!==t&&0!==t||(t=e.settings.rowHeight);var s,n=0;if(i){if(s=e.elem.querySelectorAll("tr")[i],!s)return;for(n=0;n<s.children.length;n+=1)0!==s.children[n].children.length&&(s.children[n].children[0].style.maxHeight=t-1+"px")}else for(s=e.elem.querySelectorAll("tr > td > img"),n=0;n<s.length;n+=1)s[n].style.maxHeight=t-1+"px"}function n(renderer){var e=$('<div class="dataTables_scrollHead"></div>'),t=renderer.settings.headerBarSize;renderer.widget.settings.showHeader||(e.css("display","none"),t=0),renderer.tableHeaderEl=$('<div class="tableHeader">').on(BreaseEvent.CLICK,renderer._bind("_headerClickHandler")),renderer.settings.dataOrientation===Enum.Direction.vertical?(e.height(t),e.addClass("verticalOrientation")):renderer.settings.dataOrientation===Enum.Direction.horizontal&&(e.width(t),e.addClass("horizontalOrientation")),e.append(renderer.tableHeaderEl);var i=renderer.widget.el.find(".headerContainer");i.length>0?e.insertAfter(i):renderer.widget.container.prepend(e)}function a(renderer){var e=[],t=[],i=0;$.each(renderer.settings.tableItemIds,function(t){var s=$('<div class="headerElement" style="box-sizing:border-box;"/>').append($("<span>").text(renderer.settings.headerTexts[t])),n;(renderer.settings.itemFinalVisibility[t]||renderer.settings.itemVisibility[t]||s.addClass("hidden"),renderer.settings.dataOrientation===Enum.Direction.vertical?(n=renderer.settings.itemColumnWidths[t]>0?renderer.settings.itemColumnWidths[t]:renderer.settings.columnWidth,s.width(n)):renderer.settings.dataOrientation===Enum.Direction.horizontal&&(n=renderer.settings.itemRowHeights[t]>0?renderer.settings.itemRowHeights[t]:renderer.settings.columnWidth,s.height(n)),e.push(s),renderer.settings.showSortingButton)&&UtilsImage.getInlineSvg("widgets/brease/Table/assets/sort_arrow.svg").then(function(t){var s=$('<svg class="ordering img_vert" />');s.replaceWith(t),s=t,s.addClass("ordering"),renderer.settings.dataOrientation===Enum.Direction.vertical?s.addClass("img_vert"):s.addClass("img_horz"),e[i].append(s),i+=1})}),$.when(t).done(function(){renderer.tableHeaderEl.append(e)}).fail()}function r(renderer){var e=$('<div class="dataTables_scrollBody"/>'),t=renderer.widget.el.find(".dataTables_scrollHead").detach(),i=renderer.widget.settings.showHeader?renderer.settings.headerBarSize:0;renderer.widget.container.find(".dataTable thead").remove(),renderer.tableWrapper=renderer.widget.container.find(".dataTables_wrapper"),renderer.tableBodyEl.addClass("tableCells"),renderer.settings.dataOrientation===Enum.Direction.vertical?(e.css("height","calc(100% - "+i+"px)"),e.addClass("verticalOrientation"),renderer.tableWrapper.addClass("verticalOrientation")):renderer.settings.dataOrientation===Enum.Direction.horizontal&&(e.css("width","calc(100% - "+i+"px)"),t.width(renderer.settings.headerBarSize),e.addClass("horizontalOrientation"),renderer.tableWrapper.addClass("horizontalOrientation")),renderer.tableBodyEl.wrap(e),renderer.tableWrapper.prepend(t)}function o(renderer){renderer.tableBodyEl=$("<table>").attr("id",renderer.widget.elem.id+"_table"),brease.config.editMode||(renderer.inputHandler&&renderer.inputHandler.inputsReady?renderer.tableBodyEl.on(BreaseEvent.CLICK,_.bind(renderer._cellClickHandler,renderer)):renderer.tableBodyEl.on("inputHandlerReady",_.bind(renderer._inputReadyHandler,renderer))),renderer.widget.container.append(renderer.tableBodyEl)}t._buildTable=function(e){if(!brease.config.preLoadingState){var t=this._preprocessBuildTable();if(!t||t[0]&&t[0].empty)return this.widget.resolveTable();this.updateOrder();var i={data:t,autoWidth:!1,ordering:this.settings.dataOrientation===Enum.Direction.vertical&&this.settings.showSortingButton,order:this.settings.order,paging:!1,info:!1,dom:"t",language:{zeroRecords:""},columns:this.columnDefinition,columnDefs:[{targets:"_all",createdCell:_.bind(u,this),orderable:!0,searchable:!0}],initComplete:e?_.bind(c,this):_.bind(d,this),drawCallback:_.bind(h,this),createdRow:_.bind(g,this)},s;this.settings.dataOrientation===Enum.Direction.vertical?(i.columnDefs.push({targets:-1,searchable:!1,visible:!1,orderable:!0}),s=this.getColumnClasses(this.columnDefinition.length)):s=this.getHorzColumnClasses(),s.length>0&&(i.columnDefs=i.columnDefs.concat(s)),this.tableBodyEl.DataTable(i)}},t._preprocessBuildTable=function(){if(!this.widget.model.getIsDatasetEmpty()){this.widget.model.getNumberOfRowsAvailable()>0&&this.setFilter();var e=this.settings.dataOrientation===Enum.Direction.vertical?"specColumns":"specRows";if(this._defineItemsThatAreVisible(this.widget.settings.tableConfiguration,e),this._defineItemsThatAreEnabled(this.widget.settings.tableConfiguration,e),this.widget.model.sliceDataAccordingToTableConfig(this.widget.settings.tableConfiguration),this.settings.dataOrientation===Enum.Direction.horizontal&&""!==this.settings.permOrder){var t=this.widget.model.findIndexOfActualItem(this.settings.permOrder[0]);t>-1&&this.widget.model.sortDataHorizontally(t,this.settings.permOrder[1])}var i=this.widget.model.getData();return l(this,i),i}};function l(renderer,e){renderer.columnDefinition=[];var t=1;renderer.settings.dataOrientation===Enum.Direction.vertical?(renderer.settings.itemFinalVisibility.forEach(function(e){e&&t++}),e[0]&&(t=Math.min(t,Math.max(1,e[0].length)))):e.length>0&&(t=e[0].length),renderer.columnDefinition=_.fill(Array(isNaN(t)?1:t),null)}function d(){m(this),r(this),this.updateHeaderItems(),this.updateColumnWidths(!0),this.updateRowHeights(!0),this.scrollHandler.initializeScroller(!1,!1),this.refreshScroller(),b(this.widget),this.tableReady=!0,this.widget[this.options.tableReadyCallbackFn](),"vertical"===this.settings.dataOrientation?this.selectItem("row",this.settings.selectedRow):this.selectItem("column",this.settings.selectedColumn),this._addResizeObserver(this.tableBodyEl.get(0)),this.setRendererReady()}function c(){m(this),r(this),this.updateHeaderItems(),this.updateColumnWidths(!0),this.updateRowHeights(!0),this.scrollHandler.initializeScroller(!1,!0),b(this.widget),this.tableReady=!0,this.widget[this.options.tableReadyCallbackFn](),"vertical"===this.settings.dataOrientation?this.selectItem("row",this.settings.selectedRow):this.selectItem("column",this.settings.selectedColumn),this._addResizeObserver(this.tableBodyEl.get(0)),this.addEventListeners(),this.setRendererReady()}function h(){this._updateColumnsOrRows(),this.widget[this.options.drawCallbackFn](),this.refreshScroller(),this.setRendererReady()}function u(e,t,i,s,n){var a;a=this.settings.dataOrientation===Enum.Direction.vertical?this.widget.model.getActualItem(n):this.widget.model.getActualItem(s),this.settings.itemConfigs[a]&&(this.settings.itemConfigs[a].input?e.setAttribute("input",!0):e.setAttribute("input",!1),"number"===this.settings.itemConfigs[a].type||"nodeNumber"===this.settings.itemConfigs[a].type?e.setAttribute("type","number"):"string"===this.settings.itemConfigs[a].type&&e.setAttribute("type","string"))}function g(e,t,i,s){var n,a=this.settings,r=-1;a.dataOrientation===Enum.Direction.vertical?(this._fixVerticalRowOnCallback(e,t,i),n=a.rowHeight):(r=this._fixHorzRowOnCallback(e,t,i),n=a.itemRowHeights[r]>0?a.itemRowHeights[r]:a.rowHeight),e.style.height=n+"px"}t._fixVerticalRowOnCallback=function(e,t,i){var s=this.getTableConfigClassesRows(t[t.length-1]),n=-1;s.length>0&&e.classList.add(s),this.widget.isDisabled&&e.classList.add("disabled");for(var a=this.getRowClass(i),r=0;r<e.children.length;r+=1){n=this.widget.model.getActualItem(r);var o=this.getTableItemEnableState(n);s.length>0&&e.children[r].classList.add(s),o.length>0&&e.children[r].classList.add(o),a&&e.children[r].classList.add(a)}if(this.settings.selection&&i===this.previouslySelectedItemNbr){e.classList.add("selected");for(var l=0;l<e.children.length;l+=1)e.children[l].classList.add("selected")}},t._fixHorzRowOnCallback=function(e,t,i){var s=this.widget.model.getActualItem(i);if(!(s<0)){var n={enableState:"",tableItemClass:"",overrideClass:""};this.widget.model.isLastItem(i)?n.enableState="hidden":(n.enableState=this.getTableItemEnableState(s),n.tableItemClass=this.getIndividualItemClass(s),n.overrideClass=this.getOverrideClass());for(var a in n){var r=n[a];""!==r&&(e.classList.add(r),this.addHorColumnClasses(e,r))}return this.settings.selection&&void 0!==this.previouslySelectedItemNbr&&void 0!==e.children[this.previouslySelectedItemNbr]&&e.children[this.previouslySelectedItemNbr].classList.add("selected"),s}},t.addHorColumnClasses=function(e,t){for(var i=0;i<e.children.length;i+=1){var s=e.children[i].classList,n=this.getRowClass(i);s.contains(n)||s.add(n),s.add(t)}};function m(renderer){renderer.settings.ellipsis&&renderer.widget.elem.classList.add("ellipsis"),renderer.settings.wordWrap&&renderer.settings.multiLine?renderer.widget.elem.classList.add("wordWrap"):renderer.settings.multiLine&&renderer.widget.elem.classList.add("mulitLine")}function p(renderer){if(renderer._removeResizeObserver(),renderer.table){var e=renderer.widget.container.find(".dataTables_scrollHead").detach();renderer.widget.container.append(e),renderer.scrollHandler.removeScroller(),renderer.table.destroy(!0),renderer.table=void 0}renderer.tableBodyEl&&renderer.tableBodyEl.off().empty()}function f(renderer,e,t,i){var s=renderer.tableHeaderEl.find(".headerElement");if(renderer.settings.dataOrientation===Enum.Direction.vertical){var n=renderer.tableBodyEl.find("col");$(n[e]).width(t),$(s[e]).width(t),renderer.tableHeaderEl.width(i),renderer.tableBodyEl.width(i)}else{var a=renderer.tableBodyEl.find("tr");$(a[e]).height(t),$(s[e]).height(t),renderer.tableHeaderEl.height(i),renderer.tableBodyEl.height(i)}}function b(e){if(e.settings.maxHeight>e.settings.height){var t=Math.max(Math.min(e.container.find(".dataTable").outerHeight()+e.settings.headerBarSize,e.settings.maxHeight),e.settings.height);e.el.height(t)}}return t._addResizeObserver=function(e){if(this.widget.settings.tableItemTypes.some(function(e){return e.includes("ImageList")})){var t=e.querySelector("td");if(t&&parseInt(getComputedStyle(t).getPropertyValue("padding"))>1&&"function"==typeof ResizeObserver&&void 0===this.tableBodyResizeObserver){var renderer=this;renderer.tableBodyResizeObserver=new ResizeObserver(function(){renderer.refreshScroller()}),renderer.tableBodyResizeObserver.observe(e)}}},t._removeResizeObserver=function(){this.tableBodyResizeObserver&&(this.tableBodyResizeObserver.disconnect(),this.tableBodyResizeObserver=void 0)},Renderer}),define("text!widgets/brease/Table/Table.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Table">CONTENT</div>\r\n'}),define("widgets/brease/Table/Table",["brease/core/ContainerWidget","brease/events/BreaseEvent","brease/enum/Enum","widgets/brease/Table/libs/Renderer","widgets/brease/Table/libs/Model","brease/core/Utils","widgets/brease/Table/libs/Config","widgets/brease/Table/libs/Dialogue","widgets/brease/Table/libs/ConfigBuilder","widgets/brease/common/BusyIndicatorHandler/libs/BusyIndicatorHandler","brease/controller/libs/LogCode"],function(e,BreaseEvent,Enum,Renderer,Model,Utils,t,i,ConfigBuilder,BusyIndicatorHandler,LogCode){"use strict";var s=e.extend(function Table(){e.apply(this,arguments)},t),n=s.prototype;n.init=function(){this.el.on(BreaseEvent.WIDGET_READY,this._bind("_widgetReadyHandler")),!0!==this.settings.omitClass&&this.addInitialClass("breaseTable container"),brease.config.editMode||e.prototype.init.call(this,!0),this.settings.cellVisibility=[],this.settings.cellDisability=[],this.tableReadyRumble=!1,this._setTableVisibleUpdated(!1),this._setTableEnableUpdated(!1),!0===brease.config.editMode&&(this.widgetReady=new $.Deferred,this.tableReady=new $.Deferred,this._startInitialisation(),this.addInitialClass("iatd-outline"),e.prototype.init.call(this)),this.configBuilder=new ConfigBuilder(this),this.busyIndicatorHandler=new BusyIndicatorHandler(this),this.busyIndicatorHandler.createBusyIndicator(),c(this),this.settings.dataOrientation===Enum.Direction.horizontal?this.settings.rendererOptions.selectableItem="column":this.settings.rendererOptions.selectableItem="row",this.settings.dataOrientation===Enum.Direction.horizontal?this.settings.headerBarSize=0===this.settings.headerSize?+this.settings.columnWidth:this.settings.headerSize:this.settings.headerBarSize=0===this.settings.headerSize?+this.settings.rowHeight:this.settings.headerSize,this.settings.showScrollbars||(this.settings.rendererOptions.scroller.scrollbars=!1),this.initModel(),this.initRenderer(),brease.config.editMode||(this.widgetReady=new $.Deferred,this.tableReady=new $.Deferred,Utils.isString(this.settings.tableConfiguration)&&this._parseTableConfiguration(this.settings.tableConfiguration),this._startInitialisation(),this.settings.filter=this.configBuilder.parseFilter(this.settings.filterConfiguration))},n._initEditor=function(){var e=this;require(["widgets/brease/Table/libs/EditorBehavior"],function(EditorBehavior){e.editorBehavior=new EditorBehavior(e),e.editorBehavior.initialize(),e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},n.initRenderer=function(){this.renderer=new Renderer(this,this.settings.rendererOptions)},n.initModel=function(){this.model=new Model(this)},n.widgetAddedHandler=function(e){var t;this.settings.editor.first?(this.settings.editor.first=!1,t=this.container.children("[data-brease-widget]")):(t=this.container.children(".headerContainer").children("[data-brease-widget]"),t.push(this.container.children("[data-brease-widget]")[0])),Array.prototype.forEach.call(t,function(e,t){this.settings.editor.editorItemOrder[t]=e.id,this.settings.tableItemIds[t]=e.id,this.settings.tableItemTypes[t]=e.getAttribute("data-brease-widget")},this),this.settings.editor.added+=1,this.settings.editor.added>=this.settings.editor.editorItemOrder.length&&(this.childrenInitializedInEditorHandler(),this.editorBehavior.childrenAdded(e),$("#"+this.settings.tableItemIds[0]).parent().off("ItemSizeChanged",this._bind("updateChangeInEditor")).on("ItemSizeChanged",this._bind("updateChangeInEditor")).off("ItemSizeChanging",this._bind("updateTempSizeChangeEditor")).on("ItemSizeChanging",this._bind("updateTempSizeChangeEditor"))),this.tableReady&&Array.prototype.forEach.call(t,function(e){brease.callWidget(e.id,"setTableReady",this.elem.id,!0)},this),this.renderer.refreshScroller()},n.widgetRemovedHandler=function(e){var t=this.settings.tableItemIds.indexOf(e.detail.widgetId);this.settings.tableItemIds.splice(t,1),this.settings.tableItemTypes.splice(t,1),this.settings.itemRowHeights.splice(t,1),this.settings.itemColumnWidths.splice(t,1),this.settings.itemVisibility.splice(t,1),this.settings.itemEnableStates.splice(t,1),this.settings.itemStyling.splice(t,1),this.settings.itemConfigs.splice(t,1),this.settings.headerTexts.splice(t,1),this.settings.editor.editorItemOrder.splice(t,1),this.settings.editor.added-=1,this.model.removeData(t),this.editorBehavior.childrenRemoved(t),this.renderer.refreshScroller()},n.updateChangeInEditor=function(){this._showBusyIndicator(),this.settings.editorFirst=!0,this.childrenInitializedInEditorHandler(),this.editorBehavior.childrenUpdated(),this.renderer.refreshScroller()},n.updateTempSizeChangeEditor=function(e){for(var t=this.settings.tableItemIds.indexOf(e.detail.id),i=0,s=this.settings.dataOrientation===Enum.Direction.vertical?e.detail.newColumnSize:e.detail.newRowSize,n=0;n<this.settings.tableItemIds.length;n+=1)if(n!==t){var a=0;a=this.settings.dataOrientation===Enum.Direction.vertical?0!==this.settings.itemColumnWidths[n]?this.settings.itemColumnWidths[n]:this.settings.columnWidth:0!==this.settings.itemRowHeights[n]?this.settings.itemRowHeights[n]:this.settings.rowHeight,i+=parseInt(a)}else i+=parseInt(s);console.warn("We are updating",e.detail.id,s,i),this.settings.dataOrientation===Enum.Direction.vertical?(this.elem.getElementsByTagName("table")[0].style.width=i+"px",this.elem.getElementsByClassName("headerContainer")[0].style.width=i+"px",this.elem.getElementsByTagName("col")[t].style.width=s+"px",this.elem.getElementsByClassName("headerElement")[t].style.width=s+"px"):(this.elem.getElementsByClassName("headerContainer")[0].style.height=i+"px",this.elem.getElementsByTagName("tr")[t].style.height=s+"px",this.elem.getElementsByClassName("headerElement")[t].style.height=s+"px")},n.setStyle=function(t){e.prototype.setStyle.call(this,t),this.renderer&&this.renderer.processStyleChange()},n.setTableData=function(e){this.renderer.setFilter(),e||!this.renderer.tableReady?this.renderer.updateTable():this.renderer.updateTableDataOnly()},n.setRowData=function(e,t){this.model.setDataItem(e,t),this.setTableData()},n.setColumnData=function(e,t){this.model.setDataItem(e,t),this.setTableData()},n.setRefreshRate=function(e){this.settings.refreshRate=e},n.getRefreshRate=function(){return this.settings.refreshRate},n.setInitRefreshRate=function(e){this.settings.initRefreshRate=e},n.getInitRefreshRate=function(){return this.settings.initRefreshRate},n.setStopRefreshAtScroll=function(e){this.settings.stopRefreshAtScroll=e},n.getStopRefreshAtScroll=function(){return this.settings.stopRefreshAtScroll},n.setRowHeight=function(e){this.settings.rowHeight=e,this.settings.headerBarSize=0===this.settings.headerSize?this.settings.dataOrientation===Enum.Direction.vertical?+this.settings.rowHeight:+this.settings.columnWidth:this.settings.headerSize,brease.config.editMode&&this.updateChangeInEditor()},n.getRowHeight=function(){return this.settings.rowHeight},n.setColumnWidth=function(e){this.settings.columnWidth=e,this.settings.headerBarSize=0===this.settings.headerSize?this.settings.dataOrientation===Enum.Direction.vertical?+this.settings.rowHeight:+this.settings.columnWidth:this.settings.headerSize,brease.config.editMode&&this.updateChangeInEditor()},n.getColumnWidth=function(){return this.settings.columnWidth},n.setDataOrientation=function(e){if(this.settings.dataOrientation=e,e===Enum.Direction.vertical?(this.el.find(".container").removeClass("horizontal").addClass("vertical"),this.settings.rendererOptions.selectableItem="row",this.settings.headerBarSize=0===this.settings.headerSize?+this.settings.rowHeight:this.settings.headerSize):(this.el.find(".container").removeClass("vertical").addClass("horizontal"),this.settings.rendererOptions.selectableItem="column",this.settings.headerBarSize=0===this.settings.headerSize?+this.settings.columnWidth:this.settings.headerSize),brease.config.editMode){for(var t=0;t<this.settings.tableItemIds.length;t+=1)brease.callWidget(this.settings.tableItemIds[t],"setDataOrientation",e)
;this.updateChangeInEditor()}},n.getDataOrientation=function(){return this.settings.dataOrientation},n.setOffsetRow=function(e){if(this.settings.offsetRow=e,this.renderer.tableReady){if(e>this.model.getTableDataBoundaries(this.renderer.displayedColumns).rows-1)return this.renderer.scrollHandler.calcScrollItemOffset(),void 0;this.offsetRowDeferID=_.defer(function(e){e.omitScrollPositionSubmit=!0,e.renderer.scrollHandler.scrollToIndex(e.settings.offsetRow,e.settings.offsetColumn),void 0!==e.offsetColumnDeferID&&window.clearTimeout(e.offsetColumnDeferID)},this)}},n.getOffsetRow=function(){return this.settings.offsetRow},n.setOffsetColumn=function(e){if(this.settings.offsetColumn=e,this.renderer.tableReady){if(e>this.model.getTableDataBoundaries(this.renderer.displayedColumns).columns-1)return this.renderer.scrollHandler.calcScrollItemOffset(),void 0;this.offsetColumnDeferID=_.defer(function(e){e.omitScrollPositionSubmit=!0,e.renderer.scrollHandler.scrollToIndex(e.settings.offsetRow,e.settings.offsetColumn),void 0!==e.offsetRowDeferID&&window.clearTimeout(e.offsetRowDeferID)},this)}},n.getOffsetColumn=function(){return this.settings.offsetColumn},n.setSelectedRow=function(e){this.settings.selectedRow=e,this.renderer.tableReady&&"vertical"===this.settings.dataOrientation&&this.renderer.selectItem("row",e,!0)},n.getSelectedRow=function(){return this.settings.selectedRow},n.setSelectedColumn=function(e){this.settings.selectedColumn=e,this.renderer.tableReady&&"horizontal"===this.settings.dataOrientation&&this.renderer.selectItem("column",e,!0)},n.getSelectedColumn=function(){return this.settings.selectedColumn},n.setTableConfiguration=function(e){Utils.isObject(e)?this.settings.tableConfiguration=e:Utils.isString(e)&&(this._parseTableConfiguration(e),this._showBusyIndicator(),this._updateTable())},n._parseTableConfiguration=function(e){0===e.length&&(this.settings.tableConfiguration=[]);try{this.settings.tableConfiguration=JSON.parse(e.replace(/'/g,'"'))}catch(t){this.settings.tableConfiguration="",console.iatWarn(this.elem.id+': TableConfiguration string "'+e+'" is invalid!'),this._createLogEntry(e,"tableConfiguration")}},n.getTableConfiguration=function(){return this.settings.tableConfiguration},n.setFilterConfiguration=function(e){this.renderer.resetFilterReportFlag(),this.settings.filterConfiguration=e,this.settings.filter=this.configBuilder.parseFilter(e),this._updateTable()},n.getFilterConfiguration=function(){return this.settings.filterConfiguration},n.setEllipsis=function(e){this.settings.ellipsis=e,brease.config.editMode&&this.updateChangeInEditor()},n.getEllipsis=function(){return this.settings.ellipsis},n.setUseTableStyling=function(e){this.settings.useTableStyling=e,brease.config.editMode&&this.updateChangeInEditor()},n.getUseTableStyling=function(){return this.settings.useTableStyling},n.setShowSortingButton=function(e){this.settings.showSortingButton=e,brease.config.editMode&&this.updateChangeInEditor()},n.getShowSortingButton=function(){return this.settings.showSortingButton},n.setMultiLine=function(e){this.settings.multiLine=e,brease.config.editMode&&this.updateChangeInEditor()},n.getMultiLine=function(){return this.settings.multiLine},n.setHeaderSize=function(e){this.settings.headerSize=e,this.settings.headerBarSize=0===e?this.settings.dataOrientation===Enum.Direction.vertical?+this.settings.rowHeight:+this.settings.columnWidth:e,brease.config.editMode&&this.updateChangeInEditor()},n.getHeaderSize=function(){return this.settings.headerSize},n.setWordWrap=function(e){this.settings.wordWrap=e,brease.config.editMode&&this.updateChangeInEditor()},n.getWordWrap=function(){return this.settings.wordWrap},n.setSelection=function(e){this.settings.selection=e,brease.config.editMode&&this.updateChangeInEditor()},n.getSelection=function(){return this.settings.selection},n.setShowScrollbars=function(e){this.settings.showScrollbars=e,this.settings.rendererOptions.scroller.scrollbars=e,brease.config.editMode&&this.updateChangeInEditor()},n.getShowScrollbars=function(){return this.settings.showScrollbars},n.setShowHeader=function(e){this.settings.showHeader=e,brease.config.editMode&&this.updateChangeInEditor()},n.getShowHeader=function(){return this.settings.showHeader},n.setMaxHeight=function(e){this.settings.maxHeight=e},n.getMaxHeight=function(){return this.settings.maxHeight},n.setScrollLinkYRefId=function(e){this.settings.scrollLinkYRefId=e,brease.config.editMode&&this.updateChangeInEditor()},n.getScrollLinkYRefId=function(){return this.settings.scrollLinkYRefId},n.setScrollLinkXRefId=function(e){this.settings.scrollLinkXRefId=e,brease.config.editMode&&this.updateChangeInEditor()},n.getScrollLinkXRefId=function(){return this.settings.scrollLinkXRefId},n.setBusyIndicatorDelay=function(e){this.settings.busyIndicatorDelay=e},n.getBusyIndicatorDelay=function(){return this.settings.busyIndicatorDelay},n.scrollToHorizontal=function(e){if(this.renderer.tableReady){var t=this.model.getTableDataBoundaries(this.renderer.displayedColumns).columns;void 0!==e&&e>=0&&e<t&&this.renderer.scrollHandler.scrollToIndex(-1,e)}},n.scrollToVertical=function(e){if(this.renderer.tableReady){var t=this.model.getTableDataBoundaries(this.renderer.displayedColumns).rows;void 0!==e&&e>=0&&e<t&&this.renderer.scrollHandler.scrollToIndex(e,-1)}},n.scrollPageDown=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollPageDown()},n.scrollPageUp=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollPageUp()},n.scrollPageLeft=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollPageLeft()},n.scrollPageRight=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollPageRight()},n.scrollStepDown=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollItemDown()},n.scrollStepUp=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollItemUp()},n.scrollStepRight=function(){this.renderer&&this.renderer.scrollHandler.scrollItemRight()},n.scrollStepLeft=function(){this.renderer.tableReady&&this.renderer.scrollHandler.scrollItemLeft()},n.setVerticalScroll=function(e,t){if(this.settings.dataOrientation===Enum.Direction.vertical?this.renderer.scrollHandler.scrollTo(e,"Y",!1):this.renderer.scrollHandler.scrollTo(e,"Y",!0),void 0!==this.settings.scrollLinkYRefId){if(-1!==t.indexOf(this.elem.id)||-1!==t.indexOf(this.settings.scrollLinkYRefId))return!1;t.push(this.elem.id),brease.callWidget(this.settings.scrollLinkYRefId,"setVerticalScroll",e,t)}},n.setHorizontalScroll=function(e,t){if(this.settings.dataOrientation===Enum.Direction.vertical?this.renderer.scrollHandler.scrollTo(e,"X",!0):this.renderer.scrollHandler.scrollTo(e,"X",!1),void 0!==this.settings.scrollLinkXRefId){if(-1!==t.indexOf(this.elem.id)||-1!==t.indexOf(this.settings.scrollLinkXRefId))return!1;t.push(this.elem.id),brease.callWidget(this.settings.scrollLinkXRefId,"setHorizontalScroll",e,t)}},n.setRowVisibility=function(e,t){o(this,"row",e,t),this._updateTable(),this.submitTableConfiguration()},n.setColumnVisibility=function(e,t){o(this,"column",e,t),this._updateTable(),this.submitTableConfiguration()},n.openConfiguration=function(e){this.isDisabled||("Filtering"===e?(this.configDialogue=new i(this),this.configDialogue.openFilter()):console.iatWarn("Unsupported configuration type!"))},n._clickHandler=function(t){this.renderer._itemSelectHandler(t),e.prototype._clickHandler.apply(this,arguments)},n._startInitialisation=function(){var e=this;if(this.winit=!0,$.when(this.widgetReady.promise(),this.tableReady.promise()).then(function t(){null!==e.elem&&Array.isArray(e.settings.tableItemIds)&&e.settings.tableItemIds.forEach(function(t){brease.callWidget(t,"setTableReady",e.elem.id,!0)})}),this.tableReady.then(function t(){e.createEvent("TableReady",{}).dispatch(),brease.config.preLoadingState||e._startTable()}),brease.config.editMode&&0===this.settings.tableItemIds.length)return!1;this._childInitializationProgress()},n._widgetReadyHandler=function(e){e.target.id===this.elem.id&&this.widgetReady.resolve()},n._startTable=function(){this.tableReadyRumble=!0,r(this,this.settings.tableItemIds),this.renderer.setInitData(),this._showBusyIndicator(),this.dataInitialization()},n._tableReadyCallback=function(){this.omitScrollPositionSubmit=!1;var e=this.model.getTableDataBoundaries(this.renderer.displayedColumns);this.settings.offsetColumn<=e.columns-1&&this.settings.offsetRow<=e.rows-1?0!==this.settings.offsetColumn&&0!==this.settings.offsetRow?this.renderer.scrollHandler.scrollToIndex(this.settings.offsetRow,this.settings.offsetColumn):0!==this.settings.offsetColumn&&0===this.settings.offsetRow?this.renderer.scrollHandler.scrollToIndex(-1,this.settings.offsetColumn):0===this.settings.offsetColumn&&0!==this.settings.offsetRow&&this.renderer.scrollHandler.scrollToIndex(this.settings.offsetRow,-1):this.renderer.scrollHandler.calcScrollItemOffset(),this.resolveTable()},n._rendererReadyCallback=function(){},n.resolveTable=function(){"resolved"!==this.widgetReady.state()&&this._dispatchReady(),this.sizeChanged()},n.sizeChanged=function(){this.createEvent("SizeChanged").dispatch()},n._selectionCallback=function(e){void 0!==e.rowIndex&&(this.settings.selectedRow=e.rowIndex,this.sendValueChange({selectedRow:e.rowIndex})),void 0!==e.columnIndex&&(this.settings.selectedColumn=e.columnIndex,this.sendValueChange({selectedColumn:e.columnIndex})),void 0!==e.rowIndex&&void 0!==e.columnIndex&&(this.settings.dataOrientation===Enum.Direction.vertical?l(this,e.rowIndex):l(this,e.columnIndex)),this.settings.dataOrientation===Enum.Direction.vertical?this._forwardClickEvent(e.event,e.columnIndex):this._forwardClickEvent(e.event,e.rowIndex)},n._drawCallback=function(){this.settings.tableItemIds.length>0&&this._hideBusyIndicator()},n._scrollCallback=function(e){this.settings.offsetRow=e.row,this.settings.offsetColumn=e.column,!1===this.omitScrollPositionSubmit?this.submitScrollOffset():this.omitScrollPositionSubmit=!1},n._headerClickCallback=function(e,t){this._forwardClickEvent(e,t)},n._valueUpdateAvailable=function(e){var t=!1,i=this.settings.tableItemIds.indexOf(e),s=this._getDataFromItem(e),n=Math.max.apply(Math,this.settings.tableItemLengths);this.settings.tableItemLengths[i]=s.length,t=n!==Math.max.apply(Math,this.settings.tableItemLengths),t&&!1===this.winit||!1===this.winit&&this.settings.filterConfiguration.length>3||!1===this.winit&&this.settings.showSortingButton?(r(this,this.settings.tableItemIds),this._getData(this.settings.tableItemIds,i),this.setTableData(!1)):(brease.uiController.callWidget(e,"valueUpdateApplied"),this.settings.dataOrientation===Enum.Direction.horizontal?this.setRowData(s,i):this.settings.dataOrientation===Enum.Direction.vertical&&this.setColumnData(s,i))},n._headerUpdateAvailable=function(e){var t=this.settings.tableItemIds.indexOf(e),i=brease.uiController.callWidget(e,"getHeaderText");brease.uiController.callWidget(e,"headerUpdateApplied"),this._showBusyIndicator(),this.settings.headerTexts[t]=i,this.tableReadyRumble&&this.renderer.updateTexts(),brease.config.editMode&&this.updateChangeInEditor()},n._itemConfigUpdateAvailable=function(e){"string"!=typeof e&&(e=e.target.id),brease.config.editMode||r(this,this.settings.tableItemIds)},n._itemSizeUpdateAvailable=function(e,t,i){var s=this.settings.tableItemIds.indexOf(e),n=0;"column"===t?(n=brease.uiController.callWidget(e,"getColumnWidth"),brease.uiController.callWidget(e,"itemSizeUpdateApplied"),this.settings.itemColumnWidths[s]=n,this.renderer.updateColumnWidths()):"row"===t&&(n=brease.uiController.callWidget(e,"getRowHeight"),brease.uiController.callWidget(e,"itemSizeUpdateApplied"),this.settings.itemRowHeights[s]=n,this.renderer.updateRowHeights()),"table"!==i&&this._updateTable()},n._visibleUpdateAvailable=function(e){"string"!=typeof e&&(e=e.target.id),brease.config.editMode||(this.renderer.closeInputWidgets(e),this._visibleEnableAvailableHandler(e,"isVisible","visibleUpdateApplied","itemVisibility",this._getTableVisibleUpdated()))},n._enableUpdateAvailable=function(e){this.renderer.closeInputWidgets(e),this._visibleEnableAvailableHandler(e,"isEnabled","enableUpdateApplied","itemEnableStates",this._getTableEnableUpdated())},n._visibleEnableAvailableHandler=function(e,t,i,s,n){this._showBusyIndicator();var a=this.settings.tableItemIds.indexOf(e),r=brease.uiController.callWidget(e,t);brease.uiController.callWidget(e,i),this.settings[s][a]=r,!n&&this.isVisible()&&this._updateTable()},n._formatUpdateAvailable=function(e){var t=this.settings.tableItemIds.indexOf(e),i=brease.uiController.callWidget(e,"getFormat");this.settings.itemConfigs[t].inputConfig.format=i},n._forwardClickEvent=function(e,t){var i=d(this,t);brease.callWidget(i,"_clickHandler",e,{origin:i})},n.getInternalOrderState=function(e){return brease.callWidget(d(this,e),"updateOrderState")},n.submitScrollOffset=function(){if(!0===this.isDisabled)return!1;this.sendValueChange({offsetRow:this.settings.offsetRow}),this.sendValueChange({offsetColumn:this.settings.offsetColumn})},n.submitUserInput=function(e,t){var i=this.settings.tableItemIds[e];brease.callWidget(i,"submitChange",t),this.createEvent("ValueChanged",{}).dispatch(),this.setTableData()},n.submitTableConfiguration=function(){this.sendValueChange({tableConfiguration:JSON.stringify(this.getTableConfiguration()).replace(/"/g,"'")})},n.submitFilterConfiguration=function(){this.settings.filterConfiguration=this.configBuilder.serializeFilter(this.settings.filter),this.sendValueChange({filterConfiguration:this.settings.filterConfiguration})},n._childInitializationProgress=function(){a(this)},n.childrenInitializedHandler=function(){var e=this;this.container.children(".breaseWidget").each(function(){"TABLE"!==this.tagName&&(e.settings.tableItemIds.push($(this).attr("id")),e.settings.tableItemTypes.push($(this).attr("data-brease-widget")))}),brease.config.preLoadingState?(this.widgetReady.resolve(),this._dispatchReady()):"resolved"!==this.tableReady.state()&&this.tableReady.resolve()},n.childrenInitializedInEditorHandler=function(){this.renderer.setInitData(),this._showBusyIndicator(),this.dataInitDone(this.settings.editorFirst),this.settings.editorFirst=!1},n.dataInitialization=function(){for(var e=this,t=[],i=0;i<this.settings.tableItemIds.length;i+=1)t[i]=new $.Deferred,t[i].promise();$.when.apply($,t).then(function(){e.el.off("dataInitDone"),e.dataInitDone(),e.scroller=e.renderer.scrollHandler.scrollerBody}),Array.isArray(this.settings.tableItemIds)&&this.settings.tableItemIds.forEach(function(i,s){brease.callWidget(i,"getDataInitState")?t[s].resolve():e.el.one("dataInitDone",function(i){var s=i.target.id;i.stopImmediatePropagation(),t[_.indexOf(e.settings.tableItemIds,s)].resolve()})})},n.dataUpdateData=function(){r(this,this.settings.tableItemIds),this._getData(this.settings.tableItemIds,void 0),this.setTableData(!1)},n.dataInitDone=function(e){e=void 0===e||e,r(this,this.settings.tableItemIds),this._getData(this.settings.tableItemIds,void 0),this.winit=!1,this.setTableData(e)},n.disable=function(){e.prototype.disable.apply(this,arguments),this.renderer&&this.renderer.disable()},n.enable=function(){e.prototype.enable.apply(this,arguments),this.renderer&&this.renderer.enable()},n._enableHandler=function(t){this._setTableEnableUpdated(!0),!1===t&&this.renderer.closeInputWidgets(),e.prototype._enableHandler.apply(this,arguments)},n._visibleHandler=function(){this._setTableVisibleUpdated(!0),e.prototype._visibleHandler.apply(this,arguments)},n._setTableVisibleUpdated=function(e){this.settings.tableVisibleUpdated=e},n._getTableVisibleUpdated=function(){return this.settings.tableVisibleUpdated},n._setTableEnableUpdated=function(e){this.settings.tableEnableUpdated=e},n._getTableEnableUpdated=function(){return this.settings.tableEnableUpdated},n.updateVisibility=function(){e.prototype.updateVisibility.apply(this,arguments),this.renderer&&this.renderer.setVisible(this.isVisible())},n._getData=function(e,t){var i=[];if(0!==e.length)if(void 0===t){var s=this;Array.isArray(e)&&e.forEach(function(e){var t=s._getDataFromItem(e);i.push(t)}),this.model.setData(i)}else i=this._getDataFromItem(e[t]),this.model.setDataItem(i,t)},n._getDataFromItem=function(e){var t=brease.callWidget(e,"getData");return brease.uiController.callWidget(e,"valueUpdateApplied"),t},n._updateTable=function(){(this.tableReadyRumble||brease.config.editMode)&&this.renderer.updateTable()},n._showBusyIndicator=function(){this.busyIndicatorHandler.showBusyIndicator()},n._hideBusyIndicator=function(){this.busyIndicatorHandler.hideBusyIndicator()},n._scrollXYHandler=function(e){e.stopImmediatePropagation();var t=[this.elem.id];void 0!==this.settings.scrollLinkYRefId&&void 0!==this.settings.scrollLinkXRefId?(brease.callWidget(this.settings.scrollLinkYRefId,"setVerticalScroll",e.detail,t),brease.callWidget(this.settings.scrollLinkXRefId,"setHorizontalScroll",e.detail,t)):void 0!==this.settings.scrollLinkYRefId?brease.callWidget(this.settings.scrollLinkYRefId,"setVerticalScroll",e.detail,t):void 0!==this.settings.scrollLinkXRefId&&brease.callWidget(this.settings.scrollLinkXRefId,"setHorizontalScroll",e.detail,t)},n.dispose=function(){brease.config.editMode||(window.clearTimeout(this.offsetRowDeferID),window.clearTimeout(this.offsetColumnDeferID)),this.elem.removeEventListener("ScrollXY",this._bind("_scrollXYHandler")),this.renderer.dispose(),this.busyIndicatorHandler.dispose(),this.editorBehavior&&this.editorBehavior.dispose(),e.prototype.dispose.apply(this,arguments)},n.suspend=function(){this.renderer.suspend(),e.prototype.suspend.apply(this,arguments)},n.wake=function(){this.renderer.wake(),e.prototype.wake.apply(this,arguments),this.internalData.preLoaded&&(this.internalData.preLoaded=!1,this.tableReady.resolve())},n.placedInDatabase=function(){this.settings.standalone=!1},n.sliceDatabaseData=function(){this.model.shortenData()},n.purgeDatabaseData=function(){this.model.resetData()};function a(e){var t=[];e.el.find("[data-brease-widget]").each(function(){var e=this,i=e.id,s=$.Deferred();t.push(s),brease.uiController.getWidgetState(i)===Enum.WidgetState.READY?s.resolve():e.addEventListener(BreaseEvent.WIDGET_READY,function(){s.resolve()})}),$.when.apply($,t).done(function(){e.childrenInitializedHandler()})}function r(e,t){e.settings.itemVisibility=[],e.settings.itemColumnWidths=[],e.settings.itemRowHeights=[],e.settings.headerTexts=[],e.settings.itemConfigs=[],e.settings.itemEnableStates=[],e.settings.itemStyling=[],Array.isArray(t)&&t.forEach(function(t){e.settings.itemVisibility.push(brease.callWidget(t,"isVisible")),brease.uiController.callWidget(t,"visibleUpdateApplied"),e.settings.itemColumnWidths.push(brease.callWidget(t,"getColumnWidth")),e.settings.itemRowHeights.push(brease.callWidget(t,"getRowHeight")),brease.uiController.callWidget(t,"itemSizeUpdateApplied"),e.settings.headerTexts.push(brease.callWidget(t,"getHeaderText")),brease.uiController.callWidget(t,"headerUpdateApplied"),e.settings.itemConfigs.push(brease.callWidget(t,"getItemConfig")),e.settings.itemEnableStates.push(brease.callWidget(t,"isEnabled")),brease.uiController.callWidget(t,"enableUpdateApplied"),e.settings.itemStyling.push(brease.callWidget(t,"getStyle"))})}function o(e,t,i,s){var n="spec"+t.charAt(0).toUpperCase()+t.slice(1)+"s",a=!1;if(void 0!==e.settings.tableConfiguration&&Utils.isObject(e.settings.tableConfiguration))if(Array.isArray(e.settings.tableConfiguration[n])){for(var r=0;r<e.settings.tableConfiguration[n].length;r+=1)e.settings.tableConfiguration[n][r].index===i&&(e.settings.tableConfiguration[n][r].visible=s,a=!0);a||e.settings.tableConfiguration[n].push({index:i,visible:s})}else e.settings.tableConfiguration[n]=[],e.settings.tableConfiguration[n].push({index:i,visible:s});else e.settings.tableConfiguration={specRows:[],specColumns:[]},e.settings.tableConfiguration[n].push({index:i,visible:s})}function l(e,t){Array.isArray(e.settings.tableItemTypes)&&e.settings.tableItemTypes.forEach(function(i,s){i.includes("TableItemImageList")&&brease.callWidget(e.settings.tableItemIds[s],"_updateSelectedImageIndex",t)})}function d(e,t){return e.settings.tableItemIds[t]}function c(e){0===e.settings.scrollLinkYRefId.length&&(e.settings.scrollLinkYRefId=void 0),0===e.settings.scrollLinkXRefId.length&&(e.settings.scrollLinkXRefId=void 0),e.elem.addEventListener("ScrollXY",e._bind("_scrollXYHandler"))}return n._createLogEntry=function(e,t){var i=["Table",this.elem.id,e,t],s=LogCode.getConfig(LogCode.CLIENT_INVALID_PROPERTY_VALUE);brease.loggerService.log(s.code,Enum.EventLoggerCustomer.BUR,s.verboseLevel,s.severity,i)},s}),define("text!widgets/brease/TableColumnWidget/TableColumnWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableColumnWidget">CONTENT</div>'}),define("widgets/brease/TableItemWidget/designer/ClassInfo",["brease/core/designer/BaseWidget/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableItemWidget",parents:["*"],children:[],inheritance:["widgets.brease.TableItemWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},SetColumnWidth:{method:"setColumnWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setDataOrientation:{method:"setDataOrientation",parameter:{dataOrientation:{name:"dataOrientation",index:0,type:"brease.enum.Direction"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setHeaderText:{method:"setHeaderText",parameter:{headerText:{name:"headerText",index:0,type:"String"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetRowHeight:{method:"setRowHeight",parameter:{value:{name:"value",index:0,type:"Size"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{value:{name:"value",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brease/TableItem/designer/ClassInfo",["widgets/brease/TableItemWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableItem",parents:["widgets.brease.Table"],children:[],inheritance:["widgets.brease.TableItem","widgets.brease.TableItemWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},SetColumnWidth:{method:"setColumnWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setDataOrientation:{method:"setDataOrientation",parameter:{dataOrientation:{name:"dataOrientation",index:0,type:"brease.enum.Direction"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setHeaderText:{method:"setHeaderText",parameter:{headerText:{name:"headerText",index:0,type:"String"}}},setMaxValue:{method:"setMaxValue",parameter:{value:{name:"value",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{value:{name:"value",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.ArrayNode"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetRowHeight:{method:"setRowHeight",parameter:{value:{name:"value",index:0,type:"Size"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},setStringValue:{method:"setStringValue",parameter:{stringValue:{name:"stringValue",index:0,type:"StringArray1D"}}},setStyle:{method:"setStyle"},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{value:{name:"value",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},setValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"NumberArray1D"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TableItem/TableItem.html",[],function(){return'<div id="WIDGETID"  data-brease-widget="widgets/brease/TableItem">CONTENT</div>\r\n'}),define("widgets/brease/TableItemWidget/TableItemWidget",["brease/core/BaseWidget","brease/events/BreaseEvent","brease/decorators/LanguageDependency","brease/core/Types"],function(e,BreaseEvent,t,Types){"use strict";var i={text:"",rowHeight:0,columnWidth:0,dataInitialized:!1,fireDataInitEvent:!1,order:void 0,headerText:""},s=e.extend(function TableItemWidget(){e.apply(this,arguments)},i),n=s.prototype;n.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTableItemWidget"),e.prototype.init.call(this);var t=this;this.tableReady=!1,this.valueInitState=new $.Deferred,$.when(this.valueInitState.promise()).then(function e(){t.settings.dataInitialized=!0,t.settings.fireDataInitEvent&&(t.dispatchEvent(new CustomEvent("dataInitDone",{bubbles:!0,cancelable:!0})),t.settings.fireDataInitEvent=!1),t.valueUpdateAvailable&&t.updateTableValues(),t.updateTableConfig()}),this.tableReady=!1,a(this),this.visibleUpdateAvailable=!1,this.headerUpdateAvailable=!1,this.itemSizeUpdateAvailable=!1,this.initialTableReadyCall=!1},n._clickHandler=function(t,i){this.isDisabled||this.table&&this.table.isDisabled?this._disabledClickHandler(t,i):e.prototype._clickHandler.apply(this,arguments)},n._updateTable=function(){if(!this.isDisabled&&this.tableReady){this.createEvent("TableItemChanged",{}).dispatch()}},n.enableUpdateApplied=function(){this.enableUpdateAvailable=!1},n._visibleHandler=function(){e.prototype._visibleHandler.apply(this,arguments),this.visibleUpdateAvailable=!0,this.isTableReady()&&brease.callWidget(this.tableId,"_visibleUpdateAvailable",this.elem.id),this.isTableReady()&&this.isVisible()&&this.valueUpdateAvailable&&this.updateTableValues()},n.visibleUpdateApplied=function(){this.visibleUpdateAvailable=!1},n.submitChange=function(){},n.setText=function(e){this.settings.text=Types.parseValue(e,"String"),!1===brease.language.isKey(this.settings.text)?(this.updateText(this.settings.text),this.removeTextKey()):this.setTextKey(brease.language.parseKey(this.settings.text),!0),brease.config.editMode&&this._updateTable()},n.getText=function(){return this.settings.text},n.setHeaderText=function(e){this.settings.headerText=e},n.getHeaderText=function(){return this.settings.headerText},n.updateText=function(e){null!==e&&(this.setHeaderText(e),this.updateTableHeader())},n.setTextKey=function(e,t){void 0!==e&&(this.settings.textkey=e,this.setLangDependency(!0),!0===t&&this.updateText(brease.language.getTextByKey(this.settings.textkey)))},n.removeTextKey=function(){this.settings.textkey=null,this.setLangDependency(!1)},n.getTextKey=function(){return this.settings.textkey},n.setRowHeight=function(e){void 0!==e&&(this.settings.rowHeight=e,this.itemSizeUpdateAvailable=!0,this.isTableReady()&&(brease.config.editMode?this.itemUpdate(e,this.settings.columnWidth):brease.callWidget(this.tableId,"_itemSizeUpdateAvailable",this.elem.id,"row")))},n.getRowHeight=function(){return this.settings.rowHeight},n.setColumnWidth=function(e){void 0!==e&&(this.settings.columnWidth=e,this.itemSizeUpdateAvailable=!0,this.isTableReady()&&(brease.config.editMode?this.itemUpdate(this.settings.rowHeight,e):brease.callWidget(this.tableId,"_itemSizeUpdateAvailable",this.elem.id,"column")))},n.getColumnWidth=function(){return this.settings.columnWidth},n.itemSizeUpdateApplied=function(){this.itemSizeUpdateAvailable=!1},n.updateTableHeader=function(){this.isTableReady()&&(this.headerUpdateAvailable=!0,brease.callWidget(this.tableId,"_headerUpdateAvailable",this.elem.id,this.getHeaderText()))},n.headerUpdateApplied=function(){this.headerUpdateAvailable=!1},n.updateOrderState=function(){return void 0===this.order?this.order="desc":"desc"===this.order?this.order="asc":"asc"===this.order&&(this.order=void 0),this.order},n.headerUpdateApplied=function(){this.headerUpdateAvailable=!1},n.setTableReady=function(e,t){this.tableId=e,this.table=brease.callWidget(this.tableId,"widget"),this.settings.dataOrientation=brease.callWidget(this.tableId,"getDataOrientation"),this.tableReady=t,this.initUpdateTableValues(),this.updateTableHeader()},n.langChangeHandler=function(){this.settings.textkey&&this.updateText(brease.language.getTextByKey(this.settings.textkey))},n.initUpdateTableValues=function(){this.initialTableReadyCall||this.updateTableValues()},n.getDataInitState=function(){return this.settings.dataInitialized||(this.settings.fireDataInitEvent=!0),this.settings.dataInitialized},n.valueUpdateApplied=function(){this.valueUpdateAvailable=!1},n.getData=function(){return this.settings.data},n.getDataUpdateState=function(){var e={};return e.valueUpdateAvailable=this.valueUpdateAvailable,e.visibleUpdateAvailable=this.visibleUpdateAvailable,e.headerUpdateAvailable=this.headerUpdateAvailable,e.itemSizeUpdateAvailable=this.itemSizeUpdateAvailable,e.enableUpdateAvailable=this.enableUpdateAvailable,e},n.updateTableValues=function(){},n.updateTableConfig=function(){this.isTableReady()&&brease.callWidget(this.tableId,"_itemConfigUpdateAvailable",this.elem.id)},n._enableHandler=function(){e.prototype._enableHandler.apply(this,arguments),this.enableUpdateAvailable=!0,this.isTableReady()&&brease.callWidget(this.tableId,"_enableUpdateAvailable",this.elem.id)},n.dispose=function(){this.valueInitState=null,this.enableUpdateAvailable=null,this.enableUpdateApplied=null,this.visibleUpdateAvailable=null,this.visibleUpdateApplied=null,this.headerUpdateAvailable=null,this.itemSizeUpdateAvailable=null,this.tableReady=null,this.tableId=null,this.table=null,e.prototype.dispose.apply(this,arguments)};function a(e){void 0!==e.settings.text&&(!1===brease.language.isKey(e.settings.text)?e.setText(e.settings.text):e.setTextKey(brease.language.parseKey(e.settings.text),!0))}return n._initEditor=function(){var e=this;require(["widgets/brease/TableItemWidget/libs/EditorHandles"],function(EditorHandles){var t=new EditorHandles(e);e.el.addClass("flex-item"),e.getHandles=function(){return t.getHandles()},e.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()},e.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))})},n.isTableReady=function(){return this.tableReady},n.setDataOrientation=function(e){this.settings.dataOrientation=e},n.itemUpdate=function(e,t){var i=new CustomEvent("ItemSizeChanged",{detail:{id:this.elem.id,newRowSize:e,newColumnSize:t},bubbles:!0,cancelable:!0});this.dispatchEvent(i)},n.updateEditor=function(e,t){if(this.tableReady){var i=new CustomEvent("ItemSizeChanging",{detail:{id:this.elem.id,newRowSize:e,newColumnSize:t},bubbles:!0,cancelable:!0});this.dispatchEvent(i)}},t.decorate(s,!1)}),
define("widgets/brease/TableItem/TableItem",["widgets/brease/TableItemWidget/TableItemWidget","brease/decorators/LanguageDependency","brease/decorators/MeasurementSystemDependency","brease/config/NumberFormat","brease/datatype/ArrayNode","brease/core/Utils","brease/core/Types","brease/enum/Enum","widgets/brease/common/libs/wfUtils/UtilsEditableBinding"],function(e,t,i,NumberFormat,ArrayNode,Utils,Types,Enum,UtilsEditableBinding){"use strict";var s={format:{default:{decimalPlaces:1,minimumIntegerDigits:1}},unit:void 0,showUnit:!1,value:[],stringValue:[],node:void 0,data:void 0,validDataLength:0,dataType:void 0,input:!1,inputStyle:void 0,useDigitGrouping:!0,maxValue:100,minValue:0,limitViolationPolicy:Enum.LimitViolationPolicy.NO_SUBMIT,restrict:void 0,maxLength:void 0},n=e.extend(function TableItem(){e.apply(this,arguments)},s),a=n.prototype;a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTableItem"),e.prototype.init.call(this),this.displayUnit="",this.data={node:new ArrayNode(this.settings.value,null,this.settings.minValue,this.settings.maxValue)},o(this),l(this),brease.config.editMode&&(this.settings.mockData=["1","2","3","4","5","6","7","8","9","10"],this.settings.mockString=["Mock 1","Mock 2","Mock 3","Mock 4","Mock 5","Mock 6","Mock 7","Mock 8","Mock 9","Mock 10"],this.settings.data=this.settings.mockData,this.el.zIndex(this.el.zIndex()+1))},a.setFormat=function(e){if(Utils.isObject(e))this.settings.format=e,o(this),this.formatData(),this.isTableReady()&&brease.callWidget(this.tableId,"_formatUpdateAvailable",this.elem.id);else if("string"==typeof e){try{this.settings.format=JSON.parse(e.replace(/'/g,'"')),o(this),this.formatData()}catch(t){console.iatWarn(this.elem.id+': Format String "'+e+'" is invalid!')}this.isTableReady()&&brease.callWidget(this.tableId,"_formatUpdateAvailable",this.elem.id)}},a.getFormat=function(){return this.settings.format},a.setUnit=function(e){if(Utils.isObject(e))this.settings.unit=e,this.processMeasurementSystemUpdate();else if("string"==typeof e)try{this.settings.unit=JSON.parse(e.replace(/'/g,'"')),this.processMeasurementSystemUpdate()}catch(t){console.iatWarn(this.elem.id+': Unit String "'+e+'" is invalid!')}},a.getUnit=function(){return this.settings.unit},a.setShowUnit=function(e){this.settings.showUnit=e},a.getShowUnit=function(){return this.settings.showUnit},a.setHeaderText=function(t){this.getShowUnit()&&void 0!==this.displayUnit?this.settings.headerText=t+" ["+this.displayUnit+"]":e.prototype.setHeaderText.apply(this,arguments)},a.setValue=function(e){void 0!==e&&(e=Array.isArray(e)?e:[],this.data.node.setValue(e),this.settings.validDataLength=this.data.node.getValue().length,this.settings.dataType="number",this.formatData(this.data.node.getValue()),"resolved"!==this.valueInitState.state()&&this.valueInitState.resolve())},a.getValue=function(){return this.data.node.value},a.setNode=function(e){void 0!==e.value&&(this.data.node.setId(e.id),this.data.node.setUnit(e.unit),this.setMinValue(e.minValue),this.setMaxValue(e.maxValue),e.value=Array.isArray(e.value)?e.value:[],this.data.node.setValue(e.value),this.settings.validDataLength=this.data.node.getValue().length,this.settings.dataType||this.updateTableConfig(),this.settings.dataType="nodeNumber",this.formatData(this.data.node.getValue()),"resolved"!==this.valueInitState.state()&&this.valueInitState.resolve())},a.setMinValue=function(e){Utils.isNumeric(e)&&this.data.node.setMinValue(e)},a.setMaxValue=function(e){Utils.isNumeric(e)&&this.data.node.setMaxValue(e)},a.getMinValue=function(){return this.data.node.minValue},a.getMaxValue=function(){return this.data.node.maxValue},a.getNode=function(){return this.data.node},a.setStringValue=function(e){void 0!==e&&(this.settings.stringValue=e,e=null===e?[]:e,this.settings.validDataLength=e.length,this.settings.data=brease.config.editMode?this.settings.mockString:d(this,e),this.settings.dataType||this.updateTableConfig(),this.settings.dataType="string",this.updateTableValues(),"resolved"!==this.valueInitState.state()&&this.valueInitState.resolve())},a.getStringValue=function(){return this.settings.stringValue},a.setEditable=function(e,t){this.settings.input&&UtilsEditableBinding.handleEditable(e,t,this,["node","stringValue","value"])},a.formatData=function(e){if(void 0===e)switch(this.settings.dataType){case"number":e=brease.config.editMode?this.settings.mockData:this.data.node.value;break;case"nodeNumber":e=brease.config.editMode?this.settings.mockData:this.data.node.value;break;default:return}for(var t=[],i=0;i<e.length;i+=1)t[i]=brease.formatter.formatNumber(e[i],this.settings.numberFormat,this.settings.useDigitGrouping,this.settings.separators);this.settings.data=t,this.updateTableValues()},a.updateTableValues=function(){this.valueUpdateAvailable=!0,this.settings.dataInitialized&&this.isTableReady()&&this.isVisible()&&brease.callWidget(this.tableId,"_valueUpdateAvailable",this.elem.id)},a.getItemConfig=function(){var e={};return e.type=this.settings.dataType,e.input=this.settings.input,e.inputConfig={},e.inputConfig.inputStyle=this.settings.inputStyle,e.inputConfig.validDataLength=this.settings.validDataLength,"string"===this.settings.dataType?(e.inputConfig.restrict=this.settings.restrict,e.inputConfig.maxLength=this.settings.maxLength):"number"!==this.settings.dataType&&"nodeNumber"!==this.settings.dataType||(e.inputConfig.useDigitGrouping=this.settings.useDigitGrouping,e.inputConfig.limitViolationPolicy=this.settings.limitViolationPolicy,e.inputConfig.format=this.settings.format,e.inputConfig.maxValue=this.settings.maxValue,e.inputConfig.minValue=this.settings.minValue,e.inputConfig.unit=this.settings.unit),e},a.measurementSystemChangeHandler=function(){this.processMeasurementSystemUpdate()},a.processMeasurementSystemUpdate=function(){var e=this;this.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem(),this.settings.numberFormat=NumberFormat.getFormat(this.settings.format,this.settings.mms);var t=this.data.node.unit;void 0!==this.settings.unit&&(this.data.node.unit=this.settings.unit[this.settings.mms]),this.data.node.unit!==t&&brease.language.pipeAsyncUnitSymbol(this.data.node.unit,function(t){e.displayUnit=void 0===t?void 0===e.displayUnit?"":e.displayUnit:t,e.setText(e.settings.text)});var i=brease.uiController.getSubscriptionsForElement(this.elem.id);void 0!==i&&void 0!==i.node&&this.data.node.unit!==t&&(this.sendNodeChange({attribute:"node",nodeAttribute:"unit",value:this.data.node.unit}),void 0!==this.settings.textkey?this.setTextKey(this.settings.textkey):this.setText(this.settings.text))},a.mockData=function(e){this.setValue(Array.apply(null,new Array(e)).map(Number.prototype.valueOf,0))},a.getNumberFormat=function(){return this.settings.numberFormat},a.langChangeHandler=function(){e.prototype.langChangeHandler.apply(this),this.settings.stringValue.length>0&&this.setStringValue(this.settings.stringValue)},a.submitChange=function(e){switch(this.settings.dataType){case"number":this.data.node.value=r(this,e,"Number"),this.formatData(this.data.node.value),this.sendValueChange({value:this.getValue()});break;case"nodeNumber":this.data.node.value=r(this,e,"Number"),this.formatData(this.data.node.value),this.sendValueChange({node:this.getNode()});break;case"string":this.settings.stringValue=r(this,e,"String"),this.settings.data=this.settings.stringValue,this.sendValueChange({stringValue:this.getStringValue()});break}this.createEvent("ValueChanged",{}).dispatch()},a.getItemType=function(){return"widgets/brease/TableItem"},a.dispose=function(){e.prototype.dispose.apply(this,arguments)};function r(e,t,i){return"String"===i?t.slice(0,e.settings.validDataLength).map(function(e){return Types.parseValue(e,i)}):t.slice(0,e.settings.validDataLength)}function o(e){e.settings.separators=brease.user.getSeparators(),e.settings.mms=brease.measurementSystem.getCurrentMeasurementSystem();var t=Utils.isObject(e.settings.format)?e.settings.format:{};e.defaultSettings.format&&e.defaultSettings.format.default&&(t.default=Utils.deepCopy(e.defaultSettings.format.default)),e.settings.numberFormat=NumberFormat.getFormat(t,e.settings.mms)}function l(e){Utils.isObject(e.settings.unit)||Utils.isString(e.data.node.unit)?(void 0!==e.settings.unit&&(e.data.node.unit=e.settings.unit[e.settings.mms]),brease.language.pipeAsyncUnitSymbol(e.data.node.unit,function(t){e.displayUnit=t,e.setText(e.settings.text)})):e.displayUnit=void 0}function d(e,t){var i=[];return t.forEach(function(t){brease.language.isKey(t)?(i.push(brease.language.getTextByKey(brease.language.parseKey(t))),e.setLangDependency(!0)):i.push(t)}),i}return i.decorate(t.decorate(n,!1),!0)}),define("widgets/brease/TableItemDateTime/designer/ClassInfo",["widgets/brease/TableItemWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableItemDateTime",parents:["widgets.brease.Table"],children:[],inheritance:["widgets.brease.TableItemDateTime","widgets.brease.TableItemWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},SetColumnWidth:{method:"setColumnWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setDataOrientation:{method:"setDataOrientation",parameter:{dataOrientation:{name:"dataOrientation",index:0,type:"brease.enum.Direction"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"String"},metaData:{name:"metaData",index:1,type:"Object"},omitValueInit:{name:"omitValueInit",index:2,type:"Boolean"}}},setHeaderText:{method:"setHeaderText",parameter:{headerText:{name:"headerText",index:0,type:"String"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetRowHeight:{method:"setRowHeight",parameter:{value:{name:"value",index:0,type:"Size"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{value:{name:"value",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"DateTimeArray1D"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{value:{nodeRefId:"node"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TableItemDateTime/TableItemDateTime.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableItemDateTime">CONTENT</div>'}),define("widgets/brease/TableItemDateTime/TableItemDateTime",["widgets/brease/TableItemWidget/TableItemWidget","brease/events/BreaseEvent","brease/decorators/CultureDependency","brease/helper/DateFormatter"],function(e,BreaseEvent,CultureDependency,DateFormatter){"use strict";var t={data:[],value:[],format:"F",formatKey:"",dataInitialized:!1,fireDataInitEvent:!1,dataType:"date",selectedImageIndex:-1},i=e.extend(function TableItemDateTime(){e.apply(this,arguments)},t),s=i.prototype;s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTableItemDateTime"),e.prototype.init.call(this),this.setFormatIsSet=!1,this.setValueIsSet=!1,a(this),brease.config.editMode&&(this.settings.mockData=["1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00","1970-01-01T00:00:01.000+00:00"],this.formatData(this.settings.mockData),this.el.zIndex(this.el.zIndex()+1));var t=this;this.el.one(BreaseEvent.WIDGET_READY,function(){t.settings.fireDataInitEvent=!0,n.call(t,"value")||t.valueInitState.resolve()})},s.setValue=function(e){void 0!==e&&(this.settings.value=Array.isArray(e)?e:[],this.setValueIsSet=!0,n.call(this,"format")&&!this.setFormatIsSet||(this.formatData(),"resolved"!==this.valueInitState.state()&&this.valueInitState.resolve()))},s.getValue=function(){return this.settings.value},s.setFormat=function(e,t,i){void 0===i&&(i=!1),void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.format=e,this.settings.formatKey=void 0):this.setFormatKey(brease.language.parseKey(e)),brease.config.editMode?this.formatData(this.settings.mockData):(this.formatData(),this.setFormatIsSet=!i,"resolved"!==this.valueInitState.state()&&!i&&this.setValueIsSet&&this.valueInitState.resolve()))},s.getFormat=function(){return this.settings.format},s.setFormatKey=function(e){if(void 0!==e){this.settings.formatKey=e,this.setCultureDependency(!0);var t=brease.language.getTextByKey(this.settings.formatKey);"undefined key"!==t?(this.settings.format=t,brease.config.editMode?this.formatData(this.settings.mockData):this.formatData()):console.iatWarn(this.elem.id+": Format textKey not found: "+e)}else this.settings.formatKey=void 0,console.iatInfo(this.elem.id+": The text key is not valid : "+e)},s.formatData=function(e){void 0!==e&&null!==e||(e=this.settings.value);var t=this,i,s=[];e.forEach(function(e,n){var a=new Date(e);a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),DateFormatter.format(a,t.settings.format,function(e){i=e}),s[n]=i}),t.settings.data=s,this.updateTableValues()},s.getData=function(){return this.settings.data},s.getDataUpdateState=function(){var e={};return e.enableUpdateAvailable=this.enableUpdateAvailable,e.valueUpdateAvailable=this.valueUpdateAvailable,e.visibleUpdateAvailable=this.visibleUpdateAvailable,e.headerUpdateAvailable=this.headerUpdateAvailable,e.itemSizeUpdateAvailable=this.itemSizeUpdateAvailable,e},s.getItemConfig=function(){var e={};return e.type=this.settings.dataType,e.input=!1,e.inputConfig={},e.inputConfig.format=this.settings.format,e.inputConfig.inputStyle="default",e.inputConfig.validDataLength=0,e},s.updateTableValues=function(){this.valueUpdateAvailable=!0,this.settings.dataInitialized&&this.isTableReady()&&(this.initialTableReadyCall=!0,brease.callWidget(this.tableId,"_valueUpdateAvailable",this.elem.id))},s.cultureChangeHandler=function(){this.settings.formatKey?this.setFormatKey(this.settings.formatKey):this.formatData(),e.prototype.langChangeHandler.apply(this,arguments)},s.getItemType=function(){return"widgets/brease/TableItemDateTime"};function n(e){return void 0!==this.bindings&&void 0!==this.bindings[e]}function a(e){e.setFormat(e.settings.format,void 0,!0)}return CultureDependency.decorate(i,!0)}),define("widgets/brease/TableItemImageList/designer/ClassInfo",["widgets/brease/TableItemWidget/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TableItemImageList",parents:["widgets.brease.Table"],children:[],inheritance:["widgets.brease.TableItemImageList","widgets.brease.TableItemWidget","brease.core.BaseWidget"],actions:{setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},SetColumnWidth:{method:"setColumnWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setDataOrientation:{method:"setDataOrientation",parameter:{dataOrientation:{name:"dataOrientation",index:0,type:"brease.enum.Direction"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setHeaderText:{method:"setHeaderText",parameter:{headerText:{name:"headerText",index:0,type:"String"}}},SetImageList:{method:"setImageList",parameter:{imageList:{name:"imageList",index:0,type:"GraphicCollection"}}},setImagePrefix:{method:"setImagePrefix",parameter:{imagePrefix:{name:"imagePrefix",index:0,type:"DirectoryPath"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetRowHeight:{method:"setRowHeight",parameter:{value:{name:"value",index:0,type:"Size"}}},setSelectedImageIndex:{method:"setSelectedImageIndex",parameter:{selectedImageIndex:{name:"selectedImageIndex",index:0,type:"Integer"}}},SetSelectedIndex:{method:"setSelectedIndex",parameter:{selectedIndex:{name:"selectedIndex",index:0,type:"NumberArray1D"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{value:{name:"value",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TableItemImageList/TableItemImageList.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableItemImageList">CONTENT</div>\r\n'}),define("widgets/brease/TableItemImageList/TableItemImageList",["widgets/brease/TableItemWidget/TableItemWidget","brease/events/BreaseEvent"],function(e,BreaseEvent){"use strict";var t={imagePrefix:"",imageList:[],selectedIndex:[],data:[],dataInitialized:!1,fireDataInitEvent:!1,dataType:"String",selectedImageIndex:-1},i=e.extend(function TableItemImageList(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTableItemImageList"),e.prototype.init.call(this),brease.config.editMode&&(this.settings.mockImagePrefix="widgets/brease/TableItemImageList/assets/",this.settings.mockImageList=["ConnectionFail.svg"],this.settings.mockSelectedIndex=[0,0,0,0,0,0,0,0,0,0],this.updateImageListEditor(),this.el.zIndex(this.el.zIndex()+1)),this.currentSelection=-1;var t=this;this.el.one(BreaseEvent.WIDGET_READY,function(){0!==t.settings.selectedIndex.length&&(brease.config.editMode?t.updateImageListEditor():t.settings.data=t._buildImageList(t.settings.imagePrefix,t.settings.imageList,t.settings.selectedIndex),t.settings.fireDataInitEvent=!0,t.valueInitState.resolve())})},s.updateImageListEditor=function(){var e,t;t=""===this.settings.imageList[0]?this.settings.mockImageList:""===this.settings.imagePrefix?this.settings.mockImageList:this.settings.imageList,e=""===this.settings.imagePrefix?this.settings.mockImagePrefix:""===this.settings.imageList[0]?this.settings.mockImagePrefix:this.settings.imagePrefix;for(var i=0;i<10;i+=1)this.settings.mockSelectedIndex[i]=i%this.settings.imageList.length;this.settings.selectedIndex=this.settings.mockSelectedIndex,this.settings.data=this._buildImageList(e,t,this.settings.mockSelectedIndex)},s.setImagePrefix=function(e){this.settings.imagePrefix=e,brease.config.editMode&&(this.updateImageListEditor(),this._updateTable())},s.getImagePrefix=function(){return this.settings.imagePrefix},s.setImageList=function(e){void 0!==e?(this.settings.imageList=Array.isArray(e)?e:[""],this.settings.data=this._buildImageList(this.settings.imagePrefix,this.settings.imageList,this.settings.selectedIndex),this.updateTableValues()):this.settings.imageList=[""],brease.config.editMode&&(this.updateImageListEditor(),this._updateTable())},s.getImageList=function(){return this.settings.imageList},s.setSelectedIndex=function(e){void 0!==e&&(this.settings.selectedIndex=Array.isArray(e)?e:[],this.settings.data=this._buildImageList(this.settings.imagePrefix,this.settings.imageList,this.settings.selectedIndex),this.updateTableValues(),this._updateSelectedImageIndex(this.resetSelection()),"resolved"!==this.valueInitState.state()&&this.valueInitState.resolve())},s.resetSelection=function(){return this.currentSelection=-1,this.currentSelection},s.getSelectedIndex=function(){return this.settings.selectedIndex},s.setSelectedImageIndex=function(e){this.settings.selectedImageIndex=e},s.getSelectedImageIndex=function(){return this.settings.selectedImageIndex},s.getItemConfig=function(){var e={};return e.type=this.settings.dataType,e.input=!1,e.inputConfig={},e.inputConfig.inputStyle="default",e.inputConfig.validDataLength=0,e},s.updateTableValues=function(){this.valueUpdateAvailable=!0,this.settings.dataInitialized&&this.isTableReady()&&this.isVisible()&&(this.initialTableReadyCall=!0,brease.callWidget(this.tableId,"_valueUpdateAvailable",this.elem.id))},s._updateSelectedImageIndex=function(e){if(void 0!==e&&e<this.settings.selectedIndex.length)if(this.currentSelection=e,e>=0){this.settings.selectedImageIndex=this.settings.selectedIndex[e];var t=this.createEvent("SelectedImageIndexChanged",{imageIndex:this.getSelectedImageIndex()});t.dispatch(),this.sendValueChange({selectedImageIndex:this.getSelectedImageIndex()})}else{var i=this.createEvent("SelectedImageIndexChanged",{imageIndex:this.currentSelection});i.dispatch(),this.sendValueChange({selectedImageIndex:this.currentSelection})}},s.getItemType=function(){return"widgets/brease/TableItemImageList"},s._buildImageList=function(e,t,i){var s=[],n=this.isTableReady()?brease.callWidget(this.tableId,"getRowHeight"):30;return n=0!==this.settings.rowHeight?this.settings.rowHeight:n,$(i).each(function(a){void 0!==t[i[a]]&&t[i[a]].length>0?s.push('<img src="'+e+t[i[a]]+'" style="max-width:100%; max-height:'+n+'px;" /><span>'+t[i[a]]+"</span>"):s.push("")}),s},i}),define("text!widgets/brease/TableItemWidget/TableItemWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableItemWidget">CONTENT</div>\r\n'}),define("widgets/brease/TableWidget/libs/DialogueTexts",[],function(){"use strict";function DialogueTexts(){return{en:{title:"Configuration dialogue for AlarmList",filter:{title:"Filtering",col:"Column",op:"Operator",val:"Value",and:"and",or:"or",act:"Active",inact:"Inactive",actack:"Active Acknowledged",inactack:"Inactive Acknowledged",true:"true",false:"false"},sort:{title:"Sorting",col:"Column",sort:"Sort",by:"By",first:"First",inc:"Increasing",dec:"Decreasing",then:"then",az:"A to Z",za:"Z to A",old:"Oldest first",new:"Newest first",true:"true",false:"false"}},de:{title:"Konfigurationsdialog für AlarmList",filter:{title:"Filterung",col:"Spalte",op:"Operator",val:"Wert",and:"und",or:"oder",act:"Aktiv",inact:"Inaktiv",actack:"Aktiv & Bestätigen",inactack:"Inaktiv & Bestätigen",true:"wahr",false:"falsch"},sort:{title:"Sortierung",col:"Spalte",sort:"Sortieren",by:"nach",first:"Zuerst",inc:"aufsteigend",dec:"absteigend",then:"dann",az:"A bis Z",za:"Z bis A",old:"Den ältesten zuerst",new:"Den neusten zuerst",true:"wahr",false:"falsch"}}}}return new DialogueTexts}),define("widgets/brease/TableWidget/libs/EditorBehavior",["brease/core/Class","widgets/brease/TableWidget/libs/EditorHandles"],function(e,EditorHandles){"use strict";var t={},i=e.extend(function Model(t){e.apply(this,arguments),this.widget=t},t),s=i.prototype;s.initialize=function(){this.throttledFunc=_.throttle(this.reinitialize,500),n(this)},s.reinitialize=function(){this.widget.elem&&this.widget.renderer.rebuildView()},s.childrenInitializedEditor=function(){},s.childrenAdded=function(){this.throttledFunc()},s.childrenRemoved=function(e){if(e.target===this.widget.elem){var t=e.detail.widgetId,i=this.widget.model.childrenIdList.indexOf(t);i>-1&&(this.widget.model.childrenList.splice(i,1),this.widget.model.childrenIdList.splice(i,1))}this.reinitialize()},s.dispose=function(){};function n(e){e.editMode={},e.editMode.itemDefs=[],e.widget.el.find("[data-brease-widget]").each(function(){var t=$.Deferred();e.editMode.itemDefs.push(t)}),$.when.apply($,e.editMode.itemDefs).done(function(){e.childrenInitializedEditor()}),e.widget.el.addClass("iat-container-widget");var t=new EditorHandles(e.widget);e.widget.getHandles=function(){return t.getHandles()},e.widget.designer.getSelectionDecoratables=function(){return t.getSelectionDecoratables()}}return i}),define("text!widgets/brease/TableWidget/TableWidget.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableWidget">CONTENT</div>'}),define("text!widgets/brease/TableWidgetStyle/TableWidgetStyle.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TableWidgetStyle">CONTENT</div>\r\n'}),define("text!widgets/brease/TextInput/TextInput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/TextInput"></div>\r\n'}),define("widgets/brease/TextOutput/designer/ClassInfo",["widgets/brease/Label/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.TextOutput",parents:["*"],children:[],inheritance:["widgets.brease.TextOutput","widgets.brease.Label","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setAutoScroll:{method:"setAutoScroll",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"String"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/TextOutput/TextOutput.html",[],function(){return'<label id="WIDGETID" data-brease-widget="widgets/brease/TextOutput">CONTENT</label>\r\n'});define("widgets/brease/TextOutput/TextOutput",["widgets/brease/Label/Label"],function(e){"use strict";var t={value:"default"},i=e.extend(function TextOutput(){e.apply(this,arguments)},t),s=i.prototype;return s.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseTextOutput"),this.settings.text=this.settings.value,e.prototype.init.call(this)},s.setValue=function(e){void 0!==e&&(!1===brease.language.isKey(e)?(this.settings.value=this.settings.text=e,this.setText(this.settings.text),this.removeTextKey()):this.settings.value=this.setTextKey(brease.language.parseKey(e)))},s.getValue=function(){return this.settings.value},i}),define("text!widgets/brease/ToggleButton/ToggleButton.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/ToggleButton">CONTENT</div>\r\n'}),define("widgets/brease/ToggleSwitch/designer/ClassInfo",["widgets/brease/ToggleButton/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brease.ToggleSwitch",parents:["*"],children:[],inheritance:["widgets.brease.ToggleSwitch","widgets.brease.ToggleButton","widgets.brease.Button","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},GetValueBool:{method:"getValueBool"},GetValueInteger:{method:"getValueInteger"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setAdditionalStyle:{method:"setAdditionalStyle",parameter:{styleName:{name:"styleName",index:0,type:"StyleReference"}}},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetValueBool:{method:"setValueBool",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetValueInteger:{method:"setValueInteger",parameter:{value:{name:"value",index:0,type:"Integer"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}},properties:{}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brease/ToggleSwitch/ToggleSwitch.html",[],function(){return'<div id="WIDGETID" class="breaseToggleSwitch" data-brease-widget="widgets/brease/ToggleSwitch" data-instruction-addStyleClass="true" data-instruction-useDOM="true"><div class="contentWrapper"><div class="wrapper"><svg style="display: none;"></svg><img style="display: none;" /><span class="before"></span></div><div class="breaseToggleSwitch_toggle"></div><div class="wrapper"><svg style="display: none;"></svg><img style="display: none;" /><span class="after"></span></div></div></div>\r\n'}),define("widgets/brease/ToggleSwitch/ToggleSwitch",["widgets/brease/ToggleButton/ToggleButton","brease/enum/Enum","brease/core/Utils","brease/events/BreaseEvent","widgets/brease/common/libs/wfUtils/UtilsImage","brease/core/Types"],function(e,Enum,Utils,BreaseEvent,UtilsImage,Types){"use strict";var t={height:30,width:100,text:"",mouseDownText:"",image:"",mouseDownImage:""},i=e.extend(function ToggleSwitch(){e.apply(this,arguments)},t),s=i.prototype;i.values={checked:!0,unchecked:!1},s.init=function(){!0===this.settings.omitClass&&this.elem.classList.remove("breaseToggleSwitch"),this.slider=this.el.find(".breaseToggleSwitch_toggle"),this.slider.length&&(this.sliderClone=this.slider.get(0).cloneNode(!0),this.sliderClone.classList.add("remove"),this.elem.appendChild(this.sliderClone)),n(this),a(this),this.setClasses(),e.prototype.init.call(this),"auto"===this.settings.height&&Utils.isPercentageValue(c.call(this))&&this.slider.css({height:"auto","align-self":"stretch"}),
!0!==brease.config.editMode&&this.sliderClone&&(this.elem.removeChild(this.sliderClone),this.sliderClone=null)},s._initEditor=function(){var e=this;this.elem.addEventListener(BreaseEvent.WIDGET_STYLE_PROPERTIES_CHANGED,function(){"auto"===e.settings.height&&Utils.isPercentageValue(c.call(e))?e.slider.css({height:"auto","align-self":"stretch"}):e.slider.css({height:"","align-self":""})}),this.dispatchEvent(new CustomEvent(BreaseEvent.WIDGET_EDITOR_IF_READY,{bubbles:!0}))},s.setText=function(e,t){if(this.settings.text=e,!0!==t&&this.removeTextKey(),!0!==brease.config.editMode&&!0===brease.language.isKey(this.settings.text))return this.setTextKey(brease.language.parseKey(this.settings.text),!1),this.langChangeHandler(),void 0;void 0!==this.textEl&&r(this)},s.getText=function(){return this.settings.text},s.setMouseDownText=function(e,t){if(this.settings.mouseDownText=e,!0!==t&&this.removeMouseDownTextKey(),!0!==brease.config.editMode&&!0===brease.language.isKey(this.settings.mouseDownText))return this.setMouseDownTextKey(brease.language.parseKey(this.settings.mouseDownText),!1),this.langChangeHandler(),void 0;void 0!==this.checkedTextEl&&r(this)},s.getMouseDownText=function(){return this.settings.mouseDownText},s.setImageAlign=function(e){this.settings.imageAlign=e,this.setClasses(),!this.textEl||this.settings.imageAlign!==Enum.ImageAlign.left&&this.settings.imageAlign!==Enum.ImageAlign.top?(this.wrapperAfter.append(this.imgEl),this.wrapperAfter.append(this.svgEl),this.wrapperBefore.append(this.checkedImgEl),this.wrapperBefore.append(this.checkedSvgEl)):(this.wrapperAfter.prepend(this.imgEl),this.wrapperAfter.prepend(this.svgEl),this.wrapperBefore.prepend(this.checkedImgEl),this.wrapperBefore.prepend(this.checkedSvgEl))},s.setImage=function(e){var t=this;e=Types.parseValue(e,"String",{default:""}),this.settings.image=e,d(this.imageDeferred),e.length>0?UtilsImage.isStylable(e)&&t.settings.useSVGStyling?(t.imgEl.hide(),this.imageDeferred=UtilsImage.getInlineSvg(e),this.imageDeferred.then(function(e){t.svgEl.replaceWith(e),t.svgEl=e,t.svgEl.show()})):(t.imgEl.attr("src",e).show(),t.svgEl.hide()):(t.imgEl.hide(),t.svgEl.hide())},s.setStyle=function(t){e.prototype.setStyle.call(this,t)},s.setMouseDownImage=function(e){var t=this;e=Types.parseValue(e,"String",{default:""}),this.settings.mouseDownImage=e,d(this.mouseDownImageDeferred),e.length>0?UtilsImage.isStylable(e)&&t.settings.useSVGStyling?(t.checkedImgEl.hide(),this.mouseDownImageDeferred=UtilsImage.getInlineSvg(e),this.mouseDownImageDeferred.then(function(e){t.checkedSvgEl.replaceWith(e),t.checkedSvgEl=e,t.checkedSvgEl.show()})):(t.checkedImgEl.attr("src",e).show(),t.checkedSvgEl.hide()):(t.checkedImgEl.hide(),t.checkedSvgEl.hide())},s.toggle=function(e,t){var s=!1;if(e=l.call(this,e),e===i.values.checked?(this.settings.value===i.values.unchecked&&(s=!0),this.settings.value=i.values.checked):(this.settings.value===i.values.checked&&(s=!0),this.settings.value=i.values.unchecked),o(this,this.settings.value),!0===s&&!0!==t){this.createEvent("ValueChanged",{newValue:this.getValue(),newValueBool:this.getValueBool(),newValueInteger:this.getValueInteger()}).dispatch(),this.submitChange()}this.dispatchEvent(new CustomEvent(BreaseEvent.CHANGE,{bubbles:!0,cancelable:!0,detail:{checked:this.isChecked()}}))},s._downHandler=function(t){e.prototype._downHandler.apply(this,arguments),this.isActive&&(this.currentTargetClicked=t.currentTarget)},s._upHandler=function(t){e.prototype._upHandler.apply(this,arguments),this.isDisabled||brease.config.editMode||Utils.getPointerId(t)!==this.pointerId||this.currentTargetClicked===t.currentTarget&&o(this,!this.settings.value)},s.setClasses=function(){var e;if(void 0===this.imgEl&&void 0===this.checkedImgEl||void 0===this.textEl||""===this.settings.text)this.elem.classList.remove("image-left","image-right","image-top","image-bottom");else{switch(this.settings.imageAlign){case Enum.ImageAlign.left:e="image-left";break;case Enum.ImageAlign.right:e="image-right";break;case Enum.ImageAlign.top:e="image-top";break;case Enum.ImageAlign.bottom:e="image-bottom";break}this.elem.classList.remove("image-left","image-right","image-top","image-bottom"),this.elem.classList.add(e)}},s.dispose=function(){d(this.imageDeferred),d(this.mouseDownImageDeferred),e.prototype.dispose.apply(this,arguments)};function n(e){e.wrapperBefore=e.el.find(".wrapper:first-child"),e.wrapperAfter=e.el.find(".wrapper:last-child"),e.imgEl=e.wrapperAfter.find("img"),e.checkedImgEl=e.wrapperBefore.find("img"),e.svgEl=e.wrapperAfter.find("svg"),e.checkedSvgEl=e.wrapperBefore.find("svg"),e.setImage(e.settings.image),e.setMouseDownImage(e.settings.mouseDownImage),e.wrapperBefore.prepend(e.imgEl,e.svgEl),e.wrapperAfter.prepend(e.checkedImgEl,e.checkedSvgEl)}function a(e){e.textEl=e.wrapperAfter.find("span"),e.checkedTextEl=e.wrapperBefore.find("span"),r(e)}function r(e){e.textEl.text(brease.language.unescapeText(e.settings.text)),e.checkedTextEl.text(brease.language.unescapeText(e.settings.mouseDownText))}function o(e,t){t?e.elem.classList.add("checked"):e.elem.classList.remove("checked")}function l(e){return void 0===e&&(e=this.settings.value===i.values.unchecked?i.values.checked:i.values.unchecked),e}function d(e){e&&"pending"===e.state()&&e.reject()}function c(){return this.sliderClone?window.getComputedStyle(this.sliderClone).getPropertyValue("height"):""}return i}),define("text!widgets/brease/Window/Window.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brease/Window">\r\n    <header>\r\n        <div></div>\r\n    </header>\r\n    <div class="contentBox">\r\n        <div class="content"></div>\r\n    </div>\r\n</div>\r\n'}),define("widgets/brXtended/DropDownBox/designer/ClassInfo",["widgets/brease/DropDownBox/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brXtended.DropDownBox",parents:["*"],children:[],inheritance:["widgets.brXtended.DropDownBox","widgets.brease.DropDownBox","brease.core.BaseWidget"],actions:{Close:{method:"close"},Focus:{method:"focus"},GetSelectedIndex:{method:"getSelectedIndex"},GetSelectedValue:{method:"getSelectedValue"},Open:{method:"open"},setCropToParent:{method:"setCropToParent",parameter:{cropToParent:{name:"cropToParent",index:0,type:"brease.enum.CropToParent"}}},SetDataProvider:{method:"setDataProvider",parameter:{value:{name:"value",index:0,type:"ItemCollection"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},setDisplaySettings:{method:"setDisplaySettings",parameter:{displaySettings:{name:"displaySettings",index:0,type:"brease.enum.DropDownDisplaySettings"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFitHeight2Items:{method:"setFitHeight2Items",parameter:{fitHeight2Items:{name:"fitHeight2Items",index:0,type:"Boolean"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},setImagePath:{method:"setImagePath",parameter:{imagePath:{name:"imagePath",index:0,type:"DirectoryPath"}}},setItemHeight:{method:"setItemHeight",parameter:{itemHeight:{name:"itemHeight",index:0,type:"Integer"}}},setListPosition:{method:"setListPosition",parameter:{listPosition:{name:"listPosition",index:0,type:"brease.enum.Position"}}},setListWidth:{method:"setListWidth",parameter:{listWidth:{name:"listWidth",index:0,type:"Integer"}}},setMaxVisibleEntries:{method:"setMaxVisibleEntries",parameter:{maxVisibleEntries:{name:"maxVisibleEntries",index:0,type:"Integer"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetSelectedIndex:{method:"setSelectedIndex",parameter:{index:{name:"index",index:0,type:"Integer"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},SetSelectedValue:{method:"setSelectedValue",parameter:{value:{name:"value",index:0,type:"String"},omitPrompt:{name:"omitPrompt",index:1,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},Toggle:{method:"toggle"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brXtended/DropDownBox/DropDownBox.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brXtended/DropDownBox"></div>\r\n'}),define("widgets/brXtended/DropDownBox/libs/config/Config",["brease/enum/Enum"],function(Enum){"use strict";return{selectedIndex:0,selectedValue:"",itemHeight:40,imageAlign:Enum.ImageAlign.left,imagePath:"",ellipsis:!1,wordWrap:!1,multiLine:!1,fitHeight2Items:!0,dataProvider:[],listPosition:Enum.Position.right,listPositionExt:0,listWidth:150,maxVisibleEntries:4,cropToParent:Enum.CropToParent.none,displaySettings:Enum.DropDownDisplaySettings.default,tabIndex:0}}),define("widgets/brXtended/DropDownBox/libs/view/DropDownBoxView/DropDownBoxView",["widgets/brease/common/libs/redux/view/ListView/ListView","widgets/brease/common/libs/redux/view/ItemView/ItemView","widgets/brease/DropDownBox/libs/reducer/DropDownBoxActions","brease/enum/Enum","brease/core/Utils","brease/events/BreaseEvent","brease/controller/PopUpManager","brease/events/EventDispatcher"],function(ListView,ItemView,DropDownBoxActions,Enum,Utils,BreaseEvent,e,EventDispatcher){"use strict";const t=0,i=1,s=2;var DropDownBoxView=function(e,t,i){this.el=t,this.elem=this.el.get(0),this.store=e,this.widget=i,this.render()};DropDownBoxView.prototype=new EventDispatcher;var n=DropDownBoxView.prototype;n.render=function e(){this.borderColors=this.getBorderColors(),this.dispose(),this.el.addClass("breaseDropDownBox DropDownBoxView");var t=this.store.getState();if(t.status.visible&&t.status.active){var i=t.items.itemList[t.items.selectedIndex],s=void 0===i?void 0:t.text.textElements[i.textId],n=void 0===i?void 0:t.image.imageElements[i.imageId],l={imageIndicator:{showImage:!0},text:{text:void 0===s?"":s.displayText,textSettings:t.text.textSettings,showText:t.items.listSettings.showTextsInButton},image:{image:void 0===n?void 0:n.imagePath,showImage:t.items.listSettings.showImagesInButton},itemSettings:{itemHeight:"100%",imageAlign:t.items.itemSettings.imageAlign},status:{enabled:t.status.enabled,visible:t.status.visible,selected:t.items.listOpen,lastItem:!0},offline:t.items.offline,onClick:r.bind(this)};if(this.itemView=new ItemView(l,this.el),t.items.listOpen){this.listContainer=$("<div id='"+this.elem.id+"_listBoxWrapper' class='listBoxContainer "+t.style.styleToApply+"'></div>"),this.arrow=$("<div class='arrow'></div>"),this.listContainer.append(this.arrow),brease.bodyEl.append(this.listContainer);var c=u(this.listContainer),g=Utils.getScaleFactor(this.elem),m={height:this.elem.offsetHeight,width:this.elem.offsetWidth},p=this.getLimits(t.items.listSettings.cropToParent,this.el,brease.appView,brease.bodyEl),f=this.elem.getBoundingClientRect(),b={height:t.items.listSettings.listHeight+c,width:t.items.listSettings.listWidth},v=brease.appElem.getBoundingClientRect().height,y=this.getLocation(t.items.listSettings.listPosition,t.items.listSettings.listPositionExt,b,v,f,p,g);this._listContainerSizePos(this.listContainer,y,g),h.call(this,t.items.listSettings.listPosition,m,y.width,g);var w={status:t.status,items:t.items,text:t.text,image:t.image,onClick:function(e,t,i){return function(s,n){a(e,s,t,n,i),n.preventDefault()}}(this.store,this.widget,this.elem)};this.listView=new ListView(w,this.listContainer),this.closeOnMouseDownBound=o.bind(this),this.closeOnWheelBound=d.bind(this),brease.bodyEl.on(BreaseEvent.MOUSE_DOWN,this.closeOnMouseDownBound),brease.bodyEl.on("wheel",this.closeOnWheelBound),this.dispatchEvent({type:"ViewRendered"})}}},n.dispose=function e(){void 0!==this.listView&&this.listView.dispose(),void 0!==this.itemView&&this.itemView.dispose(),void 0!==this.arrow&&this.arrow.remove(),void 0!==this.listContainer&&this.listContainer.remove(),void 0!==this.closeOnMouseDownBound&&brease.bodyEl.off(BreaseEvent.MOUSE_DOWN,this.closeOnMouseDownBound),void 0!==this.closeOnWheelBound&&brease.bodyEl.off("wheel",this.closeOnWheelBound),void 0!==this.closeOnMouseMoveBound&&brease.bodyEl.off(BreaseEvent.MOUSE_MOVE,this.closeOnMouseMoveBound)};function a(e,t,i,s,n){if(n){var a=n.getBoundingClientRect();if(s.clientX=a.left,s.clientY=a.top,i._clickHandler.call(i,s),e.getState().status.enabled){var r=DropDownBoxActions.updateSelectedItem(t);e.dispatch(r),i.valueChangeFromUI()}}}function r(e){if(this.openEventTimeStamp=e.timeStamp,this.store.getState().status.enabled){var t=DropDownBoxActions.toggleListStatus();this.store.dispatch(t),this.widget.triggerToggleStateChanged()}}function o(e){this.openEventTimeStamp===e.timeStamp||$.contains(this.listContainer.find(".ListView")[0],e.target)||this.elem.contains(e.target)?$.contains(this.elem,e.target)&&(this.closeOnMouseMoveBound=l.bind(this),brease.bodyEl.on(BreaseEvent.MOUSE_MOVE,this.closeOnMouseMoveBound)):c(this.store,this.widget)}function l(){c(this.store,this.widget)}function d(e){$.contains(this.listContainer.find(".ListView")[0],e.target)||c(this.store,this.widget)}function c(e,t){var i=DropDownBoxActions.closeList();e.dispatch(i),t.triggerToggleStateChanged()}n._listContainerSizePos=function(e,t,i){e.css({position:"fixed",height:t.height,width:t.width,top:t.top,left:t.left,"z-index":t.zIndex,transform:"scale("+i+","+i+")","transform-origin":"0px 0px 0px"})};function h(e,t,i,s){switch(e){case Enum.Position.bottom:this.listContainer.addClass("bottom"),this.arrow.addClass("bottom"),this.arrow.css({"margin-left":i/2-8,"border-bottom-color":this.borderColors.top});break;case Enum.Position.top:this.listContainer.addClass("top"),this.arrow.addClass("top"),this.arrow.css({"margin-left":i/2-8,"border-top-color":this.borderColors.bottom});break;case Enum.Position.left:this.listContainer.addClass("left"),this.arrow.addClass("left"),this.arrow.css({"margin-top":(this.el.offset().top-this.arrow.offset().top)/s+t.height/2-8,"border-left-color":this.borderColors.right});break;case Enum.Position.right:this.listContainer.addClass("right"),this.arrow.addClass("right"),this.arrow.css({"margin-top":(this.el.offset().top-this.arrow.offset().top)/s+t.height/2-8,"border-right-color":this.borderColors.left});break;case Enum.Position.center:this.listContainer.addClass("center"),this.arrow.addClass("center");break;case Enum.Position.middle:this.listContainer.addClass("right"),this.arrow.addClass("middle");break}}function u(e){var t=$('<div class="ListView Container"></div>');e.append(t);var i=Utils.roundTo(parseFloat(t.css("border-top-width")),0),s=Utils.roundTo(parseFloat(t.css("border-bottom-width")),0),n=i+s;return t.remove(),n}n.getLocation=function t(i,s,n,a,r,o,l){var d={top:0,left:0,width:n.width,height:n.height},c=8;switch(1===s?d.top=r.bottom-n.height*l:2===s?(d.top=(a-n.height*l)/2,d.top<0&&(d.top=0),d.top>r.top&&(d.top=r.top),d.top+n.height*l<r.bottom&&(d.top=r.bottom-n.height*l)):d.top=r.top,i){case Enum.Position.bottom:d.height+=8,d.top=r.bottom,d.left=r.left+(r.width-n.width*l)/2;break;case Enum.Position.top:d.height+=8,d.top=r.top-(n.height+8)*l,d.left=r.left+(r.width-n.width*l)/2;break;case Enum.Position.left:d.left=r.left-n.width*l;break;case Enum.Position.right:d.left=r.right;break;case Enum.Position.center:d.left=r.left+(r.width-n.width*l)/2;break;case Enum.Position.middle:d.top=r.top+(r.height-n.height*l)/2,d.left=r.left+(r.width-n.width*l)/2;break}return p(d,o,l,i),d.zIndex=e.getHighestZindex()+1,d};function g(e,t){var i=this.el.closest("div[data-brease-areaId]"),s=e.get(0).getBoundingClientRect();if(i.length>0&&!t){var n=i[0].getBoundingClientRect();return{top:Math.min(n.top,s.top),bottom:Math.max(n.bottom,s.bottom),left:Math.min(n.left,s.left),right:Math.max(n.right,s.right)}}return s}n.getLimits=function(e,t,i,s){var n={top:0,right:0,bottom:0,left:0,width:0,height:0},a=m(t.get(0)),r=null!==a,o=g.call(this,i,r),l=f(s.get(0).getBoundingClientRect()),d=t.parent().get(0).getBoundingClientRect();switch(e){case Enum.CropToParent.height:case Enum.CropToParent.both:n.top=d.top,n.right=r?l.right:o.right,n.bottom=d.bottom,n.left=o.left;break;default:n.top=o.top,n.right=r?l.right:o.right,n.bottom=r?l.bottom:o.bottom,n.left=o.left}return n.top=Math.max(l.top,n.top),n.right=Math.min(l.right,n.right),n.bottom=Math.min(l.bottom,n.bottom),n.left=Math.max(l.left,n.left),n.width=n.right-n.left,n.height=n.bottom-n.top,n},n.getBorderColors=function(){if(!this.itemView)return[];var e=getComputedStyle(this.itemView.el.get(0));return{bottom:e.getPropertyValue("border-bottom-color"),left:e.getPropertyValue("border-left-color"),right:e.getPropertyValue("border-right-color"),top:e.getPropertyValue("border-top-color")}};function m(e){return Utils.getClosestDialogElem(e)}function p(e,t,i,s){e.top<t.top&&(s!==Enum.Position.top&&s!==Enum.Position.middle||(e.height-=Math.abs(e.top-t.top)/i),e.top=t.top),e.top+e.height*i>t.top+t.height&&(e.height-=(e.top+e.height*i-t.top-t.height)/i),e.left<t.left&&(e.left=t.left),e.left+e.width*i>t.right&&(e.left=Math.max(t.right-e.width*i,0))}function f(e){var t={top:e.top,right:e.right,bottom:e.bottom,left:e.left};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.top=0,t.left=0,t.bottom=t.height,t.right=t.width,t}return DropDownBoxView}),define("widgets/brXtended/DropDownBox/DropDownBox",["widgets/brease/DropDownBox/DropDownBox","widgets/brease/DropDownBox/libs/FocusHandler","widgets/brXtended/DropDownBox/libs/config/Config","widgets/brease/DropDownBox/libs/config/InitState","widgets/brease/DropDownBox/libs/SubmitQueue","brease/decorators/LanguageDependency","brease/decorators/VisibilityDependency","widgets/brXtended/DropDownBox/libs/view/DropDownBoxView/DropDownBoxView","widgets/brease/DropDownBox/libs/reducer/DropDownBoxActions","widgets/brease/DropDownBox/libs/reducer/DropDownBoxReducer","widgets/brease/common/libs/external/redux","widgets/brease/common/libs/redux/utils/UtilsList","widgets/brease/common/libs/redux/utils/UtilsImage","widgets/brease/common/libs/redux/utils/UtilsText","widgets/brease/common/libs/BindingSync","widgets/brease/common/libs/wfUtils/UtilsEditableBinding","brease/decorators/DragAndDropCapability","widgets/brease/common/DragDropProperties/libs/DroppablePropertiesEvents"],function(e,FocusHandler,Config,InitState,SubmitQueue,t,i,DropDownBoxView,DropDownBoxActions,DropDownBoxReducer,s,UtilsList,UtilsImage,UtilsText,BindingSync,UtilsEditableBinding,n){"use strict";var a=Config,r=e.extend(function DropDownBox(){e.apply(this,arguments)},a);return r.prototype.init=function(){e.prototype.init.apply(this,arguments);var t=InitState.calculateInitState(this.settings,this.isEnabled(),this.isVisible());t.items.listSettings.listPositionExt=this.settings.listPositionExt,this.store=s.createStore(DropDownBoxReducer,t),window.removeEventListener("addEventListener",this.focusHandler.onRender.bind(this.focusHandler)),this.dropDownBoxView.dispose(),this.submitQueue.clear(),this.dropDownBoxView=new DropDownBoxView(this.store,this.el,this),this.store.subscribe(this.dropDownBoxView.render.bind(this.dropDownBoxView)),brease.config.isKeyboardOperationEnabled()&&this.dropDownBoxView.addEventListener("ViewRendered",this.focusHandler.onRender.bind(this.focusHandler))},n.decorate(i.decorate(t.decorate(r,!0),!1),!1)}),define("widgets/brXtended/NumericInput/designer/ClassInfo",["widgets/brease/NumericInput/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brXtended.NumericInput",parents:["*"],children:[],inheritance:["widgets.brXtended.NumericInput","widgets.brease.NumericInput","brease.core.BaseWidget"],actions:{Focus:{method:"focus"},OpenNumPadExt:{method:"openNumPadExt"},SetBackColorExt:{method:"setBackColorExt",parameter:{value:{name:"value",index:0,type:"String"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setFormat:{method:"setFormat",parameter:{format:{name:"format",index:0,type:"brease.config.MeasurementSystemFormat"}}},setKeyboard:{method:"setKeyboard",parameter:{keyboard:{name:"keyboard",index:0,type:"Boolean"}}},setLimitViolationPolicy:{method:"setLimitViolationPolicy",parameter:{limitViolationPolicy:{name:"limitViolationPolicy",index:0,type:"brease.enum.LimitViolationPolicy"}}},setMaxValue:{method:"setMaxValue",parameter:{maxValue:{name:"maxValue",index:0,type:"Number"}}},setMinValue:{method:"setMinValue",parameter:{minValue:{name:"minValue",index:0,type:"Number"}}},setNode:{method:"setNode",parameter:{node:{name:"node",index:0,type:"brease.datatype.Node"}}},setNumPadStyle:{method:"setNumPadStyle",parameter:{numPadStyle:{name:"numPadStyle",index:0,type:"String"}}},setNumpadPosition:{method:"setNumpadPosition",parameter:{numpadPosition:{name:"numpadPosition",index:0,type:"brease.enum.Position"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},setReadonly:{method:"setReadonly",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setShowUnit:{method:"setShowUnit",parameter:{showUnit:{name:"showUnit",index:0,type:"Boolean"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setSubmitOnChange:{method:"setSubmitOnChange",parameter:{submitOnChange:{name:"submitOnChange",index:0,type:"Boolean"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},setUnit:{method:"setUnit",parameter:{unit:{name:"unit",index:0,type:"brease.config.MeasurementSystemUnit"}}},setUnitAlign:{method:"setUnitAlign",parameter:{unitAlign:{name:"unitAlign",index:0,type:"brease.enum.ImageAlign"}}},setUnitTextAlign:{method:"setUnitTextAlign",parameter:{unitTextAlign:{name:"unitTextAlign",index:0,type:"brease.enum.TextAlign"}}},setUnitWidth:{method:"setUnitWidth",parameter:{value:{name:"value",index:0,type:"Size"}}},setUseDigitGrouping:{method:"setUseDigitGrouping",parameter:{useDigitGrouping:{name:"useDigitGrouping",index:0,type:"Boolean"}}},SetValue:{method:"setValue",parameter:{value:{name:"value",index:0,type:"Number"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"},SubmitChange:{method:"submitChange"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("widgets/brXtended/NumericInput/libs/Config",["brease/enum/Enum"],function(Enum){"use strict";return{}}),define("text!widgets/brXtended/NumericInput/NumericInput.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brXtended/NumericInput"></div>\r\n'}),define("widgets/brXtended/NumericInput/libs/config",["brease/enum/Enum"],function(Enum){"use strict";return{}}),define("widgets/brXtended/NumericInput/NumericInput",["widgets/brease/NumericInput/NumericInput","brease/decorators/LanguageDependency","brease/decorators/MeasurementSystemDependency","widgets/brXtended/NumericInput/libs/config","brease/enum/Enum","brease/core/Utils"],function(e,t,i,Config,Enum,Utils){"use strict";const s=1e4,n=10001;var a=Config,r=e.extend(function NumericInput(){e.apply(this,arguments)},a),o=r.prototype;return o.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("breaseNumericInput"),this.settings.omitClass=!0,e.prototype.init.call(this)},o.setBackColorExt=function(e){var t=this,i=(new Option).style;i.color=e,""!==i.color?this.el.css("background-color",e):t._errorHandling(10001)},o._errorHandling=function e(t){console.log("NumericInput Error:"+t);var i=this,s=i.createEvent("OnError",{result:t});if(void 0!==s&&s.dispatch(),!brease.config.editMode){var n="Error "+t+" in brXtended on page "+i.settings.parentContentId+" at widget "+this.elem.id;brease.loggerService.log(Enum.EventLoggerId.CLIENT_SCRIPT_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[],n)}},o.openNumPadExt=function(){this._showNumPad(this)},o._createUnitEl=function(){return $("<span></span>").addClass("breaseNumericInputExt_unit")},i.decorate(t.decorate(r,!1),!0)}),define("widgets/brXtended/Screenshot/designer/ClassInfo",["widgets/brease/Button/designer/ClassInfo"],function(e,t){"use strict";var i={meta:{className:"widgets.brXtended.Screenshot",parents:["*"],children:[],inheritance:["widgets.brXtended.Screenshot","widgets.brease.Button","brease.core.BaseWidget"],actions:{Screenshot2Client:{method:"Screenshot2Client"},Screenshot2Plc:{method:"Screenshot2Plc",parameter:{filePath:{name:"filePath",index:0,type:"FilePath"}}},Focus:{method:"focus"},RemoveImage:{method:"removeImage"},RemoveMouseDownText:{method:"removeMouseDownText"},RemoveText:{method:"removeText"},setBreakWord:{method:"setBreakWord",parameter:{breakWord:{name:"breakWord",index:0,type:"Boolean"}}},setEditable:{method:"setEditable",parameter:{editable:{name:"editable",index:0,type:"Boolean"},metaData:{name:"metaData",index:1,type:"Object"}}},setEllipsis:{method:"setEllipsis",parameter:{ellipsis:{name:"ellipsis",index:0,type:"Boolean"}}},SetEnable:{method:"setEnable",parameter:{value:{name:"value",index:0,type:"Boolean"}}},SetImage:{method:"setImage",parameter:{image:{name:"image",index:0,type:"ImagePath"}}},setImageAlign:{method:"setImageAlign",parameter:{imageAlign:{name:"imageAlign",index:0,type:"brease.enum.ImageAlign"}}},SetMouseDownImage:{method:"setMouseDownImage",parameter:{mouseDownImage:{name:"mouseDownImage",index:0,type:"ImagePath"}}},SetMouseDownText:{method:"setMouseDownText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setMouseDownTextKey:{method:"setMouseDownTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setMultiLine:{method:"setMultiLine",parameter:{multiLine:{name:"multiLine",index:0,type:"Boolean"}}},setParentCoWiId:{method:"setParentCoWiId",parameter:{value:{name:"value",index:0,type:"String"}}},SetStyle:{method:"setStyle",parameter:{value:{name:"value",index:0,type:"StyleReference"}}},setTabIndex:{method:"setTabIndex",parameter:{value:{name:"value",index:0,type:"Number"}}},SetText:{method:"setText",parameter:{text:{name:"text",index:0,type:"String"},keepKey:{name:"keepKey",index:1,type:"Boolean"}}},setTextKey:{method:"setTextKey",parameter:{key:{name:"key",index:0,type:"String"}}},setUseSVGStyling:{method:"setUseSVGStyling",parameter:{useSVGStyling:{name:"useSVGStyling",index:0,type:"Boolean"}}},SetVisible:{method:"setVisible",parameter:{value:{name:"value",index:0,type:"Boolean"}}},setWordWrap:{method:"setWordWrap",parameter:{wordWrap:{name:"wordWrap",index:0,type:"Boolean"}}},ShowTooltip:{method:"showTooltip"}}}};return e.classExtension&&(i.classExtension=e.classExtension),t&&(i.classExtension=t),i}),define("text!widgets/brXtended/Screenshot/Screenshot.html",[],function(){return'<div id="WIDGETID" data-brease-widget="widgets/brXtended/Screenshot">CONTENT</div>\r\n'}),define("widgets/brXtended/Screenshot/Screenshot",["widgets/brease/Button/Button","widgets/brease/FileExplorerSystem/FileExplorerSystem","widgets/brease/FileManager/FileManager","brease/enum/Enum","brease/core/Utils"],function(e,FileExplorerSystem,FileManager,Enum,Utils){"use strict";const t=1e4,i=10001;var s={},n=e.extend(function Screenshot(){e.apply(this,arguments)},s),a=n.prototype;return a.init=function(){!0!==this.settings.omitClass&&this.addInitialClass("brXtendedScreenshot"),brease.config.editMode||(this.a=document.createElement("a"),this.a.style.display="none",document.body.appendChild(this.a)),e.prototype.init.call(this)},a.Screenshot2Client=function e(){var t=this,i={video:{cursor:"always"},audio:!1};void 0===navigator.mediaDevices?t._errorHandling(10001,"Use HTTPS access or use flag #unsafely-treat-insecure-origin-as-secure"):navigator.mediaDevices.getDisplayMedia(i).then(function(e){setTimeout(function(){var i=document.createElement("canvas"),s=document.createElement("video");s.srcObject=e,s.play().then(function(){i.width=s.videoWidth,i.height=s.videoHeight,i.getContext("2d").drawImage(s,0,0),i.toBlob(function(e){var i=URL.createObjectURL(e),n=(new Date).toISOString().replace(/[:-]/g,"").replace("T","_").split(".")[0],a="screenshot_"+n+".png";t.a.href=i,t.a.download=a,s.srcObject.getTracks().forEach(function(e){e.stop()}),t.a.click();var r=t.createEvent("FileDownloaded",{});void 0!==r&&r.dispatch()})}).catch(function(e){t._handleStreamError(e)})},1e3)}).catch(function(e){t._handleStreamError(e)})},a.Screenshot2Plc=function e(t){var i=this,s={video:{cursor:"always"},audio:!1};void 0===navigator.mediaDevices?i._errorHandling(10001,"Use HTTPS access or use flag #unsafely-treat-insecure-origin-as-secure"):navigator.mediaDevices.getDisplayMedia(s).then(function(e){setTimeout(function(){var s=document.createElement("canvas"),n=document.createElement("video");n.srcObject=e,n.play().then(function(){s.width=n.videoWidth,s.height=n.videoHeight,s.getContext("2d").drawImage(n,0,0),n.srcObject.getTracks().forEach(function(e){e.stop()});var e=s.toDataURL("image/png").replace(/^data:image\/png;base64,/,""),a=(new Date).toISOString().replace(/[:-]/g,"").replace("T","_").split(".")[0],r=t+"/screenshot_"+a+".png";i._saveFile(r,"OVERWRITE","BINARY",e)}).catch(function(e){i._handleStreamError(e)})},1e3)}).catch(function(e){i._handleStreamError(e)})},a._saveFile=function e(t,i,s,n){if(!brease.config.preLoadingState){var a=this;void 0===a.fileExplorer&&(a.fileExplorer=new FileExplorerSystem),void 0===a.fileManager&&(a.fileManager=FileManager.createWidget(a.elem.id)),a.fileManager.save(a.elem.id,t,i,s,n).then(function(){var e=a.createEvent("FileSaved",{filePath:t});void 0!==e&&e.dispatch()}).catch(function(e){a._errorHandling(e.error.code,e.error.message)})}},a._handleStreamError=function e(t){var i=this;void 0===t.error||void 0===t.error.code?i._errorHandling(1e4,t.message):i._errorHandling(t.error.code,t.error.message)},a._errorHandling=function e(t,i){console.log("Screenshot Error:"+t);var s=this,n=s.createEvent("OnError",{result:t});if(void 0!==n&&n.dispatch(),!brease.config.editMode){var a="Error "+t+" in brXtended on page "+s.settings.parentContentId+" at widget "+this.elem.id;""!==i&&(a=a+" - "+i),brease.loggerService.log(Enum.EventLoggerId.CLIENT_SCRIPT_FAIL,Enum.EventLoggerCustomer.BUR,Enum.EventLoggerVerboseLevel.OFF,Enum.EventLoggerSeverity.ERROR,[],a)}},a.dispose=function(){var t=this;e.prototype.dispose.apply(t,arguments)},n}),require.config({waitSeconds:30,paths:{text:"libs/require_plugins/text",css:"libs/require_plugins/css","css-build":"libs/require_plugins/css-build",requireLib:"libs/require",globalize:"libs/globalize",hammer:"libs/hammer.min",mappView:"../mappView",ace:"libs/ace",DOMPurify:"libs/purify.min"},shim:{jquery:{exports:"jquery"},"libs/lodash":{exports:"_"}}}),define("require_config",function(){});